(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function aS(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var QE={exports:{}},wy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ER;function LP(){if(ER)return wy;ER=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var c in s)c!=="key"&&(r[c]=s[c])}else r=s;return s=r.ref,{$$typeof:i,type:n,key:o,ref:s!==void 0?s:null,props:r}}return wy.Fragment=e,wy.jsx=t,wy.jsxs=t,wy}var bR;function UP(){return bR||(bR=1,QE.exports=LP()),QE.exports}var ie=UP(),ZE={exports:{}},bn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TR;function PP(){if(TR)return bn;TR=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function v(K){return K===null||typeof K!="object"?null:(K=y&&K[y]||K["@@iterator"],typeof K=="function"?K:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,R={};function M(K,ce,Ee){this.props=K,this.context=ce,this.refs=R,this.updater=Ee||x}M.prototype.isReactComponent={},M.prototype.setState=function(K,ce){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,ce,"setState")},M.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function T(){}T.prototype=M.prototype;function D(K,ce,Ee){this.props=K,this.context=ce,this.refs=R,this.updater=Ee||x}var B=D.prototype=new T;B.constructor=D,b(B,M.prototype),B.isPureReactComponent=!0;var L=Array.isArray,G={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function F(K,ce,Ee,Me,Ve,ge){return Ee=ge.ref,{$$typeof:i,type:K,key:ce,ref:Ee!==void 0?Ee:null,props:ge}}function U(K,ce){return F(K.type,ce,void 0,void 0,void 0,K.props)}function I(K){return typeof K=="object"&&K!==null&&K.$$typeof===i}function N(K){var ce={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(Ee){return ce[Ee]})}var z=/\/+/g;function W(K,ce){return typeof K=="object"&&K!==null&&K.key!=null?N(""+K.key):ce.toString(36)}function k(){}function he(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(k,k):(K.status="pending",K.then(function(ce){K.status==="pending"&&(K.status="fulfilled",K.value=ce)},function(ce){K.status==="pending"&&(K.status="rejected",K.reason=ce)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function me(K,ce,Ee,Me,Ve){var ge=typeof K;(ge==="undefined"||ge==="boolean")&&(K=null);var ze=!1;if(K===null)ze=!0;else switch(ge){case"bigint":case"string":case"number":ze=!0;break;case"object":switch(K.$$typeof){case i:case e:ze=!0;break;case m:return ze=K._init,me(ze(K._payload),ce,Ee,Me,Ve)}}if(ze)return Ve=Ve(K),ze=Me===""?"."+W(K,0):Me,L(Ve)?(Ee="",ze!=null&&(Ee=ze.replace(z,"$&/")+"/"),me(Ve,ce,Ee,"",function(At){return At})):Ve!=null&&(I(Ve)&&(Ve=U(Ve,Ee+(Ve.key==null||K&&K.key===Ve.key?"":(""+Ve.key).replace(z,"$&/")+"/")+ze)),ce.push(Ve)),1;ze=0;var Je=Me===""?".":Me+":";if(L(K))for(var lt=0;lt<K.length;lt++)Me=K[lt],ge=Je+W(Me,lt),ze+=me(Me,ce,Ee,ge,Ve);else if(lt=v(K),typeof lt=="function")for(K=lt.call(K),lt=0;!(Me=K.next()).done;)Me=Me.value,ge=Je+W(Me,lt++),ze+=me(Me,ce,Ee,ge,Ve);else if(ge==="object"){if(typeof K.then=="function")return me(he(K),ce,Ee,Me,Ve);throw ce=String(K),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return ze}function q(K,ce,Ee){if(K==null)return K;var Me=[],Ve=0;return me(K,Me,"","",function(ge){return ce.call(Ee,ge,Ve++)}),Me}function ee(K){if(K._status===-1){var ce=K._result;ce=ce(),ce.then(function(Ee){(K._status===0||K._status===-1)&&(K._status=1,K._result=Ee)},function(Ee){(K._status===0||K._status===-1)&&(K._status=2,K._result=Ee)}),K._status===-1&&(K._status=0,K._result=ce)}if(K._status===1)return K._result.default;throw K._result}var ne=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)};function ye(){}return bn.Children={map:q,forEach:function(K,ce,Ee){q(K,function(){ce.apply(this,arguments)},Ee)},count:function(K){var ce=0;return q(K,function(){ce++}),ce},toArray:function(K){return q(K,function(ce){return ce})||[]},only:function(K){if(!I(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},bn.Component=M,bn.Fragment=t,bn.Profiler=s,bn.PureComponent=D,bn.StrictMode=n,bn.Suspense=f,bn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,bn.__COMPILER_RUNTIME={__proto__:null,c:function(K){return G.H.useMemoCache(K)}},bn.cache=function(K){return function(){return K.apply(null,arguments)}},bn.cloneElement=function(K,ce,Ee){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var Me=b({},K.props),Ve=K.key,ge=void 0;if(ce!=null)for(ze in ce.ref!==void 0&&(ge=void 0),ce.key!==void 0&&(Ve=""+ce.key),ce)!H.call(ce,ze)||ze==="key"||ze==="__self"||ze==="__source"||ze==="ref"&&ce.ref===void 0||(Me[ze]=ce[ze]);var ze=arguments.length-2;if(ze===1)Me.children=Ee;else if(1<ze){for(var Je=Array(ze),lt=0;lt<ze;lt++)Je[lt]=arguments[lt+2];Me.children=Je}return F(K.type,Ve,void 0,void 0,ge,Me)},bn.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:r,_context:K},K},bn.createElement=function(K,ce,Ee){var Me,Ve={},ge=null;if(ce!=null)for(Me in ce.key!==void 0&&(ge=""+ce.key),ce)H.call(ce,Me)&&Me!=="key"&&Me!=="__self"&&Me!=="__source"&&(Ve[Me]=ce[Me]);var ze=arguments.length-2;if(ze===1)Ve.children=Ee;else if(1<ze){for(var Je=Array(ze),lt=0;lt<ze;lt++)Je[lt]=arguments[lt+2];Ve.children=Je}if(K&&K.defaultProps)for(Me in ze=K.defaultProps,ze)Ve[Me]===void 0&&(Ve[Me]=ze[Me]);return F(K,ge,void 0,void 0,null,Ve)},bn.createRef=function(){return{current:null}},bn.forwardRef=function(K){return{$$typeof:c,render:K}},bn.isValidElement=I,bn.lazy=function(K){return{$$typeof:m,_payload:{_status:-1,_result:K},_init:ee}},bn.memo=function(K,ce){return{$$typeof:p,type:K,compare:ce===void 0?null:ce}},bn.startTransition=function(K){var ce=G.T,Ee={};G.T=Ee;try{var Me=K(),Ve=G.S;Ve!==null&&Ve(Ee,Me),typeof Me=="object"&&Me!==null&&typeof Me.then=="function"&&Me.then(ye,ne)}catch(ge){ne(ge)}finally{G.T=ce}},bn.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},bn.use=function(K){return G.H.use(K)},bn.useActionState=function(K,ce,Ee){return G.H.useActionState(K,ce,Ee)},bn.useCallback=function(K,ce){return G.H.useCallback(K,ce)},bn.useContext=function(K){return G.H.useContext(K)},bn.useDebugValue=function(){},bn.useDeferredValue=function(K,ce){return G.H.useDeferredValue(K,ce)},bn.useEffect=function(K,ce,Ee){var Me=G.H;if(typeof Ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Me.useEffect(K,ce)},bn.useId=function(){return G.H.useId()},bn.useImperativeHandle=function(K,ce,Ee){return G.H.useImperativeHandle(K,ce,Ee)},bn.useInsertionEffect=function(K,ce){return G.H.useInsertionEffect(K,ce)},bn.useLayoutEffect=function(K,ce){return G.H.useLayoutEffect(K,ce)},bn.useMemo=function(K,ce){return G.H.useMemo(K,ce)},bn.useOptimistic=function(K,ce){return G.H.useOptimistic(K,ce)},bn.useReducer=function(K,ce,Ee){return G.H.useReducer(K,ce,Ee)},bn.useRef=function(K){return G.H.useRef(K)},bn.useState=function(K){return G.H.useState(K)},bn.useSyncExternalStore=function(K,ce,Ee){return G.H.useSyncExternalStore(K,ce,Ee)},bn.useTransition=function(){return G.H.useTransition()},bn.version="19.1.1",bn}var MR;function pg(){return MR||(MR=1,ZE.exports=PP()),ZE.exports}var ue=pg();const wd=aS(ue);var $E={exports:{}},Dy={},eb={exports:{}},tb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CR;function FP(){return CR||(CR=1,function(i){function e(q,ee){var ne=q.length;q.push(ee);e:for(;0<ne;){var ye=ne-1>>>1,K=q[ye];if(0<s(K,ee))q[ye]=ee,q[ne]=K,ne=ye;else break e}}function t(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var ee=q[0],ne=q.pop();if(ne!==ee){q[0]=ne;e:for(var ye=0,K=q.length,ce=K>>>1;ye<ce;){var Ee=2*(ye+1)-1,Me=q[Ee],Ve=Ee+1,ge=q[Ve];if(0>s(Me,ne))Ve<K&&0>s(ge,Me)?(q[ye]=ge,q[Ve]=ne,ye=Ve):(q[ye]=Me,q[Ee]=ne,ye=Ee);else if(Ve<K&&0>s(ge,ne))q[ye]=ge,q[Ve]=ne,ye=Ve;else break e}}return ee}function s(q,ee){var ne=q.sortIndex-ee.sortIndex;return ne!==0?ne:q.id-ee.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var f=[],p=[],m=1,y=null,v=3,x=!1,b=!1,R=!1,M=!1,T=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function L(q){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=q)n(p),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(p)}}function G(q){if(R=!1,L(q),!b)if(t(f)!==null)b=!0,H||(H=!0,W());else{var ee=t(p);ee!==null&&me(G,ee.startTime-q)}}var H=!1,F=-1,U=5,I=-1;function N(){return M?!0:!(i.unstable_now()-I<U)}function z(){if(M=!1,H){var q=i.unstable_now();I=q;var ee=!0;try{e:{b=!1,R&&(R=!1,D(F),F=-1),x=!0;var ne=v;try{t:{for(L(q),y=t(f);y!==null&&!(y.expirationTime>q&&N());){var ye=y.callback;if(typeof ye=="function"){y.callback=null,v=y.priorityLevel;var K=ye(y.expirationTime<=q);if(q=i.unstable_now(),typeof K=="function"){y.callback=K,L(q),ee=!0;break t}y===t(f)&&n(f),L(q)}else n(f);y=t(f)}if(y!==null)ee=!0;else{var ce=t(p);ce!==null&&me(G,ce.startTime-q),ee=!1}}break e}finally{y=null,v=ne,x=!1}ee=void 0}}finally{ee?W():H=!1}}}var W;if(typeof B=="function")W=function(){B(z)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,he=k.port2;k.port1.onmessage=z,W=function(){he.postMessage(null)}}else W=function(){T(z,0)};function me(q,ee){F=T(function(){q(i.unstable_now())},ee)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(q){q.callback=null},i.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<q?Math.floor(1e3/q):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_next=function(q){switch(v){case 1:case 2:case 3:var ee=3;break;default:ee=v}var ne=v;v=ee;try{return q()}finally{v=ne}},i.unstable_requestPaint=function(){M=!0},i.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ne=v;v=q;try{return ee()}finally{v=ne}},i.unstable_scheduleCallback=function(q,ee,ne){var ye=i.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ye+ne:ye):ne=ye,q){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ne+K,q={id:m++,callback:ee,priorityLevel:q,startTime:ne,expirationTime:K,sortIndex:-1},ne>ye?(q.sortIndex=ne,e(p,q),t(f)===null&&q===t(p)&&(R?(D(F),F=-1):R=!0,me(G,ne-ye))):(q.sortIndex=K,e(f,q),b||x||(b=!0,H||(H=!0,W()))),q},i.unstable_shouldYield=N,i.unstable_wrapCallback=function(q){var ee=v;return function(){var ne=v;v=ee;try{return q.apply(this,arguments)}finally{v=ne}}}}(tb)),tb}var RR;function zP(){return RR||(RR=1,eb.exports=FP()),eb.exports}var nb={exports:{}},Cr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wR;function VP(){if(wR)return Cr;wR=1;var i=pg();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(f,p,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:f,containerInfo:p,implementation:m}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Cr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Cr.createPortal=function(f,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return r(f,p,null,m)},Cr.flushSync=function(f){var p=o.T,m=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=p,n.p=m,n.d.f()}},Cr.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(f,p))},Cr.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Cr.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var m=p.as,y=c(m,p.crossOrigin),v=typeof p.integrity=="string"?p.integrity:void 0,x=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?n.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:x}):m==="script"&&n.d.X(f,{crossOrigin:y,integrity:v,fetchPriority:x,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Cr.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=c(p.as,p.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(f)},Cr.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,y=c(m,p.crossOrigin);n.d.L(f,m,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Cr.preloadModule=function(f,p){if(typeof f=="string")if(p){var m=c(p.as,p.crossOrigin);n.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(f)},Cr.requestFormReset=function(f){n.d.r(f)},Cr.unstable_batchedUpdates=function(f,p){return f(p)},Cr.useFormState=function(f,p,m){return o.H.useFormState(f,p,m)},Cr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Cr.version="19.1.1",Cr}var DR;function HP(){if(DR)return nb.exports;DR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),nb.exports=VP(),nb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IR;function kP(){if(IR)return Dy;IR=1;var i=zP(),e=pg(),t=HP();function n(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var l=a,d=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(d=l.return),a=l.return;while(a)}return l.tag===3?d:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function c(a){if(r(a)!==a)throw Error(n(188))}function f(a){var l=a.alternate;if(!l){if(l=r(a),l===null)throw Error(n(188));return l!==a?null:a}for(var d=a,g=l;;){var S=d.return;if(S===null)break;var C=S.alternate;if(C===null){if(g=S.return,g!==null){d=g;continue}break}if(S.child===C.child){for(C=S.child;C;){if(C===d)return c(S),a;if(C===g)return c(S),l;C=C.sibling}throw Error(n(188))}if(d.return!==g.return)d=S,g=C;else{for(var j=!1,Y=S.child;Y;){if(Y===d){j=!0,d=S,g=C;break}if(Y===g){j=!0,g=S,d=C;break}Y=Y.sibling}if(!j){for(Y=C.child;Y;){if(Y===d){j=!0,d=C,g=S;break}if(Y===g){j=!0,g=C,d=S;break}Y=Y.sibling}if(!j)throw Error(n(189))}}if(d.alternate!==g)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?a:l}function p(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=p(a),l!==null)return l;a=a.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),D=Symbol.for("react.consumer"),B=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function W(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var k=Symbol.for("react.client.reference");function he(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===k?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case b:return"Fragment";case M:return"Profiler";case R:return"StrictMode";case G:return"Suspense";case H:return"SuspenseList";case I:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case x:return"Portal";case B:return(a.displayName||"Context")+".Provider";case D:return(a._context.displayName||"Context")+".Consumer";case L:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case F:return l=a.displayName||null,l!==null?l:he(a.type)||"Memo";case U:l=a._payload,a=a._init;try{return he(a(l))}catch{}}return null}var me=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},ye=[],K=-1;function ce(a){return{current:a}}function Ee(a){0>K||(a.current=ye[K],ye[K]=null,K--)}function Me(a,l){K++,ye[K]=a.current,a.current=l}var Ve=ce(null),ge=ce(null),ze=ce(null),Je=ce(null);function lt(a,l){switch(Me(ze,l),Me(ge,a),Me(Ve,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?QC(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=QC(l),a=ZC(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}Ee(Ve),Me(Ve,a)}function At(){Ee(Ve),Ee(ge),Ee(ze)}function Et(a){a.memoizedState!==null&&Me(Je,a);var l=Ve.current,d=ZC(l,a.type);l!==d&&(Me(ge,a),Me(Ve,d))}function Nt(a){ge.current===a&&(Ee(Ve),Ee(ge)),Je.current===a&&(Ee(Je),by._currentValue=ne)}var It=Object.prototype.hasOwnProperty,se=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,He=i.unstable_shouldYield,tt=i.unstable_requestPaint,Fe=i.unstable_now,ut=i.unstable_getCurrentPriorityLevel,Qe=i.unstable_ImmediatePriority,st=i.unstable_UserBlockingPriority,Ft=i.unstable_NormalPriority,Gt=i.unstable_LowPriority,te=i.unstable_IdlePriority,X=i.log,xe=i.unstable_setDisableYieldValue,Re=null,Ue=null;function Le(a){if(typeof X=="function"&&xe(a),Ue&&typeof Ue.setStrictMode=="function")try{Ue.setStrictMode(Re,a)}catch{}}var _t=Math.clz32?Math.clz32:Mt,ht=Math.log,wt=Math.LN2;function Mt(a){return a>>>=0,a===0?32:31-(ht(a)/wt|0)|0}var et=256,ft=4194304;function Dt(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function re(a,l,d){var g=a.pendingLanes;if(g===0)return 0;var S=0,C=a.suspendedLanes,j=a.pingedLanes;a=a.warmLanes;var Y=g&134217727;return Y!==0?(g=Y&~C,g!==0?S=Dt(g):(j&=Y,j!==0?S=Dt(j):d||(d=Y&~a,d!==0&&(S=Dt(d))))):(Y=g&~C,Y!==0?S=Dt(Y):j!==0?S=Dt(j):d||(d=g&~a,d!==0&&(S=Dt(d)))),S===0?0:l!==0&&l!==S&&(l&C)===0&&(C=S&-S,d=l&-l,C>=d||C===32&&(d&4194048)!==0)?l:S}function Te(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function rt(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oe(){var a=et;return et<<=1,(et&4194048)===0&&(et=256),a}function Ke(){var a=ft;return ft<<=1,(ft&62914560)===0&&(ft=4194304),a}function nt(a){for(var l=[],d=0;31>d;d++)l.push(a);return l}function yt(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function it(a,l,d,g,S,C){var j=a.pendingLanes;a.pendingLanes=d,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=d,a.entangledLanes&=d,a.errorRecoveryDisabledLanes&=d,a.shellSuspendCounter=0;var Y=a.entanglements,ae=a.expirationTimes,we=a.hiddenUpdates;for(d=j&~d;0<d;){var qe=31-_t(d),Ze=1<<qe;Y[qe]=0,ae[qe]=-1;var Ie=we[qe];if(Ie!==null)for(we[qe]=null,qe=0;qe<Ie.length;qe++){var Ne=Ie[qe];Ne!==null&&(Ne.lane&=-536870913)}d&=~Ze}g!==0&&ke(a,g,0),C!==0&&S===0&&a.tag!==0&&(a.suspendedLanes|=C&~(j&~l))}function ke(a,l,d){a.pendingLanes|=l,a.suspendedLanes&=~l;var g=31-_t(l);a.entangledLanes|=l,a.entanglements[g]=a.entanglements[g]|1073741824|d&4194090}function vt(a,l){var d=a.entangledLanes|=l;for(a=a.entanglements;d;){var g=31-_t(d),S=1<<g;S&l|a[g]&l&&(a[g]|=l),d&=~S}}function Ot(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function cn(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Zt(){var a=ee.p;return a!==0?a:(a=window.event,a===void 0?32:yR(a.type))}function Gi(a,l){var d=ee.p;try{return ee.p=a,l()}finally{ee.p=d}}var _n=Math.random().toString(36).slice(2),Ci="__reactFiber$"+_n,$n="__reactProps$"+_n,As="__reactContainer$"+_n,er="__reactEvents$"+_n,Lc="__reactListeners$"+_n,ns="__reactHandles$"+_n,tr="__reactResources$"+_n,nr="__reactMarker$"+_n;function Kn(a){delete a[Ci],delete a[$n],delete a[er],delete a[Lc],delete a[ns]}function gr(a){var l=a[Ci];if(l)return l;for(var d=a.parentNode;d;){if(l=d[As]||d[Ci]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(a=nR(a);a!==null;){if(d=a[Ci])return d;a=nR(a)}return l}a=d,d=a.parentNode}return null}function yr(a){if(a=a[Ci]||a[As]){var l=a.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return a}return null}function zr(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(n(33))}function xs(a){var l=a[tr];return l||(l=a[tr]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ri(a){a[nr]=!0}var qo=new Set,po={};function J(a,l){de(a,l),de(a+"Capture",l)}function de(a,l){for(po[a]=l,a=0;a<l.length;a++)qo.add(l[a])}var be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Be={},_e={};function at(a){return It.call(_e,a)?!0:It.call(Be,a)?!1:be.test(a)?_e[a]=!0:(Be[a]=!0,!1)}function dt(a,l,d){if(at(l))if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+d)}}function xt(a,l,d){if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+d)}}function mt(a,l,d,g){if(g===null)a.removeAttribute(d);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(d);return}a.setAttributeNS(l,d,""+g)}}var zt,jt;function Lt(a){if(zt===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);zt=l&&l[1]||"",jt=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zt+a+jt}var ln=!1;function wn(a,l){if(!a||ln)return"";ln=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Ne){var Ie=Ne}Reflect.construct(a,[],Ze)}else{try{Ze.call()}catch(Ne){Ie=Ne}a.call(Ze.prototype)}}else{try{throw Error()}catch(Ne){Ie=Ne}(Ze=a())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Ne){if(Ne&&Ie&&typeof Ne.stack=="string")return[Ne.stack,Ie.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=g.DetermineComponentFrameRoot(),j=C[0],Y=C[1];if(j&&Y){var ae=j.split(`
`),we=Y.split(`
`);for(S=g=0;g<ae.length&&!ae[g].includes("DetermineComponentFrameRoot");)g++;for(;S<we.length&&!we[S].includes("DetermineComponentFrameRoot");)S++;if(g===ae.length||S===we.length)for(g=ae.length-1,S=we.length-1;1<=g&&0<=S&&ae[g]!==we[S];)S--;for(;1<=g&&0<=S;g--,S--)if(ae[g]!==we[S]){if(g!==1||S!==1)do if(g--,S--,0>S||ae[g]!==we[S]){var qe=`
`+ae[g].replace(" at new "," at ");return a.displayName&&qe.includes("<anonymous>")&&(qe=qe.replace("<anonymous>",a.displayName)),qe}while(1<=g&&0<=S);break}}}finally{ln=!1,Error.prepareStackTrace=d}return(d=a?a.displayName||a.name:"")?Lt(d):""}function si(a){switch(a.tag){case 26:case 27:case 5:return Lt(a.type);case 16:return Lt("Lazy");case 13:return Lt("Suspense");case 19:return Lt("SuspenseList");case 0:case 15:return wn(a.type,!1);case 11:return wn(a.type.render,!1);case 1:return wn(a.type,!0);case 31:return Lt("Activity");default:return""}}function Vn(a){try{var l="";do l+=si(a),a=a.return;while(a);return l}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function an(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Vt(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function li(a){var l=Vt(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),g=""+a[l];if(!a.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var S=d.get,C=d.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return S.call(this)},set:function(j){g=""+j,C.call(this,j)}}),Object.defineProperty(a,l,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(j){g=""+j},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function xn(a){a._valueTracker||(a._valueTracker=li(a))}function is(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var d=l.getValue(),g="";return a&&(g=Vt(a)?a.checked?"true":"false":a.value),a=g,a!==d?(l.setValue(a),!0):!1}function ir(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var us=/[\n"\\]/g;function ci(a){return a.replace(us,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Mn(a,l,d,g,S,C,j,Y){a.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?a.type=j:a.removeAttribute("type"),l!=null?j==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+an(l)):a.value!==""+an(l)&&(a.value=""+an(l)):j!=="submit"&&j!=="reset"||a.removeAttribute("value"),l!=null?Li(a,j,an(l)):d!=null?Li(a,j,an(d)):g!=null&&a.removeAttribute("value"),S==null&&C!=null&&(a.defaultChecked=!!C),S!=null&&(a.checked=S&&typeof S!="function"&&typeof S!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?a.name=""+an(Y):a.removeAttribute("name")}function ji(a,l,d,g,S,C,j,Y){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.type=C),l!=null||d!=null){if(!(C!=="submit"&&C!=="reset"||l!=null))return;d=d!=null?""+an(d):"",l=l!=null?""+an(l):d,Y||l===a.value||(a.value=l),a.defaultValue=l}g=g??S,g=typeof g!="function"&&typeof g!="symbol"&&!!g,a.checked=Y?a.checked:!!g,a.defaultChecked=!!g,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(a.name=j)}function Li(a,l,d){l==="number"&&ir(a.ownerDocument)===a||a.defaultValue===""+d||(a.defaultValue=""+d)}function mi(a,l,d,g){if(a=a.options,l){l={};for(var S=0;S<d.length;S++)l["$"+d[S]]=!0;for(d=0;d<a.length;d++)S=l.hasOwnProperty("$"+a[d].value),a[d].selected!==S&&(a[d].selected=S),S&&g&&(a[d].defaultSelected=!0)}else{for(d=""+an(d),l=null,S=0;S<a.length;S++){if(a[S].value===d){a[S].selected=!0,g&&(a[S].defaultSelected=!0);return}l!==null||a[S].disabled||(l=a[S])}l!==null&&(l.selected=!0)}}function un(a,l,d){if(l!=null&&(l=""+an(l),l!==a.value&&(a.value=l),d==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=d!=null?""+an(d):""}function ha(a,l,d,g){if(l==null){if(g!=null){if(d!=null)throw Error(n(92));if(me(g)){if(1<g.length)throw Error(n(93));g=g[0]}d=g}d==null&&(d=""),l=d}d=an(l),a.defaultValue=d,g=a.textContent,g===d&&g!==""&&g!==null&&(a.value=g)}function Si(a,l){if(l){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=l;return}}a.textContent=l}var Dl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Uc(a,l,d){var g=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?g?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":g?a.setProperty(l,d):typeof d!="number"||d===0||Dl.has(l)?l==="float"?a.cssFloat=d:a[l]=(""+d).trim():a[l]=d+"px"}function Il(a,l,d){if(l!=null&&typeof l!="object")throw Error(n(62));if(a=a.style,d!=null){for(var g in d)!d.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?a.setProperty(g,""):g==="float"?a.cssFloat="":a[g]="");for(var S in l)g=l[S],l.hasOwnProperty(S)&&d[S]!==g&&Uc(a,S,g)}else for(var C in l)l.hasOwnProperty(C)&&Uc(a,C,l[C])}function ku(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pc(a){return hp.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var mo=null;function Vr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ha=null,go=null;function Gu(a){var l=yr(a);if(l&&(a=l.stateNode)){var d=a[$n]||null;e:switch(a=l.stateNode,l.type){case"input":if(Mn(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+ci(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var g=d[l];if(g!==a&&g.form===a.form){var S=g[$n]||null;if(!S)throw Error(n(90));Mn(g,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(l=0;l<d.length;l++)g=d[l],g.form===a.form&&is(g)}break e;case"textarea":un(a,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&mi(a,!!d.multiple,l,!1)}}}var fa=!1;function Sf(a,l,d){if(fa)return a(l,d);fa=!0;try{var g=a(l);return g}finally{if(fa=!1,(Ha!==null||go!==null)&&(Bo(),Ha&&(l=Ha,a=go,go=Ha=null,Gu(l),a)))for(l=0;l<a.length;l++)Gu(a[l])}}function Bl(a,l){var d=a.stateNode;if(d===null)return null;var g=d[$n]||null;if(g===null)return null;d=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(n(231,l,typeof d));return d}var da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_r=!1;if(da)try{var Nl={};Object.defineProperty(Nl,"passive",{get:function(){_r=!0}}),window.addEventListener("test",Nl,Nl),window.removeEventListener("test",Nl,Nl)}catch{_r=!1}var ka=null,Ol=null,Xo=null;function ju(){if(Xo)return Xo;var a,l=Ol,d=l.length,g,S="value"in ka?ka.value:ka.textContent,C=S.length;for(a=0;a<d&&l[a]===S[a];a++);var j=d-a;for(g=1;g<=j&&l[d-g]===S[C-g];g++);return Xo=S.slice(a,1<g?1-g:void 0)}function vr(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function pa(){return!0}function Ll(){return!1}function hs(a){function l(d,g,S,C,j){this._reactName=d,this._targetInst=S,this.type=g,this.nativeEvent=C,this.target=j,this.currentTarget=null;for(var Y in a)a.hasOwnProperty(Y)&&(d=a[Y],this[Y]=d?d(C):C[Y]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?pa:Ll,this.isPropagationStopped=Ll,this}return m(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=pa)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=pa)},persist:function(){},isPersistent:pa}),l}var Jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ul=hs(Jn),Pl=m({},Jn,{view:0,detail:0}),Ef=hs(Pl),ma,Wo,Ga,Yo=m({},Pl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ko,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ga&&(Ga&&a.type==="mousemove"?(ma=a.screenX-Ga.screenX,Wo=a.screenY-Ga.screenY):Wo=ma=0,Ga=a),ma)},movementY:function(a){return"movementY"in a?a.movementY:Wo}}),Hr=hs(Yo),bf=m({},Yo,{dataTransfer:0}),wg=hs(bf),wi=m({},Pl,{relatedTarget:0}),Fc=hs(wi),qu=m({},Jn,{animationName:0,elapsedTime:0,pseudoElement:0}),zc=hs(qu),Tf=m({},Jn,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Vc=hs(Tf),Hc=m({},Jn,{data:0}),kc=hs(Hc),Fl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gc(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=Cf[a])?!!l[a]:!1}function Ko(){return Gc}var Rf=m({},Pl,{key:function(a){if(a.key){var l=Fl[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=vr(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Mf[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ko,charCode:function(a){return a.type==="keypress"?vr(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?vr(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),zl=hs(Rf),Xu=m({},Yo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jc=hs(Xu),yo=m({},Pl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ko}),Wu=hs(yo),wf=m({},Jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ga=hs(wf),Yu=m({},Yo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Ku=hs(Yu),Gs=m({},Jn,{newState:0,oldState:0}),ja=hs(Gs),ya=[9,13,27,32],_a=da&&"CompositionEvent"in window,A=null;da&&"documentMode"in document&&(A=document.documentMode);var O=da&&"TextEvent"in window&&!A,V=da&&(!_a||A&&8<A&&11>=A),Z=" ",ve=!1;function Pe(a,l){switch(a){case"keyup":return ya.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gt(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Dn=!1;function Di(a,l){switch(a){case"compositionend":return gt(l);case"keypress":return l.which!==32?null:(ve=!0,Z);case"textInput":return a=l.data,a===Z&&ve?null:a;default:return null}}function In(a,l){if(Dn)return a==="compositionend"||!_a&&Pe(a,l)?(a=ju(),Xo=Ol=ka=null,Dn=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return V&&l.locale!=="ko"?null:l.data;default:return null}}var qi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ss(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!qi[a.type]:l==="textarea"}function Xi(a,l,d,g){Ha?go?go.push(g):go=[g]:Ha=g,l=l0(l,"onChange"),0<l.length&&(d=new Ul("onChange","change",null,d,g),a.push({event:d,listeners:l}))}var Ss=null,va=null;function Ju(a){XC(a,0)}function Df(a){var l=zr(a);if(is(l))return a}function fp(a,l){if(a==="change")return l}var dp=!1;if(da){var pp;if(da){var Qu="oninput"in document;if(!Qu){var Zu=document.createElement("div");Zu.setAttribute("oninput","return;"),Qu=typeof Zu.oninput=="function"}pp=Qu}else pp=!1;dp=pp&&(!document.documentMode||9<document.documentMode)}function Ti(){Ss&&(Ss.detachEvent("onpropertychange",hv),va=Ss=null)}function hv(a){if(a.propertyName==="value"&&Df(va)){var l=[];Xi(l,va,a,Vr(a)),Sf(Ju,l)}}function yE(a,l,d){a==="focusin"?(Ti(),Ss=l,va=d,Ss.attachEvent("onpropertychange",hv)):a==="focusout"&&Ti()}function fv(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Df(va)}function If(a,l){if(a==="click")return Df(l)}function Vl(a,l){if(a==="input"||a==="change")return Df(l)}function dv(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Ar=typeof Object.is=="function"?Object.is:dv;function qa(a,l){if(Ar(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var d=Object.keys(a),g=Object.keys(l);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var S=d[g];if(!It.call(l,S)||!Ar(a[S],l[S]))return!1}return!0}function xr(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Dg(a,l){var d=xr(a);a=0;for(var g;d;){if(d.nodeType===3){if(g=a+d.textContent.length,a<=l&&g>=l)return{node:d,offset:l-a};a=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=xr(d)}}function Ig(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Ig(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Bg(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=ir(a.document);l instanceof a.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)a=l.contentWindow;else break;l=ir(a.document)}return l}function Bf(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var Ng=da&&"documentMode"in document&&11>=document.documentMode,Jo=null,mp=null,Nf=null,gp=!1;function Og(a,l,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;gp||Jo==null||Jo!==ir(g)||(g=Jo,"selectionStart"in g&&Bf(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Nf&&qa(Nf,g)||(Nf=g,g=l0(mp,"onSelect"),0<g.length&&(l=new Ul("onSelect","select",null,l,d),a.push({event:l,listeners:g}),l.target=Jo)))}function Bs(a,l){var d={};return d[a.toLowerCase()]=l.toLowerCase(),d["Webkit"+a]="webkit"+l,d["Moz"+a]="moz"+l,d}var Hl={animationend:Bs("Animation","AnimationEnd"),animationiteration:Bs("Animation","AnimationIteration"),animationstart:Bs("Animation","AnimationStart"),transitionrun:Bs("Transition","TransitionRun"),transitionstart:Bs("Transition","TransitionStart"),transitioncancel:Bs("Transition","TransitionCancel"),transitionend:Bs("Transition","TransitionEnd")},yp={},pv={};da&&(pv=document.createElement("div").style,"AnimationEvent"in window||(delete Hl.animationend.animation,delete Hl.animationiteration.animation,delete Hl.animationstart.animation),"TransitionEvent"in window||delete Hl.transitionend.transition);function Qo(a){if(yp[a])return yp[a];if(!Hl[a])return a;var l=Hl[a],d;for(d in l)if(l.hasOwnProperty(d)&&d in pv)return yp[a]=l[d];return a}var sr=Qo("animationend"),Lg=Qo("animationiteration"),Sr=Qo("animationstart"),mv=Qo("transitionrun"),Zo=Qo("transitionstart"),$u=Qo("transitioncancel"),$o=Qo("transitionend"),_p=new Map,Of="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Of.push("scrollEnd");function Es(a,l){_p.set(a,l),J(l,[a])}var Ug=new WeakMap;function Ns(a,l){if(typeof a=="object"&&a!==null){var d=Ug.get(a);return d!==void 0?d:(l={value:a,source:l,stack:Vn(l)},Ug.set(a,l),l)}return{value:a,source:l,stack:Vn(l)}}var js=[],Aa=0,vp=0;function Lf(){for(var a=Aa,l=vp=Aa=0;l<a;){var d=js[l];js[l++]=null;var g=js[l];js[l++]=null;var S=js[l];js[l++]=null;var C=js[l];if(js[l++]=null,g!==null&&S!==null){var j=g.pending;j===null?S.next=S:(S.next=j.next,j.next=S),g.pending=S}C!==0&&Pg(d,S,C)}}function kl(a,l,d,g){js[Aa++]=a,js[Aa++]=l,js[Aa++]=d,js[Aa++]=g,vp|=g,a.lanes|=g,a=a.alternate,a!==null&&(a.lanes|=g)}function Ap(a,l,d,g){return kl(a,l,d,g),eh(a)}function el(a,l){return kl(a,null,null,l),eh(a)}function Pg(a,l,d){a.lanes|=d;var g=a.alternate;g!==null&&(g.lanes|=d);for(var S=!1,C=a.return;C!==null;)C.childLanes|=d,g=C.alternate,g!==null&&(g.childLanes|=d),C.tag===22&&(a=C.stateNode,a===null||a._visibility&1||(S=!0)),a=C,C=C.return;return a.tag===3?(C=a.stateNode,S&&l!==null&&(S=31-_t(d),a=C.hiddenUpdates,g=a[S],g===null?a[S]=[l]:g.push(l),l.lane=d|536870912),C):null}function eh(a){if(50<Io)throw Io=0,lu=null,Error(n(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var Gl={};function Fg(a,l,d,g){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(a,l,d,g){return new Fg(a,l,d,g)}function Uf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Wi(a,l){var d=a.alternate;return d===null?(d=Er(a.tag,l,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=l,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&65011712,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,l=a.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d.refCleanup=a.refCleanup,d}function zg(a,l){a.flags&=65011714;var d=a.alternate;return d===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,l=d.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function bs(a,l,d,g,S,C){var j=0;if(g=a,typeof a=="function")Uf(a)&&(j=1);else if(typeof a=="string")j=SP(a,d,Ve.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case I:return a=Er(31,d,l,S),a.elementType=I,a.lanes=C,a;case b:return jl(d.children,S,C,l);case R:j=8,S|=24;break;case M:return a=Er(12,d,l,S|2),a.elementType=M,a.lanes=C,a;case G:return a=Er(13,d,l,S),a.elementType=G,a.lanes=C,a;case H:return a=Er(19,d,l,S),a.elementType=H,a.lanes=C,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case T:case B:j=10;break e;case D:j=9;break e;case L:j=11;break e;case F:j=14;break e;case U:j=16,g=null;break e}j=29,d=Error(n(130,a===null?"null":typeof a,"")),g=null}return l=Er(j,d,l,S),l.elementType=a,l.type=g,l.lanes=C,l}function jl(a,l,d,g){return a=Er(7,a,g,l),a.lanes=d,a}function Pf(a,l,d){return a=Er(6,a,null,l),a.lanes=d,a}function xp(a,l,d){return l=Er(4,a.children!==null?a.children:[],a.key,l),l.lanes=d,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var th=[],br=0,Ff=null,nh=0,Os=[],kr=0,ql=null,_o=1,vo="";function tl(a,l){th[br++]=nh,th[br++]=Ff,Ff=a,nh=l}function Sp(a,l,d){Os[kr++]=_o,Os[kr++]=vo,Os[kr++]=ql,ql=a;var g=_o;a=vo;var S=32-_t(g)-1;g&=~(1<<S),d+=1;var C=32-_t(l)+S;if(30<C){var j=S-S%5;C=(g&(1<<j)-1).toString(32),g>>=j,S-=j,_o=1<<32-_t(l)+S|d<<S|g,vo=C+a}else _o=1<<C|d<<S|g,vo=a}function Vg(a){a.return!==null&&(tl(a,1),Sp(a,1,0))}function Hg(a){for(;a===Ff;)Ff=th[--br],th[br]=null,nh=th[--br],th[br]=null;for(;a===ql;)ql=Os[--kr],Os[kr]=null,vo=Os[--kr],Os[kr]=null,_o=Os[--kr],Os[kr]=null}var rr=null,Ii=null,qn=!1,xa=null,Gr=!1,Ep=Error(n(519));function Xl(a){var l=Error(n(418,""));throw qc(Ns(l,a)),Ep}function gv(a){var l=a.stateNode,d=a.type,g=a.memoizedProps;switch(l[Ci]=a,l[$n]=g,d){case"dialog":On("cancel",l),On("close",l);break;case"iframe":case"object":case"embed":On("load",l);break;case"video":case"audio":for(d=0;d<_y.length;d++)On(_y[d],l);break;case"source":On("error",l);break;case"img":case"image":case"link":On("error",l),On("load",l);break;case"details":On("toggle",l);break;case"input":On("invalid",l),ji(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),xn(l);break;case"select":On("invalid",l);break;case"textarea":On("invalid",l),ha(l,g.value,g.defaultValue,g.children),xn(l)}d=g.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||g.suppressHydrationWarning===!0||JC(l.textContent,d)?(g.popover!=null&&(On("beforetoggle",l),On("toggle",l)),g.onScroll!=null&&On("scroll",l),g.onScrollEnd!=null&&On("scrollend",l),g.onClick!=null&&(l.onclick=c0),l=!0):l=!1,l||Xl(a)}function kg(a){for(rr=a.return;rr;)switch(rr.tag){case 5:case 13:Gr=!1;return;case 27:case 3:Gr=!0;return;default:rr=rr.return}}function Xa(a){if(a!==rr)return!1;if(!qn)return kg(a),qn=!0,!1;var l=a.tag,d;if((d=l!==3&&l!==27)&&((d=l===5)&&(d=a.type,d=!(d!=="form"&&d!=="button")||PE(a.type,a.memoizedProps)),d=!d),d&&Ii&&Xl(a),kg(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8)if(d=a.data,d==="/$"){if(l===0){Ii=ml(a.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++;a=a.nextSibling}Ii=null}}else l===27?(l=Ii,Ch(a.type)?(a=HE,HE=null,Ii=a):Ii=l):Ii=rr?ml(a.stateNode.nextSibling):null;return!0}function ih(){Ii=rr=null,qn=!1}function ei(){var a=xa;return a!==null&&(Yt===null?Yt=a:Yt.push.apply(Yt,a),xa=null),a}function qc(a){xa===null?xa=[a]:xa.push(a)}var Gg=ce(null),Wl=null,nl=null;function Yl(a,l,d){Me(Gg,l._currentValue),l._currentValue=d}function il(a){a._currentValue=Gg.current,Ee(Gg)}function jg(a,l,d){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===d)break;a=a.return}}function zf(a,l,d,g){var S=a.child;for(S!==null&&(S.return=a);S!==null;){var C=S.dependencies;if(C!==null){var j=S.child;C=C.firstContext;e:for(;C!==null;){var Y=C;C=S;for(var ae=0;ae<l.length;ae++)if(Y.context===l[ae]){C.lanes|=d,Y=C.alternate,Y!==null&&(Y.lanes|=d),jg(C.return,d,a),g||(j=null);break e}C=Y.next}}else if(S.tag===18){if(j=S.return,j===null)throw Error(n(341));j.lanes|=d,C=j.alternate,C!==null&&(C.lanes|=d),jg(j,d,a),j=null}else j=S.child;if(j!==null)j.return=S;else for(j=S;j!==null;){if(j===a){j=null;break}if(S=j.sibling,S!==null){S.return=j.return,j=S;break}j=j.return}S=j}}function Sa(a,l,d,g){a=null;for(var S=l,C=!1;S!==null;){if(!C){if((S.flags&524288)!==0)C=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var j=S.alternate;if(j===null)throw Error(n(387));if(j=j.memoizedProps,j!==null){var Y=S.type;Ar(S.pendingProps.value,j.value)||(a!==null?a.push(Y):a=[Y])}}else if(S===Je.current){if(j=S.alternate,j===null)throw Error(n(387));j.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(a!==null?a.push(by):a=[by])}S=S.return}a!==null&&zf(l,a,d,g),l.flags|=262144}function Vf(a){for(a=a.firstContext;a!==null;){if(!Ar(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Ao(a){Wl=a,nl=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Ui(a){return bp(Wl,a)}function Hf(a,l){return Wl===null&&Ao(a),bp(a,l)}function bp(a,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},nl===null){if(a===null)throw Error(n(308));nl=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else nl=nl.next=l;return d}var qg=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(d,g){a.push(g)}};this.abort=function(){l.aborted=!0,a.forEach(function(d){return d()})}},_E=i.unstable_scheduleCallback,yv=i.unstable_NormalPriority,rs={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tp(){return{controller:new qg,data:new Map,refCount:0}}function sh(a){a.refCount--,a.refCount===0&&_E(yv,function(){a.controller.abort()})}var rh=null,kf=0,pn=0,ah=null;function jr(a,l){if(rh===null){var d=rh=[];kf=0,pn=RE(),ah={status:"pending",value:void 0,then:function(g){d.push(g)}}}return kf++,l.then(Mp,Mp),l}function Mp(){if(--kf===0&&rh!==null){ah!==null&&(ah.status="fulfilled");var a=rh;rh=null,pn=0,ah=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function vE(a,l){var d=[],g={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return a.then(function(){g.status="fulfilled",g.value=l;for(var S=0;S<d.length;S++)(0,d[S])(l)},function(S){for(g.status="rejected",g.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),g}var Gf=q.S;q.S=function(a,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&jr(a,l),Gf!==null&&Gf(a,l)};var Ea=ce(null);function Kl(){var a=Ea.current;return a!==null?a:hn.pooledCache}function jf(a,l){l===null?Me(Ea,Ea.current):Me(Ea,l.pool)}function Cp(){var a=Kl();return a===null?null:{parent:rs._currentValue,pool:a}}var qf=Error(n(460)),Xg=Error(n(474)),Wa=Error(n(542)),Xf={then:function(){}};function Rp(a){return a=a.status,a==="fulfilled"||a==="rejected"}function oh(){}function wp(a,l,d){switch(d=a[d],d===void 0?a.push(l):d!==l&&(l.then(oh,oh),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,_v(a),a;default:if(typeof l.status=="string")l.then(oh,oh);else{if(a=hn,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=l,a.status="pending",a.then(function(g){if(l.status==="pending"){var S=l;S.status="fulfilled",S.value=g}},function(g){if(l.status==="pending"){var S=l;S.status="rejected",S.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,_v(a),a}throw ba=l,qf}}var ba=null;function Wg(){if(ba===null)throw Error(n(459));var a=ba;return ba=null,a}function _v(a){if(a===qf||a===Wa)throw Error(n(483))}var sl=!1;function Yg(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function en(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function xo(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function rl(a,l,d){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(ti&2)!==0){var S=g.pending;return S===null?l.next=l:(l.next=S.next,S.next=l),g.pending=l,l=eh(a),Pg(a,null,d),l}return kl(a,g,l,d),eh(a)}function Xc(a,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194048)!==0)){var g=l.lanes;g&=a.pendingLanes,d|=g,l.lanes=d,vt(a,d)}}function lh(a,l){var d=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var S=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var j={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};C===null?S=C=j:C=C.next=j,d=d.next}while(d!==null);C===null?S=C=l:C=C.next=l}else S=C=l;d={baseState:g.baseState,firstBaseUpdate:S,lastBaseUpdate:C,shared:g.shared,callbacks:g.callbacks},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=l}var Kg=!1;function Wf(){if(Kg){var a=ah;if(a!==null)throw a}}function ch(a,l,d,g){Kg=!1;var S=a.updateQueue;sl=!1;var C=S.firstBaseUpdate,j=S.lastBaseUpdate,Y=S.shared.pending;if(Y!==null){S.shared.pending=null;var ae=Y,we=ae.next;ae.next=null,j===null?C=we:j.next=we,j=ae;var qe=a.alternate;qe!==null&&(qe=qe.updateQueue,Y=qe.lastBaseUpdate,Y!==j&&(Y===null?qe.firstBaseUpdate=we:Y.next=we,qe.lastBaseUpdate=ae))}if(C!==null){var Ze=S.baseState;j=0,qe=we=ae=null,Y=C;do{var Ie=Y.lane&-536870913,Ne=Ie!==Y.lane;if(Ne?(qt&Ie)===Ie:(g&Ie)===Ie){Ie!==0&&Ie===pn&&(Kg=!0),qe!==null&&(qe=qe.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});e:{var rn=a,Qt=Y;Ie=l;var Ai=d;switch(Qt.tag){case 1:if(rn=Qt.payload,typeof rn=="function"){Ze=rn.call(Ai,Ze,Ie);break e}Ze=rn;break e;case 3:rn.flags=rn.flags&-65537|128;case 0:if(rn=Qt.payload,Ie=typeof rn=="function"?rn.call(Ai,Ze,Ie):rn,Ie==null)break e;Ze=m({},Ze,Ie);break e;case 2:sl=!0}}Ie=Y.callback,Ie!==null&&(a.flags|=64,Ne&&(a.flags|=8192),Ne=S.callbacks,Ne===null?S.callbacks=[Ie]:Ne.push(Ie))}else Ne={lane:Ie,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},qe===null?(we=qe=Ne,ae=Ze):qe=qe.next=Ne,j|=Ie;if(Y=Y.next,Y===null){if(Y=S.shared.pending,Y===null)break;Ne=Y,Y=Ne.next,Ne.next=null,S.lastBaseUpdate=Ne,S.shared.pending=null}}while(!0);qe===null&&(ae=Ze),S.baseState=ae,S.firstBaseUpdate=we,S.lastBaseUpdate=qe,C===null&&(S.shared.lanes=0),to|=j,a.lanes=j,a.memoizedState=Ze}}function uh(a,l){if(typeof a!="function")throw Error(n(191,a));a.call(l)}function vv(a,l){var d=a.callbacks;if(d!==null)for(a.callbacks=null,a=0;a<d.length;a++)uh(d[a],l)}var hh=ce(null),Dp=ce(0);function Av(a,l){a=Da,Me(Dp,a),Me(hh,l),Da=a|l.baseLanes}function Jg(){Me(Dp,Da),Me(hh,hh.current)}function Yf(){Da=Dp.current,Ee(hh),Ee(Dp)}var al=0,mn=null,ri=null,as=null,Ip=!1,Jl=!1,ar=!1,fs=0,Ta=0,Ls=null,xv=0;function Yi(){throw Error(n(321))}function qs(a,l){if(l===null)return!1;for(var d=0;d<l.length&&d<a.length;d++)if(!Ar(a[d],l[d]))return!1;return!0}function ol(a,l,d,g,S,C){return al=C,mn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,q.H=a===null||a.memoizedState===null?Vp:fy,ar=!1,C=d(g,S),ar=!1,Jl&&(C=Ev(l,d,g,S)),Sv(a),C}function Sv(a){q.H=Qf;var l=ri!==null&&ri.next!==null;if(al=0,as=ri=mn=null,Ip=!1,Ta=0,Ls=null,l)throw Error(n(300));a===null||Ts||(a=a.dependencies,a!==null&&Vf(a)&&(Ts=!0))}function Ev(a,l,d,g){mn=a;var S=0;do{if(Jl&&(Ls=null),Ta=0,Jl=!1,25<=S)throw Error(n(301));if(S+=1,as=ri=null,a.updateQueue!=null){var C=a.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}q.H=Kv,C=l(d,g)}while(Jl);return C}function AE(){var a=q.H,l=a.useState()[0];return l=typeof l.then=="function"?Ya(l):l,a=a.useState()[0],(ri!==null?ri.memoizedState:null)!==a&&(mn.flags|=1024),l}function Qg(){var a=fs!==0;return fs=0,a}function Bp(a,l,d){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~d}function Zg(a){if(Ip){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}Ip=!1}al=0,as=ri=mn=null,Jl=!1,Ta=fs=0,Ls=null}function or(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return as===null?mn.memoizedState=as=a:as=as.next=a,as}function os(){if(ri===null){var a=mn.alternate;a=a!==null?a.memoizedState:null}else a=ri.next;var l=as===null?mn.memoizedState:as.next;if(l!==null)as=l,ri=a;else{if(a===null)throw mn.alternate===null?Error(n(467)):Error(n(310));ri=a,a={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},as===null?mn.memoizedState=as=a:as=as.next=a}return as}function Ql(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ya(a){var l=Ta;return Ta+=1,Ls===null&&(Ls=[]),a=wp(Ls,a,l),l=mn,(as===null?l.memoizedState:as.next)===null&&(l=l.alternate,q.H=l===null||l.memoizedState===null?Vp:fy),a}function Np(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ya(a);if(a.$$typeof===B)return Ui(a)}throw Error(n(438,String(a)))}function $g(a){var l=null,d=mn.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var g=mn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(S){return S.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=Ql(),mn.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(a),g=0;g<a;g++)d[g]=N;return l.index++,d}function ll(a,l){return typeof l=="function"?l(a):l}function Zl(a){var l=os();return ey(l,ri,a)}function ey(a,l,d){var g=a.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=d;var S=a.baseQueue,C=g.pending;if(C!==null){if(S!==null){var j=S.next;S.next=C.next,C.next=j}l.baseQueue=S=C,g.pending=null}if(C=a.baseState,S===null)a.memoizedState=C;else{l=S.next;var Y=j=null,ae=null,we=l,qe=!1;do{var Ze=we.lane&-536870913;if(Ze!==we.lane?(qt&Ze)===Ze:(al&Ze)===Ze){var Ie=we.revertLane;if(Ie===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),Ze===pn&&(qe=!0);else if((al&Ie)===Ie){we=we.next,Ie===pn&&(qe=!0);continue}else Ze={lane:0,revertLane:we.revertLane,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},ae===null?(Y=ae=Ze,j=C):ae=ae.next=Ze,mn.lanes|=Ie,to|=Ie;Ze=we.action,ar&&d(C,Ze),C=we.hasEagerState?we.eagerState:d(C,Ze)}else Ie={lane:Ze,revertLane:we.revertLane,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},ae===null?(Y=ae=Ie,j=C):ae=ae.next=Ie,mn.lanes|=Ze,to|=Ze;we=we.next}while(we!==null&&we!==l);if(ae===null?j=C:ae.next=Y,!Ar(C,a.memoizedState)&&(Ts=!0,qe&&(d=ah,d!==null)))throw d;a.memoizedState=C,a.baseState=j,a.baseQueue=ae,g.lastRenderedState=C}return S===null&&(g.lanes=0),[a.memoizedState,g.dispatch]}function ty(a){var l=os(),d=l.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=a;var g=d.dispatch,S=d.pending,C=l.memoizedState;if(S!==null){d.pending=null;var j=S=S.next;do C=a(C,j.action),j=j.next;while(j!==S);Ar(C,l.memoizedState)||(Ts=!0),l.memoizedState=C,l.baseQueue===null&&(l.baseState=C),d.lastRenderedState=C}return[C,g]}function bv(a,l,d){var g=mn,S=os(),C=qn;if(C){if(d===void 0)throw Error(n(407));d=d()}else d=l();var j=!Ar((ri||S).memoizedState,d);j&&(S.memoizedState=d,Ts=!0),S=S.queue;var Y=Mv.bind(null,g,S,a);if(ph(2048,8,Y,[a]),S.getSnapshot!==l||j||as!==null&&as.memoizedState.tag&1){if(g.flags|=2048,dh(9,Kf(),Tv.bind(null,g,S,d,l),null),hn===null)throw Error(n(349));C||(al&124)!==0||fh(g,l,d)}return d}function fh(a,l,d){a.flags|=16384,a={getSnapshot:l,value:d},l=mn.updateQueue,l===null?(l=Ql(),mn.updateQueue=l,l.stores=[a]):(d=l.stores,d===null?l.stores=[a]:d.push(a))}function Tv(a,l,d,g){l.value=d,l.getSnapshot=g,Cv(l)&&Rv(a)}function Mv(a,l,d){return d(function(){Cv(l)&&Rv(a)})}function Cv(a){var l=a.getSnapshot;a=a.value;try{var d=l();return!Ar(a,d)}catch{return!0}}function Rv(a){var l=el(a,2);l!==null&&ur(l,a,2)}function ny(a){var l=or();if(typeof a=="function"){var d=a;if(a=d(),ar){Le(!0);try{d()}finally{Le(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:a},l}function wv(a,l,d,g){return a.baseState=d,ey(a,ri,typeof g=="function"?g:ll)}function xE(a,l,d,g,S){if(zp(a))throw Error(n(485));if(a=l.action,a!==null){var C={payload:S,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){C.listeners.push(j)}};q.T!==null?d(!0):C.isTransition=!1,g(C),d=l.pending,d===null?(C.next=l.pending=C,Dv(l,C)):(C.next=d.next,l.pending=d.next=C)}}function Dv(a,l){var d=l.action,g=l.payload,S=a.state;if(l.isTransition){var C=q.T,j={};q.T=j;try{var Y=d(S,g),ae=q.S;ae!==null&&ae(j,Y),Iv(a,l,Y)}catch(we){iy(a,l,we)}finally{q.T=C}}else try{C=d(S,g),Iv(a,l,C)}catch(we){iy(a,l,we)}}function Iv(a,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(g){Bv(a,l,g)},function(g){return iy(a,l,g)}):Bv(a,l,d)}function Bv(a,l,d){l.status="fulfilled",l.value=d,Nv(l),a.state=d,l=a.pending,l!==null&&(d=l.next,d===l?a.pending=null:(d=d.next,l.next=d,Dv(a,d)))}function iy(a,l,d){var g=a.pending;if(a.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=d,Nv(l),l=l.next;while(l!==g)}a.action=null}function Nv(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function sy(a,l){return l}function Ov(a,l){if(qn){var d=hn.formState;if(d!==null){e:{var g=mn;if(qn){if(Ii){t:{for(var S=Ii,C=Gr;S.nodeType!==8;){if(!C){S=null;break t}if(S=ml(S.nextSibling),S===null){S=null;break t}}C=S.data,S=C==="F!"||C==="F"?S:null}if(S){Ii=ml(S.nextSibling),g=S.data==="F!";break e}}Xl(g)}g=!1}g&&(l=d[0])}}return d=or(),d.memoizedState=d.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sy,lastRenderedState:l},d.queue=g,d=Wv.bind(null,mn,g),g.dispatch=d,g=ny(!1),C=Fp.bind(null,mn,!1,g.queue),g=or(),S={state:l,dispatch:null,action:a,pending:null},g.queue=S,d=xE.bind(null,mn,S,C,d),S.dispatch=d,g.memoizedState=a,[l,d,!1]}function Lv(a){var l=os();return Uv(l,ri,a)}function Uv(a,l,d){if(l=ey(a,l,sy)[0],a=Zl(ll)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Ya(l)}catch(j){throw j===qf?Wa:j}else g=l;l=os();var S=l.queue,C=S.dispatch;return d!==l.memoizedState&&(mn.flags|=2048,dh(9,Kf(),SE.bind(null,S,d),null)),[g,C,a]}function SE(a,l){a.action=l}function Pv(a){var l=os(),d=ri;if(d!==null)return Uv(l,d,a);os(),l=l.memoizedState,d=os();var g=d.queue.dispatch;return d.memoizedState=a,[l,g,!1]}function dh(a,l,d,g){return a={tag:a,create:d,deps:g,inst:l,next:null},l=mn.updateQueue,l===null&&(l=Ql(),mn.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=a.next=a:(g=d.next,d.next=a,a.next=g,l.lastEffect=a),a}function Kf(){return{destroy:void 0,resource:void 0}}function ry(){return os().memoizedState}function Op(a,l,d,g){var S=or();g=g===void 0?null:g,mn.flags|=a,S.memoizedState=dh(1|l,Kf(),d,g)}function ph(a,l,d,g){var S=os();g=g===void 0?null:g;var C=S.memoizedState.inst;ri!==null&&g!==null&&qs(g,ri.memoizedState.deps)?S.memoizedState=dh(l,C,d,g):(mn.flags|=a,S.memoizedState=dh(1|l,C,d,g))}function ay(a,l){Op(8390656,8,a,l)}function oy(a,l){ph(2048,8,a,l)}function Lp(a,l){return ph(4,2,a,l)}function Up(a,l){return ph(4,4,a,l)}function Fv(a,l){if(typeof l=="function"){a=a();var d=l(a);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function zv(a,l,d){d=d!=null?d.concat([a]):null,ph(4,4,Fv.bind(null,l,a),d)}function ly(){}function Vv(a,l){var d=os();l=l===void 0?null:l;var g=d.memoizedState;return l!==null&&qs(l,g[1])?g[0]:(d.memoizedState=[a,l],a)}function cy(a,l){var d=os();l=l===void 0?null:l;var g=d.memoizedState;if(l!==null&&qs(l,g[1]))return g[0];if(g=a(),ar){Le(!0);try{a()}finally{Le(!1)}}return d.memoizedState=[g,l],g}function Pp(a,l,d){return d===void 0||(al&1073741824)!==0?a.memoizedState=l:(a.memoizedState=d,a=Qp(),mn.lanes|=a,to|=a,d)}function Hv(a,l,d,g){return Ar(d,l)?d:hh.current!==null?(a=Pp(a,d,g),Ar(a,l)||(Ts=!0),a):(al&42)===0?(Ts=!0,a.memoizedState=d):(a=Qp(),mn.lanes|=a,to|=a,l)}function kv(a,l,d,g,S){var C=ee.p;ee.p=C!==0&&8>C?C:8;var j=q.T,Y={};q.T=Y,Fp(a,!1,l,d);try{var ae=S(),we=q.S;if(we!==null&&we(Y,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var qe=vE(ae,g);Jf(a,l,qe,zi(a))}else Jf(a,l,g,zi(a))}catch(Ze){Jf(a,l,{then:function(){},status:"rejected",reason:Ze},zi())}finally{ee.p=C,q.T=j}}function EE(){}function uy(a,l,d,g){if(a.tag!==5)throw Error(n(476));var S=Gv(a).queue;kv(a,S,l,ne,d===null?EE:function(){return jv(a),d(g)})}function Gv(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:ne},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:d},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function jv(a){var l=Gv(a).next.queue;Jf(a,l,{},zi())}function hy(){return Ui(by)}function qv(){return os().memoizedState}function Xv(){return os().memoizedState}function bE(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var d=zi();a=xo(d);var g=rl(l,a,d);g!==null&&(ur(g,l,d),Xc(g,l,d)),l={cache:Tp()},a.payload=l;return}l=l.return}}function TE(a,l,d){var g=zi();d={lane:g,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},zp(a)?Yv(l,d):(d=Ap(a,l,d,g),d!==null&&(ur(d,a,g),qr(d,l,g)))}function Wv(a,l,d){var g=zi();Jf(a,l,d,g)}function Jf(a,l,d,g){var S={lane:g,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(zp(a))Yv(l,S);else{var C=a.alternate;if(a.lanes===0&&(C===null||C.lanes===0)&&(C=l.lastRenderedReducer,C!==null))try{var j=l.lastRenderedState,Y=C(j,d);if(S.hasEagerState=!0,S.eagerState=Y,Ar(Y,j))return kl(a,l,S,0),hn===null&&Lf(),!1}catch{}finally{}if(d=Ap(a,l,S,g),d!==null)return ur(d,a,g),qr(d,l,g),!0}return!1}function Fp(a,l,d,g){if(g={lane:2,revertLane:RE(),action:g,hasEagerState:!1,eagerState:null,next:null},zp(a)){if(l)throw Error(n(479))}else l=Ap(a,d,g,2),l!==null&&ur(l,a,2)}function zp(a){var l=a.alternate;return a===mn||l!==null&&l===mn}function Yv(a,l){Jl=Ip=!0;var d=a.pending;d===null?l.next=l:(l.next=d.next,d.next=l),a.pending=l}function qr(a,l,d){if((d&4194048)!==0){var g=l.lanes;g&=a.pendingLanes,d|=g,l.lanes=d,vt(a,d)}}var Qf={readContext:Ui,use:Np,useCallback:Yi,useContext:Yi,useEffect:Yi,useImperativeHandle:Yi,useLayoutEffect:Yi,useInsertionEffect:Yi,useMemo:Yi,useReducer:Yi,useRef:Yi,useState:Yi,useDebugValue:Yi,useDeferredValue:Yi,useTransition:Yi,useSyncExternalStore:Yi,useId:Yi,useHostTransitionStatus:Yi,useFormState:Yi,useActionState:Yi,useOptimistic:Yi,useMemoCache:Yi,useCacheRefresh:Yi},Vp={readContext:Ui,use:Np,useCallback:function(a,l){return or().memoizedState=[a,l===void 0?null:l],a},useContext:Ui,useEffect:ay,useImperativeHandle:function(a,l,d){d=d!=null?d.concat([a]):null,Op(4194308,4,Fv.bind(null,l,a),d)},useLayoutEffect:function(a,l){return Op(4194308,4,a,l)},useInsertionEffect:function(a,l){Op(4,2,a,l)},useMemo:function(a,l){var d=or();l=l===void 0?null:l;var g=a();if(ar){Le(!0);try{a()}finally{Le(!1)}}return d.memoizedState=[g,l],g},useReducer:function(a,l,d){var g=or();if(d!==void 0){var S=d(l);if(ar){Le(!0);try{d(l)}finally{Le(!1)}}}else S=l;return g.memoizedState=g.baseState=S,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:S},g.queue=a,a=a.dispatch=TE.bind(null,mn,a),[g.memoizedState,a]},useRef:function(a){var l=or();return a={current:a},l.memoizedState=a},useState:function(a){a=ny(a);var l=a.queue,d=Wv.bind(null,mn,l);return l.dispatch=d,[a.memoizedState,d]},useDebugValue:ly,useDeferredValue:function(a,l){var d=or();return Pp(d,a,l)},useTransition:function(){var a=ny(!1);return a=kv.bind(null,mn,a.queue,!0,!1),or().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,d){var g=mn,S=or();if(qn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=l(),hn===null)throw Error(n(349));(qt&124)!==0||fh(g,l,d)}S.memoizedState=d;var C={value:d,getSnapshot:l};return S.queue=C,ay(Mv.bind(null,g,C,a),[a]),g.flags|=2048,dh(9,Kf(),Tv.bind(null,g,C,d,l),null),d},useId:function(){var a=or(),l=hn.identifierPrefix;if(qn){var d=vo,g=_o;d=(g&~(1<<32-_t(g)-1)).toString(32)+d,l=""+l+"R"+d,d=fs++,0<d&&(l+="H"+d.toString(32)),l+=""}else d=xv++,l=""+l+"r"+d.toString(32)+"";return a.memoizedState=l},useHostTransitionStatus:hy,useFormState:Ov,useActionState:Ov,useOptimistic:function(a){var l=or();l.memoizedState=l.baseState=a;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=Fp.bind(null,mn,!0,d),d.dispatch=l,[a,l]},useMemoCache:$g,useCacheRefresh:function(){return or().memoizedState=bE.bind(null,mn)}},fy={readContext:Ui,use:Np,useCallback:Vv,useContext:Ui,useEffect:oy,useImperativeHandle:zv,useInsertionEffect:Lp,useLayoutEffect:Up,useMemo:cy,useReducer:Zl,useRef:ry,useState:function(){return Zl(ll)},useDebugValue:ly,useDeferredValue:function(a,l){var d=os();return Hv(d,ri.memoizedState,a,l)},useTransition:function(){var a=Zl(ll)[0],l=os().memoizedState;return[typeof a=="boolean"?a:Ya(a),l]},useSyncExternalStore:bv,useId:qv,useHostTransitionStatus:hy,useFormState:Lv,useActionState:Lv,useOptimistic:function(a,l){var d=os();return wv(d,ri,a,l)},useMemoCache:$g,useCacheRefresh:Xv},Kv={readContext:Ui,use:Np,useCallback:Vv,useContext:Ui,useEffect:oy,useImperativeHandle:zv,useInsertionEffect:Lp,useLayoutEffect:Up,useMemo:cy,useReducer:ty,useRef:ry,useState:function(){return ty(ll)},useDebugValue:ly,useDeferredValue:function(a,l){var d=os();return ri===null?Pp(d,a,l):Hv(d,ri.memoizedState,a,l)},useTransition:function(){var a=ty(ll)[0],l=os().memoizedState;return[typeof a=="boolean"?a:Ya(a),l]},useSyncExternalStore:bv,useId:qv,useHostTransitionStatus:hy,useFormState:Pv,useActionState:Pv,useOptimistic:function(a,l){var d=os();return ri!==null?wv(d,ri,a,l):(d.baseState=a,[a,d.queue.dispatch])},useMemoCache:$g,useCacheRefresh:Xv},Wc=null,Zf=0;function $f(a){var l=Zf;return Zf+=1,Wc===null&&(Wc=[]),wp(Wc,a,l)}function mh(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function Hp(a,l){throw l.$$typeof===y?Error(n(525)):(a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function Jv(a){var l=a._init;return l(a._payload)}function Qv(a){function l(Ae,pe){if(a){var Ce=Ae.deletions;Ce===null?(Ae.deletions=[pe],Ae.flags|=16):Ce.push(pe)}}function d(Ae,pe){if(!a)return null;for(;pe!==null;)l(Ae,pe),pe=pe.sibling;return null}function g(Ae){for(var pe=new Map;Ae!==null;)Ae.key!==null?pe.set(Ae.key,Ae):pe.set(Ae.index,Ae),Ae=Ae.sibling;return pe}function S(Ae,pe){return Ae=Wi(Ae,pe),Ae.index=0,Ae.sibling=null,Ae}function C(Ae,pe,Ce){return Ae.index=Ce,a?(Ce=Ae.alternate,Ce!==null?(Ce=Ce.index,Ce<pe?(Ae.flags|=67108866,pe):Ce):(Ae.flags|=67108866,pe)):(Ae.flags|=1048576,pe)}function j(Ae){return a&&Ae.alternate===null&&(Ae.flags|=67108866),Ae}function Y(Ae,pe,Ce,We){return pe===null||pe.tag!==6?(pe=Pf(Ce,Ae.mode,We),pe.return=Ae,pe):(pe=S(pe,Ce),pe.return=Ae,pe)}function ae(Ae,pe,Ce,We){var Ut=Ce.type;return Ut===b?qe(Ae,pe,Ce.props.children,We,Ce.key):pe!==null&&(pe.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===U&&Jv(Ut)===pe.type)?(pe=S(pe,Ce.props),mh(pe,Ce),pe.return=Ae,pe):(pe=bs(Ce.type,Ce.key,Ce.props,null,Ae.mode,We),mh(pe,Ce),pe.return=Ae,pe)}function we(Ae,pe,Ce,We){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Ce.containerInfo||pe.stateNode.implementation!==Ce.implementation?(pe=xp(Ce,Ae.mode,We),pe.return=Ae,pe):(pe=S(pe,Ce.children||[]),pe.return=Ae,pe)}function qe(Ae,pe,Ce,We,Ut){return pe===null||pe.tag!==7?(pe=jl(Ce,Ae.mode,We,Ut),pe.return=Ae,pe):(pe=S(pe,Ce),pe.return=Ae,pe)}function Ze(Ae,pe,Ce){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return pe=Pf(""+pe,Ae.mode,Ce),pe.return=Ae,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case v:return Ce=bs(pe.type,pe.key,pe.props,null,Ae.mode,Ce),mh(Ce,pe),Ce.return=Ae,Ce;case x:return pe=xp(pe,Ae.mode,Ce),pe.return=Ae,pe;case U:var We=pe._init;return pe=We(pe._payload),Ze(Ae,pe,Ce)}if(me(pe)||W(pe))return pe=jl(pe,Ae.mode,Ce,null),pe.return=Ae,pe;if(typeof pe.then=="function")return Ze(Ae,$f(pe),Ce);if(pe.$$typeof===B)return Ze(Ae,Hf(Ae,pe),Ce);Hp(Ae,pe)}return null}function Ie(Ae,pe,Ce,We){var Ut=pe!==null?pe.key:null;if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ut!==null?null:Y(Ae,pe,""+Ce,We);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case v:return Ce.key===Ut?ae(Ae,pe,Ce,We):null;case x:return Ce.key===Ut?we(Ae,pe,Ce,We):null;case U:return Ut=Ce._init,Ce=Ut(Ce._payload),Ie(Ae,pe,Ce,We)}if(me(Ce)||W(Ce))return Ut!==null?null:qe(Ae,pe,Ce,We,null);if(typeof Ce.then=="function")return Ie(Ae,pe,$f(Ce),We);if(Ce.$$typeof===B)return Ie(Ae,pe,Hf(Ae,Ce),We);Hp(Ae,Ce)}return null}function Ne(Ae,pe,Ce,We,Ut){if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return Ae=Ae.get(Ce)||null,Y(pe,Ae,""+We,Ut);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case v:return Ae=Ae.get(We.key===null?Ce:We.key)||null,ae(pe,Ae,We,Ut);case x:return Ae=Ae.get(We.key===null?Ce:We.key)||null,we(pe,Ae,We,Ut);case U:var Nn=We._init;return We=Nn(We._payload),Ne(Ae,pe,Ce,We,Ut)}if(me(We)||W(We))return Ae=Ae.get(Ce)||null,qe(pe,Ae,We,Ut,null);if(typeof We.then=="function")return Ne(Ae,pe,Ce,$f(We),Ut);if(We.$$typeof===B)return Ne(Ae,pe,Ce,Hf(pe,We),Ut);Hp(pe,We)}return null}function rn(Ae,pe,Ce,We){for(var Ut=null,Nn=null,kt=pe,$t=pe=0,Ys=null;kt!==null&&$t<Ce.length;$t++){kt.index>$t?(Ys=kt,kt=null):Ys=kt.sibling;var ii=Ie(Ae,kt,Ce[$t],We);if(ii===null){kt===null&&(kt=Ys);break}a&&kt&&ii.alternate===null&&l(Ae,kt),pe=C(ii,pe,$t),Nn===null?Ut=ii:Nn.sibling=ii,Nn=ii,kt=Ys}if($t===Ce.length)return d(Ae,kt),qn&&tl(Ae,$t),Ut;if(kt===null){for(;$t<Ce.length;$t++)kt=Ze(Ae,Ce[$t],We),kt!==null&&(pe=C(kt,pe,$t),Nn===null?Ut=kt:Nn.sibling=kt,Nn=kt);return qn&&tl(Ae,$t),Ut}for(kt=g(kt);$t<Ce.length;$t++)Ys=Ne(kt,Ae,$t,Ce[$t],We),Ys!==null&&(a&&Ys.alternate!==null&&kt.delete(Ys.key===null?$t:Ys.key),pe=C(Ys,pe,$t),Nn===null?Ut=Ys:Nn.sibling=Ys,Nn=Ys);return a&&kt.forEach(function(Bh){return l(Ae,Bh)}),qn&&tl(Ae,$t),Ut}function Qt(Ae,pe,Ce,We){if(Ce==null)throw Error(n(151));for(var Ut=null,Nn=null,kt=pe,$t=pe=0,Ys=null,ii=Ce.next();kt!==null&&!ii.done;$t++,ii=Ce.next()){kt.index>$t?(Ys=kt,kt=null):Ys=kt.sibling;var Bh=Ie(Ae,kt,ii.value,We);if(Bh===null){kt===null&&(kt=Ys);break}a&&kt&&Bh.alternate===null&&l(Ae,kt),pe=C(Bh,pe,$t),Nn===null?Ut=Bh:Nn.sibling=Bh,Nn=Bh,kt=Ys}if(ii.done)return d(Ae,kt),qn&&tl(Ae,$t),Ut;if(kt===null){for(;!ii.done;$t++,ii=Ce.next())ii=Ze(Ae,ii.value,We),ii!==null&&(pe=C(ii,pe,$t),Nn===null?Ut=ii:Nn.sibling=ii,Nn=ii);return qn&&tl(Ae,$t),Ut}for(kt=g(kt);!ii.done;$t++,ii=Ce.next())ii=Ne(kt,Ae,$t,ii.value,We),ii!==null&&(a&&ii.alternate!==null&&kt.delete(ii.key===null?$t:ii.key),pe=C(ii,pe,$t),Nn===null?Ut=ii:Nn.sibling=ii,Nn=ii);return a&&kt.forEach(function(OP){return l(Ae,OP)}),qn&&tl(Ae,$t),Ut}function Ai(Ae,pe,Ce,We){if(typeof Ce=="object"&&Ce!==null&&Ce.type===b&&Ce.key===null&&(Ce=Ce.props.children),typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case v:e:{for(var Ut=Ce.key;pe!==null;){if(pe.key===Ut){if(Ut=Ce.type,Ut===b){if(pe.tag===7){d(Ae,pe.sibling),We=S(pe,Ce.props.children),We.return=Ae,Ae=We;break e}}else if(pe.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===U&&Jv(Ut)===pe.type){d(Ae,pe.sibling),We=S(pe,Ce.props),mh(We,Ce),We.return=Ae,Ae=We;break e}d(Ae,pe);break}else l(Ae,pe);pe=pe.sibling}Ce.type===b?(We=jl(Ce.props.children,Ae.mode,We,Ce.key),We.return=Ae,Ae=We):(We=bs(Ce.type,Ce.key,Ce.props,null,Ae.mode,We),mh(We,Ce),We.return=Ae,Ae=We)}return j(Ae);case x:e:{for(Ut=Ce.key;pe!==null;){if(pe.key===Ut)if(pe.tag===4&&pe.stateNode.containerInfo===Ce.containerInfo&&pe.stateNode.implementation===Ce.implementation){d(Ae,pe.sibling),We=S(pe,Ce.children||[]),We.return=Ae,Ae=We;break e}else{d(Ae,pe);break}else l(Ae,pe);pe=pe.sibling}We=xp(Ce,Ae.mode,We),We.return=Ae,Ae=We}return j(Ae);case U:return Ut=Ce._init,Ce=Ut(Ce._payload),Ai(Ae,pe,Ce,We)}if(me(Ce))return rn(Ae,pe,Ce,We);if(W(Ce)){if(Ut=W(Ce),typeof Ut!="function")throw Error(n(150));return Ce=Ut.call(Ce),Qt(Ae,pe,Ce,We)}if(typeof Ce.then=="function")return Ai(Ae,pe,$f(Ce),We);if(Ce.$$typeof===B)return Ai(Ae,pe,Hf(Ae,Ce),We);Hp(Ae,Ce)}return typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint"?(Ce=""+Ce,pe!==null&&pe.tag===6?(d(Ae,pe.sibling),We=S(pe,Ce),We.return=Ae,Ae=We):(d(Ae,pe),We=Pf(Ce,Ae.mode,We),We.return=Ae,Ae=We),j(Ae)):d(Ae,pe)}return function(Ae,pe,Ce,We){try{Zf=0;var Ut=Ai(Ae,pe,Ce,We);return Wc=null,Ut}catch(kt){if(kt===qf||kt===Wa)throw kt;var Nn=Er(29,kt,null,Ae.mode);return Nn.lanes=We,Nn.return=Ae,Nn}finally{}}}var Yc=Qv(!0),Zv=Qv(!1),ui=ce(null),Ka=null;function $l(a){var l=a.alternate;Me(Ki,Ki.current&1),Me(ui,a),Ka===null&&(l===null||hh.current!==null||l.memoizedState!==null)&&(Ka=a)}function $v(a){if(a.tag===22){if(Me(Ki,Ki.current),Me(ui,a),Ka===null){var l=a.alternate;l!==null&&l.memoizedState!==null&&(Ka=a)}}else ec()}function ec(){Me(Ki,Ki.current),Me(ui,ui.current)}function So(a){Ee(ui),Ka===a&&(Ka=null),Ee(Ki)}var Ki=ce(0);function cl(a){for(var l=a;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||VE(d)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}function tc(a,l,d,g){l=a.memoizedState,d=d(g,l),d=d==null?l:m({},l,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var lr={enqueueSetState:function(a,l,d){a=a._reactInternals;var g=zi(),S=xo(g);S.payload=l,d!=null&&(S.callback=d),l=rl(a,S,g),l!==null&&(ur(l,a,g),Xc(l,a,g))},enqueueReplaceState:function(a,l,d){a=a._reactInternals;var g=zi(),S=xo(g);S.tag=1,S.payload=l,d!=null&&(S.callback=d),l=rl(a,S,g),l!==null&&(ur(l,a,g),Xc(l,a,g))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var d=zi(),g=xo(d);g.tag=2,l!=null&&(g.callback=l),l=rl(a,g,d),l!==null&&(ur(l,a,d),Xc(l,a,d))}};function e0(a,l,d,g,S,C,j){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,C,j):l.prototype&&l.prototype.isPureReactComponent?!qa(d,g)||!qa(S,C):!0}function t0(a,l,d,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,g),l.state!==a&&lr.enqueueReplaceState(l,l.state,null)}function Eo(a,l){var d=l;if("ref"in l){d={};for(var g in l)g!=="ref"&&(d[g]=l[g])}if(a=a.defaultProps){d===l&&(d=m({},d));for(var S in a)d[S]===void 0&&(d[S]=a[S])}return d}var Kc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function ed(a){Kc(a)}function kp(a){console.error(a)}function n0(a){Kc(a)}function Gp(a,l){try{var d=a.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function Ma(a,l,d){try{var g=a.onCaughtError;g(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function jp(a,l,d){return d=xo(d),d.tag=3,d.payload={element:null},d.callback=function(){Gp(a,l)},d}function i0(a){return a=xo(a),a.tag=3,a}function qp(a,l,d,g){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var C=g.value;a.payload=function(){return S(C)},a.callback=function(){Ma(l,d,g)}}var j=d.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(a.callback=function(){Ma(l,d,g),typeof S!="function"&&($r===null?$r=new Set([this]):$r.add(this));var Y=g.stack;this.componentDidCatch(g.value,{componentStack:Y!==null?Y:""})})}function ME(a,l,d,g,S){if(d.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=d.alternate,l!==null&&Sa(l,d,S,!0),d=ui.current,d!==null){switch(d.tag){case 13:return Ka===null?u():d.alternate===null&&Ei===0&&(Ei=3),d.flags&=-257,d.flags|=65536,d.lanes=S,g===Xf?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([g]):l.add(g),Oe(a,g,S)),!1;case 22:return d.flags|=65536,g===Xf?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([g]):d.add(g)),Oe(a,g,S)),!1}throw Error(n(435,d.tag))}return Oe(a,g,S),u(),!1}if(qn)return l=ui.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=S,g!==Ep&&(a=Error(n(422),{cause:g}),qc(Ns(a,d)))):(g!==Ep&&(l=Error(n(423),{cause:g}),qc(Ns(l,d))),a=a.current.alternate,a.flags|=65536,S&=-S,a.lanes|=S,g=Ns(g,d),S=jp(a.stateNode,g,S),lh(a,S),Ei!==4&&(Ei=2)),!1;var C=Error(n(520),{cause:g});if(C=Ns(C,d),ni===null?ni=[C]:ni.push(C),Ei!==4&&(Ei=2),l===null)return!0;g=Ns(g,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,a=S&-S,d.lanes|=a,a=jp(d.stateNode,g,a),lh(d,a),!1;case 1:if(l=d.type,C=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&($r===null||!$r.has(C))))return d.flags|=65536,S&=-S,d.lanes|=S,S=i0(S),qp(S,a,d,g),lh(d,S),!1}d=d.return}while(d!==null);return!1}var s0=Error(n(461)),Ts=!1;function Ji(a,l,d,g){l.child=a===null?Zv(l,null,d,g):Yc(l,a.child,d,g)}function Tr(a,l,d,g,S){d=d.render;var C=l.ref;if("ref"in g){var j={};for(var Y in g)Y!=="ref"&&(j[Y]=g[Y])}else j=g;return Ao(l),g=ol(a,l,d,j,C,S),Y=Qg(),a!==null&&!Ts?(Bp(a,l,S),Ms(a,l,S)):(qn&&Y&&Vg(l),l.flags|=1,Ji(a,l,g,S),l.child)}function Mr(a,l,d,g,S){if(a===null){var C=d.type;return typeof C=="function"&&!Uf(C)&&C.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=C,dy(a,l,C,g,S)):(a=bs(d.type,null,g,l,l.mode,S),a.ref=l.ref,a.return=l,l.child=a)}if(C=a.child,!td(a,S)){var j=C.memoizedProps;if(d=d.compare,d=d!==null?d:qa,d(j,g)&&a.ref===l.ref)return Ms(a,l,S)}return l.flags|=1,a=Wi(C,g),a.ref=l.ref,a.return=l,l.child=a}function dy(a,l,d,g,S){if(a!==null){var C=a.memoizedProps;if(qa(C,g)&&a.ref===l.ref)if(Ts=!1,l.pendingProps=g=C,td(a,S))(a.flags&131072)!==0&&(Ts=!0);else return l.lanes=a.lanes,Ms(a,l,S)}return gh(a,l,d,g,S)}function Jc(a,l,d){var g=l.pendingProps,S=g.children,C=a!==null?a.memoizedState:null;if(g.mode==="hidden"){if((l.flags&128)!==0){if(g=C!==null?C.baseLanes|d:d,a!==null){for(S=l.child=a.child,C=0;S!==null;)C=C|S.lanes|S.childLanes,S=S.sibling;l.childLanes=C&~g}else l.childLanes=0,l.child=null;return Qc(a,l,g,d)}if((d&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&jf(l,C!==null?C.cachePool:null),C!==null?Av(l,C):Jg(),$v(l);else return l.lanes=l.childLanes=536870912,Qc(a,l,C!==null?C.baseLanes|d:d,d)}else C!==null?(jf(l,C.cachePool),Av(l,C),ec(),l.memoizedState=null):(a!==null&&jf(l,null),Jg(),ec());return Ji(a,l,S,d),l.child}function Qc(a,l,d,g){var S=Kl();return S=S===null?null:{parent:rs._currentValue,pool:S},l.memoizedState={baseLanes:d,cachePool:S},a!==null&&jf(l,null),Jg(),$v(l),a!==null&&Sa(a,l,g,!0),null}function Zc(a,l){var d=l.ref;if(d===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(a===null||a.ref!==d)&&(l.flags|=4194816)}}function gh(a,l,d,g,S){return Ao(l),d=ol(a,l,d,g,void 0,S),g=Qg(),a!==null&&!Ts?(Bp(a,l,S),Ms(a,l,S)):(qn&&g&&Vg(l),l.flags|=1,Ji(a,l,d,S),l.child)}function Xr(a,l,d,g,S,C){return Ao(l),l.updateQueue=null,d=Ev(l,g,d,S),Sv(a),g=Qg(),a!==null&&!Ts?(Bp(a,l,C),Ms(a,l,C)):(qn&&g&&Vg(l),l.flags|=1,Ji(a,l,d,C),l.child)}function Wr(a,l,d,g,S){if(Ao(l),l.stateNode===null){var C=Gl,j=d.contextType;typeof j=="object"&&j!==null&&(C=Ui(j)),C=new d(g,C),l.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=lr,l.stateNode=C,C._reactInternals=l,C=l.stateNode,C.props=g,C.state=l.memoizedState,C.refs={},Yg(l),j=d.contextType,C.context=typeof j=="object"&&j!==null?Ui(j):Gl,C.state=l.memoizedState,j=d.getDerivedStateFromProps,typeof j=="function"&&(tc(l,d,j,g),C.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(j=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),j!==C.state&&lr.enqueueReplaceState(C,C.state,null),ch(l,g,C,S),Wf(),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(a===null){C=l.stateNode;var Y=l.memoizedProps,ae=Eo(d,Y);C.props=ae;var we=C.context,qe=d.contextType;j=Gl,typeof qe=="object"&&qe!==null&&(j=Ui(qe));var Ze=d.getDerivedStateFromProps;qe=typeof Ze=="function"||typeof C.getSnapshotBeforeUpdate=="function",Y=l.pendingProps!==Y,qe||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(Y||we!==j)&&t0(l,C,g,j),sl=!1;var Ie=l.memoizedState;C.state=Ie,ch(l,g,C,S),Wf(),we=l.memoizedState,Y||Ie!==we||sl?(typeof Ze=="function"&&(tc(l,d,Ze,g),we=l.memoizedState),(ae=sl||e0(l,d,ae,g,Ie,we,j))?(qe||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=we),C.props=g,C.state=we,C.context=j,g=ae):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{C=l.stateNode,en(a,l),j=l.memoizedProps,qe=Eo(d,j),C.props=qe,Ze=l.pendingProps,Ie=C.context,we=d.contextType,ae=Gl,typeof we=="object"&&we!==null&&(ae=Ui(we)),Y=d.getDerivedStateFromProps,(we=typeof Y=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(j!==Ze||Ie!==ae)&&t0(l,C,g,ae),sl=!1,Ie=l.memoizedState,C.state=Ie,ch(l,g,C,S),Wf();var Ne=l.memoizedState;j!==Ze||Ie!==Ne||sl||a!==null&&a.dependencies!==null&&Vf(a.dependencies)?(typeof Y=="function"&&(tc(l,d,Y,g),Ne=l.memoizedState),(qe=sl||e0(l,d,qe,g,Ie,Ne,ae)||a!==null&&a.dependencies!==null&&Vf(a.dependencies))?(we||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(g,Ne,ae),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(g,Ne,ae)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||j===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=Ne),C.props=g,C.state=Ne,C.context=ae,g=qe):(typeof C.componentDidUpdate!="function"||j===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=1024),g=!1)}return C=g,Zc(a,l),g=(l.flags&128)!==0,C||g?(C=l.stateNode,d=g&&typeof d.getDerivedStateFromError!="function"?null:C.render(),l.flags|=1,a!==null&&g?(l.child=Yc(l,a.child,null,S),l.child=Yc(l,null,d,S)):Ji(a,l,d,S),l.memoizedState=C.state,a=l.child):a=Ms(a,l,S),a}function nc(a,l,d,g){return ih(),l.flags|=256,Ji(a,l,d,g),l.child}var Ja={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qa(a){return{baseLanes:a,cachePool:Cp()}}function ds(a,l,d){return a=a!==null?a.childLanes&~d:0,l&&(a|=Ia),a}function yh(a,l,d){var g=l.pendingProps,S=!1,C=(l.flags&128)!==0,j;if((j=C)||(j=a!==null&&a.memoizedState===null?!1:(Ki.current&2)!==0),j&&(S=!0,l.flags&=-129),j=(l.flags&32)!==0,l.flags&=-33,a===null){if(qn){if(S?$l(l):ec(),qn){var Y=Ii,ae;if(ae=Y){e:{for(ae=Y,Y=Gr;ae.nodeType!==8;){if(!Y){Y=null;break e}if(ae=ml(ae.nextSibling),ae===null){Y=null;break e}}Y=ae}Y!==null?(l.memoizedState={dehydrated:Y,treeContext:ql!==null?{id:_o,overflow:vo}:null,retryLane:536870912,hydrationErrors:null},ae=Er(18,null,null,0),ae.stateNode=Y,ae.return=l,l.child=ae,rr=l,Ii=null,ae=!0):ae=!1}ae||Xl(l)}if(Y=l.memoizedState,Y!==null&&(Y=Y.dehydrated,Y!==null))return VE(Y)?l.lanes=32:l.lanes=536870912,null;So(l)}return Y=g.children,g=g.fallback,S?(ec(),S=l.mode,Y=$c({mode:"hidden",children:Y},S),g=jl(g,S,d,null),Y.return=l,g.return=l,Y.sibling=g,l.child=Y,S=l.child,S.memoizedState=Qa(d),S.childLanes=ds(a,j,d),l.memoizedState=Ja,g):($l(l),bo(l,Y))}if(ae=a.memoizedState,ae!==null&&(Y=ae.dehydrated,Y!==null)){if(C)l.flags&256?($l(l),l.flags&=-257,l=Us(a,l,d)):l.memoizedState!==null?(ec(),l.child=a.child,l.flags|=128,l=null):(ec(),S=g.fallback,Y=l.mode,g=$c({mode:"visible",children:g.children},Y),S=jl(S,Y,d,null),S.flags|=2,g.return=l,S.return=l,g.sibling=S,l.child=g,Yc(l,a.child,null,d),g=l.child,g.memoizedState=Qa(d),g.childLanes=ds(a,j,d),l.memoizedState=Ja,l=S);else if($l(l),VE(Y)){if(j=Y.nextSibling&&Y.nextSibling.dataset,j)var we=j.dgst;j=we,g=Error(n(419)),g.stack="",g.digest=j,qc({value:g,source:null,stack:null}),l=Us(a,l,d)}else if(Ts||Sa(a,l,d,!1),j=(d&a.childLanes)!==0,Ts||j){if(j=hn,j!==null&&(g=d&-d,g=(g&42)!==0?1:Ot(g),g=(g&(j.suspendedLanes|d))!==0?0:g,g!==0&&g!==ae.retryLane))throw ae.retryLane=g,el(a,g),ur(j,a,g),s0;Y.data==="$?"||u(),l=Us(a,l,d)}else Y.data==="$?"?(l.flags|=192,l.child=a.child,l=null):(a=ae.treeContext,Ii=ml(Y.nextSibling),rr=l,qn=!0,xa=null,Gr=!1,a!==null&&(Os[kr++]=_o,Os[kr++]=vo,Os[kr++]=ql,_o=a.id,vo=a.overflow,ql=l),l=bo(l,g.children),l.flags|=4096);return l}return S?(ec(),S=g.fallback,Y=l.mode,ae=a.child,we=ae.sibling,g=Wi(ae,{mode:"hidden",children:g.children}),g.subtreeFlags=ae.subtreeFlags&65011712,we!==null?S=Wi(we,S):(S=jl(S,Y,d,null),S.flags|=2),S.return=l,g.return=l,g.sibling=S,l.child=g,g=S,S=l.child,Y=a.child.memoizedState,Y===null?Y=Qa(d):(ae=Y.cachePool,ae!==null?(we=rs._currentValue,ae=ae.parent!==we?{parent:we,pool:we}:ae):ae=Cp(),Y={baseLanes:Y.baseLanes|d,cachePool:ae}),S.memoizedState=Y,S.childLanes=ds(a,j,d),l.memoizedState=Ja,g):($l(l),d=a.child,a=d.sibling,d=Wi(d,{mode:"visible",children:g.children}),d.return=l,d.sibling=null,a!==null&&(j=l.deletions,j===null?(l.deletions=[a],l.flags|=16):j.push(a)),l.child=d,l.memoizedState=null,d)}function bo(a,l){return l=$c({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function $c(a,l){return a=Er(22,a,null,l),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Us(a,l,d){return Yc(l,a.child,null,d),a=bo(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function Ps(a,l,d){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),jg(a.return,l,d)}function Un(a,l,d,g,S){var C=a.memoizedState;C===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:S}:(C.isBackwards=l,C.rendering=null,C.renderingStartTime=0,C.last=g,C.tail=d,C.tailMode=S)}function Ca(a,l,d){var g=l.pendingProps,S=g.revealOrder,C=g.tail;if(Ji(a,l,g.children,d),g=Ki.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Ps(a,d,l);else if(a.tag===19)Ps(a,d,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}switch(Me(Ki,g),S){case"forwards":for(d=l.child,S=null;d!==null;)a=d.alternate,a!==null&&cl(a)===null&&(S=d),d=d.sibling;d=S,d===null?(S=l.child,l.child=null):(S=d.sibling,d.sibling=null),Un(l,!1,S,d,C);break;case"backwards":for(d=null,S=l.child,l.child=null;S!==null;){if(a=S.alternate,a!==null&&cl(a)===null){l.child=S;break}a=S.sibling,S.sibling=d,d=S,S=a}Un(l,!0,d,null,C);break;case"together":Un(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Ms(a,l,d){if(a!==null&&(l.dependencies=a.dependencies),to|=l.lanes,(d&l.childLanes)===0)if(a!==null){if(Sa(a,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,d=Wi(a,a.pendingProps),l.child=d,d.return=l;a.sibling!==null;)a=a.sibling,d=d.sibling=Wi(a,a.pendingProps),d.return=l;d.sibling=null}return l.child}function td(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&Vf(a)))}function Ra(a,l,d){switch(l.tag){case 3:lt(l,l.stateNode.containerInfo),Yl(l,rs,a.memoizedState.cache),ih();break;case 27:case 5:Et(l);break;case 4:lt(l,l.stateNode.containerInfo);break;case 10:Yl(l,l.type,l.memoizedProps.value);break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?($l(l),l.flags|=128,null):(d&l.child.childLanes)!==0?yh(a,l,d):($l(l),a=Ms(a,l,d),a!==null?a.sibling:null);$l(l);break;case 19:var S=(a.flags&128)!==0;if(g=(d&l.childLanes)!==0,g||(Sa(a,l,d,!1),g=(d&l.childLanes)!==0),S){if(g)return Ca(a,l,d);l.flags|=128}if(S=l.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),Me(Ki,Ki.current),g)break;return null;case 22:case 23:return l.lanes=0,Jc(a,l,d);case 24:Yl(l,rs,a.memoizedState.cache)}return Ms(a,l,d)}function eu(a,l,d){if(a!==null)if(a.memoizedProps!==l.pendingProps)Ts=!0;else{if(!td(a,d)&&(l.flags&128)===0)return Ts=!1,Ra(a,l,d);Ts=(a.flags&131072)!==0}else Ts=!1,qn&&(l.flags&1048576)!==0&&Sp(l,nh,l.index);switch(l.lanes=0,l.tag){case 16:e:{a=l.pendingProps;var g=l.elementType,S=g._init;if(g=S(g._payload),l.type=g,typeof g=="function")Uf(g)?(a=Eo(g,a),l.tag=1,l=Wr(null,l,g,a,d)):(l.tag=0,l=gh(null,l,g,a,d));else{if(g!=null){if(S=g.$$typeof,S===L){l.tag=11,l=Tr(null,l,g,a,d);break e}else if(S===F){l.tag=14,l=Mr(null,l,g,a,d);break e}}throw l=he(g)||g,Error(n(306,l,""))}}return l;case 0:return gh(a,l,l.type,l.pendingProps,d);case 1:return g=l.type,S=Eo(g,l.pendingProps),Wr(a,l,g,S,d);case 3:e:{if(lt(l,l.stateNode.containerInfo),a===null)throw Error(n(387));g=l.pendingProps;var C=l.memoizedState;S=C.element,en(a,l),ch(l,g,null,d);var j=l.memoizedState;if(g=j.cache,Yl(l,rs,g),g!==C.cache&&zf(l,[rs],d,!0),Wf(),g=j.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:j.cache},l.updateQueue.baseState=C,l.memoizedState=C,l.flags&256){l=nc(a,l,g,d);break e}else if(g!==S){S=Ns(Error(n(424)),l),qc(S),l=nc(a,l,g,d);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ii=ml(a.firstChild),rr=l,qn=!0,xa=null,Gr=!0,d=Zv(l,null,g,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(ih(),g===S){l=Ms(a,l,d);break e}Ji(a,l,g,d)}l=l.child}return l;case 26:return Zc(a,l),a===null?(d=aR(l.type,null,l.pendingProps,null))?l.memoizedState=d:qn||(d=l.type,a=l.pendingProps,g=u0(ze.current).createElement(d),g[Ci]=l,g[$n]=a,hr(g,d,a),Ri(g),l.stateNode=g):l.memoizedState=aR(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return Et(l),a===null&&qn&&(g=l.stateNode=iR(l.type,l.pendingProps,ze.current),rr=l,Gr=!0,S=Ii,Ch(l.type)?(HE=S,Ii=ml(g.firstChild)):Ii=S),Ji(a,l,l.pendingProps.children,d),Zc(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&qn&&((S=g=Ii)&&(g=cP(g,l.type,l.pendingProps,Gr),g!==null?(l.stateNode=g,rr=l,Ii=ml(g.firstChild),Gr=!1,S=!0):S=!1),S||Xl(l)),Et(l),S=l.type,C=l.pendingProps,j=a!==null?a.memoizedProps:null,g=C.children,PE(S,C)?g=null:j!==null&&PE(S,j)&&(l.flags|=32),l.memoizedState!==null&&(S=ol(a,l,AE,null,null,d),by._currentValue=S),Zc(a,l),Ji(a,l,g,d),l.child;case 6:return a===null&&qn&&((a=d=Ii)&&(d=uP(d,l.pendingProps,Gr),d!==null?(l.stateNode=d,rr=l,Ii=null,a=!0):a=!1),a||Xl(l)),null;case 13:return yh(a,l,d);case 4:return lt(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=Yc(l,null,g,d):Ji(a,l,g,d),l.child;case 11:return Tr(a,l,l.type,l.pendingProps,d);case 7:return Ji(a,l,l.pendingProps,d),l.child;case 8:return Ji(a,l,l.pendingProps.children,d),l.child;case 12:return Ji(a,l,l.pendingProps.children,d),l.child;case 10:return g=l.pendingProps,Yl(l,l.type,g.value),Ji(a,l,g.children,d),l.child;case 9:return S=l.type._context,g=l.pendingProps.children,Ao(l),S=Ui(S),g=g(S),l.flags|=1,Ji(a,l,g,d),l.child;case 14:return Mr(a,l,l.type,l.pendingProps,d);case 15:return dy(a,l,l.type,l.pendingProps,d);case 19:return Ca(a,l,d);case 31:return g=l.pendingProps,d=l.mode,g={mode:g.mode,children:g.children},a===null?(d=$c(g,d),d.ref=l.ref,l.child=d,d.return=l,l=d):(d=Wi(a.child,g),d.ref=l.ref,l.child=d,d.return=l,l=d),l;case 22:return Jc(a,l,d);case 24:return Ao(l),g=Ui(rs),a===null?(S=Kl(),S===null&&(S=hn,C=Tp(),S.pooledCache=C,C.refCount++,C!==null&&(S.pooledCacheLanes|=d),S=C),l.memoizedState={parent:g,cache:S},Yg(l),Yl(l,rs,S)):((a.lanes&d)!==0&&(en(a,l),ch(l,null,null,d),Wf()),S=a.memoizedState,C=l.memoizedState,S.parent!==g?(S={parent:g,cache:g},l.memoizedState=S,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=S),Yl(l,rs,g)):(g=C.cache,Yl(l,rs,g),g!==S.cache&&zf(l,[rs],d,!0))),Ji(a,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function Za(a){a.flags|=4}function nd(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!hR(l)){if(l=ui.current,l!==null&&((qt&4194048)===qt?Ka!==null:(qt&62914560)!==qt&&(qt&536870912)===0||l!==Ka))throw ba=Xf,Xg;a.flags|=8192}}function ul(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?Ke():536870912,a.lanes|=l,kn|=l)}function tu(a,l){if(!qn)switch(a.tailMode){case"hidden":l=a.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function gi(a){var l=a.alternate!==null&&a.alternate.child===a.child,d=0,g=0;if(l)for(var S=a.child;S!==null;)d|=S.lanes|S.childLanes,g|=S.subtreeFlags&65011712,g|=S.flags&65011712,S.return=a,S=S.sibling;else for(S=a.child;S!==null;)d|=S.lanes|S.childLanes,g|=S.subtreeFlags,g|=S.flags,S.return=a,S=S.sibling;return a.subtreeFlags|=g,a.childLanes=d,l}function py(a,l,d){var g=l.pendingProps;switch(Hg(l),l.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gi(l),null;case 1:return gi(l),null;case 3:return d=l.stateNode,g=null,a!==null&&(g=a.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),il(rs),At(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(a===null||a.child===null)&&(Xa(l)?Za(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ei())),gi(l),null;case 26:return d=l.memoizedState,a===null?(Za(l),d!==null?(gi(l),nd(l,d)):(gi(l),l.flags&=-16777217)):d?d!==a.memoizedState?(Za(l),gi(l),nd(l,d)):(gi(l),l.flags&=-16777217):(a.memoizedProps!==g&&Za(l),gi(l),l.flags&=-16777217),null;case 27:Nt(l),d=ze.current;var S=l.type;if(a!==null&&l.stateNode!=null)a.memoizedProps!==g&&Za(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return gi(l),null}a=Ve.current,Xa(l)?gv(l):(a=iR(S,g,d),l.stateNode=a,Za(l))}return gi(l),null;case 5:if(Nt(l),d=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==g&&Za(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return gi(l),null}if(a=Ve.current,Xa(l))gv(l);else{switch(S=u0(ze.current),a){case 1:a=S.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:a=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":a=S.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":a=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":a=S.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof g.is=="string"?S.createElement("select",{is:g.is}):S.createElement("select"),g.multiple?a.multiple=!0:g.size&&(a.size=g.size);break;default:a=typeof g.is=="string"?S.createElement(d,{is:g.is}):S.createElement(d)}}a[Ci]=l,a[$n]=g;e:for(S=l.child;S!==null;){if(S.tag===5||S.tag===6)a.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===l)break e;for(;S.sibling===null;){if(S.return===null||S.return===l)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}l.stateNode=a;e:switch(hr(a,d,g),d){case"button":case"input":case"select":case"textarea":a=!!g.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Za(l)}}return gi(l),l.flags&=-16777217,null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==g&&Za(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(n(166));if(a=ze.current,Xa(l)){if(a=l.stateNode,d=l.memoizedProps,g=null,S=rr,S!==null)switch(S.tag){case 27:case 5:g=S.memoizedProps}a[Ci]=l,a=!!(a.nodeValue===d||g!==null&&g.suppressHydrationWarning===!0||JC(a.nodeValue,d)),a||Xl(l)}else a=u0(a).createTextNode(g),a[Ci]=l,l.stateNode=a}return gi(l),null;case 13:if(g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(S=Xa(l),g!==null&&g.dehydrated!==null){if(a===null){if(!S)throw Error(n(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Ci]=l}else ih(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gi(l),S=!1}else S=ei(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=S),S=!0;if(!S)return l.flags&256?(So(l),l):(So(l),null)}if(So(l),(l.flags&128)!==0)return l.lanes=d,l;if(d=g!==null,a=a!==null&&a.memoizedState!==null,d){g=l.child,S=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(S=g.alternate.memoizedState.cachePool.pool);var C=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==S&&(g.flags|=2048)}return d!==a&&d&&(l.child.flags|=8192),ul(l,l.updateQueue),gi(l),null;case 4:return At(),a===null&&BE(l.stateNode.containerInfo),gi(l),null;case 10:return il(l.type),gi(l),null;case 19:if(Ee(Ki),S=l.memoizedState,S===null)return gi(l),null;if(g=(l.flags&128)!==0,C=S.rendering,C===null)if(g)tu(S,!1);else{if(Ei!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(C=cl(a),C!==null){for(l.flags|=128,tu(S,!1),a=C.updateQueue,l.updateQueue=a,ul(l,a),l.subtreeFlags=0,a=d,d=l.child;d!==null;)zg(d,a),d=d.sibling;return Me(Ki,Ki.current&1|2),l.child}a=a.sibling}S.tail!==null&&Fe()>Xs&&(l.flags|=128,g=!0,tu(S,!1),l.lanes=4194304)}else{if(!g)if(a=cl(C),a!==null){if(l.flags|=128,g=!0,a=a.updateQueue,l.updateQueue=a,ul(l,a),tu(S,!0),S.tail===null&&S.tailMode==="hidden"&&!C.alternate&&!qn)return gi(l),null}else 2*Fe()-S.renderingStartTime>Xs&&d!==536870912&&(l.flags|=128,g=!0,tu(S,!1),l.lanes=4194304);S.isBackwards?(C.sibling=l.child,l.child=C):(a=S.last,a!==null?a.sibling=C:l.child=C,S.last=C)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=Fe(),l.sibling=null,a=Ki.current,Me(Ki,g?a&1|2:a&1),l):(gi(l),null);case 22:case 23:return So(l),Yf(),g=l.memoizedState!==null,a!==null?a.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(d&536870912)!==0&&(l.flags&128)===0&&(gi(l),l.subtreeFlags&6&&(l.flags|=8192)):gi(l),d=l.updateQueue,d!==null&&ul(l,d.retryQueue),d=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==d&&(l.flags|=2048),a!==null&&Ee(Ea),null;case 24:return d=null,a!==null&&(d=a.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),il(rs),gi(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function _h(a,l){switch(Hg(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return il(rs),At(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return Nt(l),null;case 13:if(So(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));ih()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return Ee(Ki),null;case 4:return At(),null;case 10:return il(l.type),null;case 22:case 23:return So(l),Yf(),a!==null&&Ee(Ea),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return il(rs),null;case 25:return null;default:return null}}function vh(a,l){switch(Hg(l),l.tag){case 3:il(rs),At();break;case 26:case 27:case 5:Nt(l);break;case 4:At();break;case 13:So(l);break;case 19:Ee(Ki);break;case 10:il(l.type);break;case 22:case 23:So(l),Yf(),a!==null&&Ee(Ea);break;case 24:il(rs)}}function nu(a,l){try{var d=l.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var S=g.next;d=S;do{if((d.tag&a)===a){g=void 0;var C=d.create,j=d.inst;g=C(),j.destroy=g}d=d.next}while(d!==S)}}catch(Y){fe(l,l.return,Y)}}function Yr(a,l,d){try{var g=l.updateQueue,S=g!==null?g.lastEffect:null;if(S!==null){var C=S.next;g=C;do{if((g.tag&a)===a){var j=g.inst,Y=j.destroy;if(Y!==void 0){j.destroy=void 0,S=l;var ae=d,we=Y;try{we()}catch(qe){fe(S,ae,qe)}}}g=g.next}while(g!==C)}}catch(qe){fe(l,l.return,qe)}}function iu(a){var l=a.updateQueue;if(l!==null){var d=a.stateNode;try{vv(l,d)}catch(g){fe(a,a.return,g)}}}function hl(a,l,d){d.props=Eo(a.type,a.memoizedProps),d.state=a.memoizedState;try{d.componentWillUnmount()}catch(g){fe(a,l,g)}}function su(a,l){try{var d=a.ref;if(d!==null){switch(a.tag){case 26:case 27:case 5:var g=a.stateNode;break;case 30:g=a.stateNode;break;default:g=a.stateNode}typeof d=="function"?a.refCleanup=d(g):d.current=g}}catch(S){fe(a,l,S)}}function To(a,l){var d=a.ref,g=a.refCleanup;if(d!==null)if(typeof g=="function")try{g()}catch(S){fe(a,l,S)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){fe(a,l,S)}else d.current=null}function Ah(a){var l=a.type,d=a.memoizedProps,g=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&g.focus();break e;case"img":d.src?g.src=d.src:d.srcSet&&(g.srcset=d.srcSet)}}catch(S){fe(a,a.return,S)}}function id(a,l,d){try{var g=a.stateNode;sP(g,a.type,d,l),g[$n]=l}catch(S){fe(a,a.return,S)}}function sd(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ch(a.type)||a.tag===4}function ic(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||sd(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ch(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function sc(a,l,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(a,l):(l=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,l.appendChild(a),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=c0));else if(g!==4&&(g===27&&Ch(a.type)&&(d=a.stateNode,l=null),a=a.child,a!==null))for(sc(a,l,d),a=a.sibling;a!==null;)sc(a,l,d),a=a.sibling}function rc(a,l,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?d.insertBefore(a,l):d.appendChild(a);else if(g!==4&&(g===27&&Ch(a.type)&&(d=a.stateNode),a=a.child,a!==null))for(rc(a,l,d),a=a.sibling;a!==null;)rc(a,l,d),a=a.sibling}function ac(a){var l=a.stateNode,d=a.memoizedProps;try{for(var g=a.type,S=l.attributes;S.length;)l.removeAttributeNode(S[0]);hr(l,g,d),l[Ci]=a,l[$n]=d}catch(C){fe(a,a.return,C)}}var Mo=!1,yi=!1,xh=!1,Kr=typeof WeakSet=="function"?WeakSet:Set,hi=null;function ps(a,l){if(a=a.containerInfo,LE=g0,a=Bg(a),Bf(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var S=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var j=0,Y=-1,ae=-1,we=0,qe=0,Ze=a,Ie=null;t:for(;;){for(var Ne;Ze!==d||S!==0&&Ze.nodeType!==3||(Y=j+S),Ze!==C||g!==0&&Ze.nodeType!==3||(ae=j+g),Ze.nodeType===3&&(j+=Ze.nodeValue.length),(Ne=Ze.firstChild)!==null;)Ie=Ze,Ze=Ne;for(;;){if(Ze===a)break t;if(Ie===d&&++we===S&&(Y=j),Ie===C&&++qe===g&&(ae=j),(Ne=Ze.nextSibling)!==null)break;Ze=Ie,Ie=Ze.parentNode}Ze=Ne}d=Y===-1||ae===-1?null:{start:Y,end:ae}}else d=null}d=d||{start:0,end:0}}else d=null;for(UE={focusedElem:a,selectionRange:d},g0=!1,hi=l;hi!==null;)if(l=hi,a=l.child,(l.subtreeFlags&1024)!==0&&a!==null)a.return=l,hi=a;else for(;hi!==null;){switch(l=hi,C=l.alternate,a=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&C!==null){a=void 0,d=l,S=C.memoizedProps,C=C.memoizedState,g=d.stateNode;try{var rn=Eo(d.type,S,d.elementType===d.type);a=g.getSnapshotBeforeUpdate(rn,C),g.__reactInternalSnapshotBeforeUpdate=a}catch(Qt){fe(d,d.return,Qt)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,d=a.nodeType,d===9)zE(a);else if(d===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":zE(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=l.sibling,a!==null){a.return=l.return,hi=a;break}hi=l.return}}function fl(a,l,d){var g=d.flags;switch(d.tag){case 0:case 11:case 15:cr(a,d),g&4&&nu(5,d);break;case 1:if(cr(a,d),g&4)if(a=d.stateNode,l===null)try{a.componentDidMount()}catch(j){fe(d,d.return,j)}else{var S=Eo(d.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(S,l,a.__reactInternalSnapshotBeforeUpdate)}catch(j){fe(d,d.return,j)}}g&64&&iu(d),g&512&&su(d,d.return);break;case 3:if(cr(a,d),g&64&&(a=d.updateQueue,a!==null)){if(l=null,d.child!==null)switch(d.child.tag){case 27:case 5:l=d.child.stateNode;break;case 1:l=d.child.stateNode}try{vv(a,l)}catch(j){fe(d,d.return,j)}}break;case 27:l===null&&g&4&&ac(d);case 26:case 5:cr(a,d),l===null&&g&4&&Ah(d),g&512&&su(d,d.return);break;case 12:cr(a,d);break;case 13:cr(a,d),g&4&&oc(a,d),g&64&&(a=d.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(d=bi.bind(null,d),hP(a,d))));break;case 22:if(g=d.memoizedState!==null||Mo,!g){l=l!==null&&l.memoizedState!==null||yi,S=Mo;var C=yi;Mo=g,(yi=l)&&!C?Co(a,d,(d.subtreeFlags&8772)!==0):cr(a,d),Mo=S,yi=C}break;case 30:break;default:cr(a,d)}}function Sn(a){var l=a.alternate;l!==null&&(a.alternate=null,Sn(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&Kn(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Wt=null,Hn=!1;function wa(a,l,d){for(d=d.child;d!==null;)ru(a,l,d),d=d.sibling}function ru(a,l,d){if(Ue&&typeof Ue.onCommitFiberUnmount=="function")try{Ue.onCommitFiberUnmount(Re,d)}catch{}switch(d.tag){case 26:yi||To(d,l),wa(a,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:yi||To(d,l);var g=Wt,S=Hn;Ch(d.type)&&(Wt=d.stateNode,Hn=!1),wa(a,l,d),Ay(d.stateNode),Wt=g,Hn=S;break;case 5:yi||To(d,l);case 6:if(g=Wt,S=Hn,Wt=null,wa(a,l,d),Wt=g,Hn=S,Wt!==null)if(Hn)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(d.stateNode)}catch(C){fe(d,l,C)}else try{Wt.removeChild(d.stateNode)}catch(C){fe(d,l,C)}break;case 18:Wt!==null&&(Hn?(a=Wt,tR(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,d.stateNode),Ry(a)):tR(Wt,d.stateNode));break;case 4:g=Wt,S=Hn,Wt=d.stateNode.containerInfo,Hn=!0,wa(a,l,d),Wt=g,Hn=S;break;case 0:case 11:case 14:case 15:yi||Yr(2,d,l),yi||Yr(4,d,l),wa(a,l,d);break;case 1:yi||(To(d,l),g=d.stateNode,typeof g.componentWillUnmount=="function"&&hl(d,l,g)),wa(a,l,d);break;case 21:wa(a,l,d);break;case 22:yi=(g=yi)||d.memoizedState!==null,wa(a,l,d),yi=g;break;default:wa(a,l,d)}}function oc(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Ry(a)}catch(d){fe(l,l.return,d)}}function Xp(a){switch(a.tag){case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new Kr),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new Kr),l;default:throw Error(n(435,a.tag))}}function au(a,l){var d=Xp(a);l.forEach(function(g){var S=tn.bind(null,a,g);d.has(g)||(d.add(g),g.then(S,S))})}function Cs(a,l){var d=l.deletions;if(d!==null)for(var g=0;g<d.length;g++){var S=d[g],C=a,j=l,Y=j;e:for(;Y!==null;){switch(Y.tag){case 27:if(Ch(Y.type)){Wt=Y.stateNode,Hn=!1;break e}break;case 5:Wt=Y.stateNode,Hn=!1;break e;case 3:case 4:Wt=Y.stateNode.containerInfo,Hn=!0;break e}Y=Y.return}if(Wt===null)throw Error(n(160));ru(C,j,S),Wt=null,Hn=!1,C=S.alternate,C!==null&&(C.return=null),S.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)Wp(l,a),l=l.sibling}var $a=null;function Wp(a,l){var d=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Cs(l,a),Pi(a),g&4&&(Yr(3,a,a.return),nu(3,a),Yr(5,a,a.return));break;case 1:Cs(l,a),Pi(a),g&512&&(yi||d===null||To(d,d.return)),g&64&&Mo&&(a=a.updateQueue,a!==null&&(g=a.callbacks,g!==null&&(d=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=d===null?g:d.concat(g))));break;case 26:var S=$a;if(Cs(l,a),Pi(a),g&512&&(yi||d===null||To(d,d.return)),g&4){var C=d!==null?d.memoizedState:null;if(g=a.memoizedState,d===null)if(g===null)if(a.stateNode===null){e:{g=a.type,d=a.memoizedProps,S=S.ownerDocument||S;t:switch(g){case"title":C=S.getElementsByTagName("title")[0],(!C||C[nr]||C[Ci]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=S.createElement(g),S.head.insertBefore(C,S.querySelector("head > title"))),hr(C,g,d),C[Ci]=a,Ri(C),g=C;break e;case"link":var j=cR("link","href",S).get(g+(d.href||""));if(j){for(var Y=0;Y<j.length;Y++)if(C=j[Y],C.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&C.getAttribute("rel")===(d.rel==null?null:d.rel)&&C.getAttribute("title")===(d.title==null?null:d.title)&&C.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){j.splice(Y,1);break t}}C=S.createElement(g),hr(C,g,d),S.head.appendChild(C);break;case"meta":if(j=cR("meta","content",S).get(g+(d.content||""))){for(Y=0;Y<j.length;Y++)if(C=j[Y],C.getAttribute("content")===(d.content==null?null:""+d.content)&&C.getAttribute("name")===(d.name==null?null:d.name)&&C.getAttribute("property")===(d.property==null?null:d.property)&&C.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&C.getAttribute("charset")===(d.charSet==null?null:d.charSet)){j.splice(Y,1);break t}}C=S.createElement(g),hr(C,g,d),S.head.appendChild(C);break;default:throw Error(n(468,g))}C[Ci]=a,Ri(C),g=C}a.stateNode=g}else uR(S,a.type,a.stateNode);else a.stateNode=lR(S,g,a.memoizedProps);else C!==g?(C===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):C.count--,g===null?uR(S,a.type,a.stateNode):lR(S,g,a.memoizedProps)):g===null&&a.stateNode!==null&&id(a,a.memoizedProps,d.memoizedProps)}break;case 27:Cs(l,a),Pi(a),g&512&&(yi||d===null||To(d,d.return)),d!==null&&g&4&&id(a,a.memoizedProps,d.memoizedProps);break;case 5:if(Cs(l,a),Pi(a),g&512&&(yi||d===null||To(d,d.return)),a.flags&32){S=a.stateNode;try{Si(S,"")}catch(Ne){fe(a,a.return,Ne)}}g&4&&a.stateNode!=null&&(S=a.memoizedProps,id(a,S,d!==null?d.memoizedProps:S)),g&1024&&(xh=!0);break;case 6:if(Cs(l,a),Pi(a),g&4){if(a.stateNode===null)throw Error(n(162));g=a.memoizedProps,d=a.stateNode;try{d.nodeValue=g}catch(Ne){fe(a,a.return,Ne)}}break;case 3:if(d0=null,S=$a,$a=h0(l.containerInfo),Cs(l,a),$a=S,Pi(a),g&4&&d!==null&&d.memoizedState.isDehydrated)try{Ry(l.containerInfo)}catch(Ne){fe(a,a.return,Ne)}xh&&(xh=!1,lc(a));break;case 4:g=$a,$a=h0(a.stateNode.containerInfo),Cs(l,a),Pi(a),$a=g;break;case 12:Cs(l,a),Pi(a);break;case 13:Cs(l,a),Pi(a),a.child.flags&8192&&a.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(ai=Fe()),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,au(a,g)));break;case 22:S=a.memoizedState!==null;var ae=d!==null&&d.memoizedState!==null,we=Mo,qe=yi;if(Mo=we||S,yi=qe||ae,Cs(l,a),yi=qe,Mo=we,Pi(a),g&8192)e:for(l=a.stateNode,l._visibility=S?l._visibility&-2:l._visibility|1,S&&(d===null||ae||Mo||yi||Jr(a)),d=null,l=a;;){if(l.tag===5||l.tag===26){if(d===null){ae=d=l;try{if(C=ae.stateNode,S)j=C.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{Y=ae.stateNode;var Ze=ae.memoizedProps.style,Ie=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;Y.style.display=Ie==null||typeof Ie=="boolean"?"":(""+Ie).trim()}}catch(Ne){fe(ae,ae.return,Ne)}}}else if(l.tag===6){if(d===null){ae=l;try{ae.stateNode.nodeValue=S?"":ae.memoizedProps}catch(Ne){fe(ae,ae.return,Ne)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=a.updateQueue,g!==null&&(d=g.retryQueue,d!==null&&(g.retryQueue=null,au(a,d))));break;case 19:Cs(l,a),Pi(a),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,au(a,g)));break;case 30:break;case 21:break;default:Cs(l,a),Pi(a)}}function Pi(a){var l=a.flags;if(l&2){try{for(var d,g=a.return;g!==null;){if(sd(g)){d=g;break}g=g.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var S=d.stateNode,C=ic(a);rc(a,C,S);break;case 5:var j=d.stateNode;d.flags&32&&(Si(j,""),d.flags&=-33);var Y=ic(a);rc(a,Y,j);break;case 3:case 4:var ae=d.stateNode.containerInfo,we=ic(a);sc(a,we,ae);break;default:throw Error(n(161))}}catch(qe){fe(a,a.return,qe)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function lc(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;lc(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function cr(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)fl(a,l.alternate,l),l=l.sibling}function Jr(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:Yr(4,l,l.return),Jr(l);break;case 1:To(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&hl(l,l.return,d),Jr(l);break;case 27:Ay(l.stateNode);case 26:case 5:To(l,l.return),Jr(l);break;case 22:l.memoizedState===null&&Jr(l);break;case 30:Jr(l);break;default:Jr(l)}a=a.sibling}}function Co(a,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,S=a,C=l,j=C.flags;switch(C.tag){case 0:case 11:case 15:Co(S,C,d),nu(4,C);break;case 1:if(Co(S,C,d),g=C,S=g.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(we){fe(g,g.return,we)}if(g=C,S=g.updateQueue,S!==null){var Y=g.stateNode;try{var ae=S.shared.hiddenCallbacks;if(ae!==null)for(S.shared.hiddenCallbacks=null,S=0;S<ae.length;S++)uh(ae[S],Y)}catch(we){fe(g,g.return,we)}}d&&j&64&&iu(C),su(C,C.return);break;case 27:ac(C);case 26:case 5:Co(S,C,d),d&&g===null&&j&4&&Ah(C),su(C,C.return);break;case 12:Co(S,C,d);break;case 13:Co(S,C,d),d&&j&4&&oc(S,C);break;case 22:C.memoizedState===null&&Co(S,C,d),su(C,C.return);break;case 30:break;default:Co(S,C,d)}l=l.sibling}}function Yp(a,l){var d=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==d&&(a!=null&&a.refCount++,d!=null&&sh(d))}function Kp(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&sh(a))}function fi(a,l,d,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Jp(a,l,d,g),l=l.sibling}function Jp(a,l,d,g){var S=l.flags;switch(l.tag){case 0:case 11:case 15:fi(a,l,d,g),S&2048&&nu(9,l);break;case 1:fi(a,l,d,g);break;case 3:fi(a,l,d,g),S&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&sh(a)));break;case 12:if(S&2048){fi(a,l,d,g),a=l.stateNode;try{var C=l.memoizedProps,j=C.id,Y=C.onPostCommit;typeof Y=="function"&&Y(j,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ae){fe(l,l.return,ae)}}else fi(a,l,d,g);break;case 13:fi(a,l,d,g);break;case 23:break;case 22:C=l.stateNode,j=l.alternate,l.memoizedState!==null?C._visibility&2?fi(a,l,d,g):eo(a,l):C._visibility&2?fi(a,l,d,g):(C._visibility|=2,dl(a,l,d,g,(l.subtreeFlags&10256)!==0)),S&2048&&Yp(j,l);break;case 24:fi(a,l,d,g),S&2048&&Kp(l.alternate,l);break;default:fi(a,l,d,g)}}function dl(a,l,d,g,S){for(S=S&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var C=a,j=l,Y=d,ae=g,we=j.flags;switch(j.tag){case 0:case 11:case 15:dl(C,j,Y,ae,S),nu(8,j);break;case 23:break;case 22:var qe=j.stateNode;j.memoizedState!==null?qe._visibility&2?dl(C,j,Y,ae,S):eo(C,j):(qe._visibility|=2,dl(C,j,Y,ae,S)),S&&we&2048&&Yp(j.alternate,j);break;case 24:dl(C,j,Y,ae,S),S&&we&2048&&Kp(j.alternate,j);break;default:dl(C,j,Y,ae,S)}l=l.sibling}}function eo(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=a,g=l,S=g.flags;switch(g.tag){case 22:eo(d,g),S&2048&&Yp(g.alternate,g);break;case 24:eo(d,g),S&2048&&Kp(g.alternate,g);break;default:eo(d,g)}l=l.sibling}}var Qr=8192;function Sh(a){if(a.subtreeFlags&Qr)for(a=a.child;a!==null;)r0(a),a=a.sibling}function r0(a){switch(a.tag){case 26:Sh(a),a.flags&Qr&&a.memoizedState!==null&&bP($a,a.memoizedState,a.memoizedProps);break;case 5:Sh(a);break;case 3:case 4:var l=$a;$a=h0(a.stateNode.containerInfo),Sh(a),$a=l;break;case 22:a.memoizedState===null&&(l=a.alternate,l!==null&&l.memoizedState!==null?(l=Qr,Qr=16777216,Sh(a),Qr=l):Sh(a));break;default:Sh(a)}}function a0(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function _i(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var g=l[d];hi=g,wo(g,a)}a0(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)my(a),a=a.sibling}function my(a){switch(a.tag){case 0:case 11:case 15:_i(a),a.flags&2048&&Yr(9,a,a.return);break;case 3:_i(a);break;case 12:_i(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,Ro(a)):_i(a);break;default:_i(a)}}function Ro(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var g=l[d];hi=g,wo(g,a)}a0(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:Yr(8,l,l.return),Ro(l);break;case 22:d=l.stateNode,d._visibility&2&&(d._visibility&=-3,Ro(l));break;default:Ro(l)}a=a.sibling}}function wo(a,l){for(;hi!==null;){var d=hi;switch(d.tag){case 0:case 11:case 15:Yr(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var g=d.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:sh(d.memoizedState.cache)}if(g=d.child,g!==null)g.return=d,hi=g;else e:for(d=a;hi!==null;){g=hi;var S=g.sibling,C=g.return;if(Sn(g),g===d){hi=null;break e}if(S!==null){S.return=C,hi=S;break e}hi=C}}}var Fi={getCacheForType:function(a){var l=Ui(rs),d=l.data.get(a);return d===void 0&&(d=a(),l.data.set(a,d)),d}},gy=typeof WeakMap=="function"?WeakMap:Map,ti=0,hn=null,Cn=null,qt=0,vn=0,Bi=null,Zr=!1,Eh=!1,bh=!1,Da=0,Ei=0,to=0,Do=0,ou=0,Ia=0,kn=0,ni=null,Yt=null,Bn=!1,ai=0,Xs=1/0,Ba=null,$r=null,ms=0,Ws=null,di=null,ea=0,pl=0,rd=null,ta=null,Io=0,lu=null;function zi(){if((ti&2)!==0&&qt!==0)return qt&-qt;if(q.T!==null){var a=pn;return a!==0?a:RE()}return Zt()}function Qp(){Ia===0&&(Ia=(qt&536870912)===0||qn?oe():536870912);var a=ui.current;return a!==null&&(a.flags|=32),Ia}function ur(a,l,d){(a===hn&&(vn===2||vn===9)||a.cancelPendingCommit!==null)&&(uc(a,0),no(a,qt,Ia,!1)),yt(a,d),((ti&2)===0||a!==hn)&&(a===hn&&((ti&2)===0&&(Do|=d),Ei===4&&no(a,qt,Ia,!1)),dc(a))}function Th(a,l,d){if((ti&6)!==0)throw Error(n(327));var g=!d&&(l&124)===0&&(l&a.expiredLanes)===0||Te(a,l),S=g?E(a,l):h(a,l,!0),C=g;do{if(S===0){Eh&&!g&&no(a,l,0,!1);break}else{if(d=a.current.alternate,C&&!cc(d)){S=h(a,l,!1),C=!1;continue}if(S===2){if(C=l,a.errorRecoveryDisabledLanes&C)var j=0;else j=a.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){l=j;e:{var Y=a;S=ni;var ae=Y.current.memoizedState.isDehydrated;if(ae&&(uc(Y,j).flags|=256),j=h(Y,j,!1),j!==2){if(bh&&!ae){Y.errorRecoveryDisabledLanes|=C,Do|=C,S=4;break e}C=Yt,Yt=S,C!==null&&(Yt===null?Yt=C:Yt.push.apply(Yt,C))}S=j}if(C=!1,S!==2)continue}}if(S===1){uc(a,0),no(a,l,0,!0);break}e:{switch(g=a,C=S,C){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:no(g,l,Ia,!Zr);break e;case 2:Yt=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(S=ai+300-Fe(),10<S)){if(no(g,l,Ia,!Zr),re(g,0,!0)!==0)break e;g.timeoutHandle=$C(ad.bind(null,g,d,Yt,Ba,Bn,l,Ia,Do,kn,Zr,C,2,-0,0),S);break e}ad(g,d,Yt,Ba,Bn,l,Ia,Do,kn,Zr,C,0,-0,0)}}break}while(!0);dc(a)}function ad(a,l,d,g,S,C,j,Y,ae,we,qe,Ze,Ie,Ne){if(a.timeoutHandle=-1,Ze=l.subtreeFlags,(Ze&8192||(Ze&16785408)===16785408)&&(Ey={stylesheets:null,count:0,unsuspend:EP},r0(l),Ze=TP(),Ze!==null)){a.cancelPendingCommit=Ze(pt.bind(null,a,l,C,d,g,S,j,Y,ae,qe,1,Ie,Ne)),no(a,C,j,!we);return}pt(a,l,C,d,g,S,j,Y,ae)}function cc(a){for(var l=a;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var g=0;g<d.length;g++){var S=d[g],C=S.getSnapshot;S=S.value;try{if(!Ar(C(),S))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function no(a,l,d,g){l&=~ou,l&=~Do,a.suspendedLanes|=l,a.pingedLanes&=~l,g&&(a.warmLanes|=l),g=a.expirationTimes;for(var S=l;0<S;){var C=31-_t(S),j=1<<C;g[C]=-1,S&=~j}d!==0&&ke(a,d,l)}function Bo(){return(ti&6)===0?(yy(0),!1):!0}function cu(){if(Cn!==null){if(vn===0)var a=Cn.return;else a=Cn,nl=Wl=null,Zg(a),Wc=null,Zf=0,a=Cn;for(;a!==null;)vh(a.alternate,a),a=a.return;Cn=null}}function uc(a,l){var d=a.timeoutHandle;d!==-1&&(a.timeoutHandle=-1,aP(d)),d=a.cancelPendingCommit,d!==null&&(a.cancelPendingCommit=null,d()),cu(),hn=a,Cn=d=Wi(a.current,null),qt=l,vn=0,Bi=null,Zr=!1,Eh=Te(a,l),bh=!1,kn=Ia=ou=Do=to=Ei=0,Yt=ni=null,Bn=!1,(l&8)!==0&&(l|=l&32);var g=a.entangledLanes;if(g!==0)for(a=a.entanglements,g&=l;0<g;){var S=31-_t(g),C=1<<S;l|=a[S],g&=~C}return Da=l,Lf(),d}function Zp(a,l){mn=null,q.H=Qf,l===qf||l===Wa?(l=Wg(),vn=3):l===Xg?(l=Wg(),vn=4):vn=l===s0?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Bi=l,Cn===null&&(Ei=1,Gp(a,Ns(l,a.current)))}function Mh(){var a=q.H;return q.H=Qf,a===null?Qf:a}function $p(){var a=q.A;return q.A=Fi,a}function u(){Ei=4,Zr||(qt&4194048)!==qt&&ui.current!==null||(Eh=!0),(to&134217727)===0&&(Do&134217727)===0||hn===null||no(hn,qt,Ia,!1)}function h(a,l,d){var g=ti;ti|=2;var S=Mh(),C=$p();(hn!==a||qt!==l)&&(Ba=null,uc(a,l)),l=!1;var j=Ei;e:do try{if(vn!==0&&Cn!==null){var Y=Cn,ae=Bi;switch(vn){case 8:cu(),j=6;break e;case 3:case 2:case 9:case 6:ui.current===null&&(l=!0);var we=vn;if(vn=0,Bi=null,le(a,Y,ae,we),d&&Eh){j=0;break e}break;default:we=vn,vn=0,Bi=null,le(a,Y,ae,we)}}_(),j=Ei;break}catch(qe){Zp(a,qe)}while(!0);return l&&a.shellSuspendCounter++,nl=Wl=null,ti=g,q.H=S,q.A=C,Cn===null&&(hn=null,qt=0,Lf()),j}function _(){for(;Cn!==null;)P(Cn)}function E(a,l){var d=ti;ti|=2;var g=Mh(),S=$p();hn!==a||qt!==l?(Ba=null,Xs=Fe()+500,uc(a,l)):Eh=Te(a,l);e:do try{if(vn!==0&&Cn!==null){l=Cn;var C=Bi;t:switch(vn){case 1:vn=0,Bi=null,le(a,l,C,1);break;case 2:case 9:if(Rp(C)){vn=0,Bi=null,Q(l);break}l=function(){vn!==2&&vn!==9||hn!==a||(vn=7),dc(a)},C.then(l,l);break e;case 3:vn=7;break e;case 4:vn=5;break e;case 7:Rp(C)?(vn=0,Bi=null,Q(l)):(vn=0,Bi=null,le(a,l,C,7));break;case 5:var j=null;switch(Cn.tag){case 26:j=Cn.memoizedState;case 5:case 27:var Y=Cn;if(!j||hR(j)){vn=0,Bi=null;var ae=Y.sibling;if(ae!==null)Cn=ae;else{var we=Y.return;we!==null?(Cn=we,Se(we)):Cn=null}break t}}vn=0,Bi=null,le(a,l,C,5);break;case 6:vn=0,Bi=null,le(a,l,C,6);break;case 8:cu(),Ei=6;break e;default:throw Error(n(462))}}w();break}catch(qe){Zp(a,qe)}while(!0);return nl=Wl=null,q.H=g,q.A=S,ti=d,Cn!==null?0:(hn=null,qt=0,Lf(),Ei)}function w(){for(;Cn!==null&&!He();)P(Cn)}function P(a){var l=eu(a.alternate,a,Da);a.memoizedProps=a.pendingProps,l===null?Se(a):Cn=l}function Q(a){var l=a,d=l.alternate;switch(l.tag){case 15:case 0:l=Xr(d,l,l.pendingProps,l.type,void 0,qt);break;case 11:l=Xr(d,l,l.pendingProps,l.type.render,l.ref,qt);break;case 5:Zg(l);default:vh(d,l),l=Cn=zg(l,Da),l=eu(d,l,Da)}a.memoizedProps=a.pendingProps,l===null?Se(a):Cn=l}function le(a,l,d,g){nl=Wl=null,Zg(l),Wc=null,Zf=0;var S=l.return;try{if(ME(a,S,l,d,qt)){Ei=1,Gp(a,Ns(d,a.current)),Cn=null;return}}catch(C){if(S!==null)throw Cn=S,C;Ei=1,Gp(a,Ns(d,a.current)),Cn=null;return}l.flags&32768?(qn||g===1?a=!0:Eh||(qt&536870912)!==0?a=!1:(Zr=a=!0,(g===2||g===9||g===3||g===6)&&(g=ui.current,g!==null&&g.tag===13&&(g.flags|=16384))),je(l,a)):Se(l)}function Se(a){var l=a;do{if((l.flags&32768)!==0){je(l,Zr);return}a=l.return;var d=py(l.alternate,l,Da);if(d!==null){Cn=d;return}if(l=l.sibling,l!==null){Cn=l;return}Cn=l=a}while(l!==null);Ei===0&&(Ei=5)}function je(a,l){do{var d=_h(a.alternate,a);if(d!==null){d.flags&=32767,Cn=d;return}if(d=a.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(a=a.sibling,a!==null)){Cn=a;return}Cn=a=d}while(a!==null);Ei=6,Cn=null}function pt(a,l,d,g,S,C,j,Y,ae){a.cancelPendingCommit=null;do hc();while(ms!==0);if((ti&6)!==0)throw Error(n(327));if(l!==null){if(l===a.current)throw Error(n(177));if(C=l.lanes|l.childLanes,C|=vp,it(a,d,C,j,Y,ae),a===hn&&(Cn=hn=null,qt=0),di=l,Ws=a,ea=d,pl=C,rd=S,ta=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,Xn(Ft,function(){return fc(),null})):(a.callbackNode=null,a.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=q.T,q.T=null,S=ee.p,ee.p=2,j=ti,ti|=4;try{ps(a,l,d)}finally{ti=j,ee.p=S,q.T=g}}ms=1,bt(),Ct(),fn()}}function bt(){if(ms===1){ms=0;var a=Ws,l=di,d=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||d){d=q.T,q.T=null;var g=ee.p;ee.p=2;var S=ti;ti|=4;try{Wp(l,a);var C=UE,j=Bg(a.containerInfo),Y=C.focusedElem,ae=C.selectionRange;if(j!==Y&&Y&&Y.ownerDocument&&Ig(Y.ownerDocument.documentElement,Y)){if(ae!==null&&Bf(Y)){var we=ae.start,qe=ae.end;if(qe===void 0&&(qe=we),"selectionStart"in Y)Y.selectionStart=we,Y.selectionEnd=Math.min(qe,Y.value.length);else{var Ze=Y.ownerDocument||document,Ie=Ze&&Ze.defaultView||window;if(Ie.getSelection){var Ne=Ie.getSelection(),rn=Y.textContent.length,Qt=Math.min(ae.start,rn),Ai=ae.end===void 0?Qt:Math.min(ae.end,rn);!Ne.extend&&Qt>Ai&&(j=Ai,Ai=Qt,Qt=j);var Ae=Dg(Y,Qt),pe=Dg(Y,Ai);if(Ae&&pe&&(Ne.rangeCount!==1||Ne.anchorNode!==Ae.node||Ne.anchorOffset!==Ae.offset||Ne.focusNode!==pe.node||Ne.focusOffset!==pe.offset)){var Ce=Ze.createRange();Ce.setStart(Ae.node,Ae.offset),Ne.removeAllRanges(),Qt>Ai?(Ne.addRange(Ce),Ne.extend(pe.node,pe.offset)):(Ce.setEnd(pe.node,pe.offset),Ne.addRange(Ce))}}}}for(Ze=[],Ne=Y;Ne=Ne.parentNode;)Ne.nodeType===1&&Ze.push({element:Ne,left:Ne.scrollLeft,top:Ne.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<Ze.length;Y++){var We=Ze[Y];We.element.scrollLeft=We.left,We.element.scrollTop=We.top}}g0=!!LE,UE=LE=null}finally{ti=S,ee.p=g,q.T=d}}a.current=l,ms=2}}function Ct(){if(ms===2){ms=0;var a=Ws,l=di,d=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||d){d=q.T,q.T=null;var g=ee.p;ee.p=2;var S=ti;ti|=4;try{fl(a,l.alternate,l)}finally{ti=S,ee.p=g,q.T=d}}ms=3}}function fn(){if(ms===4||ms===3){ms=0,tt();var a=Ws,l=di,d=ea,g=ta;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ms=5:(ms=0,di=Ws=null,na(a,a.pendingLanes));var S=a.pendingLanes;if(S===0&&($r=null),cn(d),l=l.stateNode,Ue&&typeof Ue.onCommitFiberRoot=="function")try{Ue.onCommitFiberRoot(Re,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=q.T,S=ee.p,ee.p=2,q.T=null;try{for(var C=a.onRecoverableError,j=0;j<g.length;j++){var Y=g[j];C(Y.value,{componentStack:Y.stack})}}finally{q.T=l,ee.p=S}}(ea&3)!==0&&hc(),dc(a),S=a.pendingLanes,(d&4194090)!==0&&(S&42)!==0?a===lu?Io++:(Io=0,lu=a):Io=0,yy(0)}}function na(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,sh(l)))}function hc(a){return bt(),Ct(),fn(),fc()}function fc(){if(ms!==5)return!1;var a=Ws,l=pl;pl=0;var d=cn(ea),g=q.T,S=ee.p;try{ee.p=32>d?32:d,q.T=null,d=rd,rd=null;var C=Ws,j=ea;if(ms=0,di=Ws=null,ea=0,(ti&6)!==0)throw Error(n(331));var Y=ti;if(ti|=4,my(C.current),Jp(C,C.current,j,d),ti=Y,yy(0,!1),Ue&&typeof Ue.onPostCommitFiberRoot=="function")try{Ue.onPostCommitFiberRoot(Re,C)}catch{}return!0}finally{ee.p=S,q.T=g,na(a,l)}}function De(a,l,d){l=Ns(d,l),l=jp(a.stateNode,l,2),a=rl(a,l,2),a!==null&&(yt(a,2),dc(a))}function fe(a,l,d){if(a.tag===3)De(a,a,d);else for(;l!==null;){if(l.tag===3){De(l,a,d);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&($r===null||!$r.has(g))){a=Ns(d,a),d=i0(2),g=rl(l,d,2),g!==null&&(qp(d,g,l,a),yt(g,2),dc(g));break}}l=l.return}}function Oe(a,l,d){var g=a.pingCache;if(g===null){g=a.pingCache=new gy;var S=new Set;g.set(l,S)}else S=g.get(l),S===void 0&&(S=new Set,g.set(l,S));S.has(d)||(bh=!0,S.add(d),a=ct.bind(null,a,l,d),l.then(a,a))}function ct(a,l,d){var g=a.pingCache;g!==null&&g.delete(l),a.pingedLanes|=a.suspendedLanes&d,a.warmLanes&=~d,hn===a&&(qt&d)===d&&(Ei===4||Ei===3&&(qt&62914560)===qt&&300>Fe()-ai?(ti&2)===0&&uc(a,0):ou|=d,kn===qt&&(kn=0)),dc(a)}function Ht(a,l){l===0&&(l=Ke()),a=el(a,l),a!==null&&(yt(a,l),dc(a))}function bi(a){var l=a.memoizedState,d=0;l!==null&&(d=l.retryLane),Ht(a,d)}function tn(a,l){var d=0;switch(a.tag){case 13:var g=a.stateNode,S=a.memoizedState;S!==null&&(d=S.retryLane);break;case 19:g=a.stateNode;break;case 22:g=a.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(l),Ht(a,d)}function Xn(a,l){return se(a,l)}var Qi=null,Rn=null,No=!1,em=!1,CE=!1,od=0;function dc(a){a!==Rn&&a.next===null&&(Rn===null?Qi=Rn=a:Rn=Rn.next=a),em=!0,No||(No=!0,QU())}function yy(a,l){if(!CE&&em){CE=!0;do for(var d=!1,g=Qi;g!==null;){if(a!==0){var S=g.pendingLanes;if(S===0)var C=0;else{var j=g.suspendedLanes,Y=g.pingedLanes;C=(1<<31-_t(42|a)+1)-1,C&=S&~(j&~Y),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(d=!0,GC(g,C))}else C=qt,C=re(g,g===hn?C:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(C&3)===0||Te(g,C)||(d=!0,GC(g,C));g=g.next}while(d);CE=!1}}function JU(){VC()}function VC(){em=No=!1;var a=0;od!==0&&(rP()&&(a=od),od=0);for(var l=Fe(),d=null,g=Qi;g!==null;){var S=g.next,C=HC(g,l);C===0?(g.next=null,d===null?Qi=S:d.next=S,S===null&&(Rn=d)):(d=g,(a!==0||(C&3)!==0)&&(em=!0)),g=S}yy(a)}function HC(a,l){for(var d=a.suspendedLanes,g=a.pingedLanes,S=a.expirationTimes,C=a.pendingLanes&-62914561;0<C;){var j=31-_t(C),Y=1<<j,ae=S[j];ae===-1?((Y&d)===0||(Y&g)!==0)&&(S[j]=rt(Y,l)):ae<=l&&(a.expiredLanes|=Y),C&=~Y}if(l=hn,d=qt,d=re(a,a===l?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g=a.callbackNode,d===0||a===l&&(vn===2||vn===9)||a.cancelPendingCommit!==null)return g!==null&&g!==null&&Ge(g),a.callbackNode=null,a.callbackPriority=0;if((d&3)===0||Te(a,d)){if(l=d&-d,l===a.callbackPriority)return l;switch(g!==null&&Ge(g),cn(d)){case 2:case 8:d=st;break;case 32:d=Ft;break;case 268435456:d=te;break;default:d=Ft}return g=kC.bind(null,a),d=se(d,g),a.callbackPriority=l,a.callbackNode=d,l}return g!==null&&g!==null&&Ge(g),a.callbackPriority=2,a.callbackNode=null,2}function kC(a,l){if(ms!==0&&ms!==5)return a.callbackNode=null,a.callbackPriority=0,null;var d=a.callbackNode;if(hc()&&a.callbackNode!==d)return null;var g=qt;return g=re(a,a===hn?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g===0?null:(Th(a,g,l),HC(a,Fe()),a.callbackNode!=null&&a.callbackNode===d?kC.bind(null,a):null)}function GC(a,l){if(hc())return null;Th(a,l,!0)}function QU(){oP(function(){(ti&6)!==0?se(Qe,JU):VC()})}function RE(){return od===0&&(od=oe()),od}function jC(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Pc(""+a)}function qC(a,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,a.id&&d.setAttribute("form",a.id),l.parentNode.insertBefore(d,l),a=new FormData(a),d.parentNode.removeChild(d),a}function ZU(a,l,d,g,S){if(l==="submit"&&d&&d.stateNode===S){var C=jC((S[$n]||null).action),j=g.submitter;j&&(l=(l=j[$n]||null)?jC(l.formAction):j.getAttribute("formAction"),l!==null&&(C=l,j=null));var Y=new Ul("action","action",null,g,S);a.push({event:Y,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(od!==0){var ae=j?qC(S,j):new FormData(S);uy(d,{pending:!0,data:ae,method:S.method,action:C},null,ae)}}else typeof C=="function"&&(Y.preventDefault(),ae=j?qC(S,j):new FormData(S),uy(d,{pending:!0,data:ae,method:S.method,action:C},C,ae))},currentTarget:S}]})}}for(var wE=0;wE<Of.length;wE++){var DE=Of[wE],$U=DE.toLowerCase(),eP=DE[0].toUpperCase()+DE.slice(1);Es($U,"on"+eP)}Es(sr,"onAnimationEnd"),Es(Lg,"onAnimationIteration"),Es(Sr,"onAnimationStart"),Es("dblclick","onDoubleClick"),Es("focusin","onFocus"),Es("focusout","onBlur"),Es(mv,"onTransitionRun"),Es(Zo,"onTransitionStart"),Es($u,"onTransitionCancel"),Es($o,"onTransitionEnd"),de("onMouseEnter",["mouseout","mouseover"]),de("onMouseLeave",["mouseout","mouseover"]),de("onPointerEnter",["pointerout","pointerover"]),de("onPointerLeave",["pointerout","pointerover"]),J("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),J("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),J("onBeforeInput",["compositionend","keypress","textInput","paste"]),J("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),J("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),J("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _y="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tP=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_y));function XC(a,l){l=(l&4)!==0;for(var d=0;d<a.length;d++){var g=a[d],S=g.event;g=g.listeners;e:{var C=void 0;if(l)for(var j=g.length-1;0<=j;j--){var Y=g[j],ae=Y.instance,we=Y.currentTarget;if(Y=Y.listener,ae!==C&&S.isPropagationStopped())break e;C=Y,S.currentTarget=we;try{C(S)}catch(qe){Kc(qe)}S.currentTarget=null,C=ae}else for(j=0;j<g.length;j++){if(Y=g[j],ae=Y.instance,we=Y.currentTarget,Y=Y.listener,ae!==C&&S.isPropagationStopped())break e;C=Y,S.currentTarget=we;try{C(S)}catch(qe){Kc(qe)}S.currentTarget=null,C=ae}}}}function On(a,l){var d=l[er];d===void 0&&(d=l[er]=new Set);var g=a+"__bubble";d.has(g)||(WC(l,a,2,!1),d.add(g))}function IE(a,l,d){var g=0;l&&(g|=4),WC(d,a,g,l)}var o0="_reactListening"+Math.random().toString(36).slice(2);function BE(a){if(!a[o0]){a[o0]=!0,qo.forEach(function(d){d!=="selectionchange"&&(tP.has(d)||IE(d,!1,a),IE(d,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[o0]||(l[o0]=!0,IE("selectionchange",!1,l))}}function WC(a,l,d,g){switch(yR(l)){case 2:var S=RP;break;case 8:S=wP;break;default:S=XE}d=S.bind(null,l,d,a),S=void 0,!_r||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(S=!0),g?S!==void 0?a.addEventListener(l,d,{capture:!0,passive:S}):a.addEventListener(l,d,!0):S!==void 0?a.addEventListener(l,d,{passive:S}):a.addEventListener(l,d,!1)}function NE(a,l,d,g,S){var C=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var j=g.tag;if(j===3||j===4){var Y=g.stateNode.containerInfo;if(Y===S)break;if(j===4)for(j=g.return;j!==null;){var ae=j.tag;if((ae===3||ae===4)&&j.stateNode.containerInfo===S)return;j=j.return}for(;Y!==null;){if(j=gr(Y),j===null)return;if(ae=j.tag,ae===5||ae===6||ae===26||ae===27){g=C=j;continue e}Y=Y.parentNode}}g=g.return}Sf(function(){var we=C,qe=Vr(d),Ze=[];e:{var Ie=_p.get(a);if(Ie!==void 0){var Ne=Ul,rn=a;switch(a){case"keypress":if(vr(d)===0)break e;case"keydown":case"keyup":Ne=zl;break;case"focusin":rn="focus",Ne=Fc;break;case"focusout":rn="blur",Ne=Fc;break;case"beforeblur":case"afterblur":Ne=Fc;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ne=Hr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ne=wg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ne=Wu;break;case sr:case Lg:case Sr:Ne=zc;break;case $o:Ne=ga;break;case"scroll":case"scrollend":Ne=Ef;break;case"wheel":Ne=Ku;break;case"copy":case"cut":case"paste":Ne=Vc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ne=jc;break;case"toggle":case"beforetoggle":Ne=ja}var Qt=(l&4)!==0,Ai=!Qt&&(a==="scroll"||a==="scrollend"),Ae=Qt?Ie!==null?Ie+"Capture":null:Ie;Qt=[];for(var pe=we,Ce;pe!==null;){var We=pe;if(Ce=We.stateNode,We=We.tag,We!==5&&We!==26&&We!==27||Ce===null||Ae===null||(We=Bl(pe,Ae),We!=null&&Qt.push(vy(pe,We,Ce))),Ai)break;pe=pe.return}0<Qt.length&&(Ie=new Ne(Ie,rn,null,d,qe),Ze.push({event:Ie,listeners:Qt}))}}if((l&7)===0){e:{if(Ie=a==="mouseover"||a==="pointerover",Ne=a==="mouseout"||a==="pointerout",Ie&&d!==mo&&(rn=d.relatedTarget||d.fromElement)&&(gr(rn)||rn[As]))break e;if((Ne||Ie)&&(Ie=qe.window===qe?qe:(Ie=qe.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Ne?(rn=d.relatedTarget||d.toElement,Ne=we,rn=rn?gr(rn):null,rn!==null&&(Ai=r(rn),Qt=rn.tag,rn!==Ai||Qt!==5&&Qt!==27&&Qt!==6)&&(rn=null)):(Ne=null,rn=we),Ne!==rn)){if(Qt=Hr,We="onMouseLeave",Ae="onMouseEnter",pe="mouse",(a==="pointerout"||a==="pointerover")&&(Qt=jc,We="onPointerLeave",Ae="onPointerEnter",pe="pointer"),Ai=Ne==null?Ie:zr(Ne),Ce=rn==null?Ie:zr(rn),Ie=new Qt(We,pe+"leave",Ne,d,qe),Ie.target=Ai,Ie.relatedTarget=Ce,We=null,gr(qe)===we&&(Qt=new Qt(Ae,pe+"enter",rn,d,qe),Qt.target=Ce,Qt.relatedTarget=Ai,We=Qt),Ai=We,Ne&&rn)t:{for(Qt=Ne,Ae=rn,pe=0,Ce=Qt;Ce;Ce=tm(Ce))pe++;for(Ce=0,We=Ae;We;We=tm(We))Ce++;for(;0<pe-Ce;)Qt=tm(Qt),pe--;for(;0<Ce-pe;)Ae=tm(Ae),Ce--;for(;pe--;){if(Qt===Ae||Ae!==null&&Qt===Ae.alternate)break t;Qt=tm(Qt),Ae=tm(Ae)}Qt=null}else Qt=null;Ne!==null&&YC(Ze,Ie,Ne,Qt,!1),rn!==null&&Ai!==null&&YC(Ze,Ai,rn,Qt,!0)}}e:{if(Ie=we?zr(we):window,Ne=Ie.nodeName&&Ie.nodeName.toLowerCase(),Ne==="select"||Ne==="input"&&Ie.type==="file")var Ut=fp;else if(ss(Ie))if(dp)Ut=Vl;else{Ut=fv;var Nn=yE}else Ne=Ie.nodeName,!Ne||Ne.toLowerCase()!=="input"||Ie.type!=="checkbox"&&Ie.type!=="radio"?we&&ku(we.elementType)&&(Ut=fp):Ut=If;if(Ut&&(Ut=Ut(a,we))){Xi(Ze,Ut,d,qe);break e}Nn&&Nn(a,Ie,we),a==="focusout"&&we&&Ie.type==="number"&&we.memoizedProps.value!=null&&Li(Ie,"number",Ie.value)}switch(Nn=we?zr(we):window,a){case"focusin":(ss(Nn)||Nn.contentEditable==="true")&&(Jo=Nn,mp=we,Nf=null);break;case"focusout":Nf=mp=Jo=null;break;case"mousedown":gp=!0;break;case"contextmenu":case"mouseup":case"dragend":gp=!1,Og(Ze,d,qe);break;case"selectionchange":if(Ng)break;case"keydown":case"keyup":Og(Ze,d,qe)}var kt;if(_a)e:{switch(a){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else Dn?Pe(a,d)&&($t="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&($t="onCompositionStart");$t&&(V&&d.locale!=="ko"&&(Dn||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&Dn&&(kt=ju()):(ka=qe,Ol="value"in ka?ka.value:ka.textContent,Dn=!0)),Nn=l0(we,$t),0<Nn.length&&($t=new kc($t,a,null,d,qe),Ze.push({event:$t,listeners:Nn}),kt?$t.data=kt:(kt=gt(d),kt!==null&&($t.data=kt)))),(kt=O?Di(a,d):In(a,d))&&($t=l0(we,"onBeforeInput"),0<$t.length&&(Nn=new kc("onBeforeInput","beforeinput",null,d,qe),Ze.push({event:Nn,listeners:$t}),Nn.data=kt)),ZU(Ze,a,we,d,qe)}XC(Ze,l)})}function vy(a,l,d){return{instance:a,listener:l,currentTarget:d}}function l0(a,l){for(var d=l+"Capture",g=[];a!==null;){var S=a,C=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||C===null||(S=Bl(a,d),S!=null&&g.unshift(vy(a,S,C)),S=Bl(a,l),S!=null&&g.push(vy(a,S,C))),a.tag===3)return g;a=a.return}return[]}function tm(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function YC(a,l,d,g,S){for(var C=l._reactName,j=[];d!==null&&d!==g;){var Y=d,ae=Y.alternate,we=Y.stateNode;if(Y=Y.tag,ae!==null&&ae===g)break;Y!==5&&Y!==26&&Y!==27||we===null||(ae=we,S?(we=Bl(d,C),we!=null&&j.unshift(vy(d,we,ae))):S||(we=Bl(d,C),we!=null&&j.push(vy(d,we,ae)))),d=d.return}j.length!==0&&a.push({event:l,listeners:j})}var nP=/\r\n?/g,iP=/\u0000|\uFFFD/g;function KC(a){return(typeof a=="string"?a:""+a).replace(nP,`
`).replace(iP,"")}function JC(a,l){return l=KC(l),KC(a)===l}function c0(){}function vi(a,l,d,g,S,C){switch(d){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Si(a,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Si(a,""+g);break;case"className":xt(a,"class",g);break;case"tabIndex":xt(a,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":xt(a,d,g);break;case"style":Il(a,g,C);break;case"data":if(l!=="object"){xt(a,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||d!=="href")){a.removeAttribute(d);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(d);break}g=Pc(""+g),a.setAttribute(d,g);break;case"action":case"formAction":if(typeof g=="function"){a.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(d==="formAction"?(l!=="input"&&vi(a,l,"name",S.name,S,null),vi(a,l,"formEncType",S.formEncType,S,null),vi(a,l,"formMethod",S.formMethod,S,null),vi(a,l,"formTarget",S.formTarget,S,null)):(vi(a,l,"encType",S.encType,S,null),vi(a,l,"method",S.method,S,null),vi(a,l,"target",S.target,S,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(d);break}g=Pc(""+g),a.setAttribute(d,g);break;case"onClick":g!=null&&(a.onclick=c0);break;case"onScroll":g!=null&&On("scroll",a);break;case"onScrollEnd":g!=null&&On("scrollend",a);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(d=g.__html,d!=null){if(S.children!=null)throw Error(n(60));a.innerHTML=d}}break;case"multiple":a.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":a.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){a.removeAttribute("xlink:href");break}d=Pc(""+g),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(d,""+g):a.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(d,""):a.removeAttribute(d);break;case"capture":case"download":g===!0?a.setAttribute(d,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(d,g):a.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?a.setAttribute(d,g):a.removeAttribute(d);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?a.removeAttribute(d):a.setAttribute(d,g);break;case"popover":On("beforetoggle",a),On("toggle",a),dt(a,"popover",g);break;case"xlinkActuate":mt(a,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":mt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":mt(a,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":mt(a,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":mt(a,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":mt(a,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":mt(a,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":mt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":mt(a,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":dt(a,"is",g);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=xf.get(d)||d,dt(a,d,g))}}function OE(a,l,d,g,S,C){switch(d){case"style":Il(a,g,C);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(d=g.__html,d!=null){if(S.children!=null)throw Error(n(60));a.innerHTML=d}}break;case"children":typeof g=="string"?Si(a,g):(typeof g=="number"||typeof g=="bigint")&&Si(a,""+g);break;case"onScroll":g!=null&&On("scroll",a);break;case"onScrollEnd":g!=null&&On("scrollend",a);break;case"onClick":g!=null&&(a.onclick=c0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!po.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),l=d.slice(2,S?d.length-7:void 0),C=a[$n]||null,C=C!=null?C[d]:null,typeof C=="function"&&a.removeEventListener(l,C,S),typeof g=="function")){typeof C!="function"&&C!==null&&(d in a?a[d]=null:a.hasAttribute(d)&&a.removeAttribute(d)),a.addEventListener(l,g,S);break e}d in a?a[d]=g:g===!0?a.setAttribute(d,""):dt(a,d,g)}}}function hr(a,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":On("error",a),On("load",a);var g=!1,S=!1,C;for(C in d)if(d.hasOwnProperty(C)){var j=d[C];if(j!=null)switch(C){case"src":g=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:vi(a,l,C,j,d,null)}}S&&vi(a,l,"srcSet",d.srcSet,d,null),g&&vi(a,l,"src",d.src,d,null);return;case"input":On("invalid",a);var Y=C=j=S=null,ae=null,we=null;for(g in d)if(d.hasOwnProperty(g)){var qe=d[g];if(qe!=null)switch(g){case"name":S=qe;break;case"type":j=qe;break;case"checked":ae=qe;break;case"defaultChecked":we=qe;break;case"value":C=qe;break;case"defaultValue":Y=qe;break;case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(n(137,l));break;default:vi(a,l,g,qe,d,null)}}ji(a,C,Y,ae,we,j,S,!1),xn(a);return;case"select":On("invalid",a),g=j=C=null;for(S in d)if(d.hasOwnProperty(S)&&(Y=d[S],Y!=null))switch(S){case"value":C=Y;break;case"defaultValue":j=Y;break;case"multiple":g=Y;default:vi(a,l,S,Y,d,null)}l=C,d=j,a.multiple=!!g,l!=null?mi(a,!!g,l,!1):d!=null&&mi(a,!!g,d,!0);return;case"textarea":On("invalid",a),C=S=g=null;for(j in d)if(d.hasOwnProperty(j)&&(Y=d[j],Y!=null))switch(j){case"value":g=Y;break;case"defaultValue":S=Y;break;case"children":C=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(n(91));break;default:vi(a,l,j,Y,d,null)}ha(a,g,S,C),xn(a);return;case"option":for(ae in d)if(d.hasOwnProperty(ae)&&(g=d[ae],g!=null))switch(ae){case"selected":a.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:vi(a,l,ae,g,d,null)}return;case"dialog":On("beforetoggle",a),On("toggle",a),On("cancel",a),On("close",a);break;case"iframe":case"object":On("load",a);break;case"video":case"audio":for(g=0;g<_y.length;g++)On(_y[g],a);break;case"image":On("error",a),On("load",a);break;case"details":On("toggle",a);break;case"embed":case"source":case"link":On("error",a),On("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(we in d)if(d.hasOwnProperty(we)&&(g=d[we],g!=null))switch(we){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:vi(a,l,we,g,d,null)}return;default:if(ku(l)){for(qe in d)d.hasOwnProperty(qe)&&(g=d[qe],g!==void 0&&OE(a,l,qe,g,d,void 0));return}}for(Y in d)d.hasOwnProperty(Y)&&(g=d[Y],g!=null&&vi(a,l,Y,g,d,null))}function sP(a,l,d,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,C=null,j=null,Y=null,ae=null,we=null,qe=null;for(Ne in d){var Ze=d[Ne];if(d.hasOwnProperty(Ne)&&Ze!=null)switch(Ne){case"checked":break;case"value":break;case"defaultValue":ae=Ze;default:g.hasOwnProperty(Ne)||vi(a,l,Ne,null,g,Ze)}}for(var Ie in g){var Ne=g[Ie];if(Ze=d[Ie],g.hasOwnProperty(Ie)&&(Ne!=null||Ze!=null))switch(Ie){case"type":C=Ne;break;case"name":S=Ne;break;case"checked":we=Ne;break;case"defaultChecked":qe=Ne;break;case"value":j=Ne;break;case"defaultValue":Y=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,l));break;default:Ne!==Ze&&vi(a,l,Ie,Ne,g,Ze)}}Mn(a,j,Y,ae,we,qe,C,S);return;case"select":Ne=j=Y=Ie=null;for(C in d)if(ae=d[C],d.hasOwnProperty(C)&&ae!=null)switch(C){case"value":break;case"multiple":Ne=ae;default:g.hasOwnProperty(C)||vi(a,l,C,null,g,ae)}for(S in g)if(C=g[S],ae=d[S],g.hasOwnProperty(S)&&(C!=null||ae!=null))switch(S){case"value":Ie=C;break;case"defaultValue":Y=C;break;case"multiple":j=C;default:C!==ae&&vi(a,l,S,C,g,ae)}l=Y,d=j,g=Ne,Ie!=null?mi(a,!!d,Ie,!1):!!g!=!!d&&(l!=null?mi(a,!!d,l,!0):mi(a,!!d,d?[]:"",!1));return;case"textarea":Ne=Ie=null;for(Y in d)if(S=d[Y],d.hasOwnProperty(Y)&&S!=null&&!g.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:vi(a,l,Y,null,g,S)}for(j in g)if(S=g[j],C=d[j],g.hasOwnProperty(j)&&(S!=null||C!=null))switch(j){case"value":Ie=S;break;case"defaultValue":Ne=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==C&&vi(a,l,j,S,g,C)}un(a,Ie,Ne);return;case"option":for(var rn in d)if(Ie=d[rn],d.hasOwnProperty(rn)&&Ie!=null&&!g.hasOwnProperty(rn))switch(rn){case"selected":a.selected=!1;break;default:vi(a,l,rn,null,g,Ie)}for(ae in g)if(Ie=g[ae],Ne=d[ae],g.hasOwnProperty(ae)&&Ie!==Ne&&(Ie!=null||Ne!=null))switch(ae){case"selected":a.selected=Ie&&typeof Ie!="function"&&typeof Ie!="symbol";break;default:vi(a,l,ae,Ie,g,Ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qt in d)Ie=d[Qt],d.hasOwnProperty(Qt)&&Ie!=null&&!g.hasOwnProperty(Qt)&&vi(a,l,Qt,null,g,Ie);for(we in g)if(Ie=g[we],Ne=d[we],g.hasOwnProperty(we)&&Ie!==Ne&&(Ie!=null||Ne!=null))switch(we){case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,l));break;default:vi(a,l,we,Ie,g,Ne)}return;default:if(ku(l)){for(var Ai in d)Ie=d[Ai],d.hasOwnProperty(Ai)&&Ie!==void 0&&!g.hasOwnProperty(Ai)&&OE(a,l,Ai,void 0,g,Ie);for(qe in g)Ie=g[qe],Ne=d[qe],!g.hasOwnProperty(qe)||Ie===Ne||Ie===void 0&&Ne===void 0||OE(a,l,qe,Ie,g,Ne);return}}for(var Ae in d)Ie=d[Ae],d.hasOwnProperty(Ae)&&Ie!=null&&!g.hasOwnProperty(Ae)&&vi(a,l,Ae,null,g,Ie);for(Ze in g)Ie=g[Ze],Ne=d[Ze],!g.hasOwnProperty(Ze)||Ie===Ne||Ie==null&&Ne==null||vi(a,l,Ze,Ie,g,Ne)}var LE=null,UE=null;function u0(a){return a.nodeType===9?a:a.ownerDocument}function QC(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ZC(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function PE(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var FE=null;function rP(){var a=window.event;return a&&a.type==="popstate"?a===FE?!1:(FE=a,!0):(FE=null,!1)}var $C=typeof setTimeout=="function"?setTimeout:void 0,aP=typeof clearTimeout=="function"?clearTimeout:void 0,eR=typeof Promise=="function"?Promise:void 0,oP=typeof queueMicrotask=="function"?queueMicrotask:typeof eR<"u"?function(a){return eR.resolve(null).then(a).catch(lP)}:$C;function lP(a){setTimeout(function(){throw a})}function Ch(a){return a==="head"}function tR(a,l){var d=l,g=0,S=0;do{var C=d.nextSibling;if(a.removeChild(d),C&&C.nodeType===8)if(d=C.data,d==="/$"){if(0<g&&8>g){d=g;var j=a.ownerDocument;if(d&1&&Ay(j.documentElement),d&2&&Ay(j.body),d&4)for(d=j.head,Ay(d),j=d.firstChild;j;){var Y=j.nextSibling,ae=j.nodeName;j[nr]||ae==="SCRIPT"||ae==="STYLE"||ae==="LINK"&&j.rel.toLowerCase()==="stylesheet"||d.removeChild(j),j=Y}}if(S===0){a.removeChild(C),Ry(l);return}S--}else d==="$"||d==="$?"||d==="$!"?S++:g=d.charCodeAt(0)-48;else g=0;d=C}while(d);Ry(l)}function zE(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":zE(d),Kn(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}a.removeChild(d)}}function cP(a,l,d,g){for(;a.nodeType===1;){var S=d;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(g){if(!a[nr])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(C=a.getAttribute("rel"),C==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(C!==S.rel||a.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||a.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||a.getAttribute("title")!==(S.title==null?null:S.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(C=a.getAttribute("src"),(C!==(S.src==null?null:S.src)||a.getAttribute("type")!==(S.type==null?null:S.type)||a.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&C&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var C=S.name==null?null:""+S.name;if(S.type==="hidden"&&a.getAttribute("name")===C)return a}else return a;if(a=ml(a.nextSibling),a===null)break}return null}function uP(a,l,d){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!d||(a=ml(a.nextSibling),a===null))return null;return a}function VE(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function hP(a,l){var d=a.ownerDocument;if(a.data!=="$?"||d.readyState==="complete")l();else{var g=function(){l(),d.removeEventListener("DOMContentLoaded",g)};d.addEventListener("DOMContentLoaded",g),a._reactRetry=g}}function ml(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return a}var HE=null;function nR(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return a;l--}else d==="/$"&&l++}a=a.previousSibling}return null}function iR(a,l,d){switch(l=u0(d),a){case"html":if(a=l.documentElement,!a)throw Error(n(452));return a;case"head":if(a=l.head,!a)throw Error(n(453));return a;case"body":if(a=l.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Ay(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);Kn(a)}var Oo=new Map,sR=new Set;function h0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var uu=ee.d;ee.d={f:fP,r:dP,D:pP,C:mP,L:gP,m:yP,X:vP,S:_P,M:AP};function fP(){var a=uu.f(),l=Bo();return a||l}function dP(a){var l=yr(a);l!==null&&l.tag===5&&l.type==="form"?jv(l):uu.r(a)}var nm=typeof document>"u"?null:document;function rR(a,l,d){var g=nm;if(g&&typeof l=="string"&&l){var S=ci(l);S='link[rel="'+a+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),sR.has(S)||(sR.add(S),a={rel:a,crossOrigin:d,href:l},g.querySelector(S)===null&&(l=g.createElement("link"),hr(l,"link",a),Ri(l),g.head.appendChild(l)))}}function pP(a){uu.D(a),rR("dns-prefetch",a,null)}function mP(a,l){uu.C(a,l),rR("preconnect",a,l)}function gP(a,l,d){uu.L(a,l,d);var g=nm;if(g&&a&&l){var S='link[rel="preload"][as="'+ci(l)+'"]';l==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+ci(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+ci(d.imageSizes)+'"]')):S+='[href="'+ci(a)+'"]';var C=S;switch(l){case"style":C=im(a);break;case"script":C=sm(a)}Oo.has(C)||(a=m({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:a,as:l},d),Oo.set(C,a),g.querySelector(S)!==null||l==="style"&&g.querySelector(xy(C))||l==="script"&&g.querySelector(Sy(C))||(l=g.createElement("link"),hr(l,"link",a),Ri(l),g.head.appendChild(l)))}}function yP(a,l){uu.m(a,l);var d=nm;if(d&&a){var g=l&&typeof l.as=="string"?l.as:"script",S='link[rel="modulepreload"][as="'+ci(g)+'"][href="'+ci(a)+'"]',C=S;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=sm(a)}if(!Oo.has(C)&&(a=m({rel:"modulepreload",href:a},l),Oo.set(C,a),d.querySelector(S)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Sy(C)))return}g=d.createElement("link"),hr(g,"link",a),Ri(g),d.head.appendChild(g)}}}function _P(a,l,d){uu.S(a,l,d);var g=nm;if(g&&a){var S=xs(g).hoistableStyles,C=im(a);l=l||"default";var j=S.get(C);if(!j){var Y={loading:0,preload:null};if(j=g.querySelector(xy(C)))Y.loading=5;else{a=m({rel:"stylesheet",href:a,"data-precedence":l},d),(d=Oo.get(C))&&kE(a,d);var ae=j=g.createElement("link");Ri(ae),hr(ae,"link",a),ae._p=new Promise(function(we,qe){ae.onload=we,ae.onerror=qe}),ae.addEventListener("load",function(){Y.loading|=1}),ae.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,f0(j,l,g)}j={type:"stylesheet",instance:j,count:1,state:Y},S.set(C,j)}}}function vP(a,l){uu.X(a,l);var d=nm;if(d&&a){var g=xs(d).hoistableScripts,S=sm(a),C=g.get(S);C||(C=d.querySelector(Sy(S)),C||(a=m({src:a,async:!0},l),(l=Oo.get(S))&&GE(a,l),C=d.createElement("script"),Ri(C),hr(C,"link",a),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(S,C))}}function AP(a,l){uu.M(a,l);var d=nm;if(d&&a){var g=xs(d).hoistableScripts,S=sm(a),C=g.get(S);C||(C=d.querySelector(Sy(S)),C||(a=m({src:a,async:!0,type:"module"},l),(l=Oo.get(S))&&GE(a,l),C=d.createElement("script"),Ri(C),hr(C,"link",a),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(S,C))}}function aR(a,l,d,g){var S=(S=ze.current)?h0(S):null;if(!S)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=im(d.href),d=xs(S).hoistableStyles,g=d.get(l),g||(g={type:"style",instance:null,count:0,state:null},d.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){a=im(d.href);var C=xs(S).hoistableStyles,j=C.get(a);if(j||(S=S.ownerDocument||S,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(a,j),(C=S.querySelector(xy(a)))&&!C._p&&(j.instance=C,j.state.loading=5),Oo.has(a)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Oo.set(a,d),C||xP(S,a,d,j.state))),l&&g===null)throw Error(n(528,""));return j}if(l&&g!==null)throw Error(n(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=sm(d),d=xs(S).hoistableScripts,g=d.get(l),g||(g={type:"script",instance:null,count:0,state:null},d.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function im(a){return'href="'+ci(a)+'"'}function xy(a){return'link[rel="stylesheet"]['+a+"]"}function oR(a){return m({},a,{"data-precedence":a.precedence,precedence:null})}function xP(a,l,d,g){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=a.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),hr(l,"link",d),Ri(l),a.head.appendChild(l))}function sm(a){return'[src="'+ci(a)+'"]'}function Sy(a){return"script[async]"+a}function lR(a,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var g=a.querySelector('style[data-href~="'+ci(d.href)+'"]');if(g)return l.instance=g,Ri(g),g;var S=m({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return g=(a.ownerDocument||a).createElement("style"),Ri(g),hr(g,"style",S),f0(g,d.precedence,a),l.instance=g;case"stylesheet":S=im(d.href);var C=a.querySelector(xy(S));if(C)return l.state.loading|=4,l.instance=C,Ri(C),C;g=oR(d),(S=Oo.get(S))&&kE(g,S),C=(a.ownerDocument||a).createElement("link"),Ri(C);var j=C;return j._p=new Promise(function(Y,ae){j.onload=Y,j.onerror=ae}),hr(C,"link",g),l.state.loading|=4,f0(C,d.precedence,a),l.instance=C;case"script":return C=sm(d.src),(S=a.querySelector(Sy(C)))?(l.instance=S,Ri(S),S):(g=d,(S=Oo.get(C))&&(g=m({},d),GE(g,S)),a=a.ownerDocument||a,S=a.createElement("script"),Ri(S),hr(S,"link",g),a.head.appendChild(S),l.instance=S);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,f0(g,d.precedence,a));return l.instance}function f0(a,l,d){for(var g=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=g.length?g[g.length-1]:null,C=S,j=0;j<g.length;j++){var Y=g[j];if(Y.dataset.precedence===l)C=Y;else if(C!==S)break}C?C.parentNode.insertBefore(a,C.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(a,l.firstChild))}function kE(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function GE(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var d0=null;function cR(a,l,d){if(d0===null){var g=new Map,S=d0=new Map;S.set(d,g)}else S=d0,g=S.get(d),g||(g=new Map,S.set(d,g));if(g.has(a))return g;for(g.set(a,null),d=d.getElementsByTagName(a),S=0;S<d.length;S++){var C=d[S];if(!(C[nr]||C[Ci]||a==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var j=C.getAttribute(l)||"";j=a+j;var Y=g.get(j);Y?Y.push(C):g.set(j,[C])}}return g}function uR(a,l,d){a=a.ownerDocument||a,a.head.insertBefore(d,l==="title"?a.querySelector("head > title"):null)}function SP(a,l,d){if(d===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function hR(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var Ey=null;function EP(){}function bP(a,l,d){if(Ey===null)throw Error(n(475));var g=Ey;if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var S=im(d.href),C=a.querySelector(xy(S));if(C){a=C._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(g.count++,g=p0.bind(g),a.then(g,g)),l.state.loading|=4,l.instance=C,Ri(C);return}C=a.ownerDocument||a,d=oR(d),(S=Oo.get(S))&&kE(d,S),C=C.createElement("link"),Ri(C);var j=C;j._p=new Promise(function(Y,ae){j.onload=Y,j.onerror=ae}),hr(C,"link",d),l.instance=C}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(g.count++,l=p0.bind(g),a.addEventListener("load",l),a.addEventListener("error",l))}}function TP(){if(Ey===null)throw Error(n(475));var a=Ey;return a.stylesheets&&a.count===0&&jE(a,a.stylesheets),0<a.count?function(l){var d=setTimeout(function(){if(a.stylesheets&&jE(a,a.stylesheets),a.unsuspend){var g=a.unsuspend;a.unsuspend=null,g()}},6e4);return a.unsuspend=l,function(){a.unsuspend=null,clearTimeout(d)}}:null}function p0(){if(this.count--,this.count===0){if(this.stylesheets)jE(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var m0=null;function jE(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,m0=new Map,l.forEach(MP,a),m0=null,p0.call(a))}function MP(a,l){if(!(l.state.loading&4)){var d=m0.get(a);if(d)var g=d.get(null);else{d=new Map,m0.set(a,d);for(var S=a.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<S.length;C++){var j=S[C];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(d.set(j.dataset.precedence,j),g=j)}g&&d.set(null,g)}S=l.instance,j=S.getAttribute("data-precedence"),C=d.get(j)||g,C===g&&d.set(null,S),d.set(j,S),this.count++,g=p0.bind(this),S.addEventListener("load",g),S.addEventListener("error",g),C?C.parentNode.insertBefore(S,C.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(S,a.firstChild)),l.state.loading|=4}}var by={$$typeof:B,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function CP(a,l,d,g,S,C,j,Y){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=nt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nt(0),this.hiddenUpdates=nt(null),this.identifierPrefix=g,this.onUncaughtError=S,this.onCaughtError=C,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function fR(a,l,d,g,S,C,j,Y,ae,we,qe,Ze){return a=new CP(a,l,d,j,Y,ae,we,Ze),l=1,C===!0&&(l|=24),C=Er(3,null,null,l),a.current=C,C.stateNode=a,l=Tp(),l.refCount++,a.pooledCache=l,l.refCount++,C.memoizedState={element:g,isDehydrated:d,cache:l},Yg(C),a}function dR(a){return a?(a=Gl,a):Gl}function pR(a,l,d,g,S,C){S=dR(S),g.context===null?g.context=S:g.pendingContext=S,g=xo(l),g.payload={element:d},C=C===void 0?null:C,C!==null&&(g.callback=C),d=rl(a,g,l),d!==null&&(ur(d,a,l),Xc(d,a,l))}function mR(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<l?d:l}}function qE(a,l){mR(a,l),(a=a.alternate)&&mR(a,l)}function gR(a){if(a.tag===13){var l=el(a,67108864);l!==null&&ur(l,a,67108864),qE(a,67108864)}}var g0=!0;function RP(a,l,d,g){var S=q.T;q.T=null;var C=ee.p;try{ee.p=2,XE(a,l,d,g)}finally{ee.p=C,q.T=S}}function wP(a,l,d,g){var S=q.T;q.T=null;var C=ee.p;try{ee.p=8,XE(a,l,d,g)}finally{ee.p=C,q.T=S}}function XE(a,l,d,g){if(g0){var S=WE(g);if(S===null)NE(a,l,g,y0,d),_R(a,g);else if(IP(S,a,l,d,g))g.stopPropagation();else if(_R(a,g),l&4&&-1<DP.indexOf(a)){for(;S!==null;){var C=yr(S);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var j=Dt(C.pendingLanes);if(j!==0){var Y=C;for(Y.pendingLanes|=2,Y.entangledLanes|=2;j;){var ae=1<<31-_t(j);Y.entanglements[1]|=ae,j&=~ae}dc(C),(ti&6)===0&&(Xs=Fe()+500,yy(0))}}break;case 13:Y=el(C,2),Y!==null&&ur(Y,C,2),Bo(),qE(C,2)}if(C=WE(g),C===null&&NE(a,l,g,y0,d),C===S)break;S=C}S!==null&&g.stopPropagation()}else NE(a,l,g,null,d)}}function WE(a){return a=Vr(a),YE(a)}var y0=null;function YE(a){if(y0=null,a=gr(a),a!==null){var l=r(a);if(l===null)a=null;else{var d=l.tag;if(d===13){if(a=o(l),a!==null)return a;a=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return y0=a,null}function yR(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ut()){case Qe:return 2;case st:return 8;case Ft:case Gt:return 32;case te:return 268435456;default:return 32}default:return 32}}var KE=!1,Rh=null,wh=null,Dh=null,Ty=new Map,My=new Map,Ih=[],DP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _R(a,l){switch(a){case"focusin":case"focusout":Rh=null;break;case"dragenter":case"dragleave":wh=null;break;case"mouseover":case"mouseout":Dh=null;break;case"pointerover":case"pointerout":Ty.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":My.delete(l.pointerId)}}function Cy(a,l,d,g,S,C){return a===null||a.nativeEvent!==C?(a={blockedOn:l,domEventName:d,eventSystemFlags:g,nativeEvent:C,targetContainers:[S]},l!==null&&(l=yr(l),l!==null&&gR(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,S!==null&&l.indexOf(S)===-1&&l.push(S),a)}function IP(a,l,d,g,S){switch(l){case"focusin":return Rh=Cy(Rh,a,l,d,g,S),!0;case"dragenter":return wh=Cy(wh,a,l,d,g,S),!0;case"mouseover":return Dh=Cy(Dh,a,l,d,g,S),!0;case"pointerover":var C=S.pointerId;return Ty.set(C,Cy(Ty.get(C)||null,a,l,d,g,S)),!0;case"gotpointercapture":return C=S.pointerId,My.set(C,Cy(My.get(C)||null,a,l,d,g,S)),!0}return!1}function vR(a){var l=gr(a.target);if(l!==null){var d=r(l);if(d!==null){if(l=d.tag,l===13){if(l=o(d),l!==null){a.blockedOn=l,Gi(a.priority,function(){if(d.tag===13){var g=zi();g=Ot(g);var S=el(d,g);S!==null&&ur(S,d,g),qE(d,g)}});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function _0(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var d=WE(a.nativeEvent);if(d===null){d=a.nativeEvent;var g=new d.constructor(d.type,d);mo=g,d.target.dispatchEvent(g),mo=null}else return l=yr(d),l!==null&&gR(l),a.blockedOn=d,!1;l.shift()}return!0}function AR(a,l,d){_0(a)&&d.delete(l)}function BP(){KE=!1,Rh!==null&&_0(Rh)&&(Rh=null),wh!==null&&_0(wh)&&(wh=null),Dh!==null&&_0(Dh)&&(Dh=null),Ty.forEach(AR),My.forEach(AR)}function v0(a,l){a.blockedOn===l&&(a.blockedOn=null,KE||(KE=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,BP)))}var A0=null;function xR(a){A0!==a&&(A0=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){A0===a&&(A0=null);for(var l=0;l<a.length;l+=3){var d=a[l],g=a[l+1],S=a[l+2];if(typeof g!="function"){if(YE(g||d)===null)continue;break}var C=yr(d);C!==null&&(a.splice(l,3),l-=3,uy(C,{pending:!0,data:S,method:d.method,action:g},g,S))}}))}function Ry(a){function l(ae){return v0(ae,a)}Rh!==null&&v0(Rh,a),wh!==null&&v0(wh,a),Dh!==null&&v0(Dh,a),Ty.forEach(l),My.forEach(l);for(var d=0;d<Ih.length;d++){var g=Ih[d];g.blockedOn===a&&(g.blockedOn=null)}for(;0<Ih.length&&(d=Ih[0],d.blockedOn===null);)vR(d),d.blockedOn===null&&Ih.shift();if(d=(a.ownerDocument||a).$$reactFormReplay,d!=null)for(g=0;g<d.length;g+=3){var S=d[g],C=d[g+1],j=S[$n]||null;if(typeof C=="function")j||xR(d);else if(j){var Y=null;if(C&&C.hasAttribute("formAction")){if(S=C,j=C[$n]||null)Y=j.formAction;else if(YE(S)!==null)continue}else Y=j.action;typeof Y=="function"?d[g+1]=Y:(d.splice(g,3),g-=3),xR(d)}}}function JE(a){this._internalRoot=a}x0.prototype.render=JE.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));var d=l.current,g=zi();pR(d,g,a,l,null,null)},x0.prototype.unmount=JE.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;pR(a.current,2,null,a,null,null),Bo(),l[As]=null}};function x0(a){this._internalRoot=a}x0.prototype.unstable_scheduleHydration=function(a){if(a){var l=Zt();a={blockedOn:null,target:a,priority:l};for(var d=0;d<Ih.length&&l!==0&&l<Ih[d].priority;d++);Ih.splice(d,0,a),d===0&&vR(a)}};var SR=e.version;if(SR!=="19.1.1")throw Error(n(527,SR,"19.1.1"));ee.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=f(l),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var NP={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var S0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!S0.isDisabled&&S0.supportsFiber)try{Re=S0.inject(NP),Ue=S0}catch{}}return Dy.createRoot=function(a,l){if(!s(a))throw Error(n(299));var d=!1,g="",S=ed,C=kp,j=n0,Y=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(S=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Y=l.unstable_transitionCallbacks)),l=fR(a,1,!1,null,null,d,g,S,C,j,Y,null),a[As]=l.current,BE(a),new JE(l)},Dy.hydrateRoot=function(a,l,d){if(!s(a))throw Error(n(299));var g=!1,S="",C=ed,j=kp,Y=n0,ae=null,we=null;return d!=null&&(d.unstable_strictMode===!0&&(g=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(C=d.onUncaughtError),d.onCaughtError!==void 0&&(j=d.onCaughtError),d.onRecoverableError!==void 0&&(Y=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(ae=d.unstable_transitionCallbacks),d.formState!==void 0&&(we=d.formState)),l=fR(a,1,!0,l,d??null,g,S,C,j,Y,ae,we),l.context=dR(null),d=l.current,g=zi(),g=Ot(g),S=xo(g),S.callback=null,rl(d,S,g),d=g,l.current.lanes=d,yt(l,d),dc(l),a[As]=l.current,BE(a),new x0(l)},Dy.version="19.1.1",Dy}var BR;function GP(){if(BR)return $E.exports;BR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),$E.exports=kP(),$E.exports}var wI=GP();const jP=aS(wI),qP=()=>{};var NR={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},XP=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const r=i[t++];e[n++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=i[t++],o=i[t++],c=i[t++],f=((s&7)<<18|(r&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const r=i[t++],o=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},II={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const r=i[s],o=s+1<i.length,c=o?i[s+1]:0,f=s+2<i.length,p=f?i[s+2]:0,m=r>>2,y=(r&3)<<4|c>>4;let v=(c&15)<<2|p>>6,x=p&63;f||(x=64,o||(v=64)),n.push(t[m],t[y],t[v],t[x])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(DI(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):XP(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const r=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const p=s<i.length?t[i.charAt(s)]:64;++s;const y=s<i.length?t[i.charAt(s)]:64;if(++s,r==null||c==null||p==null||y==null)throw new WP;const v=r<<2|c>>4;if(n.push(v),p!==64){const x=c<<4&240|p>>2;if(n.push(x),y!==64){const b=p<<6&192|y;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class WP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YP=function(i){const e=DI(i);return II.encodeByteArray(e,!0)},WA=function(i){return YP(i).replace(/\./g,"")},BI=function(i){try{return II.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP=()=>KP().__FIREBASE_DEFAULTS__,QP=()=>{if(typeof process>"u"||typeof NR>"u")return;const i=NR.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},ZP=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&BI(i[1]);return e&&JSON.parse(e)},oS=()=>{try{return qP()||JP()||QP()||ZP()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},NI=i=>oS()?.emulatorHosts?.[i],UM=i=>{const e=NI(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},OI=()=>oS()?.config,LI=i=>oS()?.[`_${i}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function lS(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=i.iat||0,r=i.sub||i.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...i};return[WA(JSON.stringify(t)),WA(JSON.stringify(o)),""].join(".")}const $y={};function e3(){const i={prod:[],emulator:[]};for(const e of Object.keys($y))$y[e]?i.emulator.push(e):i.prod.push(e);return i}function t3(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let OR=!1;function cS(i,e){if(typeof window>"u"||typeof document>"u"||!Hu(window.location.host)||$y[i]===e||$y[i]||OR)return;$y[i]=e;function t(v){return`__firebase__banner__${v}`}const n="__firebase__banner",r=e3().prod.length>0;function o(){const v=document.getElementById(n);v&&v.remove()}function c(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function f(v,x){v.setAttribute("width","24"),v.setAttribute("id",x),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function p(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{OR=!0,o()},v}function m(v,x){v.setAttribute("id",x),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=t3(n),x=t("text"),b=document.getElementById(x)||document.createElement("span"),R=t("learnmore"),M=document.getElementById(R)||document.createElement("a"),T=t("preprendIcon"),D=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const B=v.element;c(B),m(M,R);const L=p();f(D,T),B.append(D,b,M,L),document.body.appendChild(B)}r?(b.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function n3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ur())}function i3(){const i=oS()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function r3(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function a3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function o3(){const i=Ur();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function l3(){return!i3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function c3(){try{return typeof indexedDB=="object"}catch{return!1}}function u3(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3="FirebaseError";class Nc extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=h3,Object.setPrototypeOf(this,Nc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,F_.prototype.create)}}class F_{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?f3(r,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Nc(s,c,n)}}function f3(i,e){return i.replace(d3,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const d3=/\{\$([^}]+)}/g;function p3(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function qd(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const r=i[s],o=e[s];if(LR(r)&&LR(o)){if(!qd(r,o))return!1}else if(r!==o)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function LR(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function m3(i,e){const t=new g3(i,e);return t.subscribe.bind(t)}class g3{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");y3(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=ib),s.error===void 0&&(s.error=ib),s.complete===void 0&&(s.complete=ib);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function y3(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function ib(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(i){return i&&i._delegate?i._delegate:i}class Bu{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _3=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new $P;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(A3(e))try{this.getOrInitializeService({instanceIdentifier:Ed})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:s});n.resolve(r)}catch{}}}}clearInstance(e=Ed){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ed){return this.instances.has(e)}getOptions(e=Ed){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);n===c&&o.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const r=this.instances.get(n);return r&&e(r,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:v3(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ed){return this.component?this.component.multipleInstances?e:Ed:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function v3(i){return i===Ed?void 0:i}function A3(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _3(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pn;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Pn||(Pn={}));const S3={debug:Pn.DEBUG,verbose:Pn.VERBOSE,info:Pn.INFO,warn:Pn.WARN,error:Pn.ERROR,silent:Pn.SILENT},E3=Pn.INFO,b3={[Pn.DEBUG]:"log",[Pn.VERBOSE]:"log",[Pn.INFO]:"info",[Pn.WARN]:"warn",[Pn.ERROR]:"error"},T3=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=b3[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class PM{constructor(e){this.name=e,this._logLevel=E3,this._logHandler=T3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?S3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pn.DEBUG,...e),this._logHandler(this,Pn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pn.VERBOSE,...e),this._logHandler(this,Pn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pn.INFO,...e),this._logHandler(this,Pn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pn.WARN,...e),this._logHandler(this,Pn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pn.ERROR,...e),this._logHandler(this,Pn.ERROR,...e)}}const M3=(i,e)=>e.some(t=>i instanceof t);let UR,PR;function C3(){return UR||(UR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R3(){return PR||(PR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const PI=new WeakMap,OT=new WeakMap,FI=new WeakMap,sb=new WeakMap,FM=new WeakMap;function w3(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",r),i.removeEventListener("error",o)},r=()=>{t(Jh(i.result)),s()},o=()=>{n(i.error),s()};i.addEventListener("success",r),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&PI.set(t,i)}).catch(()=>{}),FM.set(e,i),e}function D3(i){if(OT.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",r),i.removeEventListener("error",o),i.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",r),i.addEventListener("error",o),i.addEventListener("abort",o)});OT.set(i,e)}let LT={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return OT.get(i);if(e==="objectStoreNames")return i.objectStoreNames||FI.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Jh(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function I3(i){LT=i(LT)}function B3(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(rb(this),e,...t);return FI.set(n,e.sort?e.sort():[e]),Jh(n)}:R3().includes(i)?function(...e){return i.apply(rb(this),e),Jh(PI.get(this))}:function(...e){return Jh(i.apply(rb(this),e))}}function N3(i){return typeof i=="function"?B3(i):(i instanceof IDBTransaction&&D3(i),M3(i,C3())?new Proxy(i,LT):i)}function Jh(i){if(i instanceof IDBRequest)return w3(i);if(sb.has(i))return sb.get(i);const e=N3(i);return e!==i&&(sb.set(i,e),FM.set(e,i)),e}const rb=i=>FM.get(i);function O3(i,e,{blocked:t,upgrade:n,blocking:s,terminated:r}={}){const o=indexedDB.open(i,e),c=Jh(o);return n&&o.addEventListener("upgradeneeded",f=>{n(Jh(o.result),f.oldVersion,f.newVersion,Jh(o.transaction),f)}),t&&o.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),c.then(f=>{r&&f.addEventListener("close",()=>r()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const L3=["get","getKey","getAll","getAllKeys","count"],U3=["put","add","delete","clear"],ab=new Map;function FR(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(ab.get(e))return ab.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=U3.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||L3.includes(t)))return;const r=async function(o,...c){const f=this.transaction(o,s?"readwrite":"readonly");let p=f.store;return n&&(p=p.index(c.shift())),(await Promise.all([p[t](...c),s&&f.done]))[0]};return ab.set(e,r),r}I3(i=>({...i,get:(e,t,n)=>FR(e,t)||i.get(e,t,n),has:(e,t)=>!!FR(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(F3(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function F3(i){return i.getComponent()?.type==="VERSION"}const UT="@firebase/app",zR="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu=new PM("@firebase/app"),z3="@firebase/app-compat",V3="@firebase/analytics-compat",H3="@firebase/analytics",k3="@firebase/app-check-compat",G3="@firebase/app-check",j3="@firebase/auth",q3="@firebase/auth-compat",X3="@firebase/database",W3="@firebase/data-connect",Y3="@firebase/database-compat",K3="@firebase/functions",J3="@firebase/functions-compat",Q3="@firebase/installations",Z3="@firebase/installations-compat",$3="@firebase/messaging",eF="@firebase/messaging-compat",tF="@firebase/performance",nF="@firebase/performance-compat",iF="@firebase/remote-config",sF="@firebase/remote-config-compat",rF="@firebase/storage",aF="@firebase/storage-compat",oF="@firebase/firestore",lF="@firebase/ai",cF="@firebase/firestore-compat",uF="firebase",hF="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT="[DEFAULT]",fF={[UT]:"fire-core",[z3]:"fire-core-compat",[H3]:"fire-analytics",[V3]:"fire-analytics-compat",[G3]:"fire-app-check",[k3]:"fire-app-check-compat",[j3]:"fire-auth",[q3]:"fire-auth-compat",[X3]:"fire-rtdb",[W3]:"fire-data-connect",[Y3]:"fire-rtdb-compat",[K3]:"fire-fn",[J3]:"fire-fn-compat",[Q3]:"fire-iid",[Z3]:"fire-iid-compat",[$3]:"fire-fcm",[eF]:"fire-fcm-compat",[tF]:"fire-perf",[nF]:"fire-perf-compat",[iF]:"fire-rc",[sF]:"fire-rc-compat",[rF]:"fire-gcs",[aF]:"fire-gcs-compat",[oF]:"fire-fst",[cF]:"fire-fst-compat",[lF]:"fire-vertex","fire-js":"fire-js",[uF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA=new Map,dF=new Map,FT=new Map;function VR(i,e){try{i.container.addComponent(e)}catch(t){Nu.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function nf(i){const e=i.name;if(FT.has(e))return Nu.debug(`There were multiple attempts to register component ${e}.`),!1;FT.set(e,i);for(const t of YA.values())VR(t,i);for(const t of dF.values())VR(t,i);return!0}function V_(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function ro(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qh=new F_("app","Firebase",pF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Bu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=hF;function zI(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:PT,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Qh.create("bad-app-name",{appName:String(s)});if(t||(t=OI()),!t)throw Qh.create("no-options");const r=YA.get(s);if(r){if(qd(t,r.options)&&qd(n,r.config))return r;throw Qh.create("duplicate-app",{appName:s})}const o=new x3(s);for(const f of FT.values())o.addComponent(f);const c=new mF(t,n,o);return YA.set(s,c),c}function uS(i=PT){const e=YA.get(i);if(!e&&i===PT&&OI())return zI();if(!e)throw Qh.create("no-app",{appName:i});return e}function Vo(i,e,t){let n=fF[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),r=e.match(/\s|\//);if(s||r){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nu.warn(o.join(" "));return}nf(new Bu(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF="firebase-heartbeat-database",yF=1,g_="firebase-heartbeat-store";let ob=null;function VI(){return ob||(ob=O3(gF,yF,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(g_)}catch(t){console.warn(t)}}}}).catch(i=>{throw Qh.create("idb-open",{originalErrorMessage:i.message})})),ob}async function _F(i){try{const t=(await VI()).transaction(g_),n=await t.objectStore(g_).get(HI(i));return await t.done,n}catch(e){if(e instanceof Nc)Nu.warn(e.message);else{const t=Qh.create("idb-get",{originalErrorMessage:e?.message});Nu.warn(t.message)}}}async function HR(i,e){try{const n=(await VI()).transaction(g_,"readwrite");await n.objectStore(g_).put(e,HI(i)),await n.done}catch(t){if(t instanceof Nc)Nu.warn(t.message);else{const n=Qh.create("idb-set",{originalErrorMessage:t?.message});Nu.warn(n.message)}}}function HI(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=1024,AF=30;class xF{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EF(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=kR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>AF){const s=bF(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Nu.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=kR(),{heartbeatsToSend:t,unsentEntries:n}=SF(this._heartbeatsCache.heartbeats),s=WA(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Nu.warn(e),""}}}function kR(){return new Date().toISOString().substring(0,10)}function SF(i,e=vF){const t=[];let n=i.slice();for(const s of i){const r=t.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),GR(t)>e){r.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),GR(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class EF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return c3()?u3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _F(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return HR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return HR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function GR(i){return WA(JSON.stringify({version:2,heartbeats:i})).length}function bF(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(i){nf(new Bu("platform-logger",e=>new P3(e),"PRIVATE")),nf(new Bu("heartbeat",e=>new xF(e),"PRIVATE")),Vo(UT,zR,i),Vo(UT,zR,"esm2020"),Vo("fire-js","")}TF("");function kI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MF=kI,GI=new F_("auth","Firebase",kI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA=new PM("@firebase/auth");function CF(i,...e){KA.logLevel<=Pn.WARN&&KA.warn(`Auth (${ip}): ${i}`,...e)}function IA(i,...e){KA.logLevel<=Pn.ERROR&&KA.error(`Auth (${ip}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(i,...e){throw VM(i,...e)}function bl(i,...e){return VM(i,...e)}function zM(i,e,t){const n={...MF(),[e]:t};return new F_("auth","Firebase",n).create(e,{appName:i.name})}function Fd(i){return zM(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function RF(i,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&wc(i,"argument-error"),zM(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function VM(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return GI.create(i,...e)}function on(i,e,...t){if(!i)throw VM(e,...t)}function Tu(i){const e="INTERNAL ASSERTION FAILED: "+i;throw IA(e),new Error(e)}function Ou(i,e){i||Tu(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(){return typeof self<"u"&&self.location?.href||""}function wF(){return jR()==="http:"||jR()==="https:"}function jR(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wF()||r3()||"connection"in navigator)?navigator.onLine:!0}function IF(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ou(t>e,"Short delay should be less than long delay!"),this.isMobile=n3()||a3()}get(){return DF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(i,e){Ou(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],OF=new H_(3e4,6e4);function kM(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function mg(i,e,t,n,s={}){return qI(i,s,async()=>{let r={},o={};n&&(e==="GET"?o=n:r={body:JSON.stringify(n)});const c=z_({key:i.config.apiKey,...o}).slice(1),f=await i._getAdditionalHeaders();f["Content-Type"]="application/json",i.languageCode&&(f["X-Firebase-Locale"]=i.languageCode);const p={method:e,headers:f,...r};return s3()||(p.referrerPolicy="no-referrer"),i.emulatorConfig&&Hu(i.emulatorConfig.host)&&(p.credentials="include"),jI.fetch()(await XI(i,i.config.apiHost,t,c),p)})}async function qI(i,e,t){i._canInitEmulator=!1;const n={...BF,...e};try{const s=new UF(i),r=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw E0(i,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const c=r.ok?o.errorMessage:o.error.message,[f,p]=c.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw E0(i,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw E0(i,"email-already-in-use",o);if(f==="USER_DISABLED")throw E0(i,"user-disabled",o);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw zM(i,m,p);wc(i,m)}}catch(s){if(s instanceof Nc)throw s;wc(i,"network-request-failed",{message:String(s)})}}async function LF(i,e,t,n,s={}){const r=await mg(i,e,t,n,s);return"mfaPendingCredential"in r&&wc(i,"multi-factor-auth-required",{_serverResponse:r}),r}async function XI(i,e,t,n){const s=`${e}${t}?${n}`,r=i,o=r.config.emulator?HM(i.config,s):`${i.config.apiScheme}://${s}`;return NF.includes(t)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class UF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(bl(this.auth,"network-request-failed")),OF.get())})}}function E0(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=bl(i,e,n);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PF(i,e){return mg(i,"POST","/v1/accounts:delete",e)}async function JA(i,e){return mg(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function FF(i,e=!1){const t=xi(i),n=await t.getIdToken(e),s=GM(n);on(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r?.sign_in_provider;return{claims:s,token:n,authTime:e_(lb(s.auth_time)),issuedAtTime:e_(lb(s.iat)),expirationTime:e_(lb(s.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function lb(i){return Number(i)*1e3}function GM(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return IA("JWT malformed, contained fewer than 3 sections"),null;try{const s=BI(t);return s?JSON.parse(s):(IA("Failed to decode base64 JWT payload"),null)}catch(s){return IA("Caught error parsing JWT payload as JSON",s?.toString()),null}}function qR(i){const e=GM(i);return on(e,"internal-error"),on(typeof e.exp<"u","internal-error"),on(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y_(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Nc&&zF(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function zF({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=e_(this.lastLoginAt),this.creationTime=e_(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QA(i){const e=i.auth,t=await i.getIdToken(),n=await y_(i,JA(e,{idToken:t}));on(n?.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const r=s.providerUserInfo?.length?WI(s.providerUserInfo):[],o=kF(i.providerData,r),c=i.isAnonymous,f=!(i.email&&s.passwordHash)&&!o?.length,p=c?f:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new VT(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(i,m)}async function HF(i){const e=xi(i);await QA(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kF(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function WI(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GF(i,e){const t=await qI(i,{},async()=>{const n=z_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=i.config,o=await XI(i,s,"/v1/token",`key=${r}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:c,body:n};return i.emulatorConfig&&Hu(i.emulatorConfig.host)&&(f.credentials="include"),jI.fetch()(o,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function jF(i,e){return mg(i,"POST","/v2/accounts:revokeToken",kM(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){on(e.idToken,"internal-error"),on(typeof e.idToken<"u","internal-error"),on(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){on(e.length!==0,"internal-error");const t=qR(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(on(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:r}=await GF(e,t);this.updateTokensAndExpiration(n,s,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:r}=t,o=new Um;return n&&(on(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(on(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(on(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Um,this.toJSON())}_performRefresh(){return Tu("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(i,e){on(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Sl{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new VF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new VT(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await y_(this,this.stsTokenManager.getToken(this.auth,e));return on(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return FF(this,e)}reload(){return HF(this)}_assign(e){this!==e&&(on(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Sl({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){on(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await QA(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ro(this.auth.app))return Promise.reject(Fd(this.auth));const e=await this.getIdToken();return await y_(this,PF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,r=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:y,emailVerified:v,isAnonymous:x,providerData:b,stsTokenManager:R}=t;on(y&&R,e,"internal-error");const M=Um.fromJSON(this.name,R);on(typeof y=="string",e,"internal-error"),Nh(n,e.name),Nh(s,e.name),on(typeof v=="boolean",e,"internal-error"),on(typeof x=="boolean",e,"internal-error"),Nh(r,e.name),Nh(o,e.name),Nh(c,e.name),Nh(f,e.name),Nh(p,e.name),Nh(m,e.name);const T=new Sl({uid:y,auth:e,email:s,emailVerified:v,displayName:n,isAnonymous:x,photoURL:o,phoneNumber:r,tenantId:c,stsTokenManager:M,createdAt:p,lastLoginAt:m});return b&&Array.isArray(b)&&(T.providerData=b.map(D=>({...D}))),f&&(T._redirectEventId=f),T}static async _fromIdTokenResponse(e,t,n=!1){const s=new Um;s.updateFromServerResponse(t);const r=new Sl({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await QA(r),r}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];on(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?WI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!r?.length,c=new Um;c.updateFromIdToken(n);const f=new Sl({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new VT(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!r?.length};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=new Map;function Mu(i){Ou(i instanceof Function,"Expected a class definition");let e=XR.get(i);return e?(Ou(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,XR.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}YI.type="NONE";const WR=YI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(i,e,t){return`firebase:${i}:${e}:${t}`}class Pm{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:r}=this.auth;this.fullUserKey=BA(this.userKey,s.apiKey,r),this.fullPersistenceKey=BA("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await JA(this.auth,{idToken:e}).catch(()=>{});return t?Sl._fromGetAccountInfoResponse(this.auth,t,e):null}return Sl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Pm(Mu(WR),e,n);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let r=s[0]||Mu(WR);const o=BA(n,e.config.apiKey,e.name);let c=null;for(const p of t)try{const m=await p._get(o);if(m){let y;if(typeof m=="string"){const v=await JA(e,{idToken:m}).catch(()=>{});if(!v)break;y=await Sl._fromGetAccountInfoResponse(e,v,m)}else y=Sl._fromJSON(e,m);p!==r&&(c=y),r=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!r._shouldAllowMigration||!f.length?new Pm(r,e,n):(r=f[0],c&&await r._set(o,c.toJSON()),await Promise.all(t.map(async p=>{if(p!==r)try{await p._remove(o)}catch{}})),new Pm(r,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ZI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(KI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eB(e))return"Blackberry";if(tB(e))return"Webos";if(JI(e))return"Safari";if((e.includes("chrome/")||QI(e))&&!e.includes("edge/"))return"Chrome";if($I(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if(n?.length===2)return n[1]}return"Other"}function KI(i=Ur()){return/firefox\//i.test(i)}function JI(i=Ur()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QI(i=Ur()){return/crios\//i.test(i)}function ZI(i=Ur()){return/iemobile/i.test(i)}function $I(i=Ur()){return/android/i.test(i)}function eB(i=Ur()){return/blackberry/i.test(i)}function tB(i=Ur()){return/webos/i.test(i)}function jM(i=Ur()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function qF(i=Ur()){return jM(i)&&!!window.navigator?.standalone}function XF(){return o3()&&document.documentMode===10}function nB(i=Ur()){return jM(i)||$I(i)||tB(i)||eB(i)||/windows phone/i.test(i)||ZI(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iB(i,e=[]){let t;switch(i){case"Browser":t=YR(Ur());break;case"Worker":t=`${YR(Ur())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ip}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=r=>new Promise((o,c)=>{try{const f=e(r);o(f)}catch(f){c(f)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YF(i,e={}){return mg(i,"GET","/v2/passwordPolicy",kM(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=6;class JF{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??KF,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new KR(this),this.idTokenSubscription=new KR(this),this.beforeStateQueue=new WF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mu(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pm.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await JA(this,{idToken:e}),n=await Sl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ro(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!r||r===o)&&c?.user&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(r){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return on(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await QA(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ro(this.app))return Promise.reject(Fd(this));const t=e?xi(e):null;return t&&on(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&on(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ro(this.app)?Promise.reject(Fd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ro(this.app)?Promise.reject(Fd(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YF(this),t=new JF(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new F_("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await jF(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mu(e)||this._popupRedirectResolver;on(t,this,"argument-error"),this.redirectPersistenceManager=await Pm.create(this,[Mu(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(on(c,this,"internal-error"),c.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,s);return()=>{o=!0,f()}}else{const f=e.addObserver(t);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return on(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iB(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(ro(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&CF(`Error while retrieving App Check token: ${e.error}`),e?.token}}function hS(i){return xi(i)}class KR{constructor(e){this.auth=e,this.observer=null,this.addObserver=m3(t=>this.observer=t)}get next(){return on(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qM={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZF(i){qM=i}function $F(i){return qM.loadJS(i)}function e4(){return qM.gapiScript}function t4(i){return`__${i}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(i,e){const t=V_(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),r=t.getOptions();if(qd(r,e??{}))return s;wc(s,"already-initialized")}return t.initialize({options:e})}function i4(i,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Mu);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e?.popupRedirectResolver)}function s4(i,e,t){const n=hS(i);on(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,r=sB(e),{host:o,port:c}=r4(e),f=c===null?"":`:${c}`,p={url:`${r}//${o}${f}/`},m=Object.freeze({host:o,port:c,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){on(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),on(qd(p,n.config.emulator)&&qd(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=p,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Hu(o)?(lS(`${r}//${o}${f}`),cS("Auth",!0)):a4()}function sB(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function r4(i){const e=sB(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const r=s[1];return{host:r,port:JR(n.substr(r.length+1))}}else{const[r,o]=n.split(":");return{host:r,port:JR(o)}}}function JR(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function a4(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tu("not implemented")}_getIdTokenResponse(e){return Tu("not implemented")}_linkToIdToken(e,t){return Tu("not implemented")}_getReauthenticationResolver(e){return Tu("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fm(i,e){return LF(i,"POST","/v1/accounts:signInWithIdp",kM(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4="http://localhost";class Xd extends rB{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...r}=t;if(!n||!s)return null;const o=new Xd(n,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Fm(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Fm(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fm(e,t)}buildRequest(){const e={requestUri:o4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=z_(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_ extends XM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends k_{constructor(){super("facebook.com")}static credential(e){return Xd._fromParams({providerId:kh.PROVIDER_ID,signInMethod:kh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kh.credentialFromTaggedObject(e)}static credentialFromError(e){return kh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return kh.credential(e.oauthAccessToken)}catch{return null}}}kh.FACEBOOK_SIGN_IN_METHOD="facebook.com";kh.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu extends k_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xd._fromParams({providerId:xu.PROVIDER_ID,signInMethod:xu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xu.credentialFromTaggedObject(e)}static credentialFromError(e){return xu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return xu.credential(t,n)}catch{return null}}}xu.GOOGLE_SIGN_IN_METHOD="google.com";xu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh extends k_{constructor(){super("github.com")}static credential(e){return Xd._fromParams({providerId:Gh.PROVIDER_ID,signInMethod:Gh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gh.credentialFromTaggedObject(e)}static credentialFromError(e){return Gh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gh.credential(e.oauthAccessToken)}catch{return null}}}Gh.GITHUB_SIGN_IN_METHOD="github.com";Gh.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh extends k_{constructor(){super("twitter.com")}static credential(e,t){return Xd._fromParams({providerId:jh.PROVIDER_ID,signInMethod:jh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return jh.credentialFromTaggedObject(e)}static credentialFromError(e){return jh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return jh.credential(t,n)}catch{return null}}}jh.TWITTER_SIGN_IN_METHOD="twitter.com";jh.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const r=await Sl._fromIdTokenResponse(e,n,s),o=QR(n);return new jm({user:r,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=QR(n);return new jm({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function QR(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA extends Nc{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,ZA.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new ZA(e,t,n,s)}}function aB(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?ZA._fromErrorAndOperation(i,r,e,n):r})}async function l4(i,e,t=!1){const n=await y_(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return jm._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c4(i,e,t=!1){const{auth:n}=i;if(ro(n.app))return Promise.reject(Fd(n));const s="reauthenticate";try{const r=await y_(i,aB(n,s,e,i),t);on(r.idToken,n,"internal-error");const o=GM(r.idToken);on(o,n,"internal-error");const{sub:c}=o;return on(i.uid===c,n,"user-mismatch"),jm._forOperation(i,s,r)}catch(r){throw r?.code==="auth/user-not-found"&&wc(n,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u4(i,e,t=!1){if(ro(i.app))return Promise.reject(Fd(i));const n="signIn",s=await aB(i,n,e),r=await jm._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(r.user),r}function h4(i,e,t,n){return xi(i).onIdTokenChanged(e,t,n)}function f4(i,e,t){return xi(i).beforeAuthStateChanged(e,t)}function oB(i,e,t,n){return xi(i).onAuthStateChanged(e,t,n)}function d4(i){return xi(i).signOut()}const $A="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lB{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($A,"1"),this.storage.removeItem($A),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4=1e3,m4=10;class cB extends lB{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nB(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,f)=>{this.notifyListeners(o,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},r=this.storage.getItem(n);XF()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,m4):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},p4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}cB.type="LOCAL";const g4=cB;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uB extends lB{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}uB.type="SESSION";const hB=uB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y4(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new fS(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:r}=t.data,o=this.handlersMap[s];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async p=>p(t.origin,r)),f=await y4(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}fS.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((c,f)=>{const p=WM("",20);s.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(y){const v=y;if(v.data.eventId===p)switch(v.data.status){case"ack":clearTimeout(m),r=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),c(v.data.response);break;default:clearTimeout(m),clearTimeout(r),f(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(){return window}function v4(i){xc().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fB(){return typeof xc().WorkerGlobalScope<"u"&&typeof xc().importScripts=="function"}async function A4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function x4(){return navigator?.serviceWorker?.controller||null}function S4(){return fB()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB="firebaseLocalStorageDb",E4=1,ex="firebaseLocalStorage",pB="fbase_key";class G_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function dS(i,e){return i.transaction([ex],e?"readwrite":"readonly").objectStore(ex)}function b4(){const i=indexedDB.deleteDatabase(dB);return new G_(i).toPromise()}function HT(){const i=indexedDB.open(dB,E4);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(ex,{keyPath:pB})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(ex)?e(n):(n.close(),await b4(),e(await HT()))})})}async function ZR(i,e,t){const n=dS(i,!0).put({[pB]:e,value:t});return new G_(n).toPromise()}async function T4(i,e){const t=dS(i,!1).get(e),n=await new G_(t).toPromise();return n===void 0?null:n.value}function $R(i,e){const t=dS(i,!0).delete(e);return new G_(t).toPromise()}const M4=800,C4=3;class mB{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await HT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>C4)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fB()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fS._getInstance(S4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await A4(),!this.activeServiceWorker)return;this.sender=new _4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||x4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await HT();return await ZR(e,$A,"1"),await $R(e,$A),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ZR(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>T4(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$R(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=dS(s,!1).getAll();return new G_(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:r}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),M4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mB.type="LOCAL";const R4=mB;new H_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gB(i,e){return e?Mu(e):(on(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM extends rB{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function w4(i){return u4(i.auth,new YM(i),i.bypassAuthState)}function D4(i){const{auth:e,user:t}=i;return on(t,e,"internal-error"),c4(t,new YM(i),i.bypassAuthState)}async function I4(i){const{auth:e,user:t}=i;return on(t,e,"internal-error"),l4(t,new YM(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB{constructor(e,t,n,s,r=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:r,error:o,type:c}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w4;case"linkViaPopup":case"linkViaRedirect":return I4;case"reauthViaPopup":case"reauthViaRedirect":return D4;default:wc(this.auth,"internal-error")}}resolve(e){Ou(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ou(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=new H_(2e3,1e4);async function N4(i,e,t){if(ro(i.app))return Promise.reject(bl(i,"operation-not-supported-in-this-environment"));const n=hS(i);RF(i,e,XM);const s=gB(n,t);return new Dd(n,"signInViaPopup",e,s).executeNotNull()}class Dd extends yB{constructor(e,t,n,s,r){super(e,t,s,r),this.provider=n,this.authWindow=null,this.pollId=null,Dd.currentPopupAction&&Dd.currentPopupAction.cancel(),Dd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return on(e,this.auth,"internal-error"),e}async onExecution(){Ou(this.filter.length===1,"Popup operations only handle one event");const e=WM();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(bl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(bl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dd.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bl(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,B4.get())};e()}}Dd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4="pendingRedirect",NA=new Map;class L4 extends yB{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=NA.get(this.auth._key());if(!e){try{const n=await U4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}NA.set(this.auth._key(),e)}return this.bypassAuthState||NA.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function U4(i,e){const t=z4(e),n=F4(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function P4(i,e){NA.set(i._key(),e)}function F4(i){return Mu(i._redirectPersistence)}function z4(i){return BA(O4,i.config.apiKey,i.name)}async function V4(i,e,t=!1){if(ro(i.app))return Promise.reject(Fd(i));const n=hS(i),s=gB(n,e),o=await new L4(n,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4=600*1e3;class k4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!G4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!_B(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(bl(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=H4&&this.cachedEventUids.clear(),this.cachedEventUids.has(ew(e))}saveEventToCache(e){this.cachedEventUids.add(ew(e)),this.lastProcessedEventTime=Date.now()}}function ew(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function _B({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function G4(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _B(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(i,e={}){return mg(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,X4=/^https?/;async function W4(i){if(i.config.emulator)return;const{authorizedDomains:e}=await j4(i);for(const t of e)try{if(Y4(t))return}catch{}wc(i,"unauthorized-domain")}function Y4(i){const e=zT(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const o=new URL(i);return o.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!X4.test(t))return!1;if(q4.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K4=new H_(3e4,6e4);function tw(){const i=xc().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function J4(i){return new Promise((e,t)=>{function n(){tw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tw(),t(bl(i,"network-request-failed"))},timeout:K4.get()})}if(xc().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(xc().gapi?.load)n();else{const s=t4("iframefcb");return xc()[s]=()=>{gapi.load?n():t(bl(i,"network-request-failed"))},$F(`${e4()}?onload=${s}`).catch(r=>t(r))}}).catch(e=>{throw OA=null,e})}let OA=null;function Q4(i){return OA=OA||J4(i),OA}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4=new H_(5e3,15e3),$4="__/auth/iframe",ez="emulator/auth/iframe",tz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iz(i){const e=i.config;on(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?HM(e,ez):`https://${i.config.authDomain}/${$4}`,n={apiKey:e.apiKey,appName:i.name,v:ip},s=nz.get(i.config.apiHost);s&&(n.eid=s);const r=i._getFrameworks();return r.length&&(n.fw=r.join(",")),`${t}?${z_(n).slice(1)}`}async function sz(i){const e=await Q4(i),t=xc().gapi;return on(t,i,"internal-error"),e.open({where:document.body,url:iz(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tz,dontclear:!0},n=>new Promise(async(s,r)=>{await n.restyle({setHideOnLeave:!1});const o=bl(i,"network-request-failed"),c=xc().setTimeout(()=>{r(o)},Z4.get());function f(){xc().clearTimeout(c),s(n)}n.ping(f).then(f,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},az=500,oz=600,lz="_blank",cz="http://localhost";class nw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function uz(i,e,t,n=az,s=oz){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const f={...rz,width:n.toString(),height:s.toString(),top:r,left:o},p=Ur().toLowerCase();t&&(c=QI(p)?lz:t),KI(p)&&(e=e||cz,f.scrollbars="yes");const m=Object.entries(f).reduce((v,[x,b])=>`${v}${x}=${b},`,"");if(qF(p)&&c!=="_self")return hz(e||"",c),new nw(null);const y=window.open(e||"",c,m);on(y,i,"popup-blocked");try{y.focus()}catch{}return new nw(y)}function hz(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz="__/auth/handler",dz="emulator/auth/handler",pz=encodeURIComponent("fac");async function iw(i,e,t,n,s,r){on(i.config.authDomain,i,"auth-domain-config-required"),on(i.config.apiKey,i,"invalid-api-key");const o={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:ip,eventId:s};if(e instanceof XM){e.setDefaultLanguage(i.languageCode),o.providerId=e.providerId||"",p3(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))o[m]=y}if(e instanceof k_){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(o.scopes=m.join(","))}i.tenantId&&(o.tid=i.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const f=await i._getAppCheckToken(),p=f?`#${pz}=${encodeURIComponent(f)}`:"";return`${mz(i)}?${z_(c).slice(1)}${p}`}function mz({config:i}){return i.emulator?HM(i,dz):`https://${i.authDomain}/${fz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="webStorageSupport";class gz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hB,this._completeRedirectFn=V4,this._overrideRedirectResult=P4}async _openPopup(e,t,n,s){Ou(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const r=await iw(e,t,n,zT(),s);return uz(e,r,WM())}async _openRedirect(e,t,n,s){await this._originValidation(e);const r=await iw(e,t,n,zT(),s);return v4(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:r}=this.eventManagers[t];return s?Promise.resolve(s):(Ou(r,"If manager is not set, promise should be"),r)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await sz(e),n=new k4(e);return t.register("authEvent",s=>(on(s?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(cb,{type:cb},s=>{const r=s?.[0]?.[cb];r!==void 0&&t(!!r),wc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=W4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return nB()||JI()||jM()}}const yz=gz;var sw="@firebase/auth",rw="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){on(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Az(i){nf(new Bu("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;on(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iB(i)},p=new QF(n,s,r,f);return i4(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),nf(new Bu("auth-internal",e=>{const t=hS(e.getProvider("auth").getImmediate());return(n=>new _z(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vo(sw,rw,vz(i)),Vo(sw,rw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xz=300,Sz=LI("authIdTokenMaxAge")||xz;let aw=null;const Ez=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Sz)return;const s=t?.token;aw!==s&&(aw=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function bz(i=uS()){const e=V_(i,"auth");if(e.isInitialized())return e.getImmediate();const t=n4(i,{popupRedirectResolver:yz,persistence:[R4,g4,hB]}),n=LI("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(n,location.origin);if(location.origin===r.origin){const o=Ez(r.toString());f4(t,o,()=>o(t.currentUser)),h4(t,c=>o(c))}}const s=NI("auth");return s&&s4(t,`http://${s}`),t}function Tz(){return document.getElementsByTagName("head")?.[0]??document}ZF({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const r=bl("internal-error");r.customData=s,t(r)},n.type="text/javascript",n.charset="UTF-8",Tz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Az("Browser");var Mz="firebase",Cz="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vo(Mz,Cz,"app");var ow=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zh,vB;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(F,U){function I(){}I.prototype=U.prototype,F.D=U.prototype,F.prototype=new I,F.prototype.constructor=F,F.C=function(N,z,W){for(var k=Array(arguments.length-2),he=2;he<arguments.length;he++)k[he-2]=arguments[he];return U.prototype[z].apply(N,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(F,U,I){I||(I=0);var N=Array(16);if(typeof U=="string")for(var z=0;16>z;++z)N[z]=U.charCodeAt(I++)|U.charCodeAt(I++)<<8|U.charCodeAt(I++)<<16|U.charCodeAt(I++)<<24;else for(z=0;16>z;++z)N[z]=U[I++]|U[I++]<<8|U[I++]<<16|U[I++]<<24;U=F.g[0],I=F.g[1],z=F.g[2];var W=F.g[3],k=U+(W^I&(z^W))+N[0]+3614090360&4294967295;U=I+(k<<7&4294967295|k>>>25),k=W+(z^U&(I^z))+N[1]+3905402710&4294967295,W=U+(k<<12&4294967295|k>>>20),k=z+(I^W&(U^I))+N[2]+606105819&4294967295,z=W+(k<<17&4294967295|k>>>15),k=I+(U^z&(W^U))+N[3]+3250441966&4294967295,I=z+(k<<22&4294967295|k>>>10),k=U+(W^I&(z^W))+N[4]+4118548399&4294967295,U=I+(k<<7&4294967295|k>>>25),k=W+(z^U&(I^z))+N[5]+1200080426&4294967295,W=U+(k<<12&4294967295|k>>>20),k=z+(I^W&(U^I))+N[6]+2821735955&4294967295,z=W+(k<<17&4294967295|k>>>15),k=I+(U^z&(W^U))+N[7]+4249261313&4294967295,I=z+(k<<22&4294967295|k>>>10),k=U+(W^I&(z^W))+N[8]+1770035416&4294967295,U=I+(k<<7&4294967295|k>>>25),k=W+(z^U&(I^z))+N[9]+2336552879&4294967295,W=U+(k<<12&4294967295|k>>>20),k=z+(I^W&(U^I))+N[10]+4294925233&4294967295,z=W+(k<<17&4294967295|k>>>15),k=I+(U^z&(W^U))+N[11]+2304563134&4294967295,I=z+(k<<22&4294967295|k>>>10),k=U+(W^I&(z^W))+N[12]+1804603682&4294967295,U=I+(k<<7&4294967295|k>>>25),k=W+(z^U&(I^z))+N[13]+4254626195&4294967295,W=U+(k<<12&4294967295|k>>>20),k=z+(I^W&(U^I))+N[14]+2792965006&4294967295,z=W+(k<<17&4294967295|k>>>15),k=I+(U^z&(W^U))+N[15]+1236535329&4294967295,I=z+(k<<22&4294967295|k>>>10),k=U+(z^W&(I^z))+N[1]+4129170786&4294967295,U=I+(k<<5&4294967295|k>>>27),k=W+(I^z&(U^I))+N[6]+3225465664&4294967295,W=U+(k<<9&4294967295|k>>>23),k=z+(U^I&(W^U))+N[11]+643717713&4294967295,z=W+(k<<14&4294967295|k>>>18),k=I+(W^U&(z^W))+N[0]+3921069994&4294967295,I=z+(k<<20&4294967295|k>>>12),k=U+(z^W&(I^z))+N[5]+3593408605&4294967295,U=I+(k<<5&4294967295|k>>>27),k=W+(I^z&(U^I))+N[10]+38016083&4294967295,W=U+(k<<9&4294967295|k>>>23),k=z+(U^I&(W^U))+N[15]+3634488961&4294967295,z=W+(k<<14&4294967295|k>>>18),k=I+(W^U&(z^W))+N[4]+3889429448&4294967295,I=z+(k<<20&4294967295|k>>>12),k=U+(z^W&(I^z))+N[9]+568446438&4294967295,U=I+(k<<5&4294967295|k>>>27),k=W+(I^z&(U^I))+N[14]+3275163606&4294967295,W=U+(k<<9&4294967295|k>>>23),k=z+(U^I&(W^U))+N[3]+4107603335&4294967295,z=W+(k<<14&4294967295|k>>>18),k=I+(W^U&(z^W))+N[8]+1163531501&4294967295,I=z+(k<<20&4294967295|k>>>12),k=U+(z^W&(I^z))+N[13]+2850285829&4294967295,U=I+(k<<5&4294967295|k>>>27),k=W+(I^z&(U^I))+N[2]+4243563512&4294967295,W=U+(k<<9&4294967295|k>>>23),k=z+(U^I&(W^U))+N[7]+1735328473&4294967295,z=W+(k<<14&4294967295|k>>>18),k=I+(W^U&(z^W))+N[12]+2368359562&4294967295,I=z+(k<<20&4294967295|k>>>12),k=U+(I^z^W)+N[5]+4294588738&4294967295,U=I+(k<<4&4294967295|k>>>28),k=W+(U^I^z)+N[8]+2272392833&4294967295,W=U+(k<<11&4294967295|k>>>21),k=z+(W^U^I)+N[11]+1839030562&4294967295,z=W+(k<<16&4294967295|k>>>16),k=I+(z^W^U)+N[14]+4259657740&4294967295,I=z+(k<<23&4294967295|k>>>9),k=U+(I^z^W)+N[1]+2763975236&4294967295,U=I+(k<<4&4294967295|k>>>28),k=W+(U^I^z)+N[4]+1272893353&4294967295,W=U+(k<<11&4294967295|k>>>21),k=z+(W^U^I)+N[7]+4139469664&4294967295,z=W+(k<<16&4294967295|k>>>16),k=I+(z^W^U)+N[10]+3200236656&4294967295,I=z+(k<<23&4294967295|k>>>9),k=U+(I^z^W)+N[13]+681279174&4294967295,U=I+(k<<4&4294967295|k>>>28),k=W+(U^I^z)+N[0]+3936430074&4294967295,W=U+(k<<11&4294967295|k>>>21),k=z+(W^U^I)+N[3]+3572445317&4294967295,z=W+(k<<16&4294967295|k>>>16),k=I+(z^W^U)+N[6]+76029189&4294967295,I=z+(k<<23&4294967295|k>>>9),k=U+(I^z^W)+N[9]+3654602809&4294967295,U=I+(k<<4&4294967295|k>>>28),k=W+(U^I^z)+N[12]+3873151461&4294967295,W=U+(k<<11&4294967295|k>>>21),k=z+(W^U^I)+N[15]+530742520&4294967295,z=W+(k<<16&4294967295|k>>>16),k=I+(z^W^U)+N[2]+3299628645&4294967295,I=z+(k<<23&4294967295|k>>>9),k=U+(z^(I|~W))+N[0]+4096336452&4294967295,U=I+(k<<6&4294967295|k>>>26),k=W+(I^(U|~z))+N[7]+1126891415&4294967295,W=U+(k<<10&4294967295|k>>>22),k=z+(U^(W|~I))+N[14]+2878612391&4294967295,z=W+(k<<15&4294967295|k>>>17),k=I+(W^(z|~U))+N[5]+4237533241&4294967295,I=z+(k<<21&4294967295|k>>>11),k=U+(z^(I|~W))+N[12]+1700485571&4294967295,U=I+(k<<6&4294967295|k>>>26),k=W+(I^(U|~z))+N[3]+2399980690&4294967295,W=U+(k<<10&4294967295|k>>>22),k=z+(U^(W|~I))+N[10]+4293915773&4294967295,z=W+(k<<15&4294967295|k>>>17),k=I+(W^(z|~U))+N[1]+2240044497&4294967295,I=z+(k<<21&4294967295|k>>>11),k=U+(z^(I|~W))+N[8]+1873313359&4294967295,U=I+(k<<6&4294967295|k>>>26),k=W+(I^(U|~z))+N[15]+4264355552&4294967295,W=U+(k<<10&4294967295|k>>>22),k=z+(U^(W|~I))+N[6]+2734768916&4294967295,z=W+(k<<15&4294967295|k>>>17),k=I+(W^(z|~U))+N[13]+1309151649&4294967295,I=z+(k<<21&4294967295|k>>>11),k=U+(z^(I|~W))+N[4]+4149444226&4294967295,U=I+(k<<6&4294967295|k>>>26),k=W+(I^(U|~z))+N[11]+3174756917&4294967295,W=U+(k<<10&4294967295|k>>>22),k=z+(U^(W|~I))+N[2]+718787259&4294967295,z=W+(k<<15&4294967295|k>>>17),k=I+(W^(z|~U))+N[9]+3951481745&4294967295,F.g[0]=F.g[0]+U&4294967295,F.g[1]=F.g[1]+(z+(k<<21&4294967295|k>>>11))&4294967295,F.g[2]=F.g[2]+z&4294967295,F.g[3]=F.g[3]+W&4294967295}n.prototype.u=function(F,U){U===void 0&&(U=F.length);for(var I=U-this.blockSize,N=this.B,z=this.h,W=0;W<U;){if(z==0)for(;W<=I;)s(this,F,W),W+=this.blockSize;if(typeof F=="string"){for(;W<U;)if(N[z++]=F.charCodeAt(W++),z==this.blockSize){s(this,N),z=0;break}}else for(;W<U;)if(N[z++]=F[W++],z==this.blockSize){s(this,N),z=0;break}}this.h=z,this.o+=U},n.prototype.v=function(){var F=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);F[0]=128;for(var U=1;U<F.length-8;++U)F[U]=0;var I=8*this.o;for(U=F.length-8;U<F.length;++U)F[U]=I&255,I/=256;for(this.u(F),F=Array(16),U=I=0;4>U;++U)for(var N=0;32>N;N+=8)F[I++]=this.g[U]>>>N&255;return F};function r(F,U){var I=c;return Object.prototype.hasOwnProperty.call(I,F)?I[F]:I[F]=U(F)}function o(F,U){this.h=U;for(var I=[],N=!0,z=F.length-1;0<=z;z--){var W=F[z]|0;N&&W==U||(I[z]=W,N=!1)}this.g=I}var c={};function f(F){return-128<=F&&128>F?r(F,function(U){return new o([U|0],0>U?-1:0)}):new o([F|0],0>F?-1:0)}function p(F){if(isNaN(F)||!isFinite(F))return y;if(0>F)return M(p(-F));for(var U=[],I=1,N=0;F>=I;N++)U[N]=F/I|0,I*=4294967296;return new o(U,0)}function m(F,U){if(F.length==0)throw Error("number format error: empty string");if(U=U||10,2>U||36<U)throw Error("radix out of range: "+U);if(F.charAt(0)=="-")return M(m(F.substring(1),U));if(0<=F.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=p(Math.pow(U,8)),N=y,z=0;z<F.length;z+=8){var W=Math.min(8,F.length-z),k=parseInt(F.substring(z,z+W),U);8>W?(W=p(Math.pow(U,W)),N=N.j(W).add(p(k))):(N=N.j(I),N=N.add(p(k)))}return N}var y=f(0),v=f(1),x=f(16777216);i=o.prototype,i.m=function(){if(R(this))return-M(this).m();for(var F=0,U=1,I=0;I<this.g.length;I++){var N=this.i(I);F+=(0<=N?N:4294967296+N)*U,U*=4294967296}return F},i.toString=function(F){if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(b(this))return"0";if(R(this))return"-"+M(this).toString(F);for(var U=p(Math.pow(F,6)),I=this,N="";;){var z=L(I,U).g;I=T(I,z.j(U));var W=((0<I.g.length?I.g[0]:I.h)>>>0).toString(F);if(I=z,b(I))return W+N;for(;6>W.length;)W="0"+W;N=W+N}},i.i=function(F){return 0>F?0:F<this.g.length?this.g[F]:this.h};function b(F){if(F.h!=0)return!1;for(var U=0;U<F.g.length;U++)if(F.g[U]!=0)return!1;return!0}function R(F){return F.h==-1}i.l=function(F){return F=T(this,F),R(F)?-1:b(F)?0:1};function M(F){for(var U=F.g.length,I=[],N=0;N<U;N++)I[N]=~F.g[N];return new o(I,~F.h).add(v)}i.abs=function(){return R(this)?M(this):this},i.add=function(F){for(var U=Math.max(this.g.length,F.g.length),I=[],N=0,z=0;z<=U;z++){var W=N+(this.i(z)&65535)+(F.i(z)&65535),k=(W>>>16)+(this.i(z)>>>16)+(F.i(z)>>>16);N=k>>>16,W&=65535,k&=65535,I[z]=k<<16|W}return new o(I,I[I.length-1]&-2147483648?-1:0)};function T(F,U){return F.add(M(U))}i.j=function(F){if(b(this)||b(F))return y;if(R(this))return R(F)?M(this).j(M(F)):M(M(this).j(F));if(R(F))return M(this.j(M(F)));if(0>this.l(x)&&0>F.l(x))return p(this.m()*F.m());for(var U=this.g.length+F.g.length,I=[],N=0;N<2*U;N++)I[N]=0;for(N=0;N<this.g.length;N++)for(var z=0;z<F.g.length;z++){var W=this.i(N)>>>16,k=this.i(N)&65535,he=F.i(z)>>>16,me=F.i(z)&65535;I[2*N+2*z]+=k*me,D(I,2*N+2*z),I[2*N+2*z+1]+=W*me,D(I,2*N+2*z+1),I[2*N+2*z+1]+=k*he,D(I,2*N+2*z+1),I[2*N+2*z+2]+=W*he,D(I,2*N+2*z+2)}for(N=0;N<U;N++)I[N]=I[2*N+1]<<16|I[2*N];for(N=U;N<2*U;N++)I[N]=0;return new o(I,0)};function D(F,U){for(;(F[U]&65535)!=F[U];)F[U+1]+=F[U]>>>16,F[U]&=65535,U++}function B(F,U){this.g=F,this.h=U}function L(F,U){if(b(U))throw Error("division by zero");if(b(F))return new B(y,y);if(R(F))return U=L(M(F),U),new B(M(U.g),M(U.h));if(R(U))return U=L(F,M(U)),new B(M(U.g),U.h);if(30<F.g.length){if(R(F)||R(U))throw Error("slowDivide_ only works with positive integers.");for(var I=v,N=U;0>=N.l(F);)I=G(I),N=G(N);var z=H(I,1),W=H(N,1);for(N=H(N,2),I=H(I,2);!b(N);){var k=W.add(N);0>=k.l(F)&&(z=z.add(I),W=k),N=H(N,1),I=H(I,1)}return U=T(F,z.j(U)),new B(z,U)}for(z=y;0<=F.l(U);){for(I=Math.max(1,Math.floor(F.m()/U.m())),N=Math.ceil(Math.log(I)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),W=p(I),k=W.j(U);R(k)||0<k.l(F);)I-=N,W=p(I),k=W.j(U);b(W)&&(W=v),z=z.add(W),F=T(F,k)}return new B(z,F)}i.A=function(F){return L(this,F).h},i.and=function(F){for(var U=Math.max(this.g.length,F.g.length),I=[],N=0;N<U;N++)I[N]=this.i(N)&F.i(N);return new o(I,this.h&F.h)},i.or=function(F){for(var U=Math.max(this.g.length,F.g.length),I=[],N=0;N<U;N++)I[N]=this.i(N)|F.i(N);return new o(I,this.h|F.h)},i.xor=function(F){for(var U=Math.max(this.g.length,F.g.length),I=[],N=0;N<U;N++)I[N]=this.i(N)^F.i(N);return new o(I,this.h^F.h)};function G(F){for(var U=F.g.length+1,I=[],N=0;N<U;N++)I[N]=F.i(N)<<1|F.i(N-1)>>>31;return new o(I,F.h)}function H(F,U){var I=U>>5;U%=32;for(var N=F.g.length-I,z=[],W=0;W<N;W++)z[W]=0<U?F.i(W+I)>>>U|F.i(W+I+1)<<32-U:F.i(W+I);return new o(z,F.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,vB=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=p,o.fromString=m,Zh=o}).apply(typeof ow<"u"?ow:typeof self<"u"?self:typeof window<"u"?window:{});var b0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var AB,Xy,xB,LA,kT,SB,EB,bB;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(A,O,V){return A==Array.prototype||A==Object.prototype||(A[O]=V.value),A};function t(A){A=[typeof globalThis=="object"&&globalThis,A,typeof window=="object"&&window,typeof self=="object"&&self,typeof b0=="object"&&b0];for(var O=0;O<A.length;++O){var V=A[O];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var n=t(this);function s(A,O){if(O)e:{var V=n;A=A.split(".");for(var Z=0;Z<A.length-1;Z++){var ve=A[Z];if(!(ve in V))break e;V=V[ve]}A=A[A.length-1],Z=V[A],O=O(Z),O!=Z&&O!=null&&e(V,A,{configurable:!0,writable:!0,value:O})}}function r(A,O){A instanceof String&&(A+="");var V=0,Z=!1,ve={next:function(){if(!Z&&V<A.length){var Pe=V++;return{value:O(Pe,A[Pe]),done:!1}}return Z=!0,{done:!0,value:void 0}}};return ve[Symbol.iterator]=function(){return ve},ve}s("Array.prototype.values",function(A){return A||function(){return r(this,function(O,V){return V})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function f(A){var O=typeof A;return O=O!="object"?O:A?Array.isArray(A)?"array":O:"null",O=="array"||O=="object"&&typeof A.length=="number"}function p(A){var O=typeof A;return O=="object"&&A!=null||O=="function"}function m(A,O,V){return A.call.apply(A.bind,arguments)}function y(A,O,V){if(!A)throw Error();if(2<arguments.length){var Z=Array.prototype.slice.call(arguments,2);return function(){var ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ve,Z),A.apply(O,ve)}}return function(){return A.apply(O,arguments)}}function v(A,O,V){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:y,v.apply(null,arguments)}function x(A,O){var V=Array.prototype.slice.call(arguments,1);return function(){var Z=V.slice();return Z.push.apply(Z,arguments),A.apply(this,Z)}}function b(A,O){function V(){}V.prototype=O.prototype,A.aa=O.prototype,A.prototype=new V,A.prototype.constructor=A,A.Qb=function(Z,ve,Pe){for(var gt=Array(arguments.length-2),Dn=2;Dn<arguments.length;Dn++)gt[Dn-2]=arguments[Dn];return O.prototype[ve].apply(Z,gt)}}function R(A){const O=A.length;if(0<O){const V=Array(O);for(let Z=0;Z<O;Z++)V[Z]=A[Z];return V}return[]}function M(A,O){for(let V=1;V<arguments.length;V++){const Z=arguments[V];if(f(Z)){const ve=A.length||0,Pe=Z.length||0;A.length=ve+Pe;for(let gt=0;gt<Pe;gt++)A[ve+gt]=Z[gt]}else A.push(Z)}}class T{constructor(O,V){this.i=O,this.j=V,this.h=0,this.g=null}get(){let O;return 0<this.h?(this.h--,O=this.g,this.g=O.next,O.next=null):O=this.i(),O}}function D(A){return/^[\s\xa0]*$/.test(A)}function B(){var A=c.navigator;return A&&(A=A.userAgent)?A:""}function L(A){return L[" "](A),A}L[" "]=function(){};var G=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function H(A,O,V){for(const Z in A)O.call(V,A[Z],Z,A)}function F(A,O){for(const V in A)O.call(void 0,A[V],V,A)}function U(A){const O={};for(const V in A)O[V]=A[V];return O}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(A,O){let V,Z;for(let ve=1;ve<arguments.length;ve++){Z=arguments[ve];for(V in Z)A[V]=Z[V];for(let Pe=0;Pe<I.length;Pe++)V=I[Pe],Object.prototype.hasOwnProperty.call(Z,V)&&(A[V]=Z[V])}}function z(A){var O=1;A=A.split(":");const V=[];for(;0<O&&A.length;)V.push(A.shift()),O--;return A.length&&V.push(A.join(":")),V}function W(A){c.setTimeout(()=>{throw A},0)}function k(){var A=ye;let O=null;return A.g&&(O=A.g,A.g=A.g.next,A.g||(A.h=null),O.next=null),O}class he{constructor(){this.h=this.g=null}add(O,V){const Z=me.get();Z.set(O,V),this.h?this.h.next=Z:this.g=Z,this.h=Z}}var me=new T(()=>new q,A=>A.reset());class q{constructor(){this.next=this.g=this.h=null}set(O,V){this.h=O,this.g=V,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,ne=!1,ye=new he,K=()=>{const A=c.Promise.resolve(void 0);ee=()=>{A.then(ce)}};var ce=()=>{for(var A;A=k();){try{A.h.call(A.g)}catch(V){W(V)}var O=me;O.j(A),100>O.h&&(O.h++,A.next=O.g,O.g=A)}ne=!1};function Ee(){this.s=this.s,this.C=this.C}Ee.prototype.s=!1,Ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Me(A,O){this.type=A,this.g=this.target=O,this.defaultPrevented=!1}Me.prototype.h=function(){this.defaultPrevented=!0};var Ve=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var A=!1,O=Object.defineProperty({},"passive",{get:function(){A=!0}});try{const V=()=>{};c.addEventListener("test",V,O),c.removeEventListener("test",V,O)}catch{}return A}();function ge(A,O){if(Me.call(this,A?A.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,A){var V=this.type=A.type,Z=A.changedTouches&&A.changedTouches.length?A.changedTouches[0]:null;if(this.target=A.target||A.srcElement,this.g=O,O=A.relatedTarget){if(G){e:{try{L(O.nodeName);var ve=!0;break e}catch{}ve=!1}ve||(O=null)}}else V=="mouseover"?O=A.fromElement:V=="mouseout"&&(O=A.toElement);this.relatedTarget=O,Z?(this.clientX=Z.clientX!==void 0?Z.clientX:Z.pageX,this.clientY=Z.clientY!==void 0?Z.clientY:Z.pageY,this.screenX=Z.screenX||0,this.screenY=Z.screenY||0):(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0),this.button=A.button,this.key=A.key||"",this.ctrlKey=A.ctrlKey,this.altKey=A.altKey,this.shiftKey=A.shiftKey,this.metaKey=A.metaKey,this.pointerId=A.pointerId||0,this.pointerType=typeof A.pointerType=="string"?A.pointerType:ze[A.pointerType]||"",this.state=A.state,this.i=A,A.defaultPrevented&&ge.aa.h.call(this)}}b(ge,Me);var ze={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var A=this.i;A.preventDefault?A.preventDefault():A.returnValue=!1};var Je="closure_listenable_"+(1e6*Math.random()|0),lt=0;function At(A,O,V,Z,ve){this.listener=A,this.proxy=null,this.src=O,this.type=V,this.capture=!!Z,this.ha=ve,this.key=++lt,this.da=this.fa=!1}function Et(A){A.da=!0,A.listener=null,A.proxy=null,A.src=null,A.ha=null}function Nt(A){this.src=A,this.g={},this.h=0}Nt.prototype.add=function(A,O,V,Z,ve){var Pe=A.toString();A=this.g[Pe],A||(A=this.g[Pe]=[],this.h++);var gt=se(A,O,Z,ve);return-1<gt?(O=A[gt],V||(O.fa=!1)):(O=new At(O,this.src,Pe,!!Z,ve),O.fa=V,A.push(O)),O};function It(A,O){var V=O.type;if(V in A.g){var Z=A.g[V],ve=Array.prototype.indexOf.call(Z,O,void 0),Pe;(Pe=0<=ve)&&Array.prototype.splice.call(Z,ve,1),Pe&&(Et(O),A.g[V].length==0&&(delete A.g[V],A.h--))}}function se(A,O,V,Z){for(var ve=0;ve<A.length;++ve){var Pe=A[ve];if(!Pe.da&&Pe.listener==O&&Pe.capture==!!V&&Pe.ha==Z)return ve}return-1}var Ge="closure_lm_"+(1e6*Math.random()|0),He={};function tt(A,O,V,Z,ve){if(Array.isArray(O)){for(var Pe=0;Pe<O.length;Pe++)tt(A,O[Pe],V,Z,ve);return null}return V=xe(V),A&&A[Je]?A.K(O,V,p(Z)?!!Z.capture:!1,ve):Fe(A,O,V,!1,Z,ve)}function Fe(A,O,V,Z,ve,Pe){if(!O)throw Error("Invalid event type");var gt=p(ve)?!!ve.capture:!!ve,Dn=te(A);if(Dn||(A[Ge]=Dn=new Nt(A)),V=Dn.add(O,V,Z,gt,Pe),V.proxy)return V;if(Z=ut(),V.proxy=Z,Z.src=A,Z.listener=V,A.addEventListener)Ve||(ve=gt),ve===void 0&&(ve=!1),A.addEventListener(O.toString(),Z,ve);else if(A.attachEvent)A.attachEvent(Ft(O.toString()),Z);else if(A.addListener&&A.removeListener)A.addListener(Z);else throw Error("addEventListener and attachEvent are unavailable.");return V}function ut(){function A(V){return O.call(A.src,A.listener,V)}const O=Gt;return A}function Qe(A,O,V,Z,ve){if(Array.isArray(O))for(var Pe=0;Pe<O.length;Pe++)Qe(A,O[Pe],V,Z,ve);else Z=p(Z)?!!Z.capture:!!Z,V=xe(V),A&&A[Je]?(A=A.i,O=String(O).toString(),O in A.g&&(Pe=A.g[O],V=se(Pe,V,Z,ve),-1<V&&(Et(Pe[V]),Array.prototype.splice.call(Pe,V,1),Pe.length==0&&(delete A.g[O],A.h--)))):A&&(A=te(A))&&(O=A.g[O.toString()],A=-1,O&&(A=se(O,V,Z,ve)),(V=-1<A?O[A]:null)&&st(V))}function st(A){if(typeof A!="number"&&A&&!A.da){var O=A.src;if(O&&O[Je])It(O.i,A);else{var V=A.type,Z=A.proxy;O.removeEventListener?O.removeEventListener(V,Z,A.capture):O.detachEvent?O.detachEvent(Ft(V),Z):O.addListener&&O.removeListener&&O.removeListener(Z),(V=te(O))?(It(V,A),V.h==0&&(V.src=null,O[Ge]=null)):Et(A)}}}function Ft(A){return A in He?He[A]:He[A]="on"+A}function Gt(A,O){if(A.da)A=!0;else{O=new ge(O,this);var V=A.listener,Z=A.ha||A.src;A.fa&&st(A),A=V.call(Z,O)}return A}function te(A){return A=A[Ge],A instanceof Nt?A:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function xe(A){return typeof A=="function"?A:(A[X]||(A[X]=function(O){return A.handleEvent(O)}),A[X])}function Re(){Ee.call(this),this.i=new Nt(this),this.M=this,this.F=null}b(Re,Ee),Re.prototype[Je]=!0,Re.prototype.removeEventListener=function(A,O,V,Z){Qe(this,A,O,V,Z)};function Ue(A,O){var V,Z=A.F;if(Z)for(V=[];Z;Z=Z.F)V.push(Z);if(A=A.M,Z=O.type||O,typeof O=="string")O=new Me(O,A);else if(O instanceof Me)O.target=O.target||A;else{var ve=O;O=new Me(Z,A),N(O,ve)}if(ve=!0,V)for(var Pe=V.length-1;0<=Pe;Pe--){var gt=O.g=V[Pe];ve=Le(gt,Z,!0,O)&&ve}if(gt=O.g=A,ve=Le(gt,Z,!0,O)&&ve,ve=Le(gt,Z,!1,O)&&ve,V)for(Pe=0;Pe<V.length;Pe++)gt=O.g=V[Pe],ve=Le(gt,Z,!1,O)&&ve}Re.prototype.N=function(){if(Re.aa.N.call(this),this.i){var A=this.i,O;for(O in A.g){for(var V=A.g[O],Z=0;Z<V.length;Z++)Et(V[Z]);delete A.g[O],A.h--}}this.F=null},Re.prototype.K=function(A,O,V,Z){return this.i.add(String(A),O,!1,V,Z)},Re.prototype.L=function(A,O,V,Z){return this.i.add(String(A),O,!0,V,Z)};function Le(A,O,V,Z){if(O=A.i.g[String(O)],!O)return!0;O=O.concat();for(var ve=!0,Pe=0;Pe<O.length;++Pe){var gt=O[Pe];if(gt&&!gt.da&&gt.capture==V){var Dn=gt.listener,Di=gt.ha||gt.src;gt.fa&&It(A.i,gt),ve=Dn.call(Di,Z)!==!1&&ve}}return ve&&!Z.defaultPrevented}function _t(A,O,V){if(typeof A=="function")V&&(A=v(A,V));else if(A&&typeof A.handleEvent=="function")A=v(A.handleEvent,A);else throw Error("Invalid listener argument");return 2147483647<Number(O)?-1:c.setTimeout(A,O||0)}function ht(A){A.g=_t(()=>{A.g=null,A.i&&(A.i=!1,ht(A))},A.l);const O=A.h;A.h=null,A.m.apply(null,O)}class wt extends Ee{constructor(O,V){super(),this.m=O,this.l=V,this.h=null,this.i=!1,this.g=null}j(O){this.h=arguments,this.g?this.i=!0:ht(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(A){Ee.call(this),this.h=A,this.g={}}b(Mt,Ee);var et=[];function ft(A){H(A.g,function(O,V){this.g.hasOwnProperty(V)&&st(O)},A),A.g={}}Mt.prototype.N=function(){Mt.aa.N.call(this),ft(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dt=c.JSON.stringify,re=c.JSON.parse,Te=class{stringify(A){return c.JSON.stringify(A,void 0)}parse(A){return c.JSON.parse(A,void 0)}};function rt(){}rt.prototype.h=null;function oe(A){return A.h||(A.h=A.i())}function Ke(){}var nt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function yt(){Me.call(this,"d")}b(yt,Me);function it(){Me.call(this,"c")}b(it,Me);var ke={},vt=null;function Ot(){return vt=vt||new Re}ke.La="serverreachability";function cn(A){Me.call(this,ke.La,A)}b(cn,Me);function Zt(A){const O=Ot();Ue(O,new cn(O))}ke.STAT_EVENT="statevent";function Gi(A,O){Me.call(this,ke.STAT_EVENT,A),this.stat=O}b(Gi,Me);function _n(A){const O=Ot();Ue(O,new Gi(O,A))}ke.Ma="timingevent";function Ci(A,O){Me.call(this,ke.Ma,A),this.size=O}b(Ci,Me);function $n(A,O){if(typeof A!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){A()},O)}function As(){this.g=!0}As.prototype.xa=function(){this.g=!1};function er(A,O,V,Z,ve,Pe){A.info(function(){if(A.g)if(Pe)for(var gt="",Dn=Pe.split("&"),Di=0;Di<Dn.length;Di++){var In=Dn[Di].split("=");if(1<In.length){var qi=In[0];In=In[1];var ss=qi.split("_");gt=2<=ss.length&&ss[1]=="type"?gt+(qi+"="+In+"&"):gt+(qi+"=redacted&")}}else gt=null;else gt=Pe;return"XMLHTTP REQ ("+Z+") [attempt "+ve+"]: "+O+`
`+V+`
`+gt})}function Lc(A,O,V,Z,ve,Pe,gt){A.info(function(){return"XMLHTTP RESP ("+Z+") [ attempt "+ve+"]: "+O+`
`+V+`
`+Pe+" "+gt})}function ns(A,O,V,Z){A.info(function(){return"XMLHTTP TEXT ("+O+"): "+nr(A,V)+(Z?" "+Z:"")})}function tr(A,O){A.info(function(){return"TIMEOUT: "+O})}As.prototype.info=function(){};function nr(A,O){if(!A.g)return O;if(!O)return null;try{var V=JSON.parse(O);if(V){for(A=0;A<V.length;A++)if(Array.isArray(V[A])){var Z=V[A];if(!(2>Z.length)){var ve=Z[1];if(Array.isArray(ve)&&!(1>ve.length)){var Pe=ve[0];if(Pe!="noop"&&Pe!="stop"&&Pe!="close")for(var gt=1;gt<ve.length;gt++)ve[gt]=""}}}}return Dt(V)}catch{return O}}var Kn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yr;function zr(){}b(zr,rt),zr.prototype.g=function(){return new XMLHttpRequest},zr.prototype.i=function(){return{}},yr=new zr;function xs(A,O,V,Z){this.j=A,this.i=O,this.l=V,this.R=Z||1,this.U=new Mt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ri}function Ri(){this.i=null,this.g="",this.h=!1}var qo={},po={};function J(A,O,V){A.L=1,A.v=ha(Mn(O)),A.m=V,A.P=!0,de(A,null)}function de(A,O){A.F=Date.now(),_e(A),A.A=Mn(A.v);var V=A.A,Z=A.R;Array.isArray(Z)||(Z=[String(Z)]),Gu(V.i,"t",Z),A.C=0,V=A.j.J,A.h=new Ri,A.g=ga(A.j,V?O:null,!A.m),0<A.O&&(A.M=new wt(v(A.Y,A,A.g),A.O)),O=A.U,V=A.g,Z=A.ca;var ve="readystatechange";Array.isArray(ve)||(ve&&(et[0]=ve.toString()),ve=et);for(var Pe=0;Pe<ve.length;Pe++){var gt=tt(V,ve[Pe],Z||O.handleEvent,!1,O.h||O);if(!gt)break;O.g[gt.key]=gt}O=A.H?U(A.H):{},A.m?(A.u||(A.u="POST"),O["Content-Type"]="application/x-www-form-urlencoded",A.g.ea(A.A,A.u,A.m,O)):(A.u="GET",A.g.ea(A.A,A.u,null,O)),Zt(),er(A.i,A.u,A.A,A.l,A.R,A.m)}xs.prototype.ca=function(A){A=A.target;const O=this.M;O&&Hr(A)==3?O.j():this.Y(A)},xs.prototype.Y=function(A){try{if(A==this.g)e:{const ss=Hr(this.g);var O=this.g.Ba();const Xi=this.g.Z();if(!(3>ss)&&(ss!=3||this.g&&(this.h.h||this.g.oa()||bf(this.g)))){this.J||ss!=4||O==7||(O==8||0>=Xi?Zt(3):Zt(2)),dt(this);var V=this.g.Z();this.X=V;t:if(be(this)){var Z=bf(this.g);A="";var ve=Z.length,Pe=Hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),xt(this);var gt="";break t}this.h.i=new c.TextDecoder}for(O=0;O<ve;O++)this.h.h=!0,A+=this.h.i.decode(Z[O],{stream:!(Pe&&O==ve-1)});Z.length=0,this.h.g+=A,this.C=0,gt=this.h.g}else gt=this.g.oa();if(this.o=V==200,Lc(this.i,this.u,this.A,this.l,this.R,ss,V),this.o){if(this.T&&!this.K){t:{if(this.g){var Dn,Di=this.g;if((Dn=Di.g?Di.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(Dn)){var In=Dn;break t}}In=null}if(V=In)ns(this.i,this.l,V,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zt(this,V);else{this.o=!1,this.s=3,_n(12),mt(this),xt(this);break e}}if(this.P){V=!0;let Ss;for(;!this.J&&this.C<gt.length;)if(Ss=Be(this,gt),Ss==po){ss==4&&(this.s=4,_n(14),V=!1),ns(this.i,this.l,null,"[Incomplete Response]");break}else if(Ss==qo){this.s=4,_n(15),ns(this.i,this.l,gt,"[Invalid Chunk]"),V=!1;break}else ns(this.i,this.l,Ss,null),zt(this,Ss);if(be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ss!=4||gt.length!=0||this.h.h||(this.s=1,_n(16),V=!1),this.o=this.o&&V,!V)ns(this.i,this.l,gt,"[Invalid Chunked Response]"),mt(this),xt(this);else if(0<gt.length&&!this.W){this.W=!0;var qi=this.j;qi.g==this&&qi.ba&&!qi.M&&(qi.j.info("Great, no buffering proxy detected. Bytes received: "+gt.length),Ko(qi),qi.M=!0,_n(11))}}else ns(this.i,this.l,gt,null),zt(this,gt);ss==4&&mt(this),this.o&&!this.J&&(ss==4?Xu(this.j,this):(this.o=!1,_e(this)))}else wg(this.g),V==400&&0<gt.indexOf("Unknown SID")?(this.s=3,_n(12)):(this.s=0,_n(13)),mt(this),xt(this)}}}catch{}finally{}};function be(A){return A.g?A.u=="GET"&&A.L!=2&&A.j.Ca:!1}function Be(A,O){var V=A.C,Z=O.indexOf(`
`,V);return Z==-1?po:(V=Number(O.substring(V,Z)),isNaN(V)?qo:(Z+=1,Z+V>O.length?po:(O=O.slice(Z,Z+V),A.C=Z+V,O)))}xs.prototype.cancel=function(){this.J=!0,mt(this)};function _e(A){A.S=Date.now()+A.I,at(A,A.I)}function at(A,O){if(A.B!=null)throw Error("WatchDog timer not null");A.B=$n(v(A.ba,A),O)}function dt(A){A.B&&(c.clearTimeout(A.B),A.B=null)}xs.prototype.ba=function(){this.B=null;const A=Date.now();0<=A-this.S?(tr(this.i,this.A),this.L!=2&&(Zt(),_n(17)),mt(this),this.s=2,xt(this)):at(this,this.S-A)};function xt(A){A.j.G==0||A.J||Xu(A.j,A)}function mt(A){dt(A);var O=A.M;O&&typeof O.ma=="function"&&O.ma(),A.M=null,ft(A.U),A.g&&(O=A.g,A.g=null,O.abort(),O.ma())}function zt(A,O){try{var V=A.j;if(V.G!=0&&(V.g==A||si(V.h,A))){if(!A.K&&si(V.h,A)&&V.G==3){try{var Z=V.Da.g.parse(O)}catch{Z=null}if(Array.isArray(Z)&&Z.length==3){var ve=Z;if(ve[0]==0){e:if(!V.u){if(V.g)if(V.g.F+3e3<A.F)zl(V),zc(V);else break e;Gc(V),_n(18)}}else V.za=ve[1],0<V.za-V.T&&37500>ve[2]&&V.F&&V.v==0&&!V.C&&(V.C=$n(v(V.Za,V),6e3));if(1>=wn(V.h)&&V.ca){try{V.ca()}catch{}V.ca=void 0}}else yo(V,11)}else if((A.K||V.g==A)&&zl(V),!D(O))for(ve=V.Da.g.parse(O),O=0;O<ve.length;O++){let In=ve[O];if(V.T=In[0],In=In[1],V.G==2)if(In[0]=="c"){V.K=In[1],V.ia=In[2];const qi=In[3];qi!=null&&(V.la=qi,V.j.info("VER="+V.la));const ss=In[4];ss!=null&&(V.Aa=ss,V.j.info("SVER="+V.Aa));const Xi=In[5];Xi!=null&&typeof Xi=="number"&&0<Xi&&(Z=1.5*Xi,V.L=Z,V.j.info("backChannelRequestTimeoutMs_="+Z)),Z=V;const Ss=A.g;if(Ss){const va=Ss.g?Ss.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(va){var Pe=Z.h;Pe.g||va.indexOf("spdy")==-1&&va.indexOf("quic")==-1&&va.indexOf("h2")==-1||(Pe.j=Pe.l,Pe.g=new Set,Pe.h&&(Vn(Pe,Pe.h),Pe.h=null))}if(Z.D){const Ju=Ss.g?Ss.g.getResponseHeader("X-HTTP-Session-Id"):null;Ju&&(Z.ya=Ju,un(Z.I,Z.D,Ju))}}V.G=3,V.l&&V.l.ua(),V.ba&&(V.R=Date.now()-A.F,V.j.info("Handshake RTT: "+V.R+"ms")),Z=V;var gt=A;if(Z.qa=wf(Z,Z.J?Z.ia:null,Z.W),gt.K){an(Z.h,gt);var Dn=gt,Di=Z.L;Di&&(Dn.I=Di),Dn.B&&(dt(Dn),_e(Dn)),Z.g=gt}else Cf(Z);0<V.i.length&&Vc(V)}else In[0]!="stop"&&In[0]!="close"||yo(V,7);else V.G==3&&(In[0]=="stop"||In[0]=="close"?In[0]=="stop"?yo(V,7):qu(V):In[0]!="noop"&&V.l&&V.l.ta(In),V.v=0)}}Zt(4)}catch{}}var jt=class{constructor(A,O){this.g=A,this.map=O}};function Lt(A){this.l=A||10,c.PerformanceNavigationTiming?(A=c.performance.getEntriesByType("navigation"),A=0<A.length&&(A[0].nextHopProtocol=="hq"||A[0].nextHopProtocol=="h2")):A=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=A?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ln(A){return A.h?!0:A.g?A.g.size>=A.j:!1}function wn(A){return A.h?1:A.g?A.g.size:0}function si(A,O){return A.h?A.h==O:A.g?A.g.has(O):!1}function Vn(A,O){A.g?A.g.add(O):A.h=O}function an(A,O){A.h&&A.h==O?A.h=null:A.g&&A.g.has(O)&&A.g.delete(O)}Lt.prototype.cancel=function(){if(this.i=Vt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const A of this.g.values())A.cancel();this.g.clear()}};function Vt(A){if(A.h!=null)return A.i.concat(A.h.D);if(A.g!=null&&A.g.size!==0){let O=A.i;for(const V of A.g.values())O=O.concat(V.D);return O}return R(A.i)}function li(A){if(A.V&&typeof A.V=="function")return A.V();if(typeof Map<"u"&&A instanceof Map||typeof Set<"u"&&A instanceof Set)return Array.from(A.values());if(typeof A=="string")return A.split("");if(f(A)){for(var O=[],V=A.length,Z=0;Z<V;Z++)O.push(A[Z]);return O}O=[],V=0;for(Z in A)O[V++]=A[Z];return O}function xn(A){if(A.na&&typeof A.na=="function")return A.na();if(!A.V||typeof A.V!="function"){if(typeof Map<"u"&&A instanceof Map)return Array.from(A.keys());if(!(typeof Set<"u"&&A instanceof Set)){if(f(A)||typeof A=="string"){var O=[];A=A.length;for(var V=0;V<A;V++)O.push(V);return O}O=[],V=0;for(const Z in A)O[V++]=Z;return O}}}function is(A,O){if(A.forEach&&typeof A.forEach=="function")A.forEach(O,void 0);else if(f(A)||typeof A=="string")Array.prototype.forEach.call(A,O,void 0);else for(var V=xn(A),Z=li(A),ve=Z.length,Pe=0;Pe<ve;Pe++)O.call(void 0,Z[Pe],V&&V[Pe],A)}var ir=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function us(A,O){if(A){A=A.split("&");for(var V=0;V<A.length;V++){var Z=A[V].indexOf("="),ve=null;if(0<=Z){var Pe=A[V].substring(0,Z);ve=A[V].substring(Z+1)}else Pe=A[V];O(Pe,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function ci(A){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,A instanceof ci){this.h=A.h,ji(this,A.j),this.o=A.o,this.g=A.g,Li(this,A.s),this.l=A.l;var O=A.i,V=new mo;V.i=O.i,O.g&&(V.g=new Map(O.g),V.h=O.h),mi(this,V),this.m=A.m}else A&&(O=String(A).match(ir))?(this.h=!1,ji(this,O[1]||"",!0),this.o=Si(O[2]||""),this.g=Si(O[3]||"",!0),Li(this,O[4]),this.l=Si(O[5]||"",!0),mi(this,O[6]||"",!0),this.m=Si(O[7]||"")):(this.h=!1,this.i=new mo(null,this.h))}ci.prototype.toString=function(){var A=[],O=this.j;O&&A.push(Dl(O,Il,!0),":");var V=this.g;return(V||O=="file")&&(A.push("//"),(O=this.o)&&A.push(Dl(O,Il,!0),"@"),A.push(encodeURIComponent(String(V)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),V=this.s,V!=null&&A.push(":",String(V))),(V=this.l)&&(this.g&&V.charAt(0)!="/"&&A.push("/"),A.push(Dl(V,V.charAt(0)=="/"?xf:ku,!0))),(V=this.i.toString())&&A.push("?",V),(V=this.m)&&A.push("#",Dl(V,Pc)),A.join("")};function Mn(A){return new ci(A)}function ji(A,O,V){A.j=V?Si(O,!0):O,A.j&&(A.j=A.j.replace(/:$/,""))}function Li(A,O){if(O){if(O=Number(O),isNaN(O)||0>O)throw Error("Bad port number "+O);A.s=O}else A.s=null}function mi(A,O,V){O instanceof mo?(A.i=O,Sf(A.i,A.h)):(V||(O=Dl(O,hp)),A.i=new mo(O,A.h))}function un(A,O,V){A.i.set(O,V)}function ha(A){return un(A,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),A}function Si(A,O){return A?O?decodeURI(A.replace(/%25/g,"%2525")):decodeURIComponent(A):""}function Dl(A,O,V){return typeof A=="string"?(A=encodeURI(A).replace(O,Uc),V&&(A=A.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A):null}function Uc(A){return A=A.charCodeAt(0),"%"+(A>>4&15).toString(16)+(A&15).toString(16)}var Il=/[#\/\?@]/g,ku=/[#\?:]/g,xf=/[#\?]/g,hp=/[#\?@]/g,Pc=/#/g;function mo(A,O){this.h=this.g=null,this.i=A||null,this.j=!!O}function Vr(A){A.g||(A.g=new Map,A.h=0,A.i&&us(A.i,function(O,V){A.add(decodeURIComponent(O.replace(/\+/g," ")),V)}))}i=mo.prototype,i.add=function(A,O){Vr(this),this.i=null,A=fa(this,A);var V=this.g.get(A);return V||this.g.set(A,V=[]),V.push(O),this.h+=1,this};function Ha(A,O){Vr(A),O=fa(A,O),A.g.has(O)&&(A.i=null,A.h-=A.g.get(O).length,A.g.delete(O))}function go(A,O){return Vr(A),O=fa(A,O),A.g.has(O)}i.forEach=function(A,O){Vr(this),this.g.forEach(function(V,Z){V.forEach(function(ve){A.call(O,ve,Z,this)},this)},this)},i.na=function(){Vr(this);const A=Array.from(this.g.values()),O=Array.from(this.g.keys()),V=[];for(let Z=0;Z<O.length;Z++){const ve=A[Z];for(let Pe=0;Pe<ve.length;Pe++)V.push(O[Z])}return V},i.V=function(A){Vr(this);let O=[];if(typeof A=="string")go(this,A)&&(O=O.concat(this.g.get(fa(this,A))));else{A=Array.from(this.g.values());for(let V=0;V<A.length;V++)O=O.concat(A[V])}return O},i.set=function(A,O){return Vr(this),this.i=null,A=fa(this,A),go(this,A)&&(this.h-=this.g.get(A).length),this.g.set(A,[O]),this.h+=1,this},i.get=function(A,O){return A?(A=this.V(A),0<A.length?String(A[0]):O):O};function Gu(A,O,V){Ha(A,O),0<V.length&&(A.i=null,A.g.set(fa(A,O),R(V)),A.h+=V.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const A=[],O=Array.from(this.g.keys());for(var V=0;V<O.length;V++){var Z=O[V];const Pe=encodeURIComponent(String(Z)),gt=this.V(Z);for(Z=0;Z<gt.length;Z++){var ve=Pe;gt[Z]!==""&&(ve+="="+encodeURIComponent(String(gt[Z]))),A.push(ve)}}return this.i=A.join("&")};function fa(A,O){return O=String(O),A.j&&(O=O.toLowerCase()),O}function Sf(A,O){O&&!A.j&&(Vr(A),A.i=null,A.g.forEach(function(V,Z){var ve=Z.toLowerCase();Z!=ve&&(Ha(this,Z),Gu(this,ve,V))},A)),A.j=O}function Bl(A,O){const V=new As;if(c.Image){const Z=new Image;Z.onload=x(_r,V,"TestLoadImage: loaded",!0,O,Z),Z.onerror=x(_r,V,"TestLoadImage: error",!1,O,Z),Z.onabort=x(_r,V,"TestLoadImage: abort",!1,O,Z),Z.ontimeout=x(_r,V,"TestLoadImage: timeout",!1,O,Z),c.setTimeout(function(){Z.ontimeout&&Z.ontimeout()},1e4),Z.src=A}else O(!1)}function da(A,O){const V=new As,Z=new AbortController,ve=setTimeout(()=>{Z.abort(),_r(V,"TestPingServer: timeout",!1,O)},1e4);fetch(A,{signal:Z.signal}).then(Pe=>{clearTimeout(ve),Pe.ok?_r(V,"TestPingServer: ok",!0,O):_r(V,"TestPingServer: server error",!1,O)}).catch(()=>{clearTimeout(ve),_r(V,"TestPingServer: error",!1,O)})}function _r(A,O,V,Z,ve){try{ve&&(ve.onload=null,ve.onerror=null,ve.onabort=null,ve.ontimeout=null),Z(V)}catch{}}function Nl(){this.g=new Te}function ka(A,O,V){const Z=V||"";try{is(A,function(ve,Pe){let gt=ve;p(ve)&&(gt=Dt(ve)),O.push(Z+Pe+"="+encodeURIComponent(gt))})}catch(ve){throw O.push(Z+"type="+encodeURIComponent("_badmap")),ve}}function Ol(A){this.l=A.Ub||null,this.j=A.eb||!1}b(Ol,rt),Ol.prototype.g=function(){return new Xo(this.l,this.j)},Ol.prototype.i=function(A){return function(){return A}}({});function Xo(A,O){Re.call(this),this.D=A,this.o=O,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Xo,Re),i=Xo.prototype,i.open=function(A,O){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=A,this.A=O,this.readyState=1,pa(this)},i.send=function(A){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const O={headers:this.u,method:this.B,credentials:this.m,cache:void 0};A&&(O.body=A),(this.D||c).fetch(new Request(this.A,O)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vr(this)),this.readyState=0},i.Sa=function(A){if(this.g&&(this.l=A,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=A.headers,this.readyState=2,pa(this)),this.g&&(this.readyState=3,pa(this),this.g)))if(this.responseType==="arraybuffer")A.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in A){if(this.j=A.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ju(this)}else A.text().then(this.Ra.bind(this),this.ga.bind(this))};function ju(A){A.j.read().then(A.Pa.bind(A)).catch(A.ga.bind(A))}i.Pa=function(A){if(this.g){if(this.o&&A.value)this.response.push(A.value);else if(!this.o){var O=A.value?A.value:new Uint8Array(0);(O=this.v.decode(O,{stream:!A.done}))&&(this.response=this.responseText+=O)}A.done?vr(this):pa(this),this.readyState==3&&ju(this)}},i.Ra=function(A){this.g&&(this.response=this.responseText=A,vr(this))},i.Qa=function(A){this.g&&(this.response=A,vr(this))},i.ga=function(){this.g&&vr(this)};function vr(A){A.readyState=4,A.l=null,A.j=null,A.v=null,pa(A)}i.setRequestHeader=function(A,O){this.u.append(A,O)},i.getResponseHeader=function(A){return this.h&&this.h.get(A.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const A=[],O=this.h.entries();for(var V=O.next();!V.done;)V=V.value,A.push(V[0]+": "+V[1]),V=O.next();return A.join(`\r
`)};function pa(A){A.onreadystatechange&&A.onreadystatechange.call(A)}Object.defineProperty(Xo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(A){this.m=A?"include":"same-origin"}});function Ll(A){let O="";return H(A,function(V,Z){O+=Z,O+=":",O+=V,O+=`\r
`}),O}function hs(A,O,V){e:{for(Z in V){var Z=!1;break e}Z=!0}Z||(V=Ll(V),typeof A=="string"?V!=null&&encodeURIComponent(String(V)):un(A,O,V))}function Jn(A){Re.call(this),this.headers=new Map,this.o=A||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Jn,Re);var Ul=/^https?$/i,Pl=["POST","PUT"];i=Jn.prototype,i.Ha=function(A){this.J=A},i.ea=function(A,O,V,Z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+A);O=O?O.toUpperCase():"GET",this.D=A,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yr.g(),this.v=this.o?oe(this.o):oe(yr),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(O,String(A),!0),this.B=!1}catch(Pe){Ef(this,Pe);return}if(A=V||"",V=new Map(this.headers),Z)if(Object.getPrototypeOf(Z)===Object.prototype)for(var ve in Z)V.set(ve,Z[ve]);else if(typeof Z.keys=="function"&&typeof Z.get=="function")for(const Pe of Z.keys())V.set(Pe,Z.get(Pe));else throw Error("Unknown input type for opt_headers: "+String(Z));Z=Array.from(V.keys()).find(Pe=>Pe.toLowerCase()=="content-type"),ve=c.FormData&&A instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Pl,O,void 0))||Z||ve||V.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Pe,gt]of V)this.g.setRequestHeader(Pe,gt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Yo(this),this.u=!0,this.g.send(A),this.u=!1}catch(Pe){Ef(this,Pe)}};function Ef(A,O){A.h=!1,A.g&&(A.j=!0,A.g.abort(),A.j=!1),A.l=O,A.m=5,ma(A),Ga(A)}function ma(A){A.A||(A.A=!0,Ue(A,"complete"),Ue(A,"error"))}i.abort=function(A){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=A||7,Ue(this,"complete"),Ue(this,"abort"),Ga(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ga(this,!0)),Jn.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?Wo(this):this.bb())},i.bb=function(){Wo(this)};function Wo(A){if(A.h&&typeof o<"u"&&(!A.v[1]||Hr(A)!=4||A.Z()!=2)){if(A.u&&Hr(A)==4)_t(A.Ea,0,A);else if(Ue(A,"readystatechange"),Hr(A)==4){A.h=!1;try{const gt=A.Z();e:switch(gt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var O=!0;break e;default:O=!1}var V;if(!(V=O)){var Z;if(Z=gt===0){var ve=String(A.D).match(ir)[1]||null;!ve&&c.self&&c.self.location&&(ve=c.self.location.protocol.slice(0,-1)),Z=!Ul.test(ve?ve.toLowerCase():"")}V=Z}if(V)Ue(A,"complete"),Ue(A,"success");else{A.m=6;try{var Pe=2<Hr(A)?A.g.statusText:""}catch{Pe=""}A.l=Pe+" ["+A.Z()+"]",ma(A)}}finally{Ga(A)}}}}function Ga(A,O){if(A.g){Yo(A);const V=A.g,Z=A.v[0]?()=>{}:null;A.g=null,A.v=null,O||Ue(A,"ready");try{V.onreadystatechange=Z}catch{}}}function Yo(A){A.I&&(c.clearTimeout(A.I),A.I=null)}i.isActive=function(){return!!this.g};function Hr(A){return A.g?A.g.readyState:0}i.Z=function(){try{return 2<Hr(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(A){if(this.g){var O=this.g.responseText;return A&&O.indexOf(A)==0&&(O=O.substring(A.length)),re(O)}};function bf(A){try{if(!A.g)return null;if("response"in A.g)return A.g.response;switch(A.H){case"":case"text":return A.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in A.g)return A.g.mozResponseArrayBuffer}return null}catch{return null}}function wg(A){const O={};A=(A.g&&2<=Hr(A)&&A.g.getAllResponseHeaders()||"").split(`\r
`);for(let Z=0;Z<A.length;Z++){if(D(A[Z]))continue;var V=z(A[Z]);const ve=V[0];if(V=V[1],typeof V!="string")continue;V=V.trim();const Pe=O[ve]||[];O[ve]=Pe,Pe.push(V)}F(O,function(Z){return Z.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wi(A,O,V){return V&&V.internalChannelParams&&V.internalChannelParams[A]||O}function Fc(A){this.Aa=0,this.i=[],this.j=new As,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wi("failFast",!1,A),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wi("baseRetryDelayMs",5e3,A),this.cb=wi("retryDelaySeedMs",1e4,A),this.Wa=wi("forwardChannelMaxRetries",2,A),this.wa=wi("forwardChannelRequestTimeoutMs",2e4,A),this.pa=A&&A.xmlHttpFactory||void 0,this.Xa=A&&A.Tb||void 0,this.Ca=A&&A.useFetchStreams||!1,this.L=void 0,this.J=A&&A.supportsCrossDomainXhr||!1,this.K="",this.h=new Lt(A&&A.concurrentRequestLimit),this.Da=new Nl,this.P=A&&A.fastHandshake||!1,this.O=A&&A.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=A&&A.Rb||!1,A&&A.xa&&this.j.xa(),A&&A.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&A&&A.detectBufferingProxy||!1,this.ja=void 0,A&&A.longPollingTimeout&&0<A.longPollingTimeout&&(this.ja=A.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=Fc.prototype,i.la=8,i.G=1,i.connect=function(A,O,V,Z){_n(0),this.W=A,this.H=O||{},V&&Z!==void 0&&(this.H.OSID=V,this.H.OAID=Z),this.F=this.X,this.I=wf(this,null,this.W),Vc(this)};function qu(A){if(Tf(A),A.G==3){var O=A.U++,V=Mn(A.I);if(un(V,"SID",A.K),un(V,"RID",O),un(V,"TYPE","terminate"),Fl(A,V),O=new xs(A,A.j,O),O.L=2,O.v=ha(Mn(V)),V=!1,c.navigator&&c.navigator.sendBeacon)try{V=c.navigator.sendBeacon(O.v.toString(),"")}catch{}!V&&c.Image&&(new Image().src=O.v,V=!0),V||(O.g=ga(O.j,null),O.g.ea(O.v)),O.F=Date.now(),_e(O)}Wu(A)}function zc(A){A.g&&(Ko(A),A.g.cancel(),A.g=null)}function Tf(A){zc(A),A.u&&(c.clearTimeout(A.u),A.u=null),zl(A),A.h.cancel(),A.s&&(typeof A.s=="number"&&c.clearTimeout(A.s),A.s=null)}function Vc(A){if(!ln(A.h)&&!A.s){A.s=!0;var O=A.Ga;ee||K(),ne||(ee(),ne=!0),ye.add(O,A),A.B=0}}function Hc(A,O){return wn(A.h)>=A.h.j-(A.s?1:0)?!1:A.s?(A.i=O.D.concat(A.i),!0):A.G==1||A.G==2||A.B>=(A.Va?0:A.Wa)?!1:(A.s=$n(v(A.Ga,A,O),jc(A,A.B)),A.B++,!0)}i.Ga=function(A){if(this.s)if(this.s=null,this.G==1){if(!A){this.U=Math.floor(1e5*Math.random()),A=this.U++;const ve=new xs(this,this.j,A);let Pe=this.o;if(this.S&&(Pe?(Pe=U(Pe),N(Pe,this.S)):Pe=this.S),this.m!==null||this.O||(ve.H=Pe,Pe=null),this.P)e:{for(var O=0,V=0;V<this.i.length;V++){t:{var Z=this.i[V];if("__data__"in Z.map&&(Z=Z.map.__data__,typeof Z=="string")){Z=Z.length;break t}Z=void 0}if(Z===void 0)break;if(O+=Z,4096<O){O=V;break e}if(O===4096||V===this.i.length-1){O=V+1;break e}}O=1e3}else O=1e3;O=Mf(this,ve,O),V=Mn(this.I),un(V,"RID",A),un(V,"CVER",22),this.D&&un(V,"X-HTTP-Session-Id",this.D),Fl(this,V),Pe&&(this.O?O="headers="+encodeURIComponent(String(Ll(Pe)))+"&"+O:this.m&&hs(V,this.m,Pe)),Vn(this.h,ve),this.Ua&&un(V,"TYPE","init"),this.P?(un(V,"$req",O),un(V,"SID","null"),ve.T=!0,J(ve,V,null)):J(ve,V,O),this.G=2}}else this.G==3&&(A?kc(this,A):this.i.length==0||ln(this.h)||kc(this))};function kc(A,O){var V;O?V=O.l:V=A.U++;const Z=Mn(A.I);un(Z,"SID",A.K),un(Z,"RID",V),un(Z,"AID",A.T),Fl(A,Z),A.m&&A.o&&hs(Z,A.m,A.o),V=new xs(A,A.j,V,A.B+1),A.m===null&&(V.H=A.o),O&&(A.i=O.D.concat(A.i)),O=Mf(A,V,1e3),V.I=Math.round(.5*A.wa)+Math.round(.5*A.wa*Math.random()),Vn(A.h,V),J(V,Z,O)}function Fl(A,O){A.H&&H(A.H,function(V,Z){un(O,Z,V)}),A.l&&is({},function(V,Z){un(O,Z,V)})}function Mf(A,O,V){V=Math.min(A.i.length,V);var Z=A.l?v(A.l.Na,A.l,A):null;e:{var ve=A.i;let Pe=-1;for(;;){const gt=["count="+V];Pe==-1?0<V?(Pe=ve[0].g,gt.push("ofs="+Pe)):Pe=0:gt.push("ofs="+Pe);let Dn=!0;for(let Di=0;Di<V;Di++){let In=ve[Di].g;const qi=ve[Di].map;if(In-=Pe,0>In)Pe=Math.max(0,ve[Di].g-100),Dn=!1;else try{ka(qi,gt,"req"+In+"_")}catch{Z&&Z(qi)}}if(Dn){Z=gt.join("&");break e}}}return A=A.i.splice(0,V),O.D=A,Z}function Cf(A){if(!A.g&&!A.u){A.Y=1;var O=A.Fa;ee||K(),ne||(ee(),ne=!0),ye.add(O,A),A.v=0}}function Gc(A){return A.g||A.u||3<=A.v?!1:(A.Y++,A.u=$n(v(A.Fa,A),jc(A,A.v)),A.v++,!0)}i.Fa=function(){if(this.u=null,Rf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var A=2*this.R;this.j.info("BP detection timer enabled: "+A),this.A=$n(v(this.ab,this),A)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_n(10),zc(this),Rf(this))};function Ko(A){A.A!=null&&(c.clearTimeout(A.A),A.A=null)}function Rf(A){A.g=new xs(A,A.j,"rpc",A.Y),A.m===null&&(A.g.H=A.o),A.g.O=0;var O=Mn(A.qa);un(O,"RID","rpc"),un(O,"SID",A.K),un(O,"AID",A.T),un(O,"CI",A.F?"0":"1"),!A.F&&A.ja&&un(O,"TO",A.ja),un(O,"TYPE","xmlhttp"),Fl(A,O),A.m&&A.o&&hs(O,A.m,A.o),A.L&&(A.g.I=A.L);var V=A.g;A=A.ia,V.L=1,V.v=ha(Mn(O)),V.m=null,V.P=!0,de(V,A)}i.Za=function(){this.C!=null&&(this.C=null,zc(this),Gc(this),_n(19))};function zl(A){A.C!=null&&(c.clearTimeout(A.C),A.C=null)}function Xu(A,O){var V=null;if(A.g==O){zl(A),Ko(A),A.g=null;var Z=2}else if(si(A.h,O))V=O.D,an(A.h,O),Z=1;else return;if(A.G!=0){if(O.o)if(Z==1){V=O.m?O.m.length:0,O=Date.now()-O.F;var ve=A.B;Z=Ot(),Ue(Z,new Ci(Z,V)),Vc(A)}else Cf(A);else if(ve=O.s,ve==3||ve==0&&0<O.X||!(Z==1&&Hc(A,O)||Z==2&&Gc(A)))switch(V&&0<V.length&&(O=A.h,O.i=O.i.concat(V)),ve){case 1:yo(A,5);break;case 4:yo(A,10);break;case 3:yo(A,6);break;default:yo(A,2)}}}function jc(A,O){let V=A.Ta+Math.floor(Math.random()*A.cb);return A.isActive()||(V*=2),V*O}function yo(A,O){if(A.j.info("Error code "+O),O==2){var V=v(A.fb,A),Z=A.Xa;const ve=!Z;Z=new ci(Z||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ji(Z,"https"),ha(Z),ve?Bl(Z.toString(),V):da(Z.toString(),V)}else _n(2);A.G=0,A.l&&A.l.sa(O),Wu(A),Tf(A)}i.fb=function(A){A?(this.j.info("Successfully pinged google.com"),_n(2)):(this.j.info("Failed to ping google.com"),_n(1))};function Wu(A){if(A.G=0,A.ka=[],A.l){const O=Vt(A.h);(O.length!=0||A.i.length!=0)&&(M(A.ka,O),M(A.ka,A.i),A.h.i.length=0,R(A.i),A.i.length=0),A.l.ra()}}function wf(A,O,V){var Z=V instanceof ci?Mn(V):new ci(V);if(Z.g!="")O&&(Z.g=O+"."+Z.g),Li(Z,Z.s);else{var ve=c.location;Z=ve.protocol,O=O?O+"."+ve.hostname:ve.hostname,ve=+ve.port;var Pe=new ci(null);Z&&ji(Pe,Z),O&&(Pe.g=O),ve&&Li(Pe,ve),V&&(Pe.l=V),Z=Pe}return V=A.D,O=A.ya,V&&O&&un(Z,V,O),un(Z,"VER",A.la),Fl(A,Z),Z}function ga(A,O,V){if(O&&!A.J)throw Error("Can't create secondary domain capable XhrIo object.");return O=A.Ca&&!A.pa?new Jn(new Ol({eb:V})):new Jn(A.pa),O.Ha(A.J),O}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yu(){}i=Yu.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Ku(){}Ku.prototype.g=function(A,O){return new Gs(A,O)};function Gs(A,O){Re.call(this),this.g=new Fc(O),this.l=A,this.h=O&&O.messageUrlParams||null,A=O&&O.messageHeaders||null,O&&O.clientProtocolHeaderRequired&&(A?A["X-Client-Protocol"]="webchannel":A={"X-Client-Protocol":"webchannel"}),this.g.o=A,A=O&&O.initMessageHeaders||null,O&&O.messageContentType&&(A?A["X-WebChannel-Content-Type"]=O.messageContentType:A={"X-WebChannel-Content-Type":O.messageContentType}),O&&O.va&&(A?A["X-WebChannel-Client-Profile"]=O.va:A={"X-WebChannel-Client-Profile":O.va}),this.g.S=A,(A=O&&O.Sb)&&!D(A)&&(this.g.m=A),this.v=O&&O.supportsCrossDomainXhr||!1,this.u=O&&O.sendRawJson||!1,(O=O&&O.httpSessionIdParam)&&!D(O)&&(this.g.D=O,A=this.h,A!==null&&O in A&&(A=this.h,O in A&&delete A[O])),this.j=new _a(this)}b(Gs,Re),Gs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gs.prototype.close=function(){qu(this.g)},Gs.prototype.o=function(A){var O=this.g;if(typeof A=="string"){var V={};V.__data__=A,A=V}else this.u&&(V={},V.__data__=Dt(A),A=V);O.i.push(new jt(O.Ya++,A)),O.G==3&&Vc(O)},Gs.prototype.N=function(){this.g.l=null,delete this.j,qu(this.g),delete this.g,Gs.aa.N.call(this)};function ja(A){yt.call(this),A.__headers__&&(this.headers=A.__headers__,this.statusCode=A.__status__,delete A.__headers__,delete A.__status__);var O=A.__sm__;if(O){e:{for(const V in O){A=V;break e}A=void 0}(this.i=A)&&(A=this.i,O=O!==null&&A in O?O[A]:void 0),this.data=O}else this.data=A}b(ja,yt);function ya(){it.call(this),this.status=1}b(ya,it);function _a(A){this.g=A}b(_a,Yu),_a.prototype.ua=function(){Ue(this.g,"a")},_a.prototype.ta=function(A){Ue(this.g,new ja(A))},_a.prototype.sa=function(A){Ue(this.g,new ya)},_a.prototype.ra=function(){Ue(this.g,"b")},Ku.prototype.createWebChannel=Ku.prototype.g,Gs.prototype.send=Gs.prototype.o,Gs.prototype.open=Gs.prototype.m,Gs.prototype.close=Gs.prototype.close,bB=function(){return new Ku},EB=function(){return Ot()},SB=ke,kT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kn.NO_ERROR=0,Kn.TIMEOUT=8,Kn.HTTP_ERROR=6,LA=Kn,gr.COMPLETE="complete",xB=gr,Ke.EventType=nt,nt.OPEN="a",nt.CLOSE="b",nt.ERROR="c",nt.MESSAGE="d",Re.prototype.listen=Re.prototype.K,Xy=Ke,Jn.prototype.listenOnce=Jn.prototype.L,Jn.prototype.getLastError=Jn.prototype.Ka,Jn.prototype.getLastErrorCode=Jn.prototype.Ba,Jn.prototype.getStatus=Jn.prototype.Z,Jn.prototype.getResponseJson=Jn.prototype.Oa,Jn.prototype.getResponseText=Jn.prototype.oa,Jn.prototype.send=Jn.prototype.ea,Jn.prototype.setWithCredentials=Jn.prototype.Ha,AB=Jn}).apply(typeof b0<"u"?b0:typeof self<"u"?self:typeof window<"u"?window:{});const lw="@firebase/firestore",cw="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Br.UNAUTHENTICATED=new Br(null),Br.GOOGLE_CREDENTIALS=new Br("google-credentials-uid"),Br.FIRST_PARTY=new Br("first-party-uid"),Br.MOCK_USER=new Br("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gg="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=new PM("@firebase/firestore");function Dm(){return Wd.logLevel}function Bt(i,...e){if(Wd.logLevel<=Pn.DEBUG){const t=e.map(KM);Wd.debug(`Firestore (${gg}): ${i}`,...t)}}function Lu(i,...e){if(Wd.logLevel<=Pn.ERROR){const t=e.map(KM);Wd.error(`Firestore (${gg}): ${i}`,...t)}}function qm(i,...e){if(Wd.logLevel<=Pn.WARN){const t=e.map(KM);Wd.warn(`Firestore (${gg}): ${i}`,...t)}}function KM(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,TB(i,n,t)}function TB(i,e,t){let n=`FIRESTORE (${gg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Lu(n),new Error(n)}function oi(i,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,i||TB(e,s,n)}function gn(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Rt extends Nc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MB{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rz{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Br.UNAUTHENTICATED))}shutdown(){}}class wz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Dz{constructor(e){this.t=e,this.currentUser=Br.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){oi(this.o===void 0,42304);let n=this.i;const s=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let r=new Ru;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ru,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const f=r;e.enqueueRetryable(async()=>{await f.promise,await s(this.currentUser)})},c=f=>{Bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(f=>c(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?c(f):(Bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ru)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(oi(typeof n.accessToken=="string",31837,{l:n}),new MB(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oi(e===null||typeof e=="string",2055,{h:e}),new Br(e)}}class Iz{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Br.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Bz{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Iz(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Br.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class uw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Nz{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ro(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){oi(this.o===void 0,3512);const n=r=>{r.error!=null&&Bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,Bt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>n(r))};const s=r=>{Bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):Bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new uw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(oi(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new uw(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=Oz(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<t&&(n+=e.charAt(s[r]%62))}return n}}function Fn(i,e){return i<e?-1:i>e?1:0}function GT(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const s=i.charAt(n),r=e.charAt(n);if(s!==r)return ub(s)===ub(r)?Fn(s,r):ub(s)?1:-1}return Fn(i.length,e.length)}const Lz=55296,Uz=57343;function ub(i){const e=i.charCodeAt(0);return e>=Lz&&e<=Uz}function Xm(i,e,t){return i.length===e.length&&i.every((n,s)=>t(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw="__name__";class gc{constructor(e,t,n){t===void 0?t=0:t>e.length&&sn(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&sn(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return gc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gc?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const r=gc.compareSegments(e.get(s),t.get(s));if(r!==0)return r}return Fn(e.length,t.length)}static compareSegments(e,t){const n=gc.isNumericId(e),s=gc.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?gc.extractNumericId(e).compare(gc.extractNumericId(t)):GT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Zh.fromString(e.substring(4,e.length-2))}}class Mi extends gc{construct(e,t,n){return new Mi(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Rt(Ye.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(s=>s.length>0))}return new Mi(t)}static emptyPath(){return new Mi([])}}const Pz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pr extends gc{construct(e,t,n){return new pr(e,t,n)}static isValidIdentifier(e){return Pz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hw}static keyField(){return new pr([hw])}static fromServerFormat(e){const t=[];let n="",s=0;const r=()=>{if(n.length===0)throw new Rt(Ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new Rt(Ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Rt(Ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(r(),s++)}if(r(),o)throw new Rt(Ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pr(t)}static emptyPath(){return new pr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.path=e}static fromPath(e){return new Xt(Mi.fromString(e))}static fromName(e){return new Xt(Mi.fromString(e).popFirst(5))}static empty(){return new Xt(Mi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mi.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xt(new Mi(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(i,e,t){if(!t)throw new Rt(Ye.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function Fz(i,e,t,n){if(e===!0&&n===!0)throw new Rt(Ye.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function fw(i){if(!Xt.isDocumentKey(i))throw new Rt(Ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function dw(i){if(Xt.isDocumentKey(i))throw new Rt(Ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function RB(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function pS(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":sn(12329,{type:typeof i})}function Va(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new Rt(Ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=pS(i);throw new Rt(Ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(i,e){const t={typeString:i};return e&&(t.value=e),t}function j_(i,e){if(!RB(i))throw new Rt(Ye.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,r="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const o=i[n];if(s&&typeof o!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){t=`Expected '${n}' field to equal '${r.value}'`;break}}if(t)throw new Rt(Ye.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw=-62135596800,mw=1e6;class Ni{static now(){return Ni.fromMillis(Date.now())}static fromDate(e){return Ni.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*mw);return new Ni(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Rt(Ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Rt(Ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pw)throw new Rt(Ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Rt(Ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mw}_compareTo(e){return this.seconds===e.seconds?Fn(this.nanoseconds,e.nanoseconds):Fn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ni._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(j_(e,Ni._jsonSchema))return new Ni(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ni._jsonSchemaVersion="firestore/timestamp/1.0",Ni._jsonSchema={type:Is("string",Ni._jsonSchemaVersion),seconds:Is("number"),nanoseconds:Is("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{static fromTimestamp(e){return new dn(e)}static min(){return new dn(new Ni(0,0))}static max(){return new dn(new Ni(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __=-1;function zz(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=dn.fromTimestamp(n===1e9?new Ni(t+1,0):new Ni(t,n));return new sf(s,Xt.empty(),e)}function Vz(i){return new sf(i.readTime,i.key,__)}class sf{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new sf(dn.min(),Xt.empty(),__)}static max(){return new sf(dn.max(),Xt.empty(),__)}}function Hz(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=Xt.comparator(i.documentKey,e.documentKey),t!==0?t:Fn(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yg(i){if(i.code!==Ye.FAILED_PRECONDITION||i.message!==kz)throw i;Bt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&sn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $e((n,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(n,s)},this.catchCallback=r=>{this.wrapFailure(t,r).next(n,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $e?t:$e.resolve(t)}catch(t){return $e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$e.reject(t)}static resolve(e){return new $e((t,n)=>{t(e)})}static reject(e){return new $e((t,n)=>{n(e)})}static waitFor(e){return new $e((t,n)=>{let s=0,r=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++r,o&&r===s&&t()},f=>n(f))}),o=!0,r===s&&t()})}static or(e){let t=$e.resolve(!1);for(const n of e)t=t.next(s=>s?$e.resolve(s):n());return t}static forEach(e,t){const n=[];return e.forEach((s,r)=>{n.push(t.call(this,s,r))}),this.waitFor(n)}static mapArray(e,t){return new $e((n,s)=>{const r=e.length,o=new Array(r);let c=0;for(let f=0;f<r;f++){const p=f;t(e[p]).next(m=>{o[p]=m,++c,c===r&&n(o)},m=>s(m))}})}static doWhile(e,t){return new $e((n,s)=>{const r=()=>{e()===!0?t().next(()=>{r()},s):n()};r()})}}function jz(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _g(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}mS.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=-1;function gS(i){return i==null}function tx(i){return i===0&&1/i==-1/0}function qz(i){return typeof i=="number"&&Number.isInteger(i)&&!tx(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB="";function Xz(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=gw(e)),e=Wz(i.get(t),e);return gw(e)}function Wz(i,e){let t=e;const n=i.length;for(let s=0;s<n;s++){const r=i.charAt(s);switch(r){case"\0":t+="";break;case wB:t+="";break;default:t+=r}}return t}function gw(i){return i+wB+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function pf(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function DB(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,t){this.comparator=e,this.root=t||fr.EMPTY}insert(e,t){return new es(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fr.BLACK,null,null))}remove(e){return new es(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new T0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new T0(this.root,e,this.comparator,!1)}getReverseIterator(){return new T0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new T0(this.root,e,this.comparator,!0)}}class T0{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fr{constructor(e,t,n,s,r){this.key=e,this.value=t,this.color=n??fr.RED,this.left=s??fr.EMPTY,this.right=r??fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,r){return new fr(e??this.key,t??this.value,n??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const r=n(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,n),null):r===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return fr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return fr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw sn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw sn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw sn(27949);return e+(this.isRed()?0:1)}}fr.EMPTY=null,fr.RED=!0,fr.BLACK=!1;fr.EMPTY=new class{constructor(){this.size=0}get key(){throw sn(57766)}get value(){throw sn(16141)}get color(){throw sn(16727)}get left(){throw sn(29726)}get right(){throw sn(36894)}copy(e,t,n,s,r){return this}insert(e,t,n){return new fr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.comparator=e,this.data=new es(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _w(this.data.getIterator())}getIteratorFrom(e){return new _w(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Fs)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=n.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Fs(this.comparator);return t.data=e,t}}class _w{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e){this.fields=e,e.sort(pr.comparator)}static empty(){return new ao([])}unionWith(e){let t=new Fs(pr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ao(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xm(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IB extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new IB("Invalid base64 string: "+r):r}}(e);return new mr(t)}static fromUint8Array(e){const t=function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r}(e);return new mr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mr.EMPTY_BYTE_STRING=new mr("");const Yz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rf(i){if(oi(!!i,39018),typeof i=="string"){let e=0;const t=Yz.exec(i);if(oi(!!t,46558,{timestamp:i}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ys(i.seconds),nanos:ys(i.nanos)}}function ys(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function af(i){return typeof i=="string"?mr.fromBase64String(i):mr.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB="server_timestamp",NB="__type__",OB="__previous_value__",LB="__local_write_time__";function ZM(i){return(i?.mapValue?.fields||{})[NB]?.stringValue===BB}function yS(i){const e=i.mapValue.fields[OB];return ZM(e)?yS(e):e}function v_(i){const e=rf(i.mapValue.fields[LB].timestampValue);return new Ni(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e,t,n,s,r,o,c,f,p,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=m}}const nx="(default)";class A_{constructor(e,t){this.projectId=e,this.database=t||nx}static empty(){return new A_("","")}get isDefaultDatabase(){return this.database===nx}isEqual(e){return e instanceof A_&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB="__type__",Jz="__max__",M0={mapValue:{}},PB="__vector__",ix="value";function of(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?ZM(i)?4:Zz(i)?9007199254740991:Qz(i)?10:11:sn(28295,{value:i})}function Dc(i,e){if(i===e)return!0;const t=of(i);if(t!==of(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return v_(i).isEqual(v_(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=rf(s.timestampValue),c=rf(r.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(s,r){return af(s.bytesValue).isEqual(af(r.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(s,r){return ys(s.geoPointValue.latitude)===ys(r.geoPointValue.latitude)&&ys(s.geoPointValue.longitude)===ys(r.geoPointValue.longitude)}(i,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return ys(s.integerValue)===ys(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=ys(s.doubleValue),c=ys(r.doubleValue);return o===c?tx(o)===tx(c):isNaN(o)&&isNaN(c)}return!1}(i,e);case 9:return Xm(i.arrayValue.values||[],e.arrayValue.values||[],Dc);case 10:case 11:return function(s,r){const o=s.mapValue.fields||{},c=r.mapValue.fields||{};if(yw(o)!==yw(c))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(c[f]===void 0||!Dc(o[f],c[f])))return!1;return!0}(i,e);default:return sn(52216,{left:i})}}function x_(i,e){return(i.values||[]).find(t=>Dc(t,e))!==void 0}function Wm(i,e){if(i===e)return 0;const t=of(i),n=of(e);if(t!==n)return Fn(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Fn(i.booleanValue,e.booleanValue);case 2:return function(r,o){const c=ys(r.integerValue||r.doubleValue),f=ys(o.integerValue||o.doubleValue);return c<f?-1:c>f?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1}(i,e);case 3:return vw(i.timestampValue,e.timestampValue);case 4:return vw(v_(i),v_(e));case 5:return GT(i.stringValue,e.stringValue);case 6:return function(r,o){const c=af(r),f=af(o);return c.compareTo(f)}(i.bytesValue,e.bytesValue);case 7:return function(r,o){const c=r.split("/"),f=o.split("/");for(let p=0;p<c.length&&p<f.length;p++){const m=Fn(c[p],f[p]);if(m!==0)return m}return Fn(c.length,f.length)}(i.referenceValue,e.referenceValue);case 8:return function(r,o){const c=Fn(ys(r.latitude),ys(o.latitude));return c!==0?c:Fn(ys(r.longitude),ys(o.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return Aw(i.arrayValue,e.arrayValue);case 10:return function(r,o){const c=r.fields||{},f=o.fields||{},p=c[ix]?.arrayValue,m=f[ix]?.arrayValue,y=Fn(p?.values?.length||0,m?.values?.length||0);return y!==0?y:Aw(p,m)}(i.mapValue,e.mapValue);case 11:return function(r,o){if(r===M0.mapValue&&o===M0.mapValue)return 0;if(r===M0.mapValue)return 1;if(o===M0.mapValue)return-1;const c=r.fields||{},f=Object.keys(c),p=o.fields||{},m=Object.keys(p);f.sort(),m.sort();for(let y=0;y<f.length&&y<m.length;++y){const v=GT(f[y],m[y]);if(v!==0)return v;const x=Wm(c[f[y]],p[m[y]]);if(x!==0)return x}return Fn(f.length,m.length)}(i.mapValue,e.mapValue);default:throw sn(23264,{he:t})}}function vw(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Fn(i,e);const t=rf(i),n=rf(e),s=Fn(t.seconds,n.seconds);return s!==0?s:Fn(t.nanos,n.nanos)}function Aw(i,e){const t=i.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const r=Wm(t[s],n[s]);if(r)return r}return Fn(t.length,n.length)}function Ym(i){return jT(i)}function jT(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const n=rf(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return af(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return Xt.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",s=!0;for(const r of t.values||[])s?s=!1:n+=",",n+=jT(r);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){const n=Object.keys(t.fields||{}).sort();let s="{",r=!0;for(const o of n)r?r=!1:s+=",",s+=`${o}:${jT(t.fields[o])}`;return s+"}"}(i.mapValue):sn(61005,{value:i})}function UA(i){switch(of(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=yS(i);return e?16+UA(e):16;case 5:return 2*i.stringValue.length;case 6:return af(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,r)=>s+UA(r),0)}(i.arrayValue);case 10:case 11:return function(n){let s=0;return pf(n.fields,(r,o)=>{s+=r.length+UA(o)}),s}(i.mapValue);default:throw sn(13486,{value:i})}}function xw(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function qT(i){return!!i&&"integerValue"in i}function $M(i){return!!i&&"arrayValue"in i}function Sw(i){return!!i&&"nullValue"in i}function Ew(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function PA(i){return!!i&&"mapValue"in i}function Qz(i){return(i?.mapValue?.fields||{})[UB]?.stringValue===PB}function t_(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return pf(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=t_(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=t_(i.arrayValue.values[t]);return e}return{...i}}function Zz(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===Jz}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.value=e}static empty(){return new Pa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!PA(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=t_(t)}setAll(e){let t=pr.emptyPath(),n={},s=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){const f=this.getFieldsMap(t);this.applyChanges(f,n,s),n={},s=[],t=c.popLast()}o?n[c.lastSegment()]=t_(o):s.push(c.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,s)}delete(e){const t=this.field(e.popLast());PA(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];PA(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){pf(t,(s,r)=>e[s]=r);for(const s of n)delete e[s]}clone(){return new Pa(t_(this.value))}}function FB(i){const e=[];return pf(i.fields,(t,n)=>{const s=new pr([t]);if(PA(n)){const r=FB(n.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)}),new ao(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t,n,s,r,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=r,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Or(e,0,dn.min(),dn.min(),dn.min(),Pa.empty(),0)}static newFoundDocument(e,t,n,s){return new Or(e,1,t,dn.min(),n,s,0)}static newNoDocument(e,t){return new Or(e,2,t,dn.min(),dn.min(),Pa.empty(),0)}static newUnknownDocument(e,t){return new Or(e,3,t,dn.min(),dn.min(),Pa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(dn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e,t){this.position=e,this.inclusive=t}}function bw(i,e,t){let n=0;for(let s=0;s<i.position.length;s++){const r=e[s],o=i.position[s];if(r.field.isKeyField()?n=Xt.comparator(Xt.fromName(o.referenceValue),t.key):n=Wm(o,t.data.field(r.field)),r.dir==="desc"&&(n*=-1),n!==0)break}return n}function Tw(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Dc(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,t="asc"){this.field=e,this.dir=t}}function $z(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{}class Ds extends zB{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new tV(e,t,n):t==="array-contains"?new sV(e,n):t==="in"?new rV(e,n):t==="not-in"?new aV(e,n):t==="array-contains-any"?new oV(e,n):new Ds(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new nV(e,n):new iV(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wm(t,this.value)):t!==null&&of(this.value)===of(t)&&this.matchesComparison(Wm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return sn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ml extends zB{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ml(e,t)}matches(e){return VB(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function VB(i){return i.op==="and"}function HB(i){return eV(i)&&VB(i)}function eV(i){for(const e of i.filters)if(e instanceof Ml)return!1;return!0}function XT(i){if(i instanceof Ds)return i.field.canonicalString()+i.op.toString()+Ym(i.value);if(HB(i))return i.filters.map(e=>XT(e)).join(",");{const e=i.filters.map(t=>XT(t)).join(",");return`${i.op}(${e})`}}function kB(i,e){return i instanceof Ds?function(n,s){return s instanceof Ds&&n.op===s.op&&n.field.isEqual(s.field)&&Dc(n.value,s.value)}(i,e):i instanceof Ml?function(n,s){return s instanceof Ml&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((r,o,c)=>r&&kB(o,s.filters[c]),!0):!1}(i,e):void sn(19439)}function GB(i){return i instanceof Ds?function(t){return`${t.field.canonicalString()} ${t.op} ${Ym(t.value)}`}(i):i instanceof Ml?function(t){return t.op.toString()+" {"+t.getFilters().map(GB).join(" ,")+"}"}(i):"Filter"}class tV extends Ds{constructor(e,t,n){super(e,t,n),this.key=Xt.fromName(n.referenceValue)}matches(e){const t=Xt.comparator(e.key,this.key);return this.matchesComparison(t)}}class nV extends Ds{constructor(e,t){super(e,"in",t),this.keys=jB("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class iV extends Ds{constructor(e,t){super(e,"not-in",t),this.keys=jB("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function jB(i,e){return(e.arrayValue?.values||[]).map(t=>Xt.fromName(t.referenceValue))}class sV extends Ds{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $M(t)&&x_(t.arrayValue,this.value)}}class rV extends Ds{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&x_(this.value.arrayValue,t)}}class aV extends Ds{constructor(e,t){super(e,"not-in",t)}matches(e){if(x_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!x_(this.value.arrayValue,t)}}class oV extends Ds{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$M(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>x_(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,t=null,n=[],s=[],r=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=o,this.endAt=c,this.Te=null}}function Mw(i,e=null,t=[],n=[],s=null,r=null,o=null){return new lV(i,e,t,n,s,r,o)}function e1(i){const e=gn(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>XT(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(r){return r.field.canonicalString()+r.dir}(n)).join(","),gS(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ym(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ym(n)).join(",")),e.Te=t}return e.Te}function t1(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!$z(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!kB(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!Tw(i.startAt,e.startAt)&&Tw(i.endAt,e.endAt)}function WT(i){return Xt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t=null,n=[],s=[],r=null,o="F",c=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=r,this.limitType=o,this.startAt=c,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function cV(i,e,t,n,s,r,o,c){return new vg(i,e,t,n,s,r,o,c)}function _S(i){return new vg(i)}function Cw(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function qB(i){return i.collectionGroup!==null}function n_(i){const e=gn(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),t.add(r.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Fs(pr.comparator);return o.filters.forEach(f=>{f.getFlattenedFilters().forEach(p=>{p.isInequality()&&(c=c.add(p.field))})}),c})(e).forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new S_(r,n))}),t.has(pr.keyField().canonicalString())||e.Ie.push(new S_(pr.keyField(),n))}return e.Ie}function Sc(i){const e=gn(i);return e.Ee||(e.Ee=uV(e,n_(i))),e.Ee}function uV(i,e){if(i.limitType==="F")return Mw(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(s=>{const r=s.dir==="desc"?"asc":"desc";return new S_(s.field,r)});const t=i.endAt?new sx(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new sx(i.startAt.position,i.startAt.inclusive):null;return Mw(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function YT(i,e){const t=i.filters.concat([e]);return new vg(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function KT(i,e,t){return new vg(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function vS(i,e){return t1(Sc(i),Sc(e))&&i.limitType===e.limitType}function XB(i){return`${e1(Sc(i))}|lt:${i.limitType}`}function Im(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(s=>GB(s)).join(", ")}]`),gS(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(s=>Ym(s)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(s=>Ym(s)).join(",")),`Target(${n})`}(Sc(i))}; limitType=${i.limitType})`}function AS(i,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):Xt.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(i,e)&&function(n,s){for(const r of n_(n))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(i,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(i,e)&&function(n,s){return!(n.startAt&&!function(o,c,f){const p=bw(o,c,f);return o.inclusive?p<=0:p<0}(n.startAt,n_(n),s)||n.endAt&&!function(o,c,f){const p=bw(o,c,f);return o.inclusive?p>=0:p>0}(n.endAt,n_(n),s))}(i,e)}function hV(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function WB(i){return(e,t)=>{let n=!1;for(const s of n_(i)){const r=fV(s,e,t);if(r!==0)return r;n=n||s.field.isKeyField()}return 0}}function fV(i,e,t){const n=i.field.isKeyField()?Xt.comparator(e.key,t.key):function(r,o,c){const f=o.data.field(r),p=c.data.field(r);return f!==null&&p!==null?Wm(f,p):sn(42886)}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return sn(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,r]of n)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){pf(this.inner,(t,n)=>{for(const[s,r]of n)e(s,r)})}isEmpty(){return DB(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=new es(Xt.comparator);function Uu(){return dV}const YB=new es(Xt.comparator);function Wy(...i){let e=YB;for(const t of i)e=e.insert(t.key,t);return e}function KB(i){let e=YB;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Id(){return i_()}function JB(){return i_()}function i_(){return new sp(i=>i.toString(),(i,e)=>i.isEqual(e))}const pV=new es(Xt.comparator),mV=new Fs(Xt.comparator);function zn(...i){let e=mV;for(const t of i)e=e.add(t);return e}const gV=new Fs(Fn);function yV(){return gV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tx(e)?"-0":e}}function QB(i){return{integerValue:""+i}}function _V(i,e){return qz(e)?QB(e):n1(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(){this._=void 0}}function vV(i,e,t){return i instanceof rx?function(s,r){const o={fields:{[NB]:{stringValue:BB},[LB]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&ZM(r)&&(r=yS(r)),r&&(o.fields[OB]=r),{mapValue:o}}(t,e):i instanceof E_?$B(i,e):i instanceof b_?eN(i,e):function(s,r){const o=ZB(s,r),c=Rw(o)+Rw(s.Ae);return qT(o)&&qT(s.Ae)?QB(c):n1(s.serializer,c)}(i,e)}function AV(i,e,t){return i instanceof E_?$B(i,e):i instanceof b_?eN(i,e):t}function ZB(i,e){return i instanceof ax?function(n){return qT(n)||function(r){return!!r&&"doubleValue"in r}(n)}(e)?e:{integerValue:0}:null}class rx extends xS{}class E_ extends xS{constructor(e){super(),this.elements=e}}function $B(i,e){const t=tN(e);for(const n of i.elements)t.some(s=>Dc(s,n))||t.push(n);return{arrayValue:{values:t}}}class b_ extends xS{constructor(e){super(),this.elements=e}}function eN(i,e){let t=tN(e);for(const n of i.elements)t=t.filter(s=>!Dc(s,n));return{arrayValue:{values:t}}}class ax extends xS{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Rw(i){return ys(i.integerValue||i.doubleValue)}function tN(i){return $M(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function xV(i,e){return i.field.isEqual(e.field)&&function(n,s){return n instanceof E_&&s instanceof E_||n instanceof b_&&s instanceof b_?Xm(n.elements,s.elements,Dc):n instanceof ax&&s instanceof ax?Dc(n.Ae,s.Ae):n instanceof rx&&s instanceof rx}(i.transform,e.transform)}class SV{constructor(e,t){this.version=e,this.transformResults=t}}class Ho{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ho}static exists(e){return new Ho(void 0,e)}static updateTime(e){return new Ho(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function FA(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class SS{}function nN(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new i1(i.key,Ho.none()):new q_(i.key,i.data,Ho.none());{const t=i.data,n=Pa.empty();let s=new Fs(pr.comparator);for(let r of e.fields)if(!s.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?n.delete(r):n.set(r,o),s=s.add(r)}return new mf(i.key,n,new ao(s.toArray()),Ho.none())}}function EV(i,e,t){i instanceof q_?function(s,r,o){const c=s.value.clone(),f=Dw(s.fieldTransforms,r,o.transformResults);c.setAll(f),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(i,e,t):i instanceof mf?function(s,r,o){if(!FA(s.precondition,r))return void r.convertToUnknownDocument(o.version);const c=Dw(s.fieldTransforms,r,o.transformResults),f=r.data;f.setAll(iN(s)),f.setAll(c),r.convertToFoundDocument(o.version,f).setHasCommittedMutations()}(i,e,t):function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function s_(i,e,t,n){return i instanceof q_?function(r,o,c,f){if(!FA(r.precondition,o))return c;const p=r.value.clone(),m=Iw(r.fieldTransforms,f,o);return p.setAll(m),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),null}(i,e,t,n):i instanceof mf?function(r,o,c,f){if(!FA(r.precondition,o))return c;const p=Iw(r.fieldTransforms,f,o),m=o.data;return m.setAll(iN(r)),m.setAll(p),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(y=>y.field))}(i,e,t,n):function(r,o,c){return FA(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(i,e,t)}function bV(i,e){let t=null;for(const n of i.fieldTransforms){const s=e.data.field(n.field),r=ZB(n.transform,s||null);r!=null&&(t===null&&(t=Pa.empty()),t.set(n.field,r))}return t||null}function ww(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Xm(n,s,(r,o)=>xV(r,o))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class q_ extends SS{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class mf extends SS{constructor(e,t,n,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function iN(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function Dw(i,e,t){const n=new Map;oi(i.length===t.length,32656,{Re:t.length,Ve:i.length});for(let s=0;s<t.length;s++){const r=i[s],o=r.transform,c=e.data.field(r.field);n.set(r.field,AV(o,c,t[s]))}return n}function Iw(i,e,t){const n=new Map;for(const s of i){const r=s.transform,o=t.data.field(s.field);n.set(s.field,vV(r,o,e))}return n}class i1 extends SS{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TV extends SS{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&EV(r,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=s_(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=s_(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=JB();return this.mutations.forEach(s=>{const r=e.get(s.key),o=r.overlayedDocument;let c=this.applyToLocalView(o,r.mutatedFields);c=t.has(s.key)?null:c;const f=nN(o,c);f!==null&&n.set(s.key,f),o.isValidDocument()||o.convertToNoDocument(dn.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),zn())}isEqual(e){return this.batchId===e.batchId&&Xm(this.mutations,e.mutations,(t,n)=>ww(t,n))&&Xm(this.baseMutations,e.baseMutations,(t,n)=>ww(t,n))}}class s1{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){oi(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return pV}();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,n[o].version);return new s1(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ws,Wn;function wV(i){switch(i){case Ye.OK:return sn(64938);case Ye.CANCELLED:case Ye.UNKNOWN:case Ye.DEADLINE_EXCEEDED:case Ye.RESOURCE_EXHAUSTED:case Ye.INTERNAL:case Ye.UNAVAILABLE:case Ye.UNAUTHENTICATED:return!1;case Ye.INVALID_ARGUMENT:case Ye.NOT_FOUND:case Ye.ALREADY_EXISTS:case Ye.PERMISSION_DENIED:case Ye.FAILED_PRECONDITION:case Ye.ABORTED:case Ye.OUT_OF_RANGE:case Ye.UNIMPLEMENTED:case Ye.DATA_LOSS:return!0;default:return sn(15467,{code:i})}}function sN(i){if(i===void 0)return Lu("GRPC error has no .code"),Ye.UNKNOWN;switch(i){case ws.OK:return Ye.OK;case ws.CANCELLED:return Ye.CANCELLED;case ws.UNKNOWN:return Ye.UNKNOWN;case ws.DEADLINE_EXCEEDED:return Ye.DEADLINE_EXCEEDED;case ws.RESOURCE_EXHAUSTED:return Ye.RESOURCE_EXHAUSTED;case ws.INTERNAL:return Ye.INTERNAL;case ws.UNAVAILABLE:return Ye.UNAVAILABLE;case ws.UNAUTHENTICATED:return Ye.UNAUTHENTICATED;case ws.INVALID_ARGUMENT:return Ye.INVALID_ARGUMENT;case ws.NOT_FOUND:return Ye.NOT_FOUND;case ws.ALREADY_EXISTS:return Ye.ALREADY_EXISTS;case ws.PERMISSION_DENIED:return Ye.PERMISSION_DENIED;case ws.FAILED_PRECONDITION:return Ye.FAILED_PRECONDITION;case ws.ABORTED:return Ye.ABORTED;case ws.OUT_OF_RANGE:return Ye.OUT_OF_RANGE;case ws.UNIMPLEMENTED:return Ye.UNIMPLEMENTED;case ws.DATA_LOSS:return Ye.DATA_LOSS;default:return sn(39323,{code:i})}}(Wn=ws||(ws={}))[Wn.OK=0]="OK",Wn[Wn.CANCELLED=1]="CANCELLED",Wn[Wn.UNKNOWN=2]="UNKNOWN",Wn[Wn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wn[Wn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wn[Wn.NOT_FOUND=5]="NOT_FOUND",Wn[Wn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wn[Wn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wn[Wn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wn[Wn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wn[Wn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wn[Wn.ABORTED=10]="ABORTED",Wn[Wn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wn[Wn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wn[Wn.INTERNAL=13]="INTERNAL",Wn[Wn.UNAVAILABLE=14]="UNAVAILABLE",Wn[Wn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=new Zh([4294967295,4294967295],0);function Bw(i){const e=DV().encode(i),t=new vB;return t.update(e),new Uint8Array(t.digest())}function Nw(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new Zh([t,n],0),new Zh([s,r],0)]}class r1{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Yy(`Invalid padding: ${t}`);if(n<0)throw new Yy(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Yy(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Yy(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Zh.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(Zh.fromNumber(n)));return s.compare(IV)===1&&(s=new Zh([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Bw(e),[n,s]=Nw(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(n,s,r);if(!this.we(o))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new r1(r,s,t);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const t=Bw(e),[n,s]=Nw(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(n,s,r);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Yy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t,n,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,X_.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ES(dn.min(),s,new es(Fn),Uu(),zn())}}class X_{constructor(e,t,n,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new X_(n,t,zn(),zn(),zn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class rN{constructor(e,t){this.targetId=e,this.Ce=t}}class aN{constructor(e,t,n=mr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class Ow{constructor(){this.ve=0,this.Fe=Lw(),this.Me=mr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=zn(),t=zn(),n=zn();return this.Fe.forEach((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:sn(38017,{changeType:r})}}),new X_(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Lw()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,oi(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class BV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Uu(),this.Je=C0(),this.He=C0(),this.Ye=new es(Fn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:sn(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const r=s.target;if(WT(r))if(n===0){const o=new Xt(r.path);this.et(t,o,Or.newNoDocument(o,dn.min()))}else oi(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const c=this.ut(e),f=c?this.ct(c,e,o):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:r=0}=t;let o,c;try{o=af(n).toUint8Array()}catch(f){if(f instanceof IB)return qm("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{c=new r1(o,s,r)}catch(f){return qm(f instanceof Yy?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach(r=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(c)||(this.et(t,r,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((r,o)=>{const c=this.ot(o);if(c){if(r.current&&WT(c.target)){const f=new Xt(c.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,Or.newNoDocument(f,e))}r.Be&&(t.set(o,r.ke()),r.qe())}});let n=zn();this.He.forEach((r,o)=>{let c=!0;o.forEachWhile(f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(r))}),this.je.forEach((r,o)=>o.setReadTime(e));const s=new ES(e,t,this.Ye,this.je,n);return this.je=Uu(),this.Je=C0(),this.He=C0(),this.Ye=new es(Fn),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Ow,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Fs(Fn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Fs(Fn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Bt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ow),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function C0(){return new es(Xt.comparator)}function Lw(){return new es(Xt.comparator)}const NV={asc:"ASCENDING",desc:"DESCENDING"},OV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LV={and:"AND",or:"OR"};class UV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function JT(i,e){return i.useProto3Json||gS(e)?e:{value:e}}function ox(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oN(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function PV(i,e){return ox(i,e.toTimestamp())}function Ec(i){return oi(!!i,49232),dn.fromTimestamp(function(t){const n=rf(t);return new Ni(n.seconds,n.nanos)}(i))}function a1(i,e){return QT(i,e).canonicalString()}function QT(i,e){const t=function(s){return new Mi(["projects",s.projectId,"databases",s.database])}(i).child("documents");return e===void 0?t:t.child(e)}function lN(i){const e=Mi.fromString(i);return oi(dN(e),10190,{key:e.toString()}),e}function ZT(i,e){return a1(i.databaseId,e.path)}function hb(i,e){const t=lN(e);if(t.get(1)!==i.databaseId.projectId)throw new Rt(Ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new Rt(Ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new Xt(uN(t))}function cN(i,e){return a1(i.databaseId,e)}function FV(i){const e=lN(i);return e.length===4?Mi.emptyPath():uN(e)}function $T(i){return new Mi(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function uN(i){return oi(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Uw(i,e,t){return{name:ZT(i,e),fields:t.value.mapValue.fields}}function zV(i,e){let t;if("targetChange"in e){e.targetChange;const n=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:sn(39313,{state:p})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=function(p,m){return p.useProto3Json?(oi(m===void 0||typeof m=="string",58123),mr.fromBase64String(m||"")):(oi(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),mr.fromUint8Array(m||new Uint8Array))}(i,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(p){const m=p.code===void 0?Ye.UNKNOWN:sN(p.code);return new Rt(m,p.message||"")}(o);t=new aN(n,s,r,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=hb(i,n.document.name),r=Ec(n.document.updateTime),o=n.document.createTime?Ec(n.document.createTime):dn.min(),c=new Pa({mapValue:{fields:n.document.fields}}),f=Or.newFoundDocument(s,r,o,c),p=n.targetIds||[],m=n.removedTargetIds||[];t=new zA(p,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=hb(i,n.document),r=n.readTime?Ec(n.readTime):dn.min(),o=Or.newNoDocument(s,r),c=n.removedTargetIds||[];t=new zA([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=hb(i,n.document),r=n.removedTargetIds||[];t=new zA([],r,s,null)}else{if(!("filter"in e))return sn(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:r}=n,o=new RV(s,r),c=n.targetId;t=new rN(c,o)}}return t}function VV(i,e){let t;if(e instanceof q_)t={update:Uw(i,e.key,e.value)};else if(e instanceof i1)t={delete:ZT(i,e.key)};else if(e instanceof mf)t={update:Uw(i,e.key,e.data),updateMask:KV(e.fieldMask)};else{if(!(e instanceof TV))return sn(16599,{Vt:e.type});t={verify:ZT(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(r,o){const c=o.transform;if(c instanceof rx)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof E_)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof b_)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ax)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw sn(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:PV(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:sn(27497)}(i,e.precondition)),t}function HV(i,e){return i&&i.length>0?(oi(e!==void 0,14353),i.map(t=>function(s,r){let o=s.updateTime?Ec(s.updateTime):Ec(r);return o.isEqual(dn.min())&&(o=Ec(r)),new SV(o,s.transformResults||[])}(t,e))):[]}function kV(i,e){return{documents:[cN(i,e.path)]}}function GV(i,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=cN(i,s);const r=function(p){if(p.length!==0)return fN(Ml.create(p,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const o=function(p){if(p.length!==0)return p.map(m=>function(v){return{field:Bm(v.field),direction:XV(v.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=JT(i,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{ft:t,parent:s}}function jV(i){let e=FV(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){oi(n===1,65062);const m=t.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let r=[];t.where&&(r=function(y){const v=hN(y);return v instanceof Ml&&HB(v)?v.getFilters():[v]}(t.where));let o=[];t.orderBy&&(o=function(y){return y.map(v=>function(b){return new S_(Nm(b.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(v))}(t.orderBy));let c=null;t.limit&&(c=function(y){let v;return v=typeof y=="object"?y.value:y,gS(v)?null:v}(t.limit));let f=null;t.startAt&&(f=function(y){const v=!!y.before,x=y.values||[];return new sx(x,v)}(t.startAt));let p=null;return t.endAt&&(p=function(y){const v=!y.before,x=y.values||[];return new sx(x,v)}(t.endAt)),cV(e,s,o,r,c,"F",f,p)}function qV(i,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return sn(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function hN(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Nm(t.unaryFilter.field);return Ds.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Nm(t.unaryFilter.field);return Ds.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Nm(t.unaryFilter.field);return Ds.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Nm(t.unaryFilter.field);return Ds.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return sn(61313);default:return sn(60726)}}(i):i.fieldFilter!==void 0?function(t){return Ds.create(Nm(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return sn(58110);default:return sn(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return Ml.create(t.compositeFilter.filters.map(n=>hN(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return sn(1026)}}(t.compositeFilter.op))}(i):sn(30097,{filter:i})}function XV(i){return NV[i]}function WV(i){return OV[i]}function YV(i){return LV[i]}function Bm(i){return{fieldPath:i.canonicalString()}}function Nm(i){return pr.fromServerFormat(i.fieldPath)}function fN(i){return i instanceof Ds?function(t){if(t.op==="=="){if(Ew(t.value))return{unaryFilter:{field:Bm(t.field),op:"IS_NAN"}};if(Sw(t.value))return{unaryFilter:{field:Bm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ew(t.value))return{unaryFilter:{field:Bm(t.field),op:"IS_NOT_NAN"}};if(Sw(t.value))return{unaryFilter:{field:Bm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bm(t.field),op:WV(t.op),value:t.value}}}(i):i instanceof Ml?function(t){const n=t.getFilters().map(s=>fN(s));return n.length===1?n[0]:{compositeFilter:{op:YV(t.op),filters:n}}}(i):sn(54877,{filter:i})}function KV(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function dN(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t,n,s,r=dn.min(),o=dn.min(),c=mr.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=f}withSequenceNumber(e){return new Wh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e){this.yt=e}}function QV(i){const e=jV({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?KT(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(){this.Cn=new $V}addToCollectionParentIndex(e,t){return this.Cn.add(t),$e.resolve()}getCollectionParents(e,t){return $e.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $e.resolve()}deleteFieldIndex(e,t){return $e.resolve()}deleteAllFieldIndexes(e){return $e.resolve()}createTargetIndexes(e,t){return $e.resolve()}getDocumentsMatchingTarget(e,t){return $e.resolve(null)}getIndexType(e,t){return $e.resolve(0)}getFieldIndexes(e,t){return $e.resolve([])}getNextCollectionGroupToUpdate(e){return $e.resolve(null)}getMinOffset(e,t){return $e.resolve(sf.min())}getMinOffsetFromCollectionGroup(e,t){return $e.resolve(sf.min())}updateCollectionGroup(e,t,n){return $e.resolve()}updateIndexEntries(e,t){return $e.resolve()}}class $V{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Fs(Mi.comparator),r=!s.has(n);return this.index[t]=s.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Fs(Mi.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pN=41943040;class La{static withCacheSize(e){return new La(e,La.DEFAULT_COLLECTION_PERCENTILE,La.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */La.DEFAULT_COLLECTION_PERCENTILE=10,La.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,La.DEFAULT=new La(pN,La.DEFAULT_COLLECTION_PERCENTILE,La.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),La.DISABLED=new La(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Km(0)}static cr(){return new Km(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="LruGarbageCollector",eH=1048576;function zw([i,e],[t,n]){const s=Fn(i,t);return s===0?Fn(e,n):s}class tH{constructor(e){this.Ir=e,this.buffer=new Fs(zw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();zw(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class nH{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Bt(Fw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_g(t)?Bt(Fw,"Ignoring IndexedDB error during garbage collection: ",t):await yg(t)}await this.Vr(3e5)})}}class iH{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return $e.resolve(mS.ce);const n=new tH(t);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Bt("LruGarbageCollector","Garbage collection skipped; disabled"),$e.resolve(Pw)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Pw):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,r,o,c,f,p;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,o=Date.now(),this.nthSequenceNumber(e,s))).next(y=>(n=y,c=Date.now(),this.removeTargets(e,n,t))).next(y=>(r=y,f=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(p=Date.now(),Dm()<=Pn.DEBUG&&Bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${r} targets in `+(f-c)+`ms
	Removed ${y} documents in `+(p-f)+`ms
Total Duration: ${p-m}ms`),$e.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:y})))}}function sH(i,e){return new iH(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rH{constructor(){this.changes=new sp(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?$e.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oH{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(n!==null&&s_(n.mutation,s,ao.empty(),Ni.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,zn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=zn()){const s=Id();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,n).next(r=>{let o=Wy();return r.forEach((c,f)=>{o=o.insert(c,f.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Id();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,zn()))}populateOverlays(e,t,n){const s=[];return n.forEach(r=>{t.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(e,s).next(r=>{r.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,n,s){let r=Uu();const o=i_(),c=function(){return i_()}();return t.forEach((f,p)=>{const m=n.get(p.key);s.has(p.key)&&(m===void 0||m.mutation instanceof mf)?r=r.insert(p.key,p):m!==void 0?(o.set(p.key,m.mutation.getFieldMask()),s_(m.mutation,p,m.mutation.getFieldMask(),Ni.now())):o.set(p.key,ao.empty())}),this.recalculateAndSaveOverlays(e,r).next(f=>(f.forEach((p,m)=>o.set(p,m)),t.forEach((p,m)=>c.set(p,new aH(m,o.get(p)??null))),c))}recalculateAndSaveOverlays(e,t){const n=i_();let s=new es((o,c)=>o-c),r=zn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const c of o)c.keys().forEach(f=>{const p=t.get(f);if(p===null)return;let m=n.get(f)||ao.empty();m=c.applyToLocalView(p,m),n.set(f,m);const y=(s.get(c.batchId)||zn()).add(f);s=s.insert(c.batchId,y)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const f=c.getNext(),p=f.key,m=f.value,y=JB();m.forEach(v=>{if(!r.has(v)){const x=nN(t.get(v),n.get(v));x!==null&&y.set(v,x),r=r.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,p,y))}return $e.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,s){return function(o){return Xt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):qB(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-r.size):$e.resolve(Id());let c=__,f=r;return o.next(p=>$e.forEach(p,(m,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),r.get(m)?$e.resolve():this.remoteDocumentCache.getEntry(e,m).next(v=>{f=f.insert(m,v)}))).next(()=>this.populateOverlays(e,p,r)).next(()=>this.computeViews(e,f,p,zn())).next(m=>({batchId:c,changes:KB(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xt(t)).next(n=>{let s=Wy();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const r=t.collectionGroup;let o=Wy();return this.indexManager.getCollectionParents(e,r).next(c=>$e.forEach(c,f=>{const p=function(y,v){return new vg(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,f.child(r));return this.getDocumentsMatchingCollectionQuery(e,p,n,s).next(m=>{m.forEach((y,v)=>{o=o.insert(y,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,s))).next(o=>{r.forEach((f,p)=>{const m=p.getKey();o.get(m)===null&&(o=o.insert(m,Or.newInvalidDocument(m)))});let c=Wy();return o.forEach((f,p)=>{const m=r.get(f);m!==void 0&&s_(m.mutation,p,ao.empty(),Ni.now()),AS(t,p)&&(c=c.insert(f,p))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $e.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Ec(s.createTime)}}(t)),$e.resolve()}getNamedQuery(e,t){return $e.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(s){return{name:s.name,query:QV(s.bundledQuery),readTime:Ec(s.readTime)}}(t)),$e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{constructor(){this.overlays=new es(Xt.comparator),this.qr=new Map}getOverlay(e,t){return $e.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Id();return $e.forEach(t,s=>this.getOverlay(e,s).next(r=>{r!==null&&n.set(s,r)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((s,r)=>{this.St(e,t,r)}),$e.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.qr.delete(n)),$e.resolve()}getOverlaysForCollection(e,t,n){const s=Id(),r=t.length+1,o=new Xt(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const f=c.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===r&&f.largestBatchId>n&&s.set(f.getKey(),f)}return $e.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let r=new es((p,m)=>p-m);const o=this.overlays.getIterator();for(;o.hasNext();){const p=o.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>n){let m=r.get(p.largestBatchId);m===null&&(m=Id(),r=r.insert(p.largestBatchId,m)),m.set(p.getKey(),p)}}const c=Id(),f=r.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((p,m)=>c.set(p,m)),!(c.size()>=s)););return $e.resolve(c)}St(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new CV(t,n));let r=this.qr.get(t);r===void 0&&(r=zn(),this.qr.set(t,r)),this.qr.set(t,r.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uH{constructor(){this.sessionToken=mr.EMPTY_BYTE_STRING}getSessionToken(e){return $e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(){this.Qr=new Fs(Js.$r),this.Ur=new Fs(Js.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Js(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Js(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new Xt(new Mi([])),n=new Js(t,e),s=new Js(t,e+1),r=[];return this.Ur.forEachInRange([n,s],o=>{this.Gr(o),r.push(o.key)}),r}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Xt(new Mi([])),n=new Js(t,e),s=new Js(t,e+1);let r=zn();return this.Ur.forEachInRange([n,s],o=>{r=r.add(o.key)}),r}containsKey(e){const t=new Js(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Js{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Xt.comparator(e.key,t.key)||Fn(e.Yr,t.Yr)}static Kr(e,t){return Fn(e.Yr,t.Yr)||Xt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hH{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Fs(Js.$r)}checkEmpty(e){return $e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new MV(r,t,n,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new Js(c.key,r)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return $e.resolve(o)}lookupMutationBatch(e,t){return $e.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),r=s<0?0:s;return $e.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return $e.resolve(this.mutationQueue.length===0?QM:this.tr-1)}getAllMutationBatches(e){return $e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Js(t,0),s=new Js(t,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([n,s],o=>{const c=this.Xr(o.Yr);r.push(c)}),$e.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Fs(Fn);return t.forEach(s=>{const r=new Js(s,0),o=new Js(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],c=>{n=n.add(c.Yr)})}),$e.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let r=n;Xt.isDocumentKey(r)||(r=r.child(""));const o=new Js(new Xt(r),0);let c=new Fs(Fn);return this.Zr.forEachWhile(f=>{const p=f.key.path;return!!n.isPrefixOf(p)&&(p.length===s&&(c=c.add(f.Yr)),!0)},o),$e.resolve(this.ti(c))}ti(e){const t=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){oi(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return $e.forEach(t.mutations,s=>{const r=new Js(s.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Js(t,0),s=this.Zr.firstAfterOrEqual(n);return $e.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$e.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH{constructor(e){this.ri=e,this.docs=function(){return new es(Xt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),r=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return $e.resolve(n?n.document.mutableCopy():Or.newInvalidDocument(t))}getEntries(e,t){let n=Uu();return t.forEach(s=>{const r=this.docs.get(s);n=n.insert(s,r?r.document.mutableCopy():Or.newInvalidDocument(s))}),$e.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let r=Uu();const o=t.path,c=new Xt(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(c);for(;f.hasNext();){const{key:p,value:{document:m}}=f.getNext();if(!o.isPrefixOf(p.path))break;p.path.length>o.length+1||Hz(Vz(m),n)<=0||(s.has(m.key)||AS(t,m))&&(r=r.insert(m.key,m.mutableCopy()))}return $e.resolve(r)}getAllFromCollectionGroup(e,t,n,s){sn(9500)}ii(e,t){return $e.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new dH(this)}getSize(e){return $e.resolve(this.size)}}class dH extends rH{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),$e.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pH{constructor(e){this.persistence=e,this.si=new sp(t=>e1(t),t1),this.lastRemoteSnapshotVersion=dn.min(),this.highestTargetId=0,this.oi=0,this._i=new o1,this.targetCount=0,this.ai=Km.ur()}forEachTarget(e,t){return this.si.forEach((n,s)=>t(s)),$e.resolve()}getLastRemoteSnapshotVersion(e){return $e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $e.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),$e.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Km(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$e.resolve()}updateTargetData(e,t){return this.Pr(t),$e.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$e.resolve()}removeTargets(e,t,n){let s=0;const r=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),$e.waitFor(r).next(()=>s)}getTargetCount(e){return $e.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return $e.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),$e.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach(o=>{r.push(s.markPotentiallyOrphaned(e,o))}),$e.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$e.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return $e.resolve(n)}containsKey(e,t){return $e.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e,t){this.ui={},this.overlays={},this.ci=new mS(0),this.li=!1,this.li=!0,this.hi=new uH,this.referenceDelegate=e(this),this.Pi=new pH(this),this.indexManager=new ZV,this.remoteDocumentCache=function(s){return new fH(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new JV(t),this.Ii=new lH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new cH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new hH(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Bt("MemoryPersistence","Starting transaction:",e);const s=new mH(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(r=>this.referenceDelegate.di(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}Ai(e,t){return $e.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class mH extends Gz{constructor(e){super(),this.currentSequenceNumber=e}}class l1{constructor(e){this.persistence=e,this.Ri=new o1,this.Vi=null}static mi(e){return new l1(e)}get fi(){if(this.Vi)return this.Vi;throw sn(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),$e.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),$e.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$e.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(r=>this.fi.add(r.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $e.forEach(this.fi,n=>{const s=Xt.fromPath(n);return this.gi(e,s).next(r=>{r||t.removeEntry(s,dn.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return $e.or([()=>$e.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class lx{constructor(e,t){this.persistence=e,this.pi=new sp(n=>Xz(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=sH(this,t)}static mi(e,t){return new lx(e,t)}Ei(){}di(e){return $e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(s=>n+s))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return $e.forEach(this.pi,(n,s)=>this.br(e,n,s).next(r=>r?$e.resolve():t(s)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,t).next(c=>{c||(n++,r.removeEntry(o,dn.min()))})).next(()=>r.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$e.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),$e.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),$e.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$e.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=UA(e.data.value)),t}br(e,t,n){return $e.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return $e.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=zn(),s=zn();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new c1(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yH{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return l3()?8:jz(Ur())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const r={result:null};return this.ys(e,t).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ws(e,t,s,n).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new gH;return this.Ss(e,t,o).next(c=>{if(r.result=c,this.Vs)return this.bs(e,t,o,c.size)})}).next(()=>r.result)}bs(e,t,n,s){return n.documentReadCount<this.fs?(Dm()<=Pn.DEBUG&&Bt("QueryEngine","SDK will not create cache indexes for query:",Im(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$e.resolve()):(Dm()<=Pn.DEBUG&&Bt("QueryEngine","Query:",Im(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Dm()<=Pn.DEBUG&&Bt("QueryEngine","The SDK decides to create cache indexes for query:",Im(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sc(t))):$e.resolve())}ys(e,t){if(Cw(t))return $e.resolve(null);let n=Sc(t);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=KT(t,null,"F"),n=Sc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const o=zn(...r);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(f=>{const p=this.Ds(t,c);return this.Cs(t,p,o,f.readTime)?this.ys(e,KT(t,null,"F")):this.vs(e,p,t,f)}))})))}ws(e,t,n,s){return Cw(t)||s.isEqual(dn.min())?$e.resolve(null):this.ps.getDocuments(e,n).next(r=>{const o=this.Ds(t,r);return this.Cs(t,o,n,s)?$e.resolve(null):(Dm()<=Pn.DEBUG&&Bt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Im(t)),this.vs(e,o,t,zz(s,__)).next(c=>c))})}Ds(e,t){let n=new Fs(WB(e));return t.forEach((s,r)=>{AS(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ss(e,t,n){return Dm()<=Pn.DEBUG&&Bt("QueryEngine","Using full collection scan to execute query:",Im(t)),this.ps.getDocumentsMatchingQuery(e,t,sf.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(r=>(t.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="LocalStore",_H=3e8;class vH{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new es(Fn),this.xs=new sp(r=>e1(r),t1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oH(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function AH(i,e,t,n){return new vH(i,e,t,n)}async function gN(i,e){const t=gn(i);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next(r=>(s=r,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(r=>{const o=[],c=[];let f=zn();for(const p of s){o.push(p.batchId);for(const m of p.mutations)f=f.add(m.key)}for(const p of r){c.push(p.batchId);for(const m of p.mutations)f=f.add(m.key)}return t.localDocuments.getDocuments(n,f).next(p=>({Ls:p,removedBatchIds:o,addedBatchIds:c}))})})}function xH(i,e){const t=gn(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),r=t.Ns.newChangeBuffer({trackRemovals:!0});return function(c,f,p,m){const y=p.batch,v=y.keys();let x=$e.resolve();return v.forEach(b=>{x=x.next(()=>m.getEntry(f,b)).next(R=>{const M=p.docVersions.get(b);oi(M!==null,48541),R.version.compareTo(M)<0&&(y.applyToRemoteDocument(R,p),R.isValidDocument()&&(R.setReadTime(p.commitVersion),m.addEntry(R)))})}),x.next(()=>c.mutationQueue.removeMutationBatch(f,y))}(t,n,e,r).next(()=>r.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let f=zn();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(f=f.add(c.batch.mutations[p].key));return f}(e))).next(()=>t.localDocuments.getDocuments(n,s))})}function yN(i){const e=gn(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function SH(i,e){const t=gn(i),n=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach((m,y)=>{const v=s.get(y);if(!v)return;c.push(t.Pi.removeMatchingKeys(r,m.removedDocuments,y).next(()=>t.Pi.addMatchingKeys(r,m.addedDocuments,y)));let x=v.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(y)!==null?x=x.withResumeToken(mr.EMPTY_BYTE_STRING,dn.min()).withLastLimboFreeSnapshotVersion(dn.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,n)),s=s.insert(y,x),function(R,M,T){return R.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=_H?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(v,x,m)&&c.push(t.Pi.updateTargetData(r,x))});let f=Uu(),p=zn();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(r,m))}),c.push(EH(r,o,e.documentUpdates).next(m=>{f=m.ks,p=m.qs})),!n.isEqual(dn.min())){const m=t.Pi.getLastRemoteSnapshotVersion(r).next(y=>t.Pi.setTargetsMetadata(r,r.currentSequenceNumber,n));c.push(m)}return $e.waitFor(c).next(()=>o.apply(r)).next(()=>t.localDocuments.getLocalViewOfDocuments(r,f,p)).next(()=>f)}).then(r=>(t.Ms=s,r))}function EH(i,e,t){let n=zn(),s=zn();return t.forEach(r=>n=n.add(r)),e.getEntries(i,n).next(r=>{let o=Uu();return t.forEach((c,f)=>{const p=r.get(c);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(c)),f.isNoDocument()&&f.version.isEqual(dn.min())?(e.removeEntry(c,f.readTime),o=o.insert(c,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),o=o.insert(c,f)):Bt(u1,"Ignoring outdated watch update for ",c,". Current version:",p.version," Watch version:",f.version)}),{ks:o,qs:s}})}function bH(i,e){const t=gn(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=QM),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function TH(i,e){const t=gn(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return t.Pi.getTargetData(n,e).next(r=>r?(s=r,$e.resolve(s)):t.Pi.allocateTargetId(n).next(o=>(s=new Wh(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=t.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function eM(i,e,t){const n=gn(i),s=n.Ms.get(e),r=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",r,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!_g(o))throw o;Bt(u1,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function Vw(i,e,t){const n=gn(i);let s=dn.min(),r=zn();return n.persistence.runTransaction("Execute query","readwrite",o=>function(f,p,m){const y=gn(f),v=y.xs.get(m);return v!==void 0?$e.resolve(y.Ms.get(v)):y.Pi.getTargetData(p,m)}(n,o,Sc(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,c.targetId).next(f=>{r=f})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?s:dn.min(),t?r:zn())).next(c=>(MH(n,hV(e),c),{documents:c,Qs:r})))}function MH(i,e,t){let n=i.Os.get(e)||dn.min();t.forEach((s,r)=>{r.readTime.compareTo(n)>0&&(n=r.readTime)}),i.Os.set(e,n)}class Hw{constructor(){this.activeTargetIds=yV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CH{constructor(){this.Mo=new Hw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Hw,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw="ConnectivityMonitor";class Gw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Bt(kw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Bt(kw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R0=null;function tM(){return R0===null?R0=function(){return 268435456+Math.round(2147483648*Math.random())}():R0++,"0x"+R0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb="RestConnection",wH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class DH{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===nx?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,r){const o=tM(),c=this.zo(e,t.toUriEncodedString());Bt(fb,`Sending RPC '${e}' ${o}:`,c,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,r);const{host:p}=new URL(c),m=Hu(p);return this.Jo(e,c,f,n,m).then(y=>(Bt(fb,`Received RPC '${e}' ${o}: `,y),y),y=>{throw qm(fb,`RPC '${e}' ${o} failed with error: `,y,"url: ",c,"request:",n),y})}Ho(e,t,n,s,r,o){return this.Go(e,t,n,s,r)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gg}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,r)=>e[r]=s),n&&n.headers.forEach((s,r)=>e[r]=s)}zo(e,t){const n=wH[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IH{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr="WebChannelConnection";class BH extends DH{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,r){const o=tM();return new Promise((c,f)=>{const p=new AB;p.setWithCredentials(!0),p.listenOnce(xB.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case LA.NO_ERROR:const y=p.getResponseJson();Bt(Rr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),c(y);break;case LA.TIMEOUT:Bt(Rr,`RPC '${e}' ${o} timed out`),f(new Rt(Ye.DEADLINE_EXCEEDED,"Request time out"));break;case LA.HTTP_ERROR:const v=p.getStatus();if(Bt(Rr,`RPC '${e}' ${o} failed with status:`,v,"response text:",p.getResponseText()),v>0){let x=p.getResponseJson();Array.isArray(x)&&(x=x[0]);const b=x?.error;if(b&&b.status&&b.message){const R=function(T){const D=T.toLowerCase().replace(/_/g,"-");return Object.values(Ye).indexOf(D)>=0?D:Ye.UNKNOWN}(b.status);f(new Rt(R,b.message))}else f(new Rt(Ye.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new Rt(Ye.UNAVAILABLE,"Connection failed."));break;default:sn(9055,{l_:e,streamId:o,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Bt(Rr,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(s);Bt(Rr,`RPC '${e}' ${o} sending request:`,s),p.send(t,"POST",m,n,15)})}T_(e,t,n){const s=tM(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bB(),c=EB(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,n),f.encodeInitMessageHeaders=!0;const m=r.join("");Bt(Rr,`Creating RPC '${e}' stream ${s}: ${m}`,f);const y=o.createWebChannel(m,f);this.I_(y);let v=!1,x=!1;const b=new IH({Yo:M=>{x?Bt(Rr,`Not sending because RPC '${e}' stream ${s} is closed:`,M):(v||(Bt(Rr,`Opening RPC '${e}' stream ${s} transport.`),y.open(),v=!0),Bt(Rr,`RPC '${e}' stream ${s} sending:`,M),y.send(M))},Zo:()=>y.close()}),R=(M,T,D)=>{M.listen(T,B=>{try{D(B)}catch(L){setTimeout(()=>{throw L},0)}})};return R(y,Xy.EventType.OPEN,()=>{x||(Bt(Rr,`RPC '${e}' stream ${s} transport opened.`),b.o_())}),R(y,Xy.EventType.CLOSE,()=>{x||(x=!0,Bt(Rr,`RPC '${e}' stream ${s} transport closed`),b.a_(),this.E_(y))}),R(y,Xy.EventType.ERROR,M=>{x||(x=!0,qm(Rr,`RPC '${e}' stream ${s} transport errored. Name:`,M.name,"Message:",M.message),b.a_(new Rt(Ye.UNAVAILABLE,"The operation could not be completed")))}),R(y,Xy.EventType.MESSAGE,M=>{if(!x){const T=M.data[0];oi(!!T,16349);const D=T,B=D?.error||D[0]?.error;if(B){Bt(Rr,`RPC '${e}' stream ${s} received error:`,B);const L=B.status;let G=function(U){const I=ws[U];if(I!==void 0)return sN(I)}(L),H=B.message;G===void 0&&(G=Ye.INTERNAL,H="Unknown error status: "+L+" with message "+B.message),x=!0,b.a_(new Rt(G,H)),y.close()}else Bt(Rr,`RPC '${e}' stream ${s} received:`,T),b.u_(T)}}),R(c,SB.STAT_EVENT,M=>{M.stat===kT.PROXY?Bt(Rr,`RPC '${e}' stream ${s} detected buffering proxy`):M.stat===kT.NOPROXY&&Bt(Rr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{b.__()},0),b}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function db(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bS(i){return new UV(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,t,n=1e3,s=1.5,r=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&Bt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw="PersistentStream";class vN{constructor(e,t,n,s,r,o,c,f){this.Mi=e,this.S_=n,this.b_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _N(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ye.RESOURCE_EXHAUSTED?(Lu(t.toString()),Lu("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===t&&this.G_(n,s)},n=>{e(()=>{const s=new Rt(Ye.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Bt(jw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Bt(jw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class NH extends vN{constructor(e,t,n,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,o),this.serializer=r}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=zV(this.serializer,e),n=function(r){if(!("targetChange"in r))return dn.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?dn.min():o.readTime?Ec(o.readTime):dn.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=$T(this.serializer),t.addTarget=function(r,o){let c;const f=o.target;if(c=WT(f)?{documents:kV(r,f)}:{query:GV(r,f).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=oN(r,o.resumeToken);const p=JT(r,o.expectedCount);p!==null&&(c.expectedCount=p)}else if(o.snapshotVersion.compareTo(dn.min())>0){c.readTime=ox(r,o.snapshotVersion.toTimestamp());const p=JT(r,o.expectedCount);p!==null&&(c.expectedCount=p)}return c}(this.serializer,e);const n=qV(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=$T(this.serializer),t.removeTarget=e,this.q_(t)}}class OH extends vN{constructor(e,t,n,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return oi(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oi(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oi(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=HV(e.writeResults,e.commitTime),n=Ec(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=$T(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>VV(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LH{}class UH extends LH{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Rt(Ye.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Go(e,QT(t,n),s,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Rt(Ye.UNKNOWN,r.toString())})}Ho(e,t,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,QT(t,n),s,o,c,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Rt(Ye.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class PH{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Lu(t),this.aa=!1):Bt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="RemoteStore";class FH{constructor(e,t,n,s,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{rp(this)&&(Bt(Yd,"Restarting streams for network reachability change."),await async function(f){const p=gn(f);p.Ea.add(4),await W_(p),p.Ra.set("Unknown"),p.Ea.delete(4),await TS(p)}(this))})}),this.Ra=new PH(n,s)}}async function TS(i){if(rp(i))for(const e of i.da)await e(!0)}async function W_(i){for(const e of i.da)await e(!1)}function AN(i,e){const t=gn(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),p1(t)?d1(t):Ag(t).O_()&&f1(t,e))}function h1(i,e){const t=gn(i),n=Ag(t);t.Ia.delete(e),n.O_()&&xN(t,e),t.Ia.size===0&&(n.O_()?n.L_():rp(t)&&t.Ra.set("Unknown"))}function f1(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(dn.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ag(i).Y_(e)}function xN(i,e){i.Va.Ue(e),Ag(i).Z_(e)}function d1(i){i.Va=new BV({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Ag(i).start(),i.Ra.ua()}function p1(i){return rp(i)&&!Ag(i).x_()&&i.Ia.size>0}function rp(i){return gn(i).Ea.size===0}function SN(i){i.Va=void 0}async function zH(i){i.Ra.set("Online")}async function VH(i){i.Ia.forEach((e,t)=>{f1(i,e)})}async function HH(i,e){SN(i),p1(i)?(i.Ra.ha(e),d1(i)):i.Ra.set("Unknown")}async function kH(i,e,t){if(i.Ra.set("Online"),e instanceof aN&&e.state===2&&e.cause)try{await async function(s,r){const o=r.cause;for(const c of r.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))}(i,e)}catch(n){Bt(Yd,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await cx(i,n)}else if(e instanceof zA?i.Va.Ze(e):e instanceof rN?i.Va.st(e):i.Va.tt(e),!t.isEqual(dn.min()))try{const n=await yN(i.localStore);t.compareTo(n)>=0&&await function(r,o){const c=r.Va.Tt(o);return c.targetChanges.forEach((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const m=r.Ia.get(p);m&&r.Ia.set(p,m.withResumeToken(f.resumeToken,o))}}),c.targetMismatches.forEach((f,p)=>{const m=r.Ia.get(f);if(!m)return;r.Ia.set(f,m.withResumeToken(mr.EMPTY_BYTE_STRING,m.snapshotVersion)),xN(r,f);const y=new Wh(m.target,f,p,m.sequenceNumber);f1(r,y)}),r.remoteSyncer.applyRemoteEvent(c)}(i,t)}catch(n){Bt(Yd,"Failed to raise snapshot:",n),await cx(i,n)}}async function cx(i,e,t){if(!_g(e))throw e;i.Ea.add(1),await W_(i),i.Ra.set("Offline"),t||(t=()=>yN(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{Bt(Yd,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await TS(i)})}function EN(i,e){return e().catch(t=>cx(i,t,e))}async function MS(i){const e=gn(i),t=lf(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:QM;for(;GH(e);)try{const s=await bH(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,jH(e,s)}catch(s){await cx(e,s)}bN(e)&&TN(e)}function GH(i){return rp(i)&&i.Ta.length<10}function jH(i,e){i.Ta.push(e);const t=lf(i);t.O_()&&t.X_&&t.ea(e.mutations)}function bN(i){return rp(i)&&!lf(i).x_()&&i.Ta.length>0}function TN(i){lf(i).start()}async function qH(i){lf(i).ra()}async function XH(i){const e=lf(i);for(const t of i.Ta)e.ea(t.mutations)}async function WH(i,e,t){const n=i.Ta.shift(),s=s1.from(n,e,t);await EN(i,()=>i.remoteSyncer.applySuccessfulWrite(s)),await MS(i)}async function YH(i,e){e&&lf(i).X_&&await async function(n,s){if(function(o){return wV(o)&&o!==Ye.ABORTED}(s.code)){const r=n.Ta.shift();lf(n).B_(),await EN(n,()=>n.remoteSyncer.rejectFailedWrite(r.batchId,s)),await MS(n)}}(i,e),bN(i)&&TN(i)}async function qw(i,e){const t=gn(i);t.asyncQueue.verifyOperationInProgress(),Bt(Yd,"RemoteStore received new credentials");const n=rp(t);t.Ea.add(3),await W_(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await TS(t)}async function KH(i,e){const t=gn(i);e?(t.Ea.delete(2),await TS(t)):e||(t.Ea.add(2),await W_(t),t.Ra.set("Unknown"))}function Ag(i){return i.ma||(i.ma=function(t,n,s){const r=gn(t);return r.sa(),new NH(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(i.datastore,i.asyncQueue,{Xo:zH.bind(null,i),t_:VH.bind(null,i),r_:HH.bind(null,i),H_:kH.bind(null,i)}),i.da.push(async e=>{e?(i.ma.B_(),p1(i)?d1(i):i.Ra.set("Unknown")):(await i.ma.stop(),SN(i))})),i.ma}function lf(i){return i.fa||(i.fa=function(t,n,s){const r=gn(t);return r.sa(),new OH(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:qH.bind(null,i),r_:YH.bind(null,i),ta:XH.bind(null,i),na:WH.bind(null,i)}),i.da.push(async e=>{e?(i.fa.B_(),await MS(i)):(await i.fa.stop(),i.Ta.length>0&&(Bt(Yd,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))})),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,t,n,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=r,this.deferred=new Ru,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,r){const o=Date.now()+n,c=new m1(e,t,o,s,r);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Rt(Ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function g1(i,e){if(Lu("AsyncQueue",`${e}: ${i}`),_g(i))return new Rt(Ye.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{static emptySet(e){return new zm(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Xt.comparator(t.key,n.key):(t,n)=>Xt.comparator(t.key,n.key),this.keyedMap=Wy(),this.sortedSet=new es(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=n.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new zm;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(){this.ga=new es(Xt.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):sn(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Jm{constructor(e,t,n,s,r,o,c,f,p){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,n,s,r){const o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new Jm(e,t,zm.emptySet(t),o,n,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vS(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JH{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class QH{constructor(){this.queries=Ww(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=gn(t),r=s.queries;s.queries=Ww(),r.forEach((o,c)=>{for(const f of c.Sa)f.onError(n)})})(this,new Rt(Ye.ABORTED,"Firestore shutting down"))}}function Ww(){return new sp(i=>XB(i),vS)}async function y1(i,e){const t=gn(i);let n=3;const s=e.query;let r=t.queries.get(s);r?!r.ba()&&e.Da()&&(n=2):(r=new JH,n=e.Da()?0:1);try{switch(n){case 0:r.wa=await t.onListen(s,!0);break;case 1:r.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const c=g1(o,`Initialization of query '${Im(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,r),r.Sa.push(e),e.va(t.onlineState),r.wa&&e.Fa(r.wa)&&v1(t)}async function _1(i,e){const t=gn(i),n=e.query;let s=3;const r=t.queries.get(n);if(r){const o=r.Sa.indexOf(e);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?s=e.Da()?0:1:!r.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function ZH(i,e){const t=gn(i);let n=!1;for(const s of e){const r=s.query,o=t.queries.get(r);if(o){for(const c of o.Sa)c.Fa(s)&&(n=!0);o.wa=s}}n&&v1(t)}function $H(i,e,t){const n=gn(i),s=n.queries.get(e);if(s)for(const r of s.Sa)r.onError(t);n.queries.delete(e)}function v1(i){i.Ca.forEach(e=>{e.next()})}var nM,Yw;(Yw=nM||(nM={})).Ma="default",Yw.Cache="cache";class A1{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Jm(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Jm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nM.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.key=e}}class CN{constructor(e){this.key=e}}class ek{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=zn(),this.mutatedKeys=zn(),this.eu=WB(e),this.tu=new zm(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Xw,s=t?t.tu:this.tu;let r=t?t.mutatedKeys:this.mutatedKeys,o=s,c=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,y)=>{const v=s.get(m),x=AS(this.query,y)?y:null,b=!!v&&this.mutatedKeys.has(v.key),R=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let M=!1;v&&x?v.data.isEqual(x.data)?b!==R&&(n.track({type:3,doc:x}),M=!0):this.su(v,x)||(n.track({type:2,doc:x}),M=!0,(f&&this.eu(x,f)>0||p&&this.eu(x,p)<0)&&(c=!0)):!v&&x?(n.track({type:0,doc:x}),M=!0):v&&!x&&(n.track({type:1,doc:v}),M=!0,(f||p)&&(c=!0)),M&&(x?(o=o.add(x),r=R?r.add(m):r.delete(m)):(o=o.delete(m),r=r.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),r=r.delete(m.key),n.track({type:1,doc:m})}return{tu:o,iu:n,Cs:c,mutatedKeys:r}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((m,y)=>function(x,b){const R=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return sn(20277,{Rt:M})}};return R(x)-R(b)}(m.type,y.type)||this.eu(m.doc,y.doc)),this.ou(n),s=s??!1;const c=t&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,p=f!==this.Za;return this.Za=f,o.length!==0||p?{snapshot:new Jm(this.query,e.tu,r,o,e.mutatedKeys,f===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Xw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=zn(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new CN(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new MN(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=zn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Jm.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const x1="SyncEngine";class tk{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class nk{constructor(e){this.key=e,this.hu=!1}}class ik{constructor(e,t,n,s,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new sp(c=>XB(c),vS),this.Iu=new Map,this.Eu=new Set,this.du=new es(Xt.comparator),this.Au=new Map,this.Ru=new o1,this.Vu={},this.mu=new Map,this.fu=Km.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function sk(i,e,t=!0){const n=NN(i);let s;const r=n.Tu.get(e);return r?(n.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await RN(n,e,t,!0),s}async function rk(i,e){const t=NN(i);await RN(t,e,!0,!1)}async function RN(i,e,t,n){const s=await TH(i.localStore,Sc(e)),r=s.targetId,o=i.sharedClientState.addLocalQueryTarget(r,t);let c;return n&&(c=await ak(i,e,r,o==="current",s.resumeToken)),i.isPrimaryClient&&t&&AN(i.remoteStore,s),c}async function ak(i,e,t,n,s){i.pu=(y,v,x)=>async function(R,M,T,D){let B=M.view.ru(T);B.Cs&&(B=await Vw(R.localStore,M.query,!1).then(({documents:F})=>M.view.ru(F,B)));const L=D&&D.targetChanges.get(M.targetId),G=D&&D.targetMismatches.get(M.targetId)!=null,H=M.view.applyChanges(B,R.isPrimaryClient,L,G);return Jw(R,M.targetId,H.au),H.snapshot}(i,y,v,x);const r=await Vw(i.localStore,e,!0),o=new ek(e,r.Qs),c=o.ru(r.documents),f=X_.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",s),p=o.applyChanges(c,i.isPrimaryClient,f);Jw(i,t,p.au);const m=new tk(e,t,o);return i.Tu.set(e,m),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),p.snapshot}async function ok(i,e,t){const n=gn(i),s=n.Tu.get(e),r=n.Iu.get(s.targetId);if(r.length>1)return n.Iu.set(s.targetId,r.filter(o=>!vS(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await eM(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),t&&h1(n.remoteStore,s.targetId),iM(n,s.targetId)}).catch(yg)):(iM(n,s.targetId),await eM(n.localStore,s.targetId,!0))}async function lk(i,e){const t=gn(i),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),h1(t.remoteStore,n.targetId))}async function ck(i,e,t){const n=gk(i);try{const s=await function(o,c){const f=gn(o),p=Ni.now(),m=c.reduce((x,b)=>x.add(b.key),zn());let y,v;return f.persistence.runTransaction("Locally write mutations","readwrite",x=>{let b=Uu(),R=zn();return f.Ns.getEntries(x,m).next(M=>{b=M,b.forEach((T,D)=>{D.isValidDocument()||(R=R.add(T))})}).next(()=>f.localDocuments.getOverlayedDocuments(x,b)).next(M=>{y=M;const T=[];for(const D of c){const B=bV(D,y.get(D.key).overlayedDocument);B!=null&&T.push(new mf(D.key,B,FB(B.value.mapValue),Ho.exists(!0)))}return f.mutationQueue.addMutationBatch(x,p,T,c)}).next(M=>{v=M;const T=M.applyToLocalDocumentSet(y,R);return f.documentOverlayCache.saveOverlays(x,M.batchId,T)})}).then(()=>({batchId:v.batchId,changes:KB(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,c,f){let p=o.Vu[o.currentUser.toKey()];p||(p=new es(Fn)),p=p.insert(c,f),o.Vu[o.currentUser.toKey()]=p}(n,s.batchId,t),await Y_(n,s.changes),await MS(n.remoteStore)}catch(s){const r=g1(s,"Failed to persist write");t.reject(r)}}async function wN(i,e){const t=gn(i);try{const n=await SH(t.localStore,e);e.targetChanges.forEach((s,r)=>{const o=t.Au.get(r);o&&(oi(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?oi(o.hu,14607):s.removedDocuments.size>0&&(oi(o.hu,42227),o.hu=!1))}),await Y_(t,n,e)}catch(n){await yg(n)}}function Kw(i,e,t){const n=gn(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach((r,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const f=gn(o);f.onlineState=c;let p=!1;f.queries.forEach((m,y)=>{for(const v of y.Sa)v.va(c)&&(p=!0)}),p&&v1(f)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function uk(i,e,t){const n=gn(i);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),r=s&&s.key;if(r){let o=new es(Xt.comparator);o=o.insert(r,Or.newNoDocument(r,dn.min()));const c=zn().add(r),f=new ES(dn.min(),new Map,new es(Fn),o,c);await wN(n,f),n.du=n.du.remove(r),n.Au.delete(e),S1(n)}else await eM(n.localStore,e,!1).then(()=>iM(n,e,t)).catch(yg)}async function hk(i,e){const t=gn(i),n=e.batch.batchId;try{const s=await xH(t.localStore,e);IN(t,n,null),DN(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Y_(t,s)}catch(s){await yg(s)}}async function fk(i,e,t){const n=gn(i);try{const s=await function(o,c){const f=gn(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let m;return f.mutationQueue.lookupMutationBatch(p,c).next(y=>(oi(y!==null,37113),m=y.keys(),f.mutationQueue.removeMutationBatch(p,y))).next(()=>f.mutationQueue.performConsistencyCheck(p)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(p,m,c)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,m)).next(()=>f.localDocuments.getDocuments(p,m))})}(n.localStore,e);IN(n,e,t),DN(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Y_(n,s)}catch(s){await yg(s)}}function DN(i,e){(i.mu.get(e)||[]).forEach(t=>{t.resolve()}),i.mu.delete(e)}function IN(i,e,t){const n=gn(i);let s=n.Vu[n.currentUser.toKey()];if(s){const r=s.get(e);r&&(t?r.reject(t):r.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function iM(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach(n=>{i.Ru.containsKey(n)||BN(i,n)})}function BN(i,e){i.Eu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(h1(i.remoteStore,t),i.du=i.du.remove(e),i.Au.delete(t),S1(i))}function Jw(i,e,t){for(const n of t)n instanceof MN?(i.Ru.addReference(n.key,e),dk(i,n)):n instanceof CN?(Bt(x1,"Document no longer in limbo: "+n.key),i.Ru.removeReference(n.key,e),i.Ru.containsKey(n.key)||BN(i,n.key)):sn(19791,{wu:n})}function dk(i,e){const t=e.key,n=t.path.canonicalString();i.du.get(t)||i.Eu.has(n)||(Bt(x1,"New document in limbo: "+t),i.Eu.add(n),S1(i))}function S1(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new Xt(Mi.fromString(e)),n=i.fu.next();i.Au.set(n,new nk(t)),i.du=i.du.insert(t,n),AN(i.remoteStore,new Wh(Sc(_S(t.path)),n,"TargetPurposeLimboResolution",mS.ce))}}async function Y_(i,e,t){const n=gn(i),s=[],r=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((c,f)=>{o.push(n.pu(f,e,t).then(p=>{if((p||t)&&n.isPrimaryClient){const m=p?!p.fromCache:t?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,m?"current":"not-current")}if(p){s.push(p);const m=c1.As(f.targetId,p);r.push(m)}}))}),await Promise.all(o),n.Pu.H_(s),await async function(f,p){const m=gn(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>$e.forEach(p,v=>$e.forEach(v.Es,x=>m.persistence.referenceDelegate.addReference(y,v.targetId,x)).next(()=>$e.forEach(v.ds,x=>m.persistence.referenceDelegate.removeReference(y,v.targetId,x)))))}catch(y){if(!_g(y))throw y;Bt(u1,"Failed to update sequence numbers: "+y)}for(const y of p){const v=y.targetId;if(!y.fromCache){const x=m.Ms.get(v),b=x.snapshotVersion,R=x.withLastLimboFreeSnapshotVersion(b);m.Ms=m.Ms.insert(v,R)}}}(n.localStore,r))}async function pk(i,e){const t=gn(i);if(!t.currentUser.isEqual(e)){Bt(x1,"User change. New user:",e.toKey());const n=await gN(t.localStore,e);t.currentUser=e,function(r,o){r.mu.forEach(c=>{c.forEach(f=>{f.reject(new Rt(Ye.CANCELLED,o))})}),r.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Y_(t,n.Ls)}}function mk(i,e){const t=gn(i),n=t.Au.get(e);if(n&&n.hu)return zn().add(n.key);{let s=zn();const r=t.Iu.get(e);if(!r)return s;for(const o of r){const c=t.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function NN(i){const e=gn(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=wN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uk.bind(null,e),e.Pu.H_=ZH.bind(null,e.eventManager),e.Pu.yu=$H.bind(null,e.eventManager),e}function gk(i){const e=gn(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fk.bind(null,e),e}class ux{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bS(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return AH(this.persistence,new yH,e.initialUser,this.serializer)}Cu(e){return new mN(l1.mi,this.serializer)}Du(e){return new CH}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ux.provider={build:()=>new ux};class yk extends ux{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){oi(this.persistence.referenceDelegate instanceof lx,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new nH(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?La.withCacheSize(this.cacheSizeBytes):La.DEFAULT;return new mN(n=>lx.mi(n,t),this.serializer)}}class sM{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Kw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=pk.bind(null,this.syncEngine),await KH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new QH}()}createDatastore(e){const t=bS(e.databaseInfo.databaseId),n=function(r){return new BH(r)}(e.databaseInfo);return function(r,o,c,f){return new UH(r,o,c,f)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,s,r,o,c){return new FH(n,s,r,o,c)}(this.localStore,this.datastore,e.asyncQueue,t=>Kw(this.syncEngine,t,0),function(){return Gw.v()?new Gw:new RH}())}createSyncEngine(e,t){return function(s,r,o,c,f,p,m){const y=new ik(s,r,o,c,f,p);return m&&(y.gu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const n=gn(t);Bt(Yd,"RemoteStore shutting down."),n.Ea.add(5),await W_(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}sM.provider={build:()=>new sM};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Lu("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="FirestoreClient";class _k{constructor(e,t,n,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=Br.UNAUTHENTICATED,this.clientId=JM.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,async o=>{Bt(cf,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Bt(cf,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ru;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=g1(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function pb(i,e){i.asyncQueue.verifyOperationInProgress(),Bt(cf,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(async s=>{n.isEqual(s)||(await gN(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e}async function Qw(i,e){i.asyncQueue.verifyOperationInProgress();const t=await vk(i);Bt(cf,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(n=>qw(e.remoteStore,n)),i.setAppCheckTokenChangeListener((n,s)=>qw(e.remoteStore,s)),i._onlineComponents=e}async function vk(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){Bt(cf,"Using user provided OfflineComponentProvider");try{await pb(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ye.FAILED_PRECONDITION||s.code===Ye.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;qm("Error using user provided cache. Falling back to memory cache: "+t),await pb(i,new ux)}}else Bt(cf,"Using default OfflineComponentProvider"),await pb(i,new yk(void 0));return i._offlineComponents}async function ON(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(Bt(cf,"Using user provided OnlineComponentProvider"),await Qw(i,i._uninitializedComponentsProvider._online)):(Bt(cf,"Using default OnlineComponentProvider"),await Qw(i,new sM))),i._onlineComponents}function Ak(i){return ON(i).then(e=>e.syncEngine)}async function hx(i){const e=await ON(i),t=e.eventManager;return t.onListen=sk.bind(null,e.syncEngine),t.onUnlisten=ok.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lk.bind(null,e.syncEngine),t}function xk(i,e,t={}){const n=new Ru;return i.asyncQueue.enqueueAndForget(async()=>function(r,o,c,f,p){const m=new E1({next:v=>{m.Nu(),o.enqueueAndForget(()=>_1(r,y));const x=v.docs.has(c);!x&&v.fromCache?p.reject(new Rt(Ye.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&v.fromCache&&f&&f.source==="server"?p.reject(new Rt(Ye.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(v)},error:v=>p.reject(v)}),y=new A1(_S(c.path),m,{includeMetadataChanges:!0,qa:!0});return y1(r,y)}(await hx(i),i.asyncQueue,e,t,n)),n.promise}function Sk(i,e,t={}){const n=new Ru;return i.asyncQueue.enqueueAndForget(async()=>function(r,o,c,f,p){const m=new E1({next:v=>{m.Nu(),o.enqueueAndForget(()=>_1(r,y)),v.fromCache&&f.source==="server"?p.reject(new Rt(Ye.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(v)},error:v=>p.reject(v)}),y=new A1(c,m,{includeMetadataChanges:!0,qa:!0});return y1(r,y)}(await hx(i),i.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="firestore.googleapis.com",$w=!0;class e2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Rt(Ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UN,this.ssl=$w}else this.host=e.host,this.ssl=e.ssl??$w;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<eH)throw new Rt(Ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LN(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Rt(Ye.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Rt(Ye.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Rt(Ye.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class CS{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new e2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Rt(Ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Rt(Ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new e2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Rz;switch(n.type){case"firstParty":return new Bz(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Rt(Ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Zw.get(t);n&&(Bt("ComponentProvider","Removing Datastore"),Zw.delete(t),n.terminate())}(this),Promise.resolve()}}function Ek(i,e,t,n={}){i=Va(i,CS);const s=Hu(e),r=i._getSettings(),o={...r,emulatorOptions:i._getEmulatorOptions()},c=`${e}:${t}`;s&&(lS(`https://${c}`),cS("Firestore",!0)),r.host!==UN&&r.host!==c&&qm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...r,host:c,ssl:s,emulatorOptions:n};if(!qd(f,o)&&(i._setSettings(f),n.mockUserToken)){let p,m;if(typeof n.mockUserToken=="string")p=n.mockUserToken,m=Br.MOCK_USER;else{p=UI(n.mockUserToken,i._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new Rt(Ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Br(y)}i._authCredentials=new wz(new MB(p,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new gf(this.firestore,e,this._query)}}class cs{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $h(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cs(this.firestore,e,this._key)}toJSON(){return{type:cs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(j_(t,cs._jsonSchema))return new cs(e,n||null,new Xt(Mi.fromString(t.referencePath)))}}cs._jsonSchemaVersion="firestore/documentReference/1.0",cs._jsonSchema={type:Is("string",cs._jsonSchemaVersion),referencePath:Is("string")};class $h extends gf{constructor(e,t,n){super(e,t,_S(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cs(this.firestore,null,new Xt(e))}withConverter(e){return new $h(this.firestore,e,this._path)}}function Yh(i,e,...t){if(i=xi(i),CB("collection","path",e),i instanceof CS){const n=Mi.fromString(e,...t);return dw(n),new $h(i,null,n)}{if(!(i instanceof cs||i instanceof $h))throw new Rt(Ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Mi.fromString(e,...t));return dw(n),new $h(i.firestore,null,n)}}function _c(i,e,...t){if(i=xi(i),arguments.length===1&&(e=JM.newId()),CB("doc","path",e),i instanceof CS){const n=Mi.fromString(e,...t);return fw(n),new cs(i,null,new Xt(n))}{if(!(i instanceof cs||i instanceof $h))throw new Rt(Ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Mi.fromString(e,...t));return fw(n),new cs(i.firestore,i instanceof $h?i.converter:null,new Xt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="AsyncQueue";class n2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _N(this,"async_queue_retry"),this._c=()=>{const n=db();n&&Bt(t2,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=db();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=db();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Ru;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_g(e))throw e;Bt(t2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Lu("INTERNAL UNHANDLED ERROR: ",i2(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=m1.createAndSchedule(this,e,t,n,r=>this.hc(r));return this.tc.push(s),s}uc(){this.nc&&sn(47125,{Pc:i2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function i2(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(i){return function(t,n){if(typeof t!="object"||t===null)return!1;const s=t;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(i,["next","error","complete"])}class Pu extends CS{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new n2,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new n2(e),this._firestoreClient=void 0,await e}}}function bk(i,e){const t=typeof i=="object"?i:uS(),n=typeof i=="string"?i:nx,s=V_(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const r=UM("firestore");r&&Ek(s,...r)}return s}function RS(i){if(i._terminated)throw new Rt(Ye.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||Tk(i),i._firestoreClient}function Tk(i){const e=i._freezeSettings(),t=function(s,r,o,c){return new Kz(s,r,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,LN(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new _k(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Po(mr.fromBase64String(e))}catch(t){throw new Rt(Ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Po(mr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Po._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(j_(e,Po._jsonSchema))return Po.fromBase64String(e.bytes)}}Po._jsonSchemaVersion="firestore/bytes/1.0",Po._jsonSchema={type:Is("string",Po._jsonSchemaVersion),bytes:Is("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Rt(Ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Rt(Ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Rt(Ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Fn(this._lat,e._lat)||Fn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bc._jsonSchemaVersion}}static fromJSON(e){if(j_(e,bc._jsonSchema))return new bc(e.latitude,e.longitude)}}bc._jsonSchemaVersion="firestore/geoPoint/1.0",bc._jsonSchema={type:Is("string",bc._jsonSchemaVersion),latitude:Is("number"),longitude:Is("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let r=0;r<n.length;++r)if(n[r]!==s[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Tc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(j_(e,Tc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Tc(e.vectorValues);throw new Rt(Ye.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tc._jsonSchemaVersion="firestore/vectorValue/1.0",Tc._jsonSchema={type:Is("string",Tc._jsonSchemaVersion),vectorValues:Is("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk=/^__.*__$/;class Ck{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new mf(e,this.data,this.fieldMask,t,this.fieldTransforms):new q_(e,this.data,t,this.fieldTransforms)}}class PN{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new mf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FN(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw sn(40011,{Ac:i})}}class T1{constructor(e,t,n,s,r,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new T1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fx(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(FN(this.Ac)&&Mk.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Rk{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||bS(e)}Cc(e,t,n,s=!1){return new T1({Ac:e,methodName:t,Dc:n,path:pr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function DS(i){const e=i._freezeSettings(),t=bS(i._databaseId);return new Rk(i._databaseId,!!e.ignoreUndefinedProperties,t)}function zN(i,e,t,n,s,r={}){const o=i.Cc(r.merge||r.mergeFields?2:0,e,t,s);M1("Data must be an object, but it was:",o,n);const c=VN(n,o);let f,p;if(r.merge)f=new ao(o.fieldMask),p=o.fieldTransforms;else if(r.mergeFields){const m=[];for(const y of r.mergeFields){const v=rM(e,y,t);if(!o.contains(v))throw new Rt(Ye.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);kN(m,v)||m.push(v)}f=new ao(m),p=o.fieldTransforms.filter(y=>f.covers(y.field))}else f=null,p=o.fieldTransforms;return new Ck(new Pa(c),f,p)}class IS extends b1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof IS}}function wk(i,e,t,n){const s=i.Cc(1,e,t);M1("Data must be an object, but it was:",s,n);const r=[],o=Pa.empty();pf(n,(f,p)=>{const m=C1(e,f,t);p=xi(p);const y=s.yc(m);if(p instanceof IS)r.push(m);else{const v=K_(p,y);v!=null&&(r.push(m),o.set(m,v))}});const c=new ao(r);return new PN(o,c,s.fieldTransforms)}function Dk(i,e,t,n,s,r){const o=i.Cc(1,e,t),c=[rM(e,n,t)],f=[s];if(r.length%2!=0)throw new Rt(Ye.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<r.length;v+=2)c.push(rM(e,r[v])),f.push(r[v+1]);const p=[],m=Pa.empty();for(let v=c.length-1;v>=0;--v)if(!kN(p,c[v])){const x=c[v];let b=f[v];b=xi(b);const R=o.yc(x);if(b instanceof IS)p.push(x);else{const M=K_(b,R);M!=null&&(p.push(x),m.set(x,M))}}const y=new ao(p);return new PN(m,y,o.fieldTransforms)}function Ik(i,e,t,n=!1){return K_(t,i.Cc(n?4:3,e))}function K_(i,e){if(HN(i=xi(i)))return M1("Unsupported field value:",e,i),VN(i,e);if(i instanceof b1)return function(n,s){if(!FN(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const r=[];let o=0;for(const c of n){let f=K_(c,s.wc(o));f==null&&(f={nullValue:"NULL_VALUE"}),r.push(f),o++}return{arrayValue:{values:r}}}(i,e)}return function(n,s){if((n=xi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return _V(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Ni.fromDate(n);return{timestampValue:ox(s.serializer,r)}}if(n instanceof Ni){const r=new Ni(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ox(s.serializer,r)}}if(n instanceof bc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Po)return{bytesValue:oN(s.serializer,n._byteString)};if(n instanceof cs){const r=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(r))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:a1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Tc)return function(o,c){return{mapValue:{fields:{[UB]:{stringValue:PB},[ix]:{arrayValue:{values:o.toArray().map(p=>{if(typeof p!="number")throw c.Sc("VectorValues must only contain numeric values.");return n1(c.serializer,p)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${pS(n)}`)}(i,e)}function VN(i,e){const t={};return DB(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pf(i,(n,s)=>{const r=K_(s,e.mc(n));r!=null&&(t[n]=r)}),{mapValue:{fields:t}}}function HN(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Ni||i instanceof bc||i instanceof Po||i instanceof cs||i instanceof b1||i instanceof Tc)}function M1(i,e,t){if(!HN(t)||!RB(t)){const n=pS(t);throw n==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+n)}}function rM(i,e,t){if((e=xi(e))instanceof wS)return e._internalPath;if(typeof e=="string")return C1(i,e);throw fx("Field path arguments must be of type string or ",i,!1,void 0,t)}const Bk=new RegExp("[~\\*/\\[\\]]");function C1(i,e,t){if(e.search(Bk)>=0)throw fx(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new wS(...e.split("."))._internalPath}catch{throw fx(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function fx(i,e,t,n,s){const r=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let f="";return(r||o)&&(f+=" (found",r&&(f+=` in field ${n}`),o&&(f+=` in document ${s}`),f+=")"),new Rt(Ye.INVALID_ARGUMENT,c+i+f)}function kN(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,t,n,s,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new cs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Nk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(R1("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Nk extends GN{data(){return super.data()}}function R1(i,e){return typeof e=="string"?C1(i,e):e instanceof wS?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jN(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new Rt(Ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class w1{}class qN extends w1{}function XN(i,e,...t){let n=[];e instanceof w1&&n.push(e),n=n.concat(t),function(r){const o=r.filter(f=>f instanceof I1).length,c=r.filter(f=>f instanceof D1).length;if(o>1||o>0&&c>0)throw new Rt(Ye.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)i=s._apply(i);return i}class D1 extends qN{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new D1(e,t,n)}_apply(e){const t=this._parse(e);return YN(e._query,t),new gf(e.firestore,e.converter,YT(e._query,t))}_parse(e){const t=DS(e.firestore);return function(r,o,c,f,p,m,y){let v;if(p.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Rt(Ye.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){a2(y,m);const b=[];for(const R of y)b.push(r2(f,r,R));v={arrayValue:{values:b}}}else v=r2(f,r,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||a2(y,m),v=Ik(c,o,y,m==="in"||m==="not-in");return Ds.create(p,m,v)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class I1 extends w1{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new I1(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:Ml.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,r){let o=s;const c=r.getFlattenedFilters();for(const f of c)YN(o,f),o=YT(o,f)}(e._query,t),new gf(e.firestore,e.converter,YT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class B1 extends qN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new B1(e,t)}_apply(e){const t=function(s,r,o){if(s.startAt!==null)throw new Rt(Ye.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Rt(Ye.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new S_(r,o)}(e._query,this._field,this._direction);return new gf(e.firestore,e.converter,function(s,r){const o=s.explicitOrderBy.concat([r]);return new vg(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function WN(i,e="asc"){const t=e,n=R1("orderBy",i);return B1._create(n,t)}function r2(i,e,t){if(typeof(t=xi(t))=="string"){if(t==="")throw new Rt(Ye.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qB(e)&&t.indexOf("/")!==-1)throw new Rt(Ye.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Mi.fromString(t));if(!Xt.isDocumentKey(n))throw new Rt(Ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return xw(i,new Xt(n))}if(t instanceof cs)return xw(i,t._key);throw new Rt(Ye.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pS(t)}.`)}function a2(i,e){if(!Array.isArray(i)||i.length===0)throw new Rt(Ye.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YN(i,e){const t=function(s,r){for(const o of s)for(const c of o.getFlattenedFilters())if(r.indexOf(c.op)>=0)return c.op;return null}(i.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Rt(Ye.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Rt(Ye.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Ok{convertValue(e,t="none"){switch(of(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ys(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(af(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw sn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return pf(e,(s,r)=>{n[s]=this.convertValue(r,t)}),n}convertVectorValue(e){const t=e.fields?.[ix].arrayValue?.values?.map(n=>ys(n.doubleValue));return new Tc(t)}convertGeoPoint(e){return new bc(ys(e.latitude),ys(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=yS(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(v_(e));default:return null}}convertTimestamp(e){const t=rf(e);return new Ni(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Mi.fromString(e);oi(dN(n),9688,{name:e});const s=new A_(n.get(1),n.get(3)),r=new Xt(n.popFirst(5));return s.isEqual(t)||Lu(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(i,e,t){let n;return n=i?i.toFirestore(e):e,n}class Ky{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zd extends GN{constructor(e,t,n,s,r,o){super(e,t,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new VA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(R1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Rt(Ye.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=zd._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}zd._jsonSchemaVersion="firestore/documentSnapshot/1.0",zd._jsonSchema={type:Is("string",zd._jsonSchemaVersion),bundleSource:Is("string","DocumentSnapshot"),bundleName:Is("string"),bundle:Is("string")};class VA extends zd{data(e={}){return super.data(e)}}class Vd{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Ky(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new VA(this._firestore,this._userDataWriter,n.key,n,new Ky(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Rt(Ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const f=new VA(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ky(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>r||c.type!==3).map(c=>{const f=new VA(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ky(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,m=-1;return c.type!==0&&(p=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:Lk(c.type),doc:f,oldIndex:p,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Rt(Ye.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=JM.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach(r=>{r._document!==null&&(t.push(r._document),n.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Lk(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return sn(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(i){i=Va(i,cs);const e=Va(i.firestore,Pu);return xk(RS(e),i._key).then(t=>JN(e,i,t))}Vd._jsonSchemaVersion="firestore/querySnapshot/1.0",Vd._jsonSchema={type:Is("string",Vd._jsonSchemaVersion),bundleSource:Is("string","QuerySnapshot"),bundleName:Is("string"),bundle:Is("string")};class N1 extends Ok{constructor(e){super(),this.firestore=e}convertBytes(e){return new Po(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cs(this.firestore,null,t)}}function aM(i){i=Va(i,gf);const e=Va(i.firestore,Pu),t=RS(e),n=new N1(e);return jN(i._query),Sk(t,i._query).then(s=>new Vd(e,n,i,s))}function Pk(i,e,t){i=Va(i,cs);const n=Va(i.firestore,Pu),s=KN(i.converter,e);return BS(n,[zN(DS(n),"setDoc",i._key,s,i.converter!==null,t).toMutation(i._key,Ho.none())])}function HA(i,e,t,...n){i=Va(i,cs);const s=Va(i.firestore,Pu),r=DS(s);let o;return o=typeof(e=xi(e))=="string"||e instanceof wS?Dk(r,"updateDoc",i._key,e,t,n):wk(r,"updateDoc",i._key,e),BS(s,[o.toMutation(i._key,Ho.exists(!0))])}function O1(i){return BS(Va(i.firestore,Pu),[new i1(i._key,Ho.none())])}function dx(i,e){const t=Va(i.firestore,Pu),n=_c(i),s=KN(i.converter,e);return BS(t,[zN(DS(i.firestore),"addDoc",n._key,s,i.converter!==null,{}).toMutation(n._key,Ho.exists(!1))]).then(()=>n)}function Fk(i,...e){i=xi(i);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||s2(e[n])||(t=e[n++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(s2(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let r,o,c;if(i instanceof cs)o=Va(i.firestore,Pu),c=_S(i._key.path),r={next:f=>{e[n]&&e[n](JN(o,i,f))},error:e[n+1],complete:e[n+2]};else{const f=Va(i,gf);o=Va(f.firestore,Pu),c=f._query;const p=new N1(o);r={next:m=>{e[n]&&e[n](new Vd(o,p,f,m))},error:e[n+1],complete:e[n+2]},jN(i._query)}return function(p,m,y,v){const x=new E1(v),b=new A1(m,x,y);return p.asyncQueue.enqueueAndForget(async()=>y1(await hx(p),b)),()=>{x.Nu(),p.asyncQueue.enqueueAndForget(async()=>_1(await hx(p),b))}}(RS(o),c,s,r)}function BS(i,e){return function(n,s){const r=new Ru;return n.asyncQueue.enqueueAndForget(async()=>ck(await Ak(n),s,r)),r.promise}(RS(i),e)}function JN(i,e,t){const n=t.docs.get(e._key),s=new N1(i);return new zd(i,s,e._key,n,new Ky(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){gg=s})(ip),nf(new Bu("firestore",(n,{instanceIdentifier:s,options:r})=>{const o=n.getProvider("app").getImmediate(),c=new Pu(new Dz(n.getProvider("auth-internal")),new Nz(o,n.getProvider("app-check-internal")),function(p,m){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Rt(Ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new A_(p.options.projectId,m)}(o,s),o);return r={useFetchStreams:t,...r},c._setSettings(r),c},"PUBLIC").setMultipleInstances(!0)),Vo(lw,cw,e),Vo(lw,cw,"esm2020")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e,t,n,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ro(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||s?.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM="us-central1";class Vk{constructor(e,t,n,s,r=oM,o=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new zk(e,t,n,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(r);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=oM}catch{this.customDomain=null,this.region=r}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Hk(i,e,t){const n=Hu(e);i.emulatorOrigin=`http${n?"s":""}://${e}:${t}`,n&&(lS(i.emulatorOrigin),cS("Functions",!0))}const o2="@firebase/functions",l2="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk="auth-internal",Gk="app-check-internal",jk="messaging-internal";function qk(i){const e=(t,{instanceIdentifier:n})=>{const s=t.getProvider("app").getImmediate(),r=t.getProvider(kk),o=t.getProvider(jk),c=t.getProvider(Gk);return new Vk(s,r,o,c,n)};nf(new Bu(QN,e,"PUBLIC").setMultipleInstances(!0)),Vo(o2,l2,i),Vo(o2,l2,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(i=uS(),e=oM){const n=V_(xi(i),QN).getImmediate({identifier:e}),s=UM("functions");return s&&Wk(n,...s),n}function Wk(i,e,t){Hk(xi(i),e,t)}qk();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="firebasestorage.googleapis.com",$N="storageBucket",Yk=120*1e3,Kk=600*1e3,Jk=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Nc{constructor(e,t,n=0){super(mb(e),`Firebase Storage: ${t} (${mb(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ts.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Oi;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Oi||(Oi={}));function mb(i){return"storage/"+i}function L1(){const i="An unknown error occurred, please check the error payload for server response.";return new ts(Oi.UNKNOWN,i)}function Qk(i){return new ts(Oi.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}function Zk(i){return new ts(Oi.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $k(){const i="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ts(Oi.UNAUTHENTICATED,i)}function eG(){return new ts(Oi.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function tG(i){return new ts(Oi.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}function eO(){return new ts(Oi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tO(){return new ts(Oi.CANCELED,"User canceled the upload/download.")}function nG(i){return new ts(Oi.INVALID_URL,"Invalid URL '"+i+"'.")}function iG(i){return new ts(Oi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function sG(){return new ts(Oi.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+$N+"' property when initializing the app?")}function nO(){return new ts(Oi.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function rG(){return new ts(Oi.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function aG(){return new ts(Oi.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function oG(i){return new ts(Oi.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function lM(i){return new ts(Oi.INVALID_ARGUMENT,i)}function iO(){return new ts(Oi.APP_DELETED,"The Firebase app was deleted.")}function lG(i){return new ts(Oi.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function r_(i,e){return new ts(Oi.INVALID_FORMAT,"String does not match format '"+i+"': "+e)}function Iy(i){throw new ts(Oi.INTERNAL_ERROR,"Internal error: "+i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=ca.makeFromUrl(e,t)}catch{return new ca(e,"")}if(n.path==="")return n;throw iG(e)}static makeFromUrl(e,t){let n=null;const s="([A-Za-z0-9.\\-_]+)";function r(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",c=new RegExp("^gs://"+s+o,"i"),f={bucket:1,path:3};function p(L){L.path_=decodeURIComponent(L.path)}const m="v[A-Za-z0-9_]+",y=t.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",x=new RegExp(`^https?://${y}/${m}/b/${s}/o${v}`,"i"),b={bucket:1,path:3},R=t===ZN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,M="([^?#]*)",T=new RegExp(`^https?://${R}/${s}/${M}`,"i"),B=[{regex:c,indices:f,postModify:r},{regex:x,indices:b,postModify:p},{regex:T,indices:{bucket:1,path:2},postModify:p}];for(let L=0;L<B.length;L++){const G=B[L],H=G.regex.exec(e);if(H){const F=H[G.indices.bucket];let U=H[G.indices.path];U||(U=""),n=new ca(F,U),G.postModify(n);break}}if(n==null)throw nG(e);return n}}class cG{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uG(i,e,t){let n=1,s=null,r=null,o=!1,c=0;function f(){return c===2}let p=!1;function m(...M){p||(p=!0,e.apply(null,M))}function y(M){s=setTimeout(()=>{s=null,i(x,f())},M)}function v(){r&&clearTimeout(r)}function x(M,...T){if(p){v();return}if(M){v(),m.call(null,M,...T);return}if(f()||o){v(),m.call(null,M,...T);return}n<64&&(n*=2);let B;c===1?(c=2,B=0):B=(n+Math.random())*1e3,y(B)}let b=!1;function R(M){b||(b=!0,v(),!p&&(s!==null?(M||(c=2),clearTimeout(s),y(0)):M||(c=1)))}return y(0),r=setTimeout(()=>{o=!0,R(!0)},t),R}function hG(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fG(i){return i!==void 0}function dG(i){return typeof i=="function"}function pG(i){return typeof i=="object"&&!Array.isArray(i)}function NS(i){return typeof i=="string"||i instanceof String}function c2(i){return U1()&&i instanceof Blob}function U1(){return typeof Blob<"u"}function cM(i,e,t,n){if(n<e)throw lM(`Invalid value for '${i}'. Expected ${e} or greater.`);if(n>t)throw lM(`Invalid value for '${i}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(i,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${i}`}function sO(i){const e=encodeURIComponent;let t="?";for(const n in i)if(i.hasOwnProperty(n)){const s=e(n)+"="+e(i[n]);t=t+s+"&"}return t=t.slice(0,-1),t}var Hd;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(Hd||(Hd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(i,e){const t=i>=500&&i<600,s=[408,429].indexOf(i)!==-1,r=e.indexOf(i)!==-1;return t||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mG{constructor(e,t,n,s,r,o,c,f,p,m,y,v=!0,x=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=f,this.timeout_=p,this.progressCallback_=m,this.connectionFactory_=y,this.retry=v,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,R)=>{this.resolve_=b,this.reject_=R,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new w0(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=c=>{const f=c.loaded,p=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,p)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const c=r.getErrorCode()===Hd.NO_ERROR,f=r.getStatus();if(!c||rO(f,this.additionalRetryCodes_)&&this.retry){const m=r.getErrorCode()===Hd.ABORT;n(!1,new w0(!1,null,m));return}const p=this.successCodes_.indexOf(f)!==-1;n(!0,new w0(p,r))})},t=(n,s)=>{const r=this.resolve_,o=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const f=this.callback_(c,c.getResponse());fG(f)?r(f):r()}catch(f){o(f)}else if(c!==null){const f=L1();f.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,f)):o(f)}else if(s.canceled){const f=this.appDelete_?iO():tO();o(f)}else{const f=eO();o(f)}};this.canceled_?t(!1,new w0(!1,null,!0)):this.backoffId_=uG(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&hG(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class w0{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function gG(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function yG(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _G(i,e){e&&(i["X-Firebase-GMPID"]=e)}function vG(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function AG(i,e,t,n,s,r,o=!0,c=!1){const f=sO(i.urlParams),p=i.url+f,m=Object.assign({},i.headers);return _G(m,e),gG(m,t),yG(m,r),vG(m,n),new mG(p,i.method,m,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,s,o,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xG(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function SG(...i){const e=xG();if(e!==void 0){const t=new e;for(let n=0;n<i.length;n++)t.append(i[n]);return t.getBlob()}else{if(U1())return new Blob(i);throw new ts(Oi.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function EG(i,e,t){return i.webkitSlice?i.webkitSlice(e,t):i.mozSlice?i.mozSlice(e,t):i.slice?i.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bG(i){if(typeof atob>"u")throw oG("base-64");return atob(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class gb{constructor(e,t){this.data=e,this.contentType=t||null}}function TG(i,e){switch(i){case vc.RAW:return new gb(aO(e));case vc.BASE64:case vc.BASE64URL:return new gb(oO(i,e));case vc.DATA_URL:return new gb(CG(e),RG(e))}throw L1()}function aO(i){const e=[];for(let t=0;t<i.length;t++){let n=i.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<i.length-1&&(i.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const r=n,o=i.charCodeAt(++t);n=65536|(r&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function MG(i){let e;try{e=decodeURIComponent(i)}catch{throw r_(vc.DATA_URL,"Malformed data URL.")}return aO(e)}function oO(i,e){switch(i){case vc.BASE64:{const s=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(s||r)throw r_(i,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case vc.BASE64URL:{const s=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(s||r)throw r_(i,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=bG(e)}catch(s){throw s.message.includes("polyfill")?s:r_(i,"Invalid character found")}const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}class lO{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw r_(vc.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=wG(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function CG(i){const e=new lO(i);return e.base64?oO(vc.BASE64,e.rest):MG(e.rest)}function RG(i){return new lO(i).contentType}function wG(i,e){return i.length>=e.length?i.substring(i.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,t){let n=0,s="";c2(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(c2(this.data_)){const n=this.data_,s=EG(n,e,t);return s===null?null:new Su(s)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Su(n,!0)}}static getBlob(...e){if(U1()){const t=e.map(n=>n instanceof Su?n.data_:n);return new Su(SG.apply(null,t))}else{const t=e.map(o=>NS(o)?TG(vc.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const s=new Uint8Array(n);let r=0;return t.forEach(o=>{for(let c=0;c<o.length;c++)s[r++]=o[c]}),new Su(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(i){let e;try{e=JSON.parse(i)}catch{return null}return pG(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DG(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function IG(i,e){const t=e.split("/").filter(n=>n.length>0).join("/");return i.length===0?t:i+"/"+t}function cO(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BG(i,e){return e}class ia{constructor(e,t,n,s){this.server=e,this.local=t||e,this.writable=!!n,this.xform=s||BG}}let D0=null;function NG(i){return!NS(i)||i.length<2?i:cO(i)}function OS(){if(D0)return D0;const i=[];i.push(new ia("bucket")),i.push(new ia("generation")),i.push(new ia("metageneration")),i.push(new ia("name","fullPath",!0));function e(r,o){return NG(o)}const t=new ia("name");t.xform=e,i.push(t);function n(r,o){return o!==void 0?Number(o):o}const s=new ia("size");return s.xform=n,i.push(s),i.push(new ia("timeCreated")),i.push(new ia("updated")),i.push(new ia("md5Hash",null,!0)),i.push(new ia("cacheControl",null,!0)),i.push(new ia("contentDisposition",null,!0)),i.push(new ia("contentEncoding",null,!0)),i.push(new ia("contentLanguage",null,!0)),i.push(new ia("contentType",null,!0)),i.push(new ia("metadata","customMetadata",!0)),D0=i,D0}function OG(i,e){function t(){const n=i.bucket,s=i.fullPath,r=new ca(n,s);return e._makeStorageReference(r)}Object.defineProperty(i,"ref",{get:t})}function LG(i,e,t){const n={};n.type="file";const s=t.length;for(let r=0;r<s;r++){const o=t[r];n[o.local]=o.xform(n,e[o.server])}return OG(n,i),n}function uO(i,e,t){const n=P1(e);return n===null?null:LG(i,n,t)}function UG(i,e,t,n){const s=P1(e);if(s===null||!NS(s.downloadTokens))return null;const r=s.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(p=>{const m=i.bucket,y=i.fullPath,v="/b/"+o(m)+"/o/"+o(y),x=ap(v,t,n),b=sO({alt:"media",token:p});return x+b})[0]}function hO(i,e){const t={},n=e.length;for(let s=0;s<n;s++){const r=e[s];r.writable&&(t[r.server]=i[r.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="prefixes",h2="items";function PG(i,e,t){const n={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[u2])for(const s of t[u2]){const r=s.replace(/\/$/,""),o=i._makeStorageReference(new ca(e,r));n.prefixes.push(o)}if(t[h2])for(const s of t[h2]){const r=i._makeStorageReference(new ca(e,s.name));n.items.push(r)}return n}function FG(i,e,t){const n=P1(t);return n===null?null:PG(i,e,n)}class yf{constructor(e,t,n,s){this.url=e,this.method=t,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(i){if(!i)throw L1()}function F1(i,e){function t(n,s){const r=uO(i,s,e);return Mc(r!==null),r}return t}function zG(i,e){function t(n,s){const r=FG(i,e,s);return Mc(r!==null),r}return t}function VG(i,e){function t(n,s){const r=uO(i,s,e);return Mc(r!==null),UG(r,s,i.host,i._protocol)}return t}function xg(i){function e(t,n){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=eG():s=$k():t.getStatus()===402?s=Zk(i.bucket):t.getStatus()===403?s=tG(i.path):s=n,s.status=t.getStatus(),s.serverResponse=n.serverResponse,s}return e}function z1(i){const e=xg(i);function t(n,s){let r=e(n,s);return n.getStatus()===404&&(r=Qk(i.path)),r.serverResponse=s.serverResponse,r}return t}function fO(i,e,t){const n=e.fullServerUrl(),s=ap(n,i.host,i._protocol),r="GET",o=i.maxOperationRetryTime,c=new yf(s,r,F1(i,t),o);return c.errorHandler=z1(e),c}function HG(i,e,t,n,s){const r={};e.isRoot?r.prefix="":r.prefix=e.path+"/",t.length>0&&(r.delimiter=t),n&&(r.pageToken=n),s&&(r.maxResults=s);const o=e.bucketOnlyServerUrl(),c=ap(o,i.host,i._protocol),f="GET",p=i.maxOperationRetryTime,m=new yf(c,f,zG(i,e.bucket),p);return m.urlParams=r,m.errorHandler=xg(e),m}function kG(i,e,t){const n=e.fullServerUrl(),s=ap(n,i.host,i._protocol),r="GET",o=i.maxOperationRetryTime,c=new yf(s,r,VG(i,t),o);return c.errorHandler=z1(e),c}function GG(i,e){const t=e.fullServerUrl(),n=ap(t,i.host,i._protocol),s="DELETE",r=i.maxOperationRetryTime;function o(f,p){}const c=new yf(n,s,o,r);return c.successCodes=[200,204],c.errorHandler=z1(e),c}function jG(i,e){return i&&i.contentType||e&&e.type()||"application/octet-stream"}function dO(i,e,t){const n=Object.assign({},t);return n.fullPath=i.path,n.size=e.size(),n.contentType||(n.contentType=jG(null,e)),n}function pO(i,e,t,n,s){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function c(){let B="";for(let L=0;L<2;L++)B=B+Math.random().toString().slice(2);return B}const f=c();o["Content-Type"]="multipart/related; boundary="+f;const p=dO(e,n,s),m=hO(p,t),y="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+m+`\r
--`+f+`\r
Content-Type: `+p.contentType+`\r
\r
`,v=`\r
--`+f+"--",x=Su.getBlob(y,n,v);if(x===null)throw nO();const b={name:p.fullPath},R=ap(r,i.host,i._protocol),M="POST",T=i.maxUploadRetryTime,D=new yf(R,M,F1(i,t),T);return D.urlParams=b,D.headers=o,D.body=x.uploadData(),D.errorHandler=xg(e),D}class px{constructor(e,t,n,s){this.current=e,this.total=t,this.finalized=!!n,this.metadata=s||null}}function V1(i,e){let t=null;try{t=i.getResponseHeader("X-Goog-Upload-Status")}catch{Mc(!1)}return Mc(!!t&&(e||["active"]).indexOf(t)!==-1),t}function qG(i,e,t,n,s){const r=e.bucketOnlyServerUrl(),o=dO(e,n,s),c={name:o.fullPath},f=ap(r,i.host,i._protocol),p="POST",m={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},y=hO(o,t),v=i.maxUploadRetryTime;function x(R){V1(R);let M;try{M=R.getResponseHeader("X-Goog-Upload-URL")}catch{Mc(!1)}return Mc(NS(M)),M}const b=new yf(f,p,x,v);return b.urlParams=c,b.headers=m,b.body=y,b.errorHandler=xg(e),b}function XG(i,e,t,n){const s={"X-Goog-Upload-Command":"query"};function r(p){const m=V1(p,["active","final"]);let y=null;try{y=p.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Mc(!1)}y||Mc(!1);const v=Number(y);return Mc(!isNaN(v)),new px(v,n.size(),m==="final")}const o="POST",c=i.maxUploadRetryTime,f=new yf(t,o,r,c);return f.headers=s,f.errorHandler=xg(e),f}const f2=256*1024;function WG(i,e,t,n,s,r,o,c){const f=new px(0,0);if(o?(f.current=o.current,f.total=o.total):(f.current=0,f.total=n.size()),n.size()!==f.total)throw rG();const p=f.total-f.current;let m=p;s>0&&(m=Math.min(m,s));const y=f.current,v=y+m;let x="";m===0?x="finalize":p===m?x="upload, finalize":x="upload";const b={"X-Goog-Upload-Command":x,"X-Goog-Upload-Offset":`${f.current}`},R=n.slice(y,v);if(R===null)throw nO();function M(L,G){const H=V1(L,["active","final"]),F=f.current+m,U=n.size();let I;return H==="final"?I=F1(e,r)(L,G):I=null,new px(F,U,H==="final",I)}const T="POST",D=e.maxUploadRetryTime,B=new yf(t,T,M,D);return B.headers=b,B.body=R.uploadData(),B.progressCallback=c||null,B.errorHandler=xg(i),B}const Ua={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function yb(i){switch(i){case"running":case"pausing":case"canceling":return Ua.RUNNING;case"paused":return Ua.PAUSED;case"success":return Ua.SUCCESS;case"canceled":return Ua.CANCELED;case"error":return Ua.ERROR;default:return Ua.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YG{constructor(e,t,n){if(dG(e)||t!=null||n!=null)this.next=e,this.error=t??void 0,this.complete=n??void 0;else{const r=e;this.next=r.next,this.error=r.error,this.complete=r.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(i){return(...e)=>{Promise.resolve().then(()=>i(...e))}}class KG{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hd.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hd.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hd.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,s,r){if(this.sent_)throw Iy("cannot .send() more than once");if(Hu(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),r!==void 0)for(const o in r)r.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,r[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Iy("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Iy("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Iy("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Iy("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class JG extends KG{initXhr(){this.xhr_.responseType="text"}}function yc(){return new JG}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QG{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=OS(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Oi.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const r=this.isExponentialBackoffExpired();if(rO(s.status,[]))if(r)s=eO();else{this.sleepTime=Math.max(this.sleepTime*2,Jk),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Oi.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,r)=>{this._resolve=s,this._reject=r,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const n=qG(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(n,yc,e,t);this._request=s,s.getPromise().then(r=>{this._request=void 0,this._uploadUrl=r,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,n)=>{const s=XG(this._ref.storage,this._ref._location,e,this._blob),r=this._ref.storage._makeRequest(s,yc,t,n);this._request=r,r.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=f2*this._chunkMultiplier,t=new px(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((s,r)=>{let o;try{o=WG(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(f){this._error=f,this._transition("error");return}const c=this._ref.storage._makeRequest(o,yc,s,r,!1);this._request=c,c.getPromise().then(f=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(f.current),f.finalized?(this._metadata=f.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){f2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const n=fO(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(n,yc,e,t);this._request=s,s.getPromise().then(r=>{this._request=void 0,this._metadata=r,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const n=pO(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(n,yc,e,t);this._request=s,s.getPromise().then(r=>{this._request=void 0,this._metadata=r,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=tO(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=yb(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,s){const r=new YG(t||void 0,n||void 0,s||void 0);return this._addObserver(r),()=>{this._removeObserver(r)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(yb(this._state)){case Ua.SUCCESS:rm(this._resolve.bind(null,this.snapshot))();break;case Ua.CANCELED:case Ua.ERROR:const t=this._reject;rm(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(yb(this._state)){case Ua.RUNNING:case Ua.PAUSED:e.next&&rm(e.next.bind(e,this.snapshot))();break;case Ua.SUCCESS:e.complete&&rm(e.complete.bind(e))();break;case Ua.CANCELED:case Ua.ERROR:e.error&&rm(e.error.bind(e,this._error))();break;default:e.error&&rm(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,t){this._service=e,t instanceof ca?this._location=t:this._location=ca.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kd(e,t)}get root(){const e=new ca(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cO(this._location.path)}get storage(){return this._service}get parent(){const e=DG(this._location.path);if(e===null)return null;const t=new ca(this._location.bucket,e);return new Kd(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw lG(e)}}function ZG(i,e,t){i._throwIfRoot("uploadBytes");const n=pO(i.storage,i._location,OS(),new Su(e,!0),t);return i.storage.makeRequestWithTokens(n,yc).then(s=>({metadata:s,ref:i}))}function $G(i,e,t){return i._throwIfRoot("uploadBytesResumable"),new QG(i,new Su(e),t)}function e9(i){const e={prefixes:[],items:[]};return mO(i,e).then(()=>e)}async function mO(i,e,t){const s=await t9(i,{pageToken:t});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await mO(i,e,s.nextPageToken)}function t9(i,e){e!=null&&typeof e.maxResults=="number"&&cM("options.maxResults",1,1e3,e.maxResults);const t=e||{},n=HG(i.storage,i._location,"/",t.pageToken,t.maxResults);return i.storage.makeRequestWithTokens(n,yc)}function n9(i){i._throwIfRoot("getMetadata");const e=fO(i.storage,i._location,OS());return i.storage.makeRequestWithTokens(e,yc)}function i9(i){i._throwIfRoot("getDownloadURL");const e=kG(i.storage,i._location,OS());return i.storage.makeRequestWithTokens(e,yc).then(t=>{if(t===null)throw aG();return t})}function s9(i){i._throwIfRoot("deleteObject");const e=GG(i.storage,i._location);return i.storage.makeRequestWithTokens(e,yc)}function r9(i,e){const t=IG(i._location.path,e),n=new ca(i._location.bucket,t);return new Kd(i.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a9(i){return/^[A-Za-z]+:\/\//.test(i)}function o9(i,e){return new Kd(i,e)}function gO(i,e){if(i instanceof H1){const t=i;if(t._bucket==null)throw sG();const n=new Kd(t,t._bucket);return e!=null?gO(n,e):n}else return e!==void 0?r9(i,e):i}function l9(i,e){if(e&&a9(e)){if(i instanceof H1)return o9(i,e);throw lM("To use ref(service, url), the first argument must be a Storage instance.")}else return gO(i,e)}function d2(i,e){const t=e?.[$N];return t==null?null:ca.makeFromBucketSpec(t,i)}function c9(i,e,t,n={}){i.host=`${e}:${t}`;const s=Hu(e);s&&(lS(`https://${i.host}/b`),cS("Storage",!0)),i._isUsingEmulator=!0,i._protocol=s?"https":"http";const{mockUserToken:r}=n;r&&(i._overrideAuthToken=typeof r=="string"?r:UI(r,i.app.options.projectId))}class H1{constructor(e,t,n,s,r,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=r,this._isUsingEmulator=o,this._bucket=null,this._host=ZN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Yk,this._maxUploadRetryTime=Kk,this._requests=new Set,s!=null?this._bucket=ca.makeFromBucketSpec(s,this._host):this._bucket=d2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ca.makeFromBucketSpec(this._url,e):this._bucket=d2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cM("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cM("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ro(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kd(this,e)}_makeRequest(e,t,n,s,r=!0){if(this._deleted)return new cG(iO());{const o=AG(e,this._appId,n,s,t,this._firebaseVersion,r,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,s).getPromise()}}const p2="@firebase/storage",m2="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO="storage";function u9(i,e,t){return i=xi(i),ZG(i,e,t)}function h9(i,e,t){return i=xi(i),$G(i,e,t)}function g2(i){return i=xi(i),n9(i)}function y2(i){return i=xi(i),e9(i)}function _O(i){return i=xi(i),i9(i)}function vO(i){return i=xi(i),s9(i)}function Qm(i,e){return i=xi(i),l9(i,e)}function f9(i=uS(),e){i=xi(i);const n=V_(i,yO).getImmediate({identifier:e}),s=UM("storage");return s&&d9(n,...s),n}function d9(i,e,t,n={}){c9(i,e,t,n)}function p9(i,{instanceIdentifier:e}){const t=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),s=i.getProvider("app-check-internal");return new H1(t,n,s,e,ip)}function m9(){nf(new Bu(yO,p9,"PUBLIC").setMultipleInstances(!0)),Vo(p2,m2,""),Vo(p2,m2,"esm2020")}m9();const g9={apiKey:"AIzaSyAiJN6RqcyiETRswL-sW4QXVfC1InrspE8",authDomain:"isthishenry-99ba6.firebaseapp.com",projectId:"isthishenry-99ba6",storageBucket:"isthishenry-99ba6.firebasestorage.app",messagingSenderId:"699151675972",appId:"1:699151675972:web:dc34890ae46310d42c4211"},LS=zI(g9),oa=bz(LS),AO=new xu;AO.addScope("https://www.googleapis.com/auth/calendar.readonly");const dr=bk(LS);Xk(LS);const Zm=f9(LS),ot={desktop:"#b7b7b7",windowBg:"#c0c0c0",windowHeader:"#b7b7b7",text:"#000000",textLight:"#ffffff",borderLight:"#dfdfdf",borderDark:"#404040",button:"#c0c0c0"},Zi=({children:i,style:e={},disabled:t=!1,active:n=!1,...s})=>{const[r,o]=ue.useState(!1);return ie.jsx("button",{disabled:t,onMouseDown:()=>o(!0),onMouseUp:()=>o(!1),onMouseLeave:()=>o(!1),style:{background:ot.button,border:"2px solid",borderColor:r||n?`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`:`${ot.borderLight} ${ot.borderDark} ${ot.borderDark} ${ot.borderLight}`,padding:"4px 8px",fontFamily:"'Pixelify Sans', monospace",fontSize:"12px",cursor:"pointer",userSelect:"none",color:t?"#808080":ot.text,...e},...s,children:i})},y9=({title:i,children:e,onClose:t,style:n={}})=>ie.jsxs("div",{style:{background:ot.windowBg,border:"2px solid",borderColor:`${ot.borderLight} ${ot.borderDark} ${ot.borderDark} ${ot.borderLight}`,height:"100%",display:"flex",flexDirection:"column",fontFamily:"'Pixelify Sans', monospace",fontSize:"12px",...n},children:[ie.jsxs("div",{style:{background:ot.windowHeader,color:ot.text,padding:"2px 4px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none",fontFamily:"'Jacquard 12', monospace"},children:[ie.jsx("span",{style:{fontWeight:"bold"},children:i}),t&&ie.jsx(Zi,{onClick:t,style:{width:"20px",height:"20px",padding:0,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Arial",lineHeight:"1"},children:""})]}),ie.jsx("div",{style:{flex:1,padding:"8px",overflow:"auto",color:ot.text},children:e})]}),xO=({id:i,title:e,position:t,size:n,onPositionChange:s,onSizeChange:r,onClose:o,children:c,zIndex:f})=>{const[p,m]=ue.useState(!1),[y,v]=ue.useState(!1),[x,b]=ue.useState({x:0,y:0}),[R,M]=ue.useState(""),[T,D]=ue.useState({x:0,y:0,width:0,height:0}),B=ue.useRef(null),L=U=>{U.target.closest("button")||U.target.closest(".resize-handle")||(m(!0),b({x:U.clientX-t.x,y:U.clientY-t.y}))},G=U=>{U.stopPropagation();const I=U.target,N=I.classList.contains("resize-se")?"se":I.classList.contains("resize-e")?"e":I.classList.contains("resize-s")?"s":"se";v(!0),M(N),D({x:U.clientX,y:U.clientY,width:n.width,height:n.height})},H=ue.useCallback(U=>{if(p)s(i,{x:U.clientX-x.x,y:U.clientY-x.y});else if(y){const I=U.clientX-T.x,N=U.clientY-T.y;let z=n.width,W=n.height;R.includes("e")&&(z=Math.max(200,T.width+I)),R.includes("s")&&(W=Math.max(150,T.height+N)),r(i,{width:z,height:W})}},[p,y,x.x,x.y,T,R,i,s,r,n.width,n.height]),F=ue.useCallback(()=>{m(!1),v(!1),M("")},[]);return ue.useEffect(()=>{if(p||y)return document.addEventListener("mousemove",H),document.addEventListener("mouseup",F),()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",F)}},[p,y,H,F]),ie.jsxs("div",{ref:B,style:{position:"absolute",left:t.x,top:t.y,width:n.width,height:n.height,zIndex:f,cursor:p?"move":"default",pointerEvents:"auto",outline:y?"2px dashed #0000ff":"none"},onMouseDown:L,children:[ie.jsx(y9,{title:e,onClose:()=>o(i),children:c}),ie.jsx("div",{className:"resize-handle resize-se",style:{position:"absolute",bottom:0,right:0,width:"12px",height:"12px",cursor:"se-resize",background:"transparent",userSelect:"none",zIndex:1e3,pointerEvents:"auto"},onMouseDown:G}),ie.jsx("div",{className:"resize-handle resize-e",style:{position:"absolute",top:"20px",right:0,width:"6px",height:"calc(100% - 32px)",cursor:"e-resize",userSelect:"none",zIndex:999,pointerEvents:"auto",background:"transparent"},onMouseDown:G}),ie.jsx("div",{className:"resize-handle resize-s",style:{position:"absolute",bottom:0,left:"20px",width:"calc(100% - 32px)",height:"6px",cursor:"s-resize",userSelect:"none",zIndex:999,pointerEvents:"auto",background:"transparent"},onMouseDown:G})]})},uM=({style:i={},...e})=>ie.jsx("input",{type:"text",style:{background:ot.textLight,border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,padding:"4px",fontFamily:"'Pixelify Sans', monospace",fontSize:"12px",outline:"none",...i},...e}),SO=({style:i={},...e})=>ie.jsx("textarea",{style:{background:ot.textLight,border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,padding:"4px",fontFamily:"'Pixelify Sans', monospace",fontSize:"12px",resize:"none",outline:"none",...i},...e}),_9=({children:i,style:e={},...t})=>ie.jsx("select",{style:{background:ot.textLight,border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,padding:"4px",fontFamily:"'Pixelify Sans', monospace",fontSize:"12px",outline:"none",...e},...t,children:i}),v9=({isActive:i,duration:e=1e3})=>{const[t,n]=ue.useState(0),[s,r]=ue.useState(!1),[o,c]=ue.useState(!1);ue.useEffect(()=>{if(!i){t>0&&(n(100),r(!0),c(!0),setTimeout(()=>{c(!1),r(!1),n(0)},2e3));return}r(!1),c(!1);const m=Date.now(),y=()=>{const v=Date.now()-m,x=Math.min(v/e*100,100);n(x),x<100&&i&&requestAnimationFrame(y)};y()},[i,e,t]);const f=()=>o||s?"#00aa00":i&&t>0?"#0080ff":"#00aa00",p=()=>o||s&&!i?"":i&&t>0?"":"";return ie.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,fontSize:"10px",fontFamily:"'Pixelify Sans', monospace",backgroundColor:"#c0c0c0",minWidth:"50px",height:"20px"},title:i?"Syncing changes...":"All changes synced",children:[ie.jsx("span",{style:{color:f(),fontSize:"12px",fontWeight:"bold"},children:p()}),ie.jsx("div",{style:{flex:1,height:"6px",background:"#808080",border:"1px inset #c0c0c0",overflow:"hidden"},children:ie.jsx("div",{style:{width:i?`${t}%`:"100%",height:"100%",background:f(),transition:i?"none":"width 0.3s ease"}})})]})},A9=()=>{const[i,e]=ue.useState({isActive:!1,pendingOperations:0}),t=ue.useRef(null),n=ue.useCallback(()=>{e(r=>({isActive:!0,pendingOperations:r.pendingOperations+1})),t.current&&clearTimeout(t.current)},[]),s=ue.useCallback(()=>{e(r=>{const o=Math.max(0,r.pendingOperations-1);return o===0&&(t.current=setTimeout(()=>{e(c=>({...c,isActive:!1}))},100)),{isActive:r.isActive,pendingOperations:o}})},[]);return{isActive:i.isActive,startSync:n,endSync:s}},EO=ue.createContext(void 0),x9=({children:i})=>{const e=A9(),[t]=ue.useState(()=>new Set),s={...e,onStorageChange:()=>{t.forEach(r=>r())},storageChangeListeners:t};return ie.jsx(EO.Provider,{value:s,children:i})},J_=()=>{const i=ue.useContext(EO);if(i===void 0)throw new Error("useSyncContext must be used within a SyncProvider");return i},S9=()=>{const[i,e]=ue.useState(null),{storageChangeListeners:t}=J_(),[n,s]=ue.useState({totalBytes:0,imageBytes:0,modelBytes:0,imageCount:0,modelCount:0,isLoading:!0,error:null});ue.useEffect(()=>oB(oa,f=>{e(f)}),[]);const r=ue.useCallback(async()=>{if(!i){s(c=>({...c,totalBytes:0,imageBytes:0,modelBytes:0,imageCount:0,modelCount:0,isLoading:!1,error:null}));return}try{s(v=>({...v,isLoading:!0,error:null}));let c=0,f=0,p=0,m=0;try{const v=Qm(Zm,`desktop-images/${i.uid}`),x=await y2(v);for(const b of x.items)try{const R=await g2(b);c+=R.size||0,p++}catch(R){console.warn("Could not get metadata for image:",b.name,R)}}catch(v){v?.code==="storage/object-not-found"||v?.code==="storage/unauthorized"?console.log("No images folder found or no permission - this is normal for new users"):console.warn("Could not list images:",v)}try{const v=Qm(Zm,`desktop-3d-models/${i.uid}`),x=await y2(v);for(const b of x.items)try{const R=await g2(b);f+=R.size||0,m++}catch(R){console.warn("Could not get metadata for model:",b.name,R)}}catch(v){v?.code==="storage/object-not-found"||v?.code==="storage/unauthorized"?console.log("No models folder found or no permission - this is normal for new users"):console.warn("Could not list models:",v)}const y=c+f;s({totalBytes:y,imageBytes:c,modelBytes:f,imageCount:p,modelCount:m,isLoading:!1,error:null})}catch(c){console.error("Error calculating storage usage:",c),s(f=>({...f,isLoading:!1,error:c instanceof Error?c.message:"Failed to calculate storage usage"}))}},[i]);ue.useEffect(()=>{if(i){const c=setTimeout(()=>{r()},1e3);return()=>clearTimeout(c)}else r()},[r,i]),ue.useEffect(()=>(t.add(r),()=>{t.delete(r)}),[t,r]);const o=ue.useCallback(c=>{if(c===0)return"0 B";const f=1024,p=["B","KB","MB","GB"],m=Math.floor(Math.log(c)/Math.log(f));return parseFloat((c/Math.pow(f,m)).toFixed(1))+" "+p[m]},[]);return{...n,formatBytes:o,refreshUsage:r}},E9=()=>{const{totalBytes:i,imageCount:e,modelCount:t,isLoading:n,error:s,formatBytes:r}=S9();if(s)return ie.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,fontSize:"10px",fontFamily:"'Pixelify Sans', monospace",backgroundColor:"#c0c0c0",minWidth:"60px",height:"20px",color:"#800000"},title:`Storage Error: ${s}`,children:[ie.jsx("span",{children:""}),ie.jsx("span",{children:"Error"})]});if(n)return ie.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,fontSize:"10px",fontFamily:"'Pixelify Sans', monospace",backgroundColor:"#c0c0c0",minWidth:"60px",height:"20px"},title:"Loading storage usage...",children:[ie.jsx("span",{children:""}),ie.jsx("span",{children:"..."})]});const o=e+t,c=o>0?`Storage Usage:
${r(i)} total
${e} images, ${t} 3D models`:`Storage Usage:
No files uploaded yet
Drag & drop images or GLB files to start`;return ie.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,fontSize:"10px",fontFamily:"'Pixelify Sans', monospace",backgroundColor:"#c0c0c0",minWidth:"70px",height:"20px",color:"#000000"},title:c,children:[ie.jsx("span",{style:{fontSize:"11px"},children:""}),ie.jsx("span",{style:{fontWeight:"bold"},children:i>0?r(i):"0 B"}),o>0&&ie.jsxs("span",{style:{color:"#666666",fontSize:"9px"},children:["(",o,")"]})]})},b9=({windows:i,activeWindow:e,onAddWindow:t,onFocusWindow:n,onSaveLayout:s,onClearAll:r,onLogout:o,currentTime:c})=>{const{isActive:f}=J_();return ie.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:"32px",background:ot.windowBg,borderTop:`2px solid ${ot.borderLight}`,display:"flex",alignItems:"center",padding:"2px",gap:"4px",zIndex:2e3},children:[ie.jsx(Zi,{onClick:()=>t("search"),title:"Search",children:""}),ie.jsx(Zi,{onClick:()=>t("rss"),title:"RSS Feed",children:""}),ie.jsx(Zi,{onClick:()=>t("notes"),title:"Notes",children:""}),ie.jsx(Zi,{onClick:()=>t("ai"),title:"AI Launcher",children:""}),ie.jsx(Zi,{onClick:()=>t("bookmarks"),title:"Bookmarks",children:""}),ie.jsx(Zi,{onClick:()=>t("calendar"),title:"Calendar",children:""}),ie.jsx(Zi,{onClick:()=>t("uidemo"),title:"UI Demo",children:""}),ie.jsx("div",{style:{width:"2px",height:"28px",borderLeft:`1px solid ${ot.borderDark}`,borderRight:`1px solid ${ot.borderLight}`,margin:"0 2px"}}),ie.jsx("div",{style:{flex:1,display:"flex",gap:"2px",overflow:"hidden"},children:i.map(p=>ie.jsx(Zi,{onClick:()=>n(p.id),active:e===p.id,style:{flexShrink:1,minWidth:"60px",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.title},p.id))}),ie.jsx(E9,{}),ie.jsx(v9,{isActive:f}),ie.jsx("div",{style:{padding:"2px 8px",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,fontSize:"11px",fontFamily:"'Pixelify Sans', monospace",color:"#000000",backgroundColor:"#c0c0c0",minWidth:"80px",textAlign:"center"},children:c}),ie.jsx(Zi,{onClick:s,title:"Save Layout",children:""}),ie.jsx(Zi,{onClick:r,title:"Clear All Windows",children:""}),ie.jsx(Zi,{onClick:o,title:"Logout",children:"Logout"})]})},T9=()=>{const[i,e]=ue.useState(""),t=()=>{i.trim()&&(window.open(`https://www.google.com/search?q=${encodeURIComponent(i)}`,"_blank"),e(""))};return ie.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center",fontFamily:"'Pixelify Sans', monospace"},children:[ie.jsx("span",{style:{fontSize:"16px"},children:""}),ie.jsx(uM,{value:i,onChange:n=>e(n.target.value),onKeyPress:n=>n.key==="Enter"&&t(),placeholder:"Search Google...",style:{flex:1,width:"300px"}}),ie.jsx(Zi,{onClick:t,children:"Go"})]})},M9="https://api.allorigins.win/raw?url=",C9=["https://rss.nytimes.com/services/xml/rss/nyt/Technology.xml","https://rss.nytimes.com/services/xml/rss/nyt/World.xml","http://astralcodexten.substack.com/feed"];class R9{async fetchFeeds(){const e=[];for(const t of C9)try{const n=await fetch(`${M9}${encodeURIComponent(t)}`);if(!n.ok){console.error(`Failed to fetch ${t}: ${n.statusText}`);continue}const s=await n.text(),r=new window.DOMParser().parseFromString(s,"text/xml"),o=r.querySelector("channel > title")?.textContent||"Unknown Source";r.querySelectorAll("item").forEach(f=>{e.push({title:f.querySelector("title")?.textContent||"",link:f.querySelector("link")?.textContent||"",description:f.querySelector("description")?.textContent?.replace(/<[^>]*>?/gm,"")||"",pubDate:f.querySelector("pubDate")?.textContent||"",source:o})})}catch(n){console.error(`Error parsing feed from ${t}:`,n)}return e.sort((t,n)=>{const s=t.pubDate?new Date(t.pubDate).getTime():0;return(n.pubDate?new Date(n.pubDate).getTime():0)-s}),e.slice(0,30)}}const w9=new R9,D9=()=>{const[i,e]=ue.useState([]),[t,n]=ue.useState(!0),[s,r]=ue.useState(null);return ue.useEffect(()=>{(async()=>{try{n(!0);const c=await w9.fetchFeeds();e(c)}catch(c){r("Failed to load RSS feeds"),console.error(c)}finally{n(!1)}})()},[]),{articles:i,loading:t,error:s}},I9=()=>{const{articles:i,loading:e,error:t}=D9();return e?ie.jsx("div",{style:{padding:"8px"},children:"Loading feeds..."}):t?ie.jsx("div",{style:{padding:"8px",color:"red"},children:t}):ie.jsx("div",{style:{height:"100%",overflowY:"auto",background:"#ffffff",color:"#000000",fontFamily:"'Pixelify Sans', monospace",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`},children:i.map((n,s)=>ie.jsxs("div",{style:{borderBottom:`1px solid ${ot.borderDark}`,padding:"8px",cursor:"pointer"},onClick:()=>window.open(n.link,"_blank"),children:[ie.jsx("div",{style:{fontWeight:"bold",marginBottom:"2px",fontSize:"12px",color:"#000000",fontFamily:"'Pixelify Sans', monospace"},children:n.title}),ie.jsx("div",{style:{color:"#000000",fontSize:"11px",marginBottom:"4px",maxHeight:"4.5em",overflow:"hidden",fontFamily:"'Pixelify Sans', monospace"},children:n.description}),ie.jsxs("div",{style:{color:"#666666",fontSize:"10px",fontStyle:"italic",display:"flex",justifyContent:"space-between",fontFamily:"'Pixelify Sans', monospace"},children:[ie.jsxs("span",{children:[" ",n.source]}),n.pubDate&&ie.jsx("span",{children:new Date(n.pubDate).toLocaleDateString()})]})]},s))})};class B9{async saveLayout(e,t){const n=_c(dr,"layouts",e);await Pk(n,{windows:t,timestamp:new Date})}async loadLayout(e){const t=_c(dr,"layouts",e),n=await Uk(t);return n.exists()?n.data().windows:null}async getNotes(e){const t=Yh(dr,"users",e,"notes"),n=XN(t,WN("timestamp","desc"));return(await aM(n)).docs.map(r=>({id:r.id,...r.data()}))}async saveNote(e,t){const n={text:t,timestamp:new Date().toISOString()},s=Yh(dr,"users",e,"notes");return{id:(await dx(s,n)).id,...n}}async getBookmarks(e){const t=Yh(dr,"users",e,"bookmarks"),n=await aM(t);return n.empty?[{name:"GitHub",url:"https://github.com",icon:""},{name:"Hacker News",url:"https://news.ycombinator.com",icon:""}]:n.docs.map(s=>({id:s.id,...s.data()}))}async addBookmark(e,t){const n=Yh(dr,"users",e,"bookmarks");return{id:(await dx(n,t)).id,...t}}async removeBookmark(e,t){const n=_c(dr,"users",e,"bookmarks",t);await O1(n)}}const ef=new B9,_2=i=>{let e;const t=new Set,n=(p,m)=>{const y=typeof p=="function"?p(e):p;if(!Object.is(y,e)){const v=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(x=>x(e,v))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>f,subscribe:p=>(t.add(p),()=>t.delete(p))},f=e=i(n,s,c);return c},bO=i=>i?_2(i):_2,N9=i=>i;function O9(i,e=N9){const t=wd.useSyncExternalStore(i.subscribe,wd.useCallback(()=>e(i.getState()),[i,e]),wd.useCallback(()=>e(i.getInitialState()),[i,e]));return wd.useDebugValue(t),t}const v2=i=>{const e=bO(i),t=n=>O9(e,n);return Object.assign(t,e),t},L9=i=>i?v2(i):v2,U9={search:"Search",rss:"RSS Feed",notes:"Quick Notes",ai:"AI Assistant",bookmarks:"Bookmarks",calendar:"Calendar",uidemo:"UI Demo"},P9={search:{width:400,height:100},rss:{width:350,height:400},notes:{width:300,height:350},ai:{width:280,height:250},bookmarks:{width:200,height:250},calendar:{width:320,height:420},uidemo:{width:500,height:600}},k1=L9((i,e)=>({windows:[],activeWindow:null,userId:null,setUserId:t=>i({userId:t}),addWindow:t=>{const n={id:`${t}-${Date.now()}`,type:t,title:U9[t],position:{x:100+Math.random()*200,y:100+Math.random()*100},size:P9[t]};i(s=>({windows:[...s.windows,n],activeWindow:n.id}))},removeWindow:t=>{i(n=>({windows:n.windows.filter(s=>s.id!==t),activeWindow:n.activeWindow===t?null:n.activeWindow}))},updateWindowPosition:(t,n)=>{i(s=>({windows:s.windows.map(r=>r.id===t?{...r,position:n}:r)}))},updateWindowSize:(t,n)=>{i(s=>({windows:s.windows.map(r=>r.id===t?{...r,size:n}:r)}))},focusWindow:t=>{i({activeWindow:t})},saveLayout:async()=>{const{windows:t,userId:n}=e();n&&(await ef.saveLayout(n,t),alert("Layout saved!"))},loadLayout:async()=>{const{userId:t}=e();if(t){const n=await ef.loadLayout(t);n&&i({windows:n})}},clearAll:()=>{if(confirm("Clear all windows? This cannot be undone.")){i({windows:[],activeWindow:null});const{userId:t}=e();t&&ef.saveLayout(t,[])}}})),F9=()=>{const[i,e]=ue.useState([]),t=k1(r=>r.userId),n=ue.useCallback(async()=>{if(t){const r=await ef.getNotes(t);e(r)}},[t]);return ue.useEffect(()=>{n()},[n]),{notes:i,saveNote:async r=>{t&&(await ef.saveNote(t,r),n())}}},z9=()=>{const[i,e]=ue.useState(""),{notes:t,saveNote:n}=F9(),s=async()=>{await n(i),e("")};return ie.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",height:"100%"},children:[ie.jsx(SO,{value:i,onChange:r=>e(r.target.value),placeholder:"Type your note here...",style:{height:"80px"}}),ie.jsx(Zi,{onClick:s,disabled:!i.trim(),children:" Save Note"}),ie.jsx("div",{style:{flex:1,overflow:"auto",border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,padding:"4px",background:"#ffffff",color:"#000000",fontFamily:"'Pixelify Sans', monospace"},children:t.map(r=>ie.jsxs("div",{style:{borderBottom:`1px solid ${ot.borderDark}`,padding:"4px 0",marginBottom:"4px"},children:[ie.jsx("div",{style:{color:"#666666",fontSize:"10px",fontFamily:"'Pixelify Sans', monospace"},children:new Date(r.timestamp).toLocaleString()}),ie.jsx("div",{style:{whiteSpace:"pre-wrap",color:"#000000",fontFamily:"'Pixelify Sans', monospace"},children:r.text})]},r.id))})]})},_b=[{id:"claude",name:"Claude",url:"https://claude.ai/new"},{id:"chatgpt",name:"ChatGPT",url:"https://chat.openai.com/"},{id:"gemini",name:"Gemini",url:"https://gemini.google.com/app"}],V9=()=>{const[i,e]=ue.useState(""),[t,n]=ue.useState("claude"),s=()=>{if(!i.trim())return;const r=_b.find(o=>o.id===t);r&&navigator.clipboard.writeText(i).then(()=>{window.open(r.url,"_blank"),e(""),alert(`Prompt copied to clipboard! Paste it in ${r.name} chat.`)})};return ie.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[ie.jsx(_9,{value:t,onChange:r=>n(r.target.value),children:_b.map(r=>ie.jsx("option",{value:r.id,children:r.name},r.id))}),ie.jsx(SO,{value:i,onChange:r=>e(r.target.value),placeholder:"Enter your prompt...",style:{minHeight:"80px"}}),ie.jsxs(Zi,{onClick:s,disabled:!i.trim(),children:[" Launch ",_b.find(r=>r.id===t)?.name]})]})},H9=()=>{const[i,e]=ue.useState([]),t=k1(o=>o.userId),n=ue.useCallback(async()=>{if(t){const o=await ef.getBookmarks(t);e(o)}},[t]);return ue.useEffect(()=>{n()},[n]),{bookmarks:i,addBookmark:async o=>{t&&(await ef.addBookmark(t,o),n())},removeBookmark:async o=>{t&&(await ef.removeBookmark(t,o),n())}}},k9=()=>{const{bookmarks:i,addBookmark:e}=H9(),[t,n]=ue.useState(!1),[s,r]=ue.useState({name:"",url:""}),o=()=>{s.name&&s.url&&(e({...s,icon:""}),r({name:"",url:""}),n(!1))};return ie.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontFamily:"'Pixelify Sans', monospace"},children:[i.map((c,f)=>ie.jsxs(Zi,{onClick:()=>window.open(c.url,"_blank"),style:{textAlign:"left",justifyContent:"flex-start",padding:"4px 8px"},children:[ie.jsx("span",{style:{marginRight:"6px"},children:c.icon}),c.name]},f)),t?ie.jsxs("div",{style:{border:"2px solid",borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,padding:"4px",background:ot.windowBg,fontFamily:"'Pixelify Sans', monospace"},children:[ie.jsx(uM,{value:s.name,onChange:c=>r({...s,name:c.target.value}),placeholder:"Name",style:{width:"100%",marginBottom:"4px"}}),ie.jsx(uM,{value:s.url,onChange:c=>r({...s,url:c.target.value}),placeholder:"URL",style:{width:"100%",marginBottom:"4px"}}),ie.jsxs("div",{style:{display:"flex",gap:"4px"},children:[ie.jsx(Zi,{onClick:o,style:{fontSize:"10px",padding:"2px 6px"},children:"OK"}),ie.jsx(Zi,{onClick:()=>n(!1),style:{fontSize:"10px",padding:"2px 6px"},children:"Cancel"})]})]}):ie.jsx(Zi,{onClick:()=>n(!0),style:{marginTop:"8px"},children:" Add Bookmark"})]})},By="google_calendar_tokens",G9=()=>{const[i,e]=ue.useState([]),[t,n]=ue.useState(!1),[s,r]=ue.useState(null),[o,c]=ue.useState(!1),[f,p]=ue.useState(null);ue.useEffect(()=>{(()=>{try{const T=localStorage.getItem(By);if(T){const D=JSON.parse(T),B=Date.now();D.expires_at>B+3e5?(p(D.access_token),c(!0),console.log("Restored valid access token from storage")):(console.log("Stored token expired, clearing storage"),localStorage.removeItem(By))}}catch(T){console.error("Error checking stored tokens:",T),localStorage.removeItem(By)}})()},[]);const m=ue.useCallback(M=>{try{const T=Date.now()+M.expires_in*1e3,D={access_token:M.access_token,expires_at:T,refresh_token:M.refresh_token};localStorage.setItem(By,JSON.stringify(D)),console.log("Stored tokens, expires at:",new Date(T))}catch(T){console.error("Error storing tokens:",T)}},[]),y=ue.useCallback(()=>{localStorage.removeItem(By),p(null),c(!1)},[]),v=ue.useCallback(()=>new Promise((M,T)=>{if(window.google?.accounts){M();return}const D=document.createElement("script");D.src="https://accounts.google.com/gsi/client",D.onload=()=>{const B=document.createElement("script");B.src="https://apis.google.com/js/api.js",B.onload=()=>{window.gapi.load("client",{callback:M,onerror:T})},B.onerror=T,document.head.appendChild(B)},D.onerror=T,document.head.appendChild(D)}),[]),x=ue.useCallback(async()=>{try{return await v(),new Promise(M=>{window.google.accounts.oauth2.initTokenClient({client_id:"699151675972-8ur3v19ta7aq7ss11o41lrl4hfn0ab3i.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/calendar.readonly",callback:D=>{if(D.error){console.error("OAuth error:",D),r("Failed to authenticate with Google Calendar"),y(),M(!1);return}console.log("OAuth success, storing tokens"),m(D),p(D.access_token),c(!0),r(null),M(!0)}}).requestAccessToken()})}catch(M){return console.error("Calendar permission error:",M),r("Failed to get calendar permission. Please check your Google API configuration."),y(),!1}},[v,m,y]),b=ue.useCallback(async()=>{if(!((!o||!f)&&!await x())){n(!0),r(null);try{const M=new Date().toISOString(),T=new Date(Date.now()+720*60*60*1e3).toISOString(),D=new URL("https://www.googleapis.com/calendar/v3/calendars/primary/events");D.searchParams.append("timeMin",M),D.searchParams.append("timeMax",T),D.searchParams.append("singleEvents","true"),D.searchParams.append("orderBy","startTime"),D.searchParams.append("maxResults","50"),D.searchParams.append("key","AIzaSyB1eVbZ6VOZDU26V3wBWSZ-ecuLKM_mzpY"),console.log("Making Calendar API request to:",D.toString());const B=await fetch(D.toString(),{headers:{Authorization:`Bearer ${f}`}});if(console.log("API Response Status:",B.status),!B.ok){const H=await B.json().catch(()=>({}));if(console.error("Calendar API response:",H),B.status===401){if(console.log("Token expired, requesting new permission"),y(),await x())return await b();throw new Error("Authentication failed. Please try again.")}else if(B.status===403)throw H.error?.message?.includes("Calendar API has not been used")?new Error("Google Calendar API is not enabled. Please enable it in Google Cloud Console."):H.error?.message?.includes("insufficient")?new Error("Insufficient permissions. Please grant calendar access."):new Error(`Calendar API access denied: ${H.error?.message||"Check your API key and OAuth setup"}`);throw new Error(`Calendar API error: ${B.status} ${B.statusText}`)}const G=(await B.json()).items||[];e(G),r(null)}catch(M){console.error("Error loading calendar events:",M);const T=M instanceof Error?M.message:"Failed to load calendar events";r(`${T}. Using demo data instead.`);const D=[{id:"demo-1",summary:"Demo: Team Meeting",start:{dateTime:new Date().toISOString()},end:{dateTime:new Date(Date.now()+36e5).toISOString()},location:"Conference Room A"},{id:"demo-2",summary:"Demo: Lunch Meeting",start:{dateTime:new Date(Date.now()+864e5).toISOString()},end:{dateTime:new Date(Date.now()+864e5+36e5).toISOString()},location:"Restaurant"}];e(D)}finally{n(!1)}}},[o,f,x,y]),R=ue.useCallback(()=>{y(),e([]),r(null),console.log("Logged out and cleared calendar data")},[y]);return{events:i,loading:t,error:s,hasPermission:o,requestPermission:x,loadEvents:b,logout:R}},j9=()=>{const{events:i,loading:e,error:t,loadEvents:n,hasPermission:s,requestPermission:r,logout:o}=G9();ue.useEffect(()=>{s&&n()},[s,n]);const c=y=>new Date(y).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:y.includes("T")?"numeric":void 0,minute:y.includes("T")?"2-digit":void 0}),f=y=>y.start.dateTime||y.start.date||"",p=i.filter(y=>{const v=f(y);if(!v)return!1;const x=new Date().toDateString(),b=new Date(v).toDateString();return x===b}),m=i.filter(y=>{const v=f(y);if(!v)return!1;const x=new Date;return new Date(v)>x}).slice(0,5);return s?e?ie.jsx("div",{style:{padding:"16px",textAlign:"center",color:ot.text},children:"Loading calendar events..."}):t?ie.jsxs("div",{style:{padding:"16px"},children:[ie.jsx("div",{style:{color:"red",marginBottom:"12px",fontSize:"11px"},children:" Calendar Setup Required"}),ie.jsx("div",{style:{color:ot.text,fontSize:"10px",marginBottom:"12px",lineHeight:"1.4"},children:t}),t.includes("API is not enabled")&&ie.jsxs("div",{style:{background:ot.textLight,border:`1px solid ${ot.borderDark}`,padding:"8px",fontSize:"10px",marginBottom:"12px",lineHeight:"1.3"},children:[ie.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Setup Steps:"}),ie.jsx("div",{children:"1. Go to Google Cloud Console"}),ie.jsx("div",{children:"2. Enable Google Calendar API"}),ie.jsx("div",{children:"3. Create OAuth credentials"}),ie.jsx("div",{children:"4. Add your domain to authorized origins"})]}),ie.jsx(Zi,{onClick:r,style:{fontSize:"10px"},children:" Try Again"})]}):ie.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",color:"#000000",fontFamily:"'Pixelify Sans', monospace"},children:[ie.jsxs("div",{style:{padding:"8px",borderBottom:`1px solid ${ot.borderDark}`,background:ot.windowHeader,fontWeight:"bold",fontSize:"12px",color:"#000000",fontFamily:"'Pixelify Sans', monospace",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ie.jsxs("span",{children:[" ",new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),ie.jsx("button",{onClick:o,style:{background:"none",border:"none",color:"#000000",fontSize:"10px",cursor:"pointer",padding:"2px 4px",fontFamily:"'Pixelify Sans', monospace"},title:"Logout from Google Calendar",children:""})]}),ie.jsxs("div",{style:{flex:1,overflow:"auto"},children:[p.length>0&&ie.jsxs("div",{style:{padding:"8px"},children:[ie.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"11px",color:"#000000",fontFamily:"'Jacquard 12', monospace"},children:"Today's Events:"}),p.map(y=>ie.jsxs("div",{style:{border:`1px solid ${ot.borderDark}`,borderColor:`${ot.borderLight} ${ot.borderDark} ${ot.borderDark} ${ot.borderLight}`,padding:"6px",marginBottom:"4px",background:"#ffffff",fontSize:"11px",fontFamily:"'Pixelify Sans', monospace"},children:[ie.jsx("div",{style:{fontWeight:"bold",marginBottom:"2px"},children:y.summary}),ie.jsx("div",{style:{color:"#666",fontSize:"10px"},children:c(f(y))}),y.location&&ie.jsxs("div",{style:{color:"#555",fontSize:"10px",marginTop:"2px"},children:[" ",y.location]})]},y.id))]}),m.length>0&&ie.jsxs("div",{style:{padding:"8px"},children:[ie.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"11px",color:"#000000",fontFamily:"'Jacquard 12', monospace"},children:"Upcoming Events:"}),m.map(y=>ie.jsxs("div",{style:{border:`1px solid ${ot.borderDark}`,borderColor:`${ot.borderDark} ${ot.borderLight} ${ot.borderLight} ${ot.borderDark}`,padding:"6px",marginBottom:"4px",background:ot.windowBg,fontSize:"11px"},children:[ie.jsx("div",{style:{fontWeight:"bold",marginBottom:"2px"},children:y.summary}),ie.jsx("div",{style:{color:"#666",fontSize:"10px"},children:c(f(y))}),y.location&&ie.jsxs("div",{style:{color:"#555",fontSize:"10px",marginTop:"2px"},children:[" ",y.location]})]},y.id))]}),p.length===0&&m.length===0&&ie.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"11px"},children:"No upcoming events found"})]}),ie.jsx("div",{style:{padding:"8px",borderTop:`1px solid ${ot.borderDark}`,textAlign:"center"},children:ie.jsx(Zi,{onClick:n,style:{fontSize:"11px"},children:" Refresh"})})]}):ie.jsxs("div",{style:{padding:"16px",textAlign:"center"},children:[ie.jsx("div",{style:{marginBottom:"16px",color:ot.text},children:"Calendar access required to view your events"}),ie.jsx(Zi,{onClick:r,children:" Grant Calendar Access"})]})},q9=(i,e={})=>{const{maxWidth:t=800,maxHeight:n=600,quality:s=.8,format:r="webp"}=e;return new Promise((o,c)=>{const f=document.createElement("canvas"),p=f.getContext("2d"),m=new Image;m.onload=()=>{let{width:y,height:v}=m;y>t&&(v=v*t/y,y=t),v>n&&(y=y*n/v,v=n),f.width=y,f.height=v,p?(p.drawImage(m,0,0,y,v),f.toBlob(x=>{x?o(x):c(new Error("Failed to compress image"))},`image/${r}`,s)):c(new Error("Failed to get canvas context"))},m.onerror=()=>c(new Error("Failed to load image")),m.src=URL.createObjectURL(i)})},X9=(i,e="webp")=>`${i.replace(/\.[^/.]+$/,"")}.${e}`,W9=()=>{const[i,e]=ue.useState([]),[t,n]=ue.useState(!1),[s,r]=ue.useState(null),o=ue.useCallback(async()=>{const b=oa.currentUser;if(b){n(!0),r(null);try{const R=Yh(dr,"users",b.uid,"desktopImages"),M=await aM(R),T=[];M.forEach(D=>{T.push({id:D.id,...D.data()})}),e(T)}catch(R){console.error("Error loading desktop images:",R),r(`Failed to load images: ${R.message}`)}finally{n(!1)}}},[]),c=ue.useCallback(async(b,R)=>{const M=oa.currentUser;if(!M){r("User not authenticated");return}if(!b.type.startsWith("image/")){r("Please select an image file");return}if(b.size>50*1024*1024){r("Image file too large (max 50MB)");return}n(!0),r(null);try{console.log(`Original file size: ${(b.size/1024/1024).toFixed(2)}MB`);const T=await q9(b,{maxWidth:1200,maxHeight:900,quality:.8,format:"webp"});console.log(`Compressed size: ${(T.size/1024/1024).toFixed(2)}MB`),console.log(`Compression ratio: ${((b.size-T.size)/b.size*100).toFixed(1)}%`);const D=Date.now(),B=X9(b.name,"webp"),L=`desktopImages/${M.uid}/${D}-${B}`,G=Qm(Zm,L),H=await u9(G,T),F=await _O(H.ref),U={width:200,height:150},I={name:b.name,compressedName:B,url:F,position:R,size:U,uploadedAt:new Date().toISOString(),storagePath:L,originalSize:b.size,compressedSize:T.size,compressionRatio:((b.size-T.size)/b.size*100).toFixed(1)},N=Yh(dr,"users",M.uid,"desktopImages"),z=await dx(N,I);e(W=>[...W,{id:z.id,...I}])}catch(T){console.error("Error adding image:",T),T.message?.includes("compress")?r(`Failed to compress image: ${T.message}`):T.message?.includes("upload")?r(`Failed to upload image: ${T.message}`):r(`Failed to add image: ${T.message}`)}finally{n(!1)}},[]),f=ue.useCallback(async(b,R)=>{const M=oa.currentUser;if(M)try{const T=_c(dr,"users",M.uid,"desktopImages",b);await HA(T,{position:R})}catch(T){console.error("Error updating image position:",T),r(`Failed to update position: ${T.message}`)}},[]),p=ue.useCallback((b,R)=>{e(M=>M.map(T=>T.id===b?{...T,position:R}:T))},[]),m=ue.useCallback(async(b,R)=>{const M=oa.currentUser;if(M)try{const T=_c(dr,"users",M.uid,"desktopImages",b);await HA(T,{size:R})}catch(T){console.error("Error updating image size:",T),r(`Failed to update size: ${T.message}`)}},[]),y=ue.useCallback((b,R)=>{e(M=>M.map(T=>T.id===b?{...T,size:R}:T))},[]),v=ue.useCallback(async(b,R)=>{const M=oa.currentUser;if(M)try{const T=_c(dr,"users",M.uid,"desktopImages",b);await HA(T,{aspectRatio:R}),e(D=>D.map(B=>B.id===b?{...B,aspectRatio:R}:B))}catch(T){console.error("Error updating image aspect ratio:",T)}},[]),x=ue.useCallback(async b=>{const R=oa.currentUser;if(R)try{const M=i.find(D=>D.id===b);if(!M)return;const T=Qm(Zm,M.storagePath);await vO(T),await O1(_c(dr,"users",R.uid,"desktopImages",b)),e(D=>D.filter(B=>B.id!==b))}catch(M){console.error("Error deleting image:",M),r(`Failed to delete image: ${M.message}`)}},[i]);return ue.useEffect(()=>{const b=oa.onAuthStateChanged(R=>{R?o():e([])});return()=>b()},[o]),{images:i,loading:t,error:s,addImage:c,updateImagePosition:f,updateImagePositionLocal:p,updateImageSize:m,updateImageSizeLocal:y,updateImageAspectRatio:v,deleteImage:x,loadImages:o}},T_=(i,e)=>{let t;return(...n)=>{clearTimeout(t),t=setTimeout(()=>i(...n),e)}},Y9=({id:i,src:e,position:t,size:n,storedAspectRatio:s,onPositionChange:r,onPositionChangeLocal:o,onSizeChange:c,onSizeChangeLocal:f,onAspectRatioUpdate:p,onDelete:m})=>{const[y,v]=ue.useState(!1),[x,b]=ue.useState(!1),[R,M]=ue.useState({x:0,y:0}),[T,D]=ue.useState(!1),[B,L]=ue.useState(s||null),{startSync:G,endSync:H}=J_(),F=ue.useMemo(()=>T_((k,he)=>{G(),r(k,he),setTimeout(H,1200)},500),[r,G,H]),U=ue.useMemo(()=>T_((k,he)=>{G(),c(k,he),setTimeout(H,1200)},500),[c,G,H]),I=ue.useCallback(k=>{(k.target===k.currentTarget||k.target.tagName==="IMG")&&(k.preventDefault(),v(!0),M({x:k.clientX-t.x,y:k.clientY-t.y}))},[t]),N=ue.useCallback(k=>{if(y){const he={x:k.clientX-R.x,y:k.clientY-R.y};o(i,he),F(i,he)}},[y,R,i,o,F]),z=ue.useCallback(()=>{v(!1),b(!1)},[]);wd.useEffect(()=>{if(y||x)return document.addEventListener("mousemove",N),document.addEventListener("mouseup",z),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",z)}},[y,x,N,z]);const W=ue.useCallback(k=>{k.stopPropagation(),k.preventDefault(),b(!0);const he=k.clientX,me=k.clientY,q=n.width,ee=n.height,ne=K=>{const ce=K.clientX-he,Ee=K.clientY-me;let Me,Ve;if(B){const ze=Math.sqrt(ce*ce+Ee*Ee),Je=ce+Ee>0?1:-1,lt=1+ze*Je/Math.max(q,ee);Me=Math.max(50,q*lt),Ve=Math.max(50/B,Me/B)}else Me=Math.max(50,q+ce),Ve=Math.max(50,ee+Ee);const ge={width:Me,height:Ve};f(i,ge),U(i,ge)},ye=()=>{b(!1),document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",ye)};document.addEventListener("mousemove",ne),document.addEventListener("mouseup",ye)},[i,n,B,f,U]);return ie.jsxs("div",{style:{position:"absolute",left:t.x,top:t.y,width:n.width,height:n.height,cursor:y?"grabbing":"grab",zIndex:500,userSelect:"none"},onMouseDown:I,onMouseEnter:()=>D(!0),onMouseLeave:()=>D(!1),children:[ie.jsx("img",{src:e,alt:"Desktop image",style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"},draggable:!1,onLoad:k=>{const he=k.target,me=he.naturalWidth/he.naturalHeight;L(me),!s&&me&&(G(),p(i,me),setTimeout(H,1200))}}),T&&ie.jsx("div",{style:{position:"absolute",top:"-8px",right:"-8px",width:"20px",height:"20px",background:"red",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},onClick:k=>{k.stopPropagation(),m(i)},children:""}),T&&ie.jsx("div",{style:{position:"absolute",bottom:"-4px",right:"-4px",width:"12px",height:"12px",background:"#666",cursor:"nw-resize"},onMouseDown:W})]})},K9=()=>{const{images:i,loading:e,error:t,addImage:n,updateImagePosition:s,updateImagePositionLocal:r,updateImageSize:o,updateImageSizeLocal:c,updateImageAspectRatio:f,deleteImage:p}=W9(),{onStorageChange:m}=J_(),[y,v]=ue.useState(!1),x=ue.useCallback(async(M,T)=>{await n(M,T),m()},[n,m]),b=ue.useCallback(async M=>{await p(M),m()},[p,m]),R=ue.useCallback(async M=>{M.preventDefault(),M.stopPropagation(),v(!1);const T=Array.from(M.dataTransfer?.files||[]),D=T.filter(B=>B.type.startsWith("image/"));if(D.length===0){const B=new CustomEvent("non-image-files-dropped",{detail:{files:T,originalEvent:M}});document.dispatchEvent(B);return}for(const B of D){const L={x:M.clientX-100,y:M.clientY-100};await x(B,L)}},[x]);return ue.useEffect(()=>{const M=B=>{B.dataTransfer?.types.includes("Files")&&(B.preventDefault(),B.stopPropagation(),v(!0))},T=B=>{B.dataTransfer?.types.includes("Files")&&(B.preventDefault(),B.stopPropagation(),B.relatedTarget||v(!1))},D=B=>{B.dataTransfer?.types.includes("Files")&&(B.preventDefault(),B.stopPropagation(),v(!0))};return document.addEventListener("dragenter",M),document.addEventListener("dragover",D),document.addEventListener("dragleave",T),document.addEventListener("drop",R),()=>{document.removeEventListener("dragenter",M),document.removeEventListener("dragover",D),document.removeEventListener("dragleave",T),document.removeEventListener("drop",R)}},[R]),e?null:ie.jsxs(ie.Fragment,{children:[y&&ie.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 100, 255, 0.1)",border:"3px dashed #0066ff",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:ie.jsx("div",{style:{backgroundColor:"rgba(0, 100, 255, 0.9)",color:"white",padding:"20px 40px",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",fontFamily:"'Jacquard 12', 'MS Sans Serif', monospace"},children:" Drop images here!"})}),i.map(M=>ie.jsx(Y9,{id:M.id,src:M.url,position:M.position,size:M.size,storedAspectRatio:M.aspectRatio,onPositionChange:s,onPositionChangeLocal:r,onSizeChange:o,onSizeChangeLocal:c,onAspectRatioUpdate:f,onDelete:b},M.id)),e&&ie.jsxs("div",{style:{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"12px 20px",borderRadius:"6px",fontSize:"14px",zIndex:10001,fontFamily:"'Jacquard 12', 'MS Sans Serif', monospace",display:"flex",alignItems:"center",gap:"8px"},children:[ie.jsx("div",{style:{width:"16px",height:"16px",border:"2px solid transparent",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}})," Compressing and uploading image..."]}),t&&ie.jsxs("div",{style:{position:"fixed",top:"10px",right:"10px",background:"red",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",zIndex:1e3,maxWidth:"300px"},children:[" ",t]})]})},A2="desktop-3d-models",J9=T_(async(i,e,t)=>{try{const n=_c(dr,"users",i,"desktop3DModels",e);await HA(n,{position:t})}catch(n){console.error("Error updating 3D model position:",n)}},500),Q9=()=>{const[i,e]=ue.useState([]),[t,n]=ue.useState(!1),[s,r]=ue.useState(0),[o,c]=ue.useState(null);ue.useEffect(()=>{const y=oa.currentUser;if(!y){e([]);return}const v=XN(Yh(dr,"users",y.uid,"desktop3DModels"),WN("createdAt","desc"));return Fk(v,b=>{const R=b.docs.map(M=>({id:M.id,...M.data(),createdAt:M.data().createdAt?.toDate()||new Date}));e(R)},b=>{console.error("Error loading 3D models:",b),c("Failed to load 3D models")})},[]);const f=ue.useCallback(async(y,v)=>{const x=oa.currentUser;if(!x){c("User not authenticated");return}try{if(n(!0),r(0),c(null),!(y.type==="model/gltf-binary"||y.name.toLowerCase().endsWith(".glb")||y.name.toLowerCase().endsWith(".gltf")))throw new Error("Please upload GLB or GLTF files only");const R=50*1024*1024;if(y.size>R)throw new Error("File too large. Maximum size is 50MB.");const M=Date.now(),T=`${M}_${y.name}`,D=Qm(Zm,`${A2}/${T}`),B=h9(D,y);return new Promise((L,G)=>{B.on("state_changed",H=>{const F=H.bytesTransferred/H.totalBytes*100;r(F)},H=>{console.error("Upload error:",H),c("Failed to upload 3D model"),G(H)},async()=>{try{const H=await _O(B.snapshot.ref),F=`model-window-${M}`;await dx(Yh(dr,"users",x.uid,"desktop3DModels"),{name:y.name,url:H,position:v,windowId:F,createdAt:new Date,storageRef:T}),L()}catch(H){console.error("Firestore error:",H),c("Failed to save 3D model data"),G(H)}})})}catch(b){console.error("Error uploading 3D model:",b),c(b instanceof Error?b.message:"Failed to upload 3D model")}finally{n(!1),r(0)}},[]),p=ue.useCallback((y,v)=>{const x=oa.currentUser;x&&(e(b=>b.map(R=>R.id===y?{...R,position:v}:R)),J9(x.uid,y,v))},[]),m=ue.useCallback(async y=>{const v=oa.currentUser;if(v)try{const x=i.find(b=>b.id===y);if(!x)return;await O1(_c(dr,"users",v.uid,"desktop3DModels",y));try{const b=Qm(Zm,`${A2}/${x.storageRef}`);await vO(b)}catch(b){console.warn("Storage deletion failed (file may not exist):",b)}}catch(x){console.error("Error deleting 3D model:",x),c("Failed to delete 3D model")}},[i]);return ue.useEffect(()=>{if(o){const y=setTimeout(()=>c(null),5e3);return()=>clearTimeout(y)}},[o]),{models:i,uploading:t,uploadProgress:s,uploadModel:f,updateModelPosition:p,deleteModel:m,error:o}};var vb={exports:{}},hu={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x2;function Z9(){return x2||(x2=1,hu.ConcurrentRoot=1,hu.ContinuousEventPriority=8,hu.DefaultEventPriority=32,hu.DiscreteEventPriority=2,hu.IdleEventPriority=268435456,hu.LegacyRoot=0,hu.NoEventPriority=0),hu}var S2;function $9(){return S2||(S2=1,vb.exports=Z9()),vb.exports}var kA=$9();/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Q_="179",bd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Td={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},TO=0,hM=1,MO=2,e6=3,CO=0,US=1,a_=2,Al=3,Ic=0,ua=1,Fo=2,wu=0,kd=1,fM=2,dM=3,pM=4,RO=5,qh=100,wO=101,DO=102,IO=103,BO=104,NO=200,OO=201,LO=202,UO=203,mx=204,gx=205,PO=206,FO=207,zO=208,VO=209,HO=210,kO=211,GO=212,jO=213,qO=214,yx=0,_x=1,vx=2,Jd=3,Ax=4,xx=5,Sx=6,Ex=7,Z_=0,XO=1,WO=2,Cc=0,YO=1,KO=2,JO=3,G1=4,QO=5,ZO=6,$O=7,mM="attached",eL="detached",PS=300,Fu=301,uf=302,M_=303,C_=304,Sg=306,hf=1e3,oo=1001,$m=1002,Qs=1003,FS=1004,t6=1004,Bd=1005,n6=1005,_s=1006,Vm=1007,i6=1007,zo=1008,s6=1008,ko=1009,j1=1010,q1=1011,eg=1012,zS=1013,zu=1014,za=1015,Eg=1016,VS=1017,HS=1018,tg=1020,X1=35902,W1=1021,Y1=1022,Lr=1023,ng=1026,ig=1027,kS=1028,$_=1029,K1=1030,GS=1031,r6=1032,jS=1033,o_=33776,l_=33777,c_=33778,u_=33779,bx=35840,Tx=35841,Mx=35842,Cx=35843,Rx=36196,wx=37492,Dx=37496,Ix=37808,Bx=37809,Nx=37810,Ox=37811,Lx=37812,Ux=37813,Px=37814,Fx=37815,zx=37816,Vx=37817,Hx=37818,kx=37819,Gx=37820,jx=37821,h_=36492,qx=36494,Xx=36495,J1=36283,Wx=36284,Yx=36285,Kx=36286,tL=2200,nL=2201,iL=2202,sg=2300,rg=2301,GA=2302,Nd=2400,Od=2401,R_=2402,qS=2500,Q1=2501,sL=0,Z1=1,Jx=2,rL=3200,aL=3201,a6=3202,o6=3203,_f=0,oL=1,Eu="",Nr="srgb",ff="srgb-linear",w_="linear",pi="srgb",l6=0,Md=7680,c6=7681,u6=7682,h6=7683,f6=34055,d6=34056,p6=5386,m6=512,g6=513,y6=514,_6=515,v6=516,A6=517,x6=518,gM=519,lL=512,cL=513,uL=514,$1=515,hL=516,fL=517,dL=518,pL=519,D_=35044,S6=35048,E6=35040,b6=35045,T6=35049,M6=35041,C6=35046,R6=35050,w6=35042,D6="100",yM="300 es",lo=2e3,ag=2001,I6={COMPUTE:"compute",RENDER:"render"},B6={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},N6={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};let Oc=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}};const wr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let E2=1234567;const Gd=Math.PI/180,og=180/Math.PI;function uo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(wr[i&255]+wr[i>>8&255]+wr[i>>16&255]+wr[i>>24&255]+"-"+wr[e&255]+wr[e>>8&255]+"-"+wr[e>>16&15|64]+wr[e>>24&255]+"-"+wr[t&63|128]+wr[t>>8&255]+"-"+wr[t>>16&255]+wr[t>>24&255]+wr[n&255]+wr[n>>8&255]+wr[n>>16&255]+wr[n>>24&255]).toLowerCase()}function nn(i,e,t){return Math.max(e,Math.min(t,i))}function eC(i,e){return(i%e+e)%e}function O6(i,e,t,n,s){return n+(i-e)*(s-n)/(t-e)}function L6(i,e,t){return i!==e?(t-i)/(e-i):0}function f_(i,e,t){return(1-t)*i+t*e}function U6(i,e,t,n){return f_(i,e,1-Math.exp(-t*n))}function P6(i,e=1){return e-Math.abs(eC(i,e*2)-e)}function F6(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function z6(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function V6(i,e){return i+Math.floor(Math.random()*(e-i+1))}function H6(i,e){return i+Math.random()*(e-i)}function k6(i){return i*(.5-Math.random())}function G6(i){i!==void 0&&(E2=i);let e=E2+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function j6(i){return i*Gd}function q6(i){return i*og}function X6(i){return(i&i-1)===0&&i!==0}function W6(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Y6(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function K6(i,e,t,n,s){const r=Math.cos,o=Math.sin,c=r(t/2),f=o(t/2),p=r((e+n)/2),m=o((e+n)/2),y=r((e-n)/2),v=o((e-n)/2),x=r((n-e)/2),b=o((n-e)/2);switch(s){case"XYX":i.set(c*m,f*y,f*v,c*p);break;case"YZY":i.set(f*v,c*m,f*y,c*p);break;case"ZXZ":i.set(f*y,f*v,c*m,c*p);break;case"XZX":i.set(c*m,f*b,f*x,c*p);break;case"YXY":i.set(f*x,c*m,f*b,c*p);break;case"ZYZ":i.set(f*b,f*x,c*m,c*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function la(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function En(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const mL={DEG2RAD:Gd,RAD2DEG:og,generateUUID:uo,clamp:nn,euclideanModulo:eC,mapLinear:O6,inverseLerp:L6,lerp:f_,damp:U6,pingpong:P6,smoothstep:F6,smootherstep:z6,randInt:V6,randFloat:H6,randFloatSpread:k6,seededRandom:G6,degToRad:j6,radToDeg:q6,isPowerOfTwo:X6,ceilPowerOfTwo:W6,floorPowerOfTwo:Y6,setQuaternionFromProperEuler:K6,normalize:En,denormalize:la};class Xe{constructor(e=0,t=0){Xe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=nn(this.x,e.x,t.x),this.y=nn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=nn(this.x,e,t),this.y=nn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(nn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*s+e.x,this.y=r*s+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Zs{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,r,o,c){let f=n[s+0],p=n[s+1],m=n[s+2],y=n[s+3];const v=r[o+0],x=r[o+1],b=r[o+2],R=r[o+3];if(c===0){e[t+0]=f,e[t+1]=p,e[t+2]=m,e[t+3]=y;return}if(c===1){e[t+0]=v,e[t+1]=x,e[t+2]=b,e[t+3]=R;return}if(y!==R||f!==v||p!==x||m!==b){let M=1-c;const T=f*v+p*x+m*b+y*R,D=T>=0?1:-1,B=1-T*T;if(B>Number.EPSILON){const G=Math.sqrt(B),H=Math.atan2(G,T*D);M=Math.sin(M*H)/G,c=Math.sin(c*H)/G}const L=c*D;if(f=f*M+v*L,p=p*M+x*L,m=m*M+b*L,y=y*M+R*L,M===1-c){const G=1/Math.sqrt(f*f+p*p+m*m+y*y);f*=G,p*=G,m*=G,y*=G}}e[t]=f,e[t+1]=p,e[t+2]=m,e[t+3]=y}static multiplyQuaternionsFlat(e,t,n,s,r,o){const c=n[s],f=n[s+1],p=n[s+2],m=n[s+3],y=r[o],v=r[o+1],x=r[o+2],b=r[o+3];return e[t]=c*b+m*y+f*x-p*v,e[t+1]=f*b+m*v+p*y-c*x,e[t+2]=p*b+m*x+c*v-f*y,e[t+3]=m*b-c*y-f*v-p*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,r=e._z,o=e._order,c=Math.cos,f=Math.sin,p=c(n/2),m=c(s/2),y=c(r/2),v=f(n/2),x=f(s/2),b=f(r/2);switch(o){case"XYZ":this._x=v*m*y+p*x*b,this._y=p*x*y-v*m*b,this._z=p*m*b+v*x*y,this._w=p*m*y-v*x*b;break;case"YXZ":this._x=v*m*y+p*x*b,this._y=p*x*y-v*m*b,this._z=p*m*b-v*x*y,this._w=p*m*y+v*x*b;break;case"ZXY":this._x=v*m*y-p*x*b,this._y=p*x*y+v*m*b,this._z=p*m*b+v*x*y,this._w=p*m*y-v*x*b;break;case"ZYX":this._x=v*m*y-p*x*b,this._y=p*x*y+v*m*b,this._z=p*m*b-v*x*y,this._w=p*m*y+v*x*b;break;case"YZX":this._x=v*m*y+p*x*b,this._y=p*x*y+v*m*b,this._z=p*m*b-v*x*y,this._w=p*m*y-v*x*b;break;case"XZY":this._x=v*m*y-p*x*b,this._y=p*x*y-v*m*b,this._z=p*m*b+v*x*y,this._w=p*m*y+v*x*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],r=t[8],o=t[1],c=t[5],f=t[9],p=t[2],m=t[6],y=t[10],v=n+c+y;if(v>0){const x=.5/Math.sqrt(v+1);this._w=.25/x,this._x=(m-f)*x,this._y=(r-p)*x,this._z=(o-s)*x}else if(n>c&&n>y){const x=2*Math.sqrt(1+n-c-y);this._w=(m-f)/x,this._x=.25*x,this._y=(s+o)/x,this._z=(r+p)/x}else if(c>y){const x=2*Math.sqrt(1+c-n-y);this._w=(r-p)/x,this._x=(s+o)/x,this._y=.25*x,this._z=(f+m)/x}else{const x=2*Math.sqrt(1+y-n-c);this._w=(o-s)/x,this._x=(r+p)/x,this._y=(f+m)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(nn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,r=e._z,o=e._w,c=t._x,f=t._y,p=t._z,m=t._w;return this._x=n*m+o*c+s*p-r*f,this._y=s*m+o*f+r*c-n*p,this._z=r*m+o*p+n*f-s*c,this._w=o*m-n*c-s*f-r*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,s=this._y,r=this._z,o=this._w;let c=o*e._w+n*e._x+s*e._y+r*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=o,this._x=n,this._y=s,this._z=r,this;const f=1-c*c;if(f<=Number.EPSILON){const x=1-t;return this._w=x*o+t*this._w,this._x=x*n+t*this._x,this._y=x*s+t*this._y,this._z=x*r+t*this._z,this.normalize(),this}const p=Math.sqrt(f),m=Math.atan2(p,c),y=Math.sin((1-t)*m)/p,v=Math.sin(t*m)/p;return this._w=o*y+this._w*v,this._x=n*y+this._x*v,this._y=s*y+this._y*v,this._z=r*y+this._z*v,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ${constructor(e=0,t=0,n=0){$.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(b2.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(b2.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*s,this.y=r[1]*t+r[4]*n+r[7]*s,this.z=r[2]*t+r[5]*n+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*s+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*s+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*s+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,r=e.x,o=e.y,c=e.z,f=e.w,p=2*(o*s-c*n),m=2*(c*t-r*s),y=2*(r*n-o*t);return this.x=t+f*p+o*y-c*m,this.y=n+f*m+c*p-r*y,this.z=s+f*y+r*m-o*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*s,this.y=r[1]*t+r[5]*n+r[9]*s,this.z=r[2]*t+r[6]*n+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=nn(this.x,e.x,t.x),this.y=nn(this.y,e.y,t.y),this.z=nn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=nn(this.x,e,t),this.y=nn(this.y,e,t),this.z=nn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(nn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,r=e.z,o=t.x,c=t.y,f=t.z;return this.x=s*f-r*c,this.y=r*o-n*f,this.z=n*c-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Ab.copy(this).projectOnVector(e),this.sub(Ab)}reflect(e){return this.sub(Ab.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ab=new $,b2=new Zs;class An{constructor(e,t,n,s,r,o,c,f,p){An.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,c,f,p)}set(e,t,n,s,r,o,c,f,p){const m=this.elements;return m[0]=e,m[1]=s,m[2]=c,m[3]=t,m[4]=r,m[5]=f,m[6]=n,m[7]=o,m[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],c=n[3],f=n[6],p=n[1],m=n[4],y=n[7],v=n[2],x=n[5],b=n[8],R=s[0],M=s[3],T=s[6],D=s[1],B=s[4],L=s[7],G=s[2],H=s[5],F=s[8];return r[0]=o*R+c*D+f*G,r[3]=o*M+c*B+f*H,r[6]=o*T+c*L+f*F,r[1]=p*R+m*D+y*G,r[4]=p*M+m*B+y*H,r[7]=p*T+m*L+y*F,r[2]=v*R+x*D+b*G,r[5]=v*M+x*B+b*H,r[8]=v*T+x*L+b*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],f=e[6],p=e[7],m=e[8];return t*o*m-t*c*p-n*r*m+n*c*f+s*r*p-s*o*f}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],f=e[6],p=e[7],m=e[8],y=m*o-c*p,v=c*f-m*r,x=p*r-o*f,b=t*y+n*v+s*x;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/b;return e[0]=y*R,e[1]=(s*p-m*n)*R,e[2]=(c*n-s*o)*R,e[3]=v*R,e[4]=(m*t-s*f)*R,e[5]=(s*r-c*t)*R,e[6]=x*R,e[7]=(n*f-p*t)*R,e[8]=(o*t-n*r)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,r,o,c){const f=Math.cos(r),p=Math.sin(r);return this.set(n*f,n*p,-n*(f*o+p*c)+o+e,-s*p,s*f,-s*(-p*o+f*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(xb.makeScale(e,t)),this}rotate(e){return this.premultiply(xb.makeRotation(-e)),this}translate(e,t){return this.premultiply(xb.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const xb=new An;function gL(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const J6={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Om(i,e){return new J6[i](e)}function I_(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function yL(){const i=I_("canvas");return i.style.display="block",i}const T2={};function Hm(i){i in T2||(T2[i]=!0,console.warn(i))}function Q6(i,e,t){return new Promise(function(n,s){function r(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}const M2=new An().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),C2=new An().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Z6(){const i={enabled:!0,workingColorSpace:ff,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===pi&&(s.r=Du(s.r),s.g=Du(s.g),s.b=Du(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===pi&&(s.r=km(s.r),s.g=km(s.g),s.b=km(s.b))),s},workingToColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},colorSpaceToWorking:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Eu?w_:this.spaces[s].transfer},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,r){return Hm("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(s,r)},toWorkingColorSpace:function(s,r){return Hm("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(s,r)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[ff]:{primaries:e,whitePoint:n,transfer:w_,toXYZ:M2,fromXYZ:C2,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Nr},outputColorSpaceConfig:{drawingBufferColorSpace:Nr}},[Nr]:{primaries:e,whitePoint:n,transfer:pi,toXYZ:M2,fromXYZ:C2,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Nr}}}),i}const Gn=Z6();function Du(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function km(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let am;class _L{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{am===void 0&&(am=I_("canvas")),am.width=e.width,am.height=e.height;const s=am.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),n=am}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=I_("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=Du(r[o]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Du(t[n]/255)*255):t[n]=Du(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let $6=0;class Kh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:$6++}),this.uuid=uo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,c=s.length;o<c;o++)s[o].isDataTexture?r.push(Sb(s[o].image)):r.push(Sb(s[o]))}else r=Sb(s);n.url=r}return t||(e.images[this.uuid]=n),n}}function Sb(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?_L.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let e5=0;const Eb=new $;class ki extends Oc{constructor(e=ki.DEFAULT_IMAGE,t=ki.DEFAULT_MAPPING,n=oo,s=oo,r=_s,o=zo,c=Lr,f=ko,p=ki.DEFAULT_ANISOTROPY,m=Eu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:e5++}),this.uuid=uo(),this.name="",this.source=new Kh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=f,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new An,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Eb).x}get height(){return this.source.getSize(Eb).y}get depth(){return this.source.getSize(Eb).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}s&&n&&s.isVector2&&n.isVector2||s&&n&&s.isVector3&&n.isVector3||s&&n&&s.isMatrix3&&n.isMatrix3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==PS)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hf:e.x=e.x-Math.floor(e.x);break;case oo:e.x=e.x<0?0:1;break;case $m:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hf:e.y=e.y-Math.floor(e.y);break;case oo:e.y=e.y<0?0:1;break;case $m:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ki.DEFAULT_IMAGE=null;ki.DEFAULT_MAPPING=PS;ki.DEFAULT_ANISOTROPY=1;class Qn{constructor(e=0,t=0,n=0,s=1){Qn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*s+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*s+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*s+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,r;const f=e.elements,p=f[0],m=f[4],y=f[8],v=f[1],x=f[5],b=f[9],R=f[2],M=f[6],T=f[10];if(Math.abs(m-v)<.01&&Math.abs(y-R)<.01&&Math.abs(b-M)<.01){if(Math.abs(m+v)<.1&&Math.abs(y+R)<.1&&Math.abs(b+M)<.1&&Math.abs(p+x+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const B=(p+1)/2,L=(x+1)/2,G=(T+1)/2,H=(m+v)/4,F=(y+R)/4,U=(b+M)/4;return B>L&&B>G?B<.01?(n=0,s=.707106781,r=.707106781):(n=Math.sqrt(B),s=H/n,r=F/n):L>G?L<.01?(n=.707106781,s=0,r=.707106781):(s=Math.sqrt(L),n=H/s,r=U/s):G<.01?(n=.707106781,s=.707106781,r=0):(r=Math.sqrt(G),n=F/r,s=U/r),this.set(n,s,r,t),this}let D=Math.sqrt((M-b)*(M-b)+(y-R)*(y-R)+(v-m)*(v-m));return Math.abs(D)<.001&&(D=1),this.x=(M-b)/D,this.y=(y-R)/D,this.z=(v-m)/D,this.w=Math.acos((p+x+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=nn(this.x,e.x,t.x),this.y=nn(this.y,e.y,t.y),this.z=nn(this.z,e.z,t.z),this.w=nn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=nn(this.x,e,t),this.y=nn(this.y,e,t),this.z=nn(this.z,e,t),this.w=nn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(nn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class tC extends Oc{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_s,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Qn(0,0,e,t),this.scissorTest=!1,this.viewport=new Qn(0,0,e,t);const s={width:e,height:t,depth:n.depth},r=new ki(s);this.textures=[];const o=n.count;for(let c=0;c<o;c++)this.textures[c]=r.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:_s,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n,this.textures[s].isArrayTexture=this.textures[s].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new Kh(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Bc extends tC{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class XS extends ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Qs,this.minFilter=Qs,this.wrapR=oo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class t5 extends Bc{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new XS(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class WS extends ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Qs,this.minFilter=Qs,this.wrapR=oo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class n5 extends Bc{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new WS(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class $s{constructor(e=new $(1/0,1/0,1/0),t=new $(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(gl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(gl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=gl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,c=r.count;o<c;o++)e.isMesh===!0?e.getVertexPosition(o,gl):gl.fromBufferAttribute(r,o),gl.applyMatrix4(e.matrixWorld),this.expandByPoint(gl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),I0.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),I0.copy(n.boundingBox)),I0.applyMatrix4(e.matrixWorld),this.union(I0)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,gl),gl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ny),B0.subVectors(this.max,Ny),om.subVectors(e.a,Ny),lm.subVectors(e.b,Ny),cm.subVectors(e.c,Ny),Oh.subVectors(lm,om),Lh.subVectors(cm,lm),ld.subVectors(om,cm);let t=[0,-Oh.z,Oh.y,0,-Lh.z,Lh.y,0,-ld.z,ld.y,Oh.z,0,-Oh.x,Lh.z,0,-Lh.x,ld.z,0,-ld.x,-Oh.y,Oh.x,0,-Lh.y,Lh.x,0,-ld.y,ld.x,0];return!bb(t,om,lm,cm,B0)||(t=[1,0,0,0,1,0,0,0,1],!bb(t,om,lm,cm,B0))?!1:(N0.crossVectors(Oh,Lh),t=[N0.x,N0.y,N0.z],bb(t,om,lm,cm,B0))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,gl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(gl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(fu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),fu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),fu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),fu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),fu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),fu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),fu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),fu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(fu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const fu=[new $,new $,new $,new $,new $,new $,new $,new $],gl=new $,I0=new $s,om=new $,lm=new $,cm=new $,Oh=new $,Lh=new $,ld=new $,Ny=new $,B0=new $,N0=new $,cd=new $;function bb(i,e,t,n,s){for(let r=0,o=i.length-3;r<=o;r+=3){cd.fromArray(i,r);const c=s.x*Math.abs(cd.x)+s.y*Math.abs(cd.y)+s.z*Math.abs(cd.z),f=e.dot(cd),p=t.dot(cd),m=n.dot(cd);if(Math.max(-Math.max(f,p,m),Math.min(f,p,m))>c)return!1}return!0}const i5=new $s,Oy=new $,Tb=new $;class zs{constructor(e=new $,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):i5.setFromPoints(e).getCenter(n);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Oy.subVectors(e,this.center);const t=Oy.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(Oy,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Tb.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Oy.copy(e.center).add(Tb)),this.expandByPoint(Oy.copy(e.center).sub(Tb))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const du=new $,Mb=new $,O0=new $,Uh=new $,Cb=new $,L0=new $,Rb=new $;class op{constructor(e=new $,t=new $(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,du)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=du.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(du.copy(this.origin).addScaledVector(this.direction,t),du.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){Mb.copy(e).add(t).multiplyScalar(.5),O0.copy(t).sub(e).normalize(),Uh.copy(this.origin).sub(Mb);const r=e.distanceTo(t)*.5,o=-this.direction.dot(O0),c=Uh.dot(this.direction),f=-Uh.dot(O0),p=Uh.lengthSq(),m=Math.abs(1-o*o);let y,v,x,b;if(m>0)if(y=o*f-c,v=o*c-f,b=r*m,y>=0)if(v>=-b)if(v<=b){const R=1/m;y*=R,v*=R,x=y*(y+o*v+2*c)+v*(o*y+v+2*f)+p}else v=r,y=Math.max(0,-(o*v+c)),x=-y*y+v*(v+2*f)+p;else v=-r,y=Math.max(0,-(o*v+c)),x=-y*y+v*(v+2*f)+p;else v<=-b?(y=Math.max(0,-(-o*r+c)),v=y>0?-r:Math.min(Math.max(-r,-f),r),x=-y*y+v*(v+2*f)+p):v<=b?(y=0,v=Math.min(Math.max(-r,-f),r),x=v*(v+2*f)+p):(y=Math.max(0,-(o*r+c)),v=y>0?r:Math.min(Math.max(-r,-f),r),x=-y*y+v*(v+2*f)+p);else v=o>0?-r:r,y=Math.max(0,-(o*v+c)),x=-y*y+v*(v+2*f)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,y),s&&s.copy(Mb).addScaledVector(O0,v),x}intersectSphere(e,t){du.subVectors(e.center,this.origin);const n=du.dot(this.direction),s=du.dot(du)-n*n,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),c=n-o,f=n+o;return f<0?null:c<0?this.at(f,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,r,o,c,f;const p=1/this.direction.x,m=1/this.direction.y,y=1/this.direction.z,v=this.origin;return p>=0?(n=(e.min.x-v.x)*p,s=(e.max.x-v.x)*p):(n=(e.max.x-v.x)*p,s=(e.min.x-v.x)*p),m>=0?(r=(e.min.y-v.y)*m,o=(e.max.y-v.y)*m):(r=(e.max.y-v.y)*m,o=(e.min.y-v.y)*m),n>o||r>s||((r>n||isNaN(n))&&(n=r),(o<s||isNaN(s))&&(s=o),y>=0?(c=(e.min.z-v.z)*y,f=(e.max.z-v.z)*y):(c=(e.max.z-v.z)*y,f=(e.min.z-v.z)*y),n>f||c>s)||((c>n||n!==n)&&(n=c),(f<s||s!==s)&&(s=f),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,du)!==null}intersectTriangle(e,t,n,s,r){Cb.subVectors(t,e),L0.subVectors(n,e),Rb.crossVectors(Cb,L0);let o=this.direction.dot(Rb),c;if(o>0){if(s)return null;c=1}else if(o<0)c=-1,o=-o;else return null;Uh.subVectors(this.origin,e);const f=c*this.direction.dot(L0.crossVectors(Uh,L0));if(f<0)return null;const p=c*this.direction.dot(Cb.cross(Uh));if(p<0||f+p>o)return null;const m=-c*Uh.dot(Rb);return m<0?null:this.at(m/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Jt{constructor(e,t,n,s,r,o,c,f,p,m,y,v,x,b,R,M){Jt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,c,f,p,m,y,v,x,b,R,M)}set(e,t,n,s,r,o,c,f,p,m,y,v,x,b,R,M){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=s,T[1]=r,T[5]=o,T[9]=c,T[13]=f,T[2]=p,T[6]=m,T[10]=y,T[14]=v,T[3]=x,T[7]=b,T[11]=R,T[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Jt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/um.setFromMatrixColumn(e,0).length(),r=1/um.setFromMatrixColumn(e,1).length(),o=1/um.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,r=e.z,o=Math.cos(n),c=Math.sin(n),f=Math.cos(s),p=Math.sin(s),m=Math.cos(r),y=Math.sin(r);if(e.order==="XYZ"){const v=o*m,x=o*y,b=c*m,R=c*y;t[0]=f*m,t[4]=-f*y,t[8]=p,t[1]=x+b*p,t[5]=v-R*p,t[9]=-c*f,t[2]=R-v*p,t[6]=b+x*p,t[10]=o*f}else if(e.order==="YXZ"){const v=f*m,x=f*y,b=p*m,R=p*y;t[0]=v+R*c,t[4]=b*c-x,t[8]=o*p,t[1]=o*y,t[5]=o*m,t[9]=-c,t[2]=x*c-b,t[6]=R+v*c,t[10]=o*f}else if(e.order==="ZXY"){const v=f*m,x=f*y,b=p*m,R=p*y;t[0]=v-R*c,t[4]=-o*y,t[8]=b+x*c,t[1]=x+b*c,t[5]=o*m,t[9]=R-v*c,t[2]=-o*p,t[6]=c,t[10]=o*f}else if(e.order==="ZYX"){const v=o*m,x=o*y,b=c*m,R=c*y;t[0]=f*m,t[4]=b*p-x,t[8]=v*p+R,t[1]=f*y,t[5]=R*p+v,t[9]=x*p-b,t[2]=-p,t[6]=c*f,t[10]=o*f}else if(e.order==="YZX"){const v=o*f,x=o*p,b=c*f,R=c*p;t[0]=f*m,t[4]=R-v*y,t[8]=b*y+x,t[1]=y,t[5]=o*m,t[9]=-c*m,t[2]=-p*m,t[6]=x*y+b,t[10]=v-R*y}else if(e.order==="XZY"){const v=o*f,x=o*p,b=c*f,R=c*p;t[0]=f*m,t[4]=-y,t[8]=p*m,t[1]=v*y+R,t[5]=o*m,t[9]=x*y-b,t[2]=b*y-x,t[6]=c*m,t[10]=R*y+v}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(s5,e,r5)}lookAt(e,t,n){const s=this.elements;return io.subVectors(e,t),io.lengthSq()===0&&(io.z=1),io.normalize(),Ph.crossVectors(n,io),Ph.lengthSq()===0&&(Math.abs(n.z)===1?io.x+=1e-4:io.z+=1e-4,io.normalize(),Ph.crossVectors(n,io)),Ph.normalize(),U0.crossVectors(io,Ph),s[0]=Ph.x,s[4]=U0.x,s[8]=io.x,s[1]=Ph.y,s[5]=U0.y,s[9]=io.y,s[2]=Ph.z,s[6]=U0.z,s[10]=io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],c=n[4],f=n[8],p=n[12],m=n[1],y=n[5],v=n[9],x=n[13],b=n[2],R=n[6],M=n[10],T=n[14],D=n[3],B=n[7],L=n[11],G=n[15],H=s[0],F=s[4],U=s[8],I=s[12],N=s[1],z=s[5],W=s[9],k=s[13],he=s[2],me=s[6],q=s[10],ee=s[14],ne=s[3],ye=s[7],K=s[11],ce=s[15];return r[0]=o*H+c*N+f*he+p*ne,r[4]=o*F+c*z+f*me+p*ye,r[8]=o*U+c*W+f*q+p*K,r[12]=o*I+c*k+f*ee+p*ce,r[1]=m*H+y*N+v*he+x*ne,r[5]=m*F+y*z+v*me+x*ye,r[9]=m*U+y*W+v*q+x*K,r[13]=m*I+y*k+v*ee+x*ce,r[2]=b*H+R*N+M*he+T*ne,r[6]=b*F+R*z+M*me+T*ye,r[10]=b*U+R*W+M*q+T*K,r[14]=b*I+R*k+M*ee+T*ce,r[3]=D*H+B*N+L*he+G*ne,r[7]=D*F+B*z+L*me+G*ye,r[11]=D*U+B*W+L*q+G*K,r[15]=D*I+B*k+L*ee+G*ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],r=e[12],o=e[1],c=e[5],f=e[9],p=e[13],m=e[2],y=e[6],v=e[10],x=e[14],b=e[3],R=e[7],M=e[11],T=e[15];return b*(+r*f*y-s*p*y-r*c*v+n*p*v+s*c*x-n*f*x)+R*(+t*f*x-t*p*v+r*o*v-s*o*x+s*p*m-r*f*m)+M*(+t*p*y-t*c*x-r*o*y+n*o*x+r*c*m-n*p*m)+T*(-s*c*m-t*f*y+t*c*v+s*o*y-n*o*v+n*f*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],f=e[6],p=e[7],m=e[8],y=e[9],v=e[10],x=e[11],b=e[12],R=e[13],M=e[14],T=e[15],D=y*M*p-R*v*p+R*f*x-c*M*x-y*f*T+c*v*T,B=b*v*p-m*M*p-b*f*x+o*M*x+m*f*T-o*v*T,L=m*R*p-b*y*p+b*c*x-o*R*x-m*c*T+o*y*T,G=b*y*f-m*R*f-b*c*v+o*R*v+m*c*M-o*y*M,H=t*D+n*B+s*L+r*G;if(H===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const F=1/H;return e[0]=D*F,e[1]=(R*v*r-y*M*r-R*s*x+n*M*x+y*s*T-n*v*T)*F,e[2]=(c*M*r-R*f*r+R*s*p-n*M*p-c*s*T+n*f*T)*F,e[3]=(y*f*r-c*v*r-y*s*p+n*v*p+c*s*x-n*f*x)*F,e[4]=B*F,e[5]=(m*M*r-b*v*r+b*s*x-t*M*x-m*s*T+t*v*T)*F,e[6]=(b*f*r-o*M*r-b*s*p+t*M*p+o*s*T-t*f*T)*F,e[7]=(o*v*r-m*f*r+m*s*p-t*v*p-o*s*x+t*f*x)*F,e[8]=L*F,e[9]=(b*y*r-m*R*r-b*n*x+t*R*x+m*n*T-t*y*T)*F,e[10]=(o*R*r-b*c*r+b*n*p-t*R*p-o*n*T+t*c*T)*F,e[11]=(m*c*r-o*y*r-m*n*p+t*y*p+o*n*x-t*c*x)*F,e[12]=G*F,e[13]=(m*R*s-b*y*s+b*n*v-t*R*v-m*n*M+t*y*M)*F,e[14]=(b*c*s-o*R*s-b*n*f+t*R*f+o*n*M-t*c*M)*F,e[15]=(o*y*s-m*c*s+m*n*f-t*y*f-o*n*v+t*c*v)*F,this}scale(e){const t=this.elements,n=e.x,s=e.y,r=e.z;return t[0]*=n,t[4]*=s,t[8]*=r,t[1]*=n,t[5]*=s,t[9]*=r,t[2]*=n,t[6]*=s,t[10]*=r,t[3]*=n,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),r=1-n,o=e.x,c=e.y,f=e.z,p=r*o,m=r*c;return this.set(p*o+n,p*c-s*f,p*f+s*c,0,p*c+s*f,m*c+n,m*f-s*o,0,p*f-s*c,m*f+s*o,r*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,r,o){return this.set(1,n,r,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,r=t._x,o=t._y,c=t._z,f=t._w,p=r+r,m=o+o,y=c+c,v=r*p,x=r*m,b=r*y,R=o*m,M=o*y,T=c*y,D=f*p,B=f*m,L=f*y,G=n.x,H=n.y,F=n.z;return s[0]=(1-(R+T))*G,s[1]=(x+L)*G,s[2]=(b-B)*G,s[3]=0,s[4]=(x-L)*H,s[5]=(1-(v+T))*H,s[6]=(M+D)*H,s[7]=0,s[8]=(b+B)*F,s[9]=(M-D)*F,s[10]=(1-(v+R))*F,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let r=um.set(s[0],s[1],s[2]).length();const o=um.set(s[4],s[5],s[6]).length(),c=um.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),e.x=s[12],e.y=s[13],e.z=s[14],yl.copy(this);const p=1/r,m=1/o,y=1/c;return yl.elements[0]*=p,yl.elements[1]*=p,yl.elements[2]*=p,yl.elements[4]*=m,yl.elements[5]*=m,yl.elements[6]*=m,yl.elements[8]*=y,yl.elements[9]*=y,yl.elements[10]*=y,t.setFromRotationMatrix(yl),n.x=r,n.y=o,n.z=c,this}makePerspective(e,t,n,s,r,o,c=lo,f=!1){const p=this.elements,m=2*r/(t-e),y=2*r/(n-s),v=(t+e)/(t-e),x=(n+s)/(n-s);let b,R;if(f)b=r/(o-r),R=o*r/(o-r);else if(c===lo)b=-(o+r)/(o-r),R=-2*o*r/(o-r);else if(c===ag)b=-o/(o-r),R=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return p[0]=m,p[4]=0,p[8]=v,p[12]=0,p[1]=0,p[5]=y,p[9]=x,p[13]=0,p[2]=0,p[6]=0,p[10]=b,p[14]=R,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,s,r,o,c=lo,f=!1){const p=this.elements,m=2/(t-e),y=2/(n-s),v=-(t+e)/(t-e),x=-(n+s)/(n-s);let b,R;if(f)b=1/(o-r),R=o/(o-r);else if(c===lo)b=-2/(o-r),R=-(o+r)/(o-r);else if(c===ag)b=-1/(o-r),R=-r/(o-r);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return p[0]=m,p[4]=0,p[8]=0,p[12]=v,p[1]=0,p[5]=y,p[9]=0,p[13]=x,p[2]=0,p[6]=0,p[10]=b,p[14]=R,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const um=new $,yl=new Jt,s5=new $(0,0,0),r5=new $(1,1,1),Ph=new $,U0=new $,io=new $,R2=new Jt,w2=new Zs;class ho{constructor(e=0,t=0,n=0,s=ho.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,r=s[0],o=s[4],c=s[8],f=s[1],p=s[5],m=s[9],y=s[2],v=s[6],x=s[10];switch(t){case"XYZ":this._y=Math.asin(nn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-m,x),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(v,p),this._z=0);break;case"YXZ":this._x=Math.asin(-nn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(c,x),this._z=Math.atan2(f,p)):(this._y=Math.atan2(-y,r),this._z=0);break;case"ZXY":this._x=Math.asin(nn(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-y,x),this._z=Math.atan2(-o,p)):(this._y=0,this._z=Math.atan2(f,r));break;case"ZYX":this._y=Math.asin(-nn(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(v,x),this._z=Math.atan2(f,r)):(this._x=0,this._z=Math.atan2(-o,p));break;case"YZX":this._z=Math.asin(nn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,p),this._y=Math.atan2(-y,r)):(this._x=0,this._y=Math.atan2(c,x));break;case"XZY":this._z=Math.asin(-nn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(v,p),this._y=Math.atan2(c,r)):(this._x=Math.atan2(-m,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return R2.makeRotationFromQuaternion(e),this.setFromRotationMatrix(R2,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return w2.setFromEuler(this),this.setFromQuaternion(w2,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ho.DEFAULT_ORDER="XYZ";class lg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let a5=0;const D2=new $,hm=new Zs,pu=new Jt,P0=new $,Ly=new $,o5=new $,l5=new Zs,I2=new $(1,0,0),B2=new $(0,1,0),N2=new $(0,0,1),O2={type:"added"},c5={type:"removed"},fm={type:"childadded",child:null},wb={type:"childremoved",child:null};class jn extends Oc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:a5++}),this.uuid=uo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=jn.DEFAULT_UP.clone();const e=new $,t=new ho,n=new Zs,s=new $(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Jt},normalMatrix:{value:new An}}),this.matrix=new Jt,this.matrixWorld=new Jt,this.matrixAutoUpdate=jn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=jn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new lg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hm.setFromAxisAngle(e,t),this.quaternion.multiply(hm),this}rotateOnWorldAxis(e,t){return hm.setFromAxisAngle(e,t),this.quaternion.premultiply(hm),this}rotateX(e){return this.rotateOnAxis(I2,e)}rotateY(e){return this.rotateOnAxis(B2,e)}rotateZ(e){return this.rotateOnAxis(N2,e)}translateOnAxis(e,t){return D2.copy(e).applyQuaternion(this.quaternion),this.position.add(D2.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(I2,e)}translateY(e){return this.translateOnAxis(B2,e)}translateZ(e){return this.translateOnAxis(N2,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?P0.copy(e):P0.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),Ly.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pu.lookAt(Ly,P0,this.up):pu.lookAt(P0,Ly,this.up),this.quaternion.setFromRotationMatrix(pu),s&&(pu.extractRotation(s.matrixWorld),hm.setFromRotationMatrix(pu),this.quaternion.premultiply(hm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(O2),fm.child=e,this.dispatchEvent(fm),fm.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(c5),wb.child=e,this.dispatchEvent(wb),wb.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),pu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),pu.multiply(e.parent.matrixWorld)),e.applyMatrix4(pu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(O2),fm.child=e,this.dispatchEvent(fm),fm.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ly,e,o5),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ly,l5,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(c=>({...c})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function r(c,f){return c[f.uuid]===void 0&&(c[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const f=c.shapes;if(Array.isArray(f))for(let p=0,m=f.length;p<m;p++){const y=f[p];r(e.shapes,y)}else r(e.shapes,f)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let f=0,p=this.material.length;f<p;f++)c.push(r(e.materials,this.material[f]));s.material=c}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){const f=this.animations[c];s.animations.push(r(e.animations,f))}}if(t){const c=o(e.geometries),f=o(e.materials),p=o(e.textures),m=o(e.images),y=o(e.shapes),v=o(e.skeletons),x=o(e.animations),b=o(e.nodes);c.length>0&&(n.geometries=c),f.length>0&&(n.materials=f),p.length>0&&(n.textures=p),m.length>0&&(n.images=m),y.length>0&&(n.shapes=y),v.length>0&&(n.skeletons=v),x.length>0&&(n.animations=x),b.length>0&&(n.nodes=b)}return n.object=s,n;function o(c){const f=[];for(const p in c){const m=c[p];delete m.metadata,f.push(m)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}jn.DEFAULT_UP=new $(0,1,0);jn.DEFAULT_MATRIX_AUTO_UPDATE=!0;jn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _l=new $,mu=new $,Db=new $,gu=new $,dm=new $,pm=new $,L2=new $,Ib=new $,Bb=new $,Nb=new $,Ob=new Qn,Lb=new Qn,Ub=new Qn;class Fa{constructor(e=new $,t=new $,n=new $){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),_l.subVectors(e,t),s.cross(_l);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,n,s,r){_l.subVectors(s,t),mu.subVectors(n,t),Db.subVectors(e,t);const o=_l.dot(_l),c=_l.dot(mu),f=_l.dot(Db),p=mu.dot(mu),m=mu.dot(Db),y=o*p-c*c;if(y===0)return r.set(0,0,0),null;const v=1/y,x=(p*f-c*m)*v,b=(o*m-c*f)*v;return r.set(1-x-b,b,x)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,gu)===null?!1:gu.x>=0&&gu.y>=0&&gu.x+gu.y<=1}static getInterpolation(e,t,n,s,r,o,c,f){return this.getBarycoord(e,t,n,s,gu)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(r,gu.x),f.addScaledVector(o,gu.y),f.addScaledVector(c,gu.z),f)}static getInterpolatedAttribute(e,t,n,s,r,o){return Ob.setScalar(0),Lb.setScalar(0),Ub.setScalar(0),Ob.fromBufferAttribute(e,t),Lb.fromBufferAttribute(e,n),Ub.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(Ob,r.x),o.addScaledVector(Lb,r.y),o.addScaledVector(Ub,r.z),o}static isFrontFacing(e,t,n,s){return _l.subVectors(n,t),mu.subVectors(e,t),_l.cross(mu).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _l.subVectors(this.c,this.b),mu.subVectors(this.a,this.b),_l.cross(mu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fa.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Fa.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,r){return Fa.getInterpolation(e,this.a,this.b,this.c,t,n,s,r)}containsPoint(e){return Fa.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fa.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,r=this.c;let o,c;dm.subVectors(s,n),pm.subVectors(r,n),Ib.subVectors(e,n);const f=dm.dot(Ib),p=pm.dot(Ib);if(f<=0&&p<=0)return t.copy(n);Bb.subVectors(e,s);const m=dm.dot(Bb),y=pm.dot(Bb);if(m>=0&&y<=m)return t.copy(s);const v=f*y-m*p;if(v<=0&&f>=0&&m<=0)return o=f/(f-m),t.copy(n).addScaledVector(dm,o);Nb.subVectors(e,r);const x=dm.dot(Nb),b=pm.dot(Nb);if(b>=0&&x<=b)return t.copy(r);const R=x*p-f*b;if(R<=0&&p>=0&&b<=0)return c=p/(p-b),t.copy(n).addScaledVector(pm,c);const M=m*b-x*y;if(M<=0&&y-m>=0&&x-b>=0)return L2.subVectors(r,s),c=(y-m)/(y-m+(x-b)),t.copy(s).addScaledVector(L2,c);const T=1/(M+R+v);return o=R*T,c=v*T,t.copy(n).addScaledVector(dm,o).addScaledVector(pm,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const vL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Fh={h:0,s:0,l:0},F0={h:0,s:0,l:0};function Pb(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class St{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Nr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Gn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,s=Gn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Gn.colorSpaceToWorking(this,s),this}setHSL(e,t,n,s=Gn.workingColorSpace){if(e=eC(e,1),t=nn(t,0,1),n=nn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=Pb(o,r,e+1/3),this.g=Pb(o,r,e),this.b=Pb(o,r,e-1/3)}return Gn.colorSpaceToWorking(this,s),this}setStyle(e,t=Nr){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],c=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Nr){const n=vL[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Du(e.r),this.g=Du(e.g),this.b=Du(e.b),this}copyLinearToSRGB(e){return this.r=km(e.r),this.g=km(e.g),this.b=km(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Nr){return Gn.workingToColorSpace(Dr.copy(this),e),Math.round(nn(Dr.r*255,0,255))*65536+Math.round(nn(Dr.g*255,0,255))*256+Math.round(nn(Dr.b*255,0,255))}getHexString(e=Nr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Gn.workingColorSpace){Gn.workingToColorSpace(Dr.copy(this),t);const n=Dr.r,s=Dr.g,r=Dr.b,o=Math.max(n,s,r),c=Math.min(n,s,r);let f,p;const m=(c+o)/2;if(c===o)f=0,p=0;else{const y=o-c;switch(p=m<=.5?y/(o+c):y/(2-o-c),o){case n:f=(s-r)/y+(s<r?6:0);break;case s:f=(r-n)/y+2;break;case r:f=(n-s)/y+4;break}f/=6}return e.h=f,e.s=p,e.l=m,e}getRGB(e,t=Gn.workingColorSpace){return Gn.workingToColorSpace(Dr.copy(this),t),e.r=Dr.r,e.g=Dr.g,e.b=Dr.b,e}getStyle(e=Nr){Gn.workingToColorSpace(Dr.copy(this),e);const t=Dr.r,n=Dr.g,s=Dr.b;return e!==Nr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL(Fh),this.setHSL(Fh.h+e,Fh.s+t,Fh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Fh),e.getHSL(F0);const n=f_(Fh.h,F0.h,t),s=f_(Fh.s,F0.s,t),r=f_(Fh.l,F0.l,t);return this.setHSL(n,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*s,this.g=r[1]*t+r[4]*n+r[7]*s,this.b=r[2]*t+r[5]*n+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Dr=new St;St.NAMES=vL;let u5=0;class Vs extends Oc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:u5++}),this.uuid=uo(),this.name="",this.type="Material",this.blending=kd,this.side=Ic,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=mx,this.blendDst=gx,this.blendEquation=qh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=Jd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=gM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Md,this.stencilZFail=Md,this.stencilZPass=Md,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==kd&&(n.blending=this.blending),this.side!==Ic&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==mx&&(n.blendSrc=this.blendSrc),this.blendDst!==gx&&(n.blendDst=this.blendDst),this.blendEquation!==qh&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Jd&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==gM&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Md&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Md&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Md&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(r){const o=[];for(const c in r){const f=r[c];delete f.metadata,o.push(f)}return o}if(t){const r=s(e.textures),o=s(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let r=0;r!==s;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class co extends Vs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.combine=Z_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const bu=h5();function h5(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),s=new Uint32Array(512);for(let f=0;f<256;++f){const p=f-127;p<-27?(n[f]=0,n[f|256]=32768,s[f]=24,s[f|256]=24):p<-14?(n[f]=1024>>-p-14,n[f|256]=1024>>-p-14|32768,s[f]=-p-1,s[f|256]=-p-1):p<=15?(n[f]=p+15<<10,n[f|256]=p+15<<10|32768,s[f]=13,s[f|256]=13):p<128?(n[f]=31744,n[f|256]=64512,s[f]=24,s[f|256]=24):(n[f]=31744,n[f|256]=64512,s[f]=13,s[f|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),c=new Uint32Array(64);for(let f=1;f<1024;++f){let p=f<<13,m=0;for(;(p&8388608)===0;)p<<=1,m-=8388608;p&=-8388609,m+=947912704,r[f]=p|m}for(let f=1024;f<2048;++f)r[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)o[f]=f<<23;o[31]=1199570944,o[32]=2147483648;for(let f=33;f<63;++f)o[f]=2147483648+(f-32<<23);o[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(c[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:c}}function Oa(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=nn(i,-65504,65504),bu.floatView[0]=i;const e=bu.uint32View[0],t=e>>23&511;return bu.baseTable[t]+((e&8388607)>>bu.shiftTable[t])}function Jy(i){const e=i>>10;return bu.uint32View[0]=bu.mantissaTable[bu.offsetTable[e]+(i&1023)]+bu.exponentTable[e],bu.floatView[0]}class f5{static toHalfFloat(e){return Oa(e)}static fromHalfFloat(e){return Jy(e)}}const Rs=new $,z0=new Xe;let d5=0;class Zn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:d5++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=D_,this.updateRanges=[],this.gpuType=za,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)z0.fromBufferAttribute(this,t),z0.applyMatrix3(e),this.setXY(t,z0.x,z0.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.applyMatrix3(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.applyMatrix4(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.applyNormalMatrix(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.transformDirection(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=la(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=la(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=la(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=la(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=la(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),s=En(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),s=En(s,this.array),r=En(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==D_&&(e.usage=this.usage),e}}class p5 extends Zn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class m5 extends Zn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class g5 extends Zn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class y5 extends Zn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class nC extends Zn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class _5 extends Zn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class iC extends Zn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class v5 extends Zn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Jy(this.array[e*this.itemSize]);return this.normalized&&(t=la(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=Oa(t),this}getY(e){let t=Jy(this.array[e*this.itemSize+1]);return this.normalized&&(t=la(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=Oa(t),this}getZ(e){let t=Jy(this.array[e*this.itemSize+2]);return this.normalized&&(t=la(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=Oa(t),this}getW(e){let t=Jy(this.array[e*this.itemSize+3]);return this.normalized&&(t=la(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=Oa(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.array[e+0]=Oa(t),this.array[e+1]=Oa(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),s=En(s,this.array)),this.array[e+0]=Oa(t),this.array[e+1]=Oa(n),this.array[e+2]=Oa(s),this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),s=En(s,this.array),r=En(r,this.array)),this.array[e+0]=Oa(t),this.array[e+1]=Oa(n),this.array[e+2]=Oa(s),this.array[e+3]=Oa(r),this}}class Pt extends Zn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let A5=0;const Lo=new Jt,Fb=new jn,mm=new $,so=new $s,Uy=new $s,Ks=new $;class yn extends Oc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:A5++}),this.uuid=uo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(gL(e)?iC:nC)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new An().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Lo.makeRotationFromQuaternion(e),this.applyMatrix4(Lo),this}rotateX(e){return Lo.makeRotationX(e),this.applyMatrix4(Lo),this}rotateY(e){return Lo.makeRotationY(e),this.applyMatrix4(Lo),this}rotateZ(e){return Lo.makeRotationZ(e),this.applyMatrix4(Lo),this}translate(e,t,n){return Lo.makeTranslation(e,t,n),this.applyMatrix4(Lo),this}scale(e,t,n){return Lo.makeScale(e,t,n),this.applyMatrix4(Lo),this}lookAt(e){return Fb.lookAt(e),Fb.updateMatrix(),this.applyMatrix4(Fb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(mm).negate(),this.translate(mm.x,mm.y,mm.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Pt(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $s);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new $(-1/0,-1/0,-1/0),new $(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const r=t[n];so.setFromBufferAttribute(r),this.morphTargetsRelative?(Ks.addVectors(this.boundingBox.min,so.min),this.boundingBox.expandByPoint(Ks),Ks.addVectors(this.boundingBox.max,so.max),this.boundingBox.expandByPoint(Ks)):(this.boundingBox.expandByPoint(so.min),this.boundingBox.expandByPoint(so.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new $,1/0);return}if(e){const n=this.boundingSphere.center;if(so.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const c=t[r];Uy.setFromBufferAttribute(c),this.morphTargetsRelative?(Ks.addVectors(so.min,Uy.min),so.expandByPoint(Ks),Ks.addVectors(so.max,Uy.max),so.expandByPoint(Ks)):(so.expandByPoint(Uy.min),so.expandByPoint(Uy.max))}so.getCenter(n);let s=0;for(let r=0,o=e.count;r<o;r++)Ks.fromBufferAttribute(e,r),s=Math.max(s,n.distanceToSquared(Ks));if(t)for(let r=0,o=t.length;r<o;r++){const c=t[r],f=this.morphTargetsRelative;for(let p=0,m=c.count;p<m;p++)Ks.fromBufferAttribute(c,p),f&&(mm.fromBufferAttribute(e,p),Ks.add(mm)),s=Math.max(s,n.distanceToSquared(Ks))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Zn(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),c=[],f=[];for(let U=0;U<n.count;U++)c[U]=new $,f[U]=new $;const p=new $,m=new $,y=new $,v=new Xe,x=new Xe,b=new Xe,R=new $,M=new $;function T(U,I,N){p.fromBufferAttribute(n,U),m.fromBufferAttribute(n,I),y.fromBufferAttribute(n,N),v.fromBufferAttribute(r,U),x.fromBufferAttribute(r,I),b.fromBufferAttribute(r,N),m.sub(p),y.sub(p),x.sub(v),b.sub(v);const z=1/(x.x*b.y-b.x*x.y);isFinite(z)&&(R.copy(m).multiplyScalar(b.y).addScaledVector(y,-x.y).multiplyScalar(z),M.copy(y).multiplyScalar(x.x).addScaledVector(m,-b.x).multiplyScalar(z),c[U].add(R),c[I].add(R),c[N].add(R),f[U].add(M),f[I].add(M),f[N].add(M))}let D=this.groups;D.length===0&&(D=[{start:0,count:e.count}]);for(let U=0,I=D.length;U<I;++U){const N=D[U],z=N.start,W=N.count;for(let k=z,he=z+W;k<he;k+=3)T(e.getX(k+0),e.getX(k+1),e.getX(k+2))}const B=new $,L=new $,G=new $,H=new $;function F(U){G.fromBufferAttribute(s,U),H.copy(G);const I=c[U];B.copy(I),B.sub(G.multiplyScalar(G.dot(I))).normalize(),L.crossVectors(H,I);const z=L.dot(f[U])<0?-1:1;o.setXYZW(U,B.x,B.y,B.z,z)}for(let U=0,I=D.length;U<I;++U){const N=D[U],z=N.start,W=N.count;for(let k=z,he=z+W;k<he;k+=3)F(e.getX(k+0)),F(e.getX(k+1)),F(e.getX(k+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Zn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let v=0,x=n.count;v<x;v++)n.setXYZ(v,0,0,0);const s=new $,r=new $,o=new $,c=new $,f=new $,p=new $,m=new $,y=new $;if(e)for(let v=0,x=e.count;v<x;v+=3){const b=e.getX(v+0),R=e.getX(v+1),M=e.getX(v+2);s.fromBufferAttribute(t,b),r.fromBufferAttribute(t,R),o.fromBufferAttribute(t,M),m.subVectors(o,r),y.subVectors(s,r),m.cross(y),c.fromBufferAttribute(n,b),f.fromBufferAttribute(n,R),p.fromBufferAttribute(n,M),c.add(m),f.add(m),p.add(m),n.setXYZ(b,c.x,c.y,c.z),n.setXYZ(R,f.x,f.y,f.z),n.setXYZ(M,p.x,p.y,p.z)}else for(let v=0,x=t.count;v<x;v+=3)s.fromBufferAttribute(t,v+0),r.fromBufferAttribute(t,v+1),o.fromBufferAttribute(t,v+2),m.subVectors(o,r),y.subVectors(s,r),m.cross(y),n.setXYZ(v+0,m.x,m.y,m.z),n.setXYZ(v+1,m.x,m.y,m.z),n.setXYZ(v+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ks.fromBufferAttribute(e,t),Ks.normalize(),e.setXYZ(t,Ks.x,Ks.y,Ks.z)}toNonIndexed(){function e(c,f){const p=c.array,m=c.itemSize,y=c.normalized,v=new p.constructor(f.length*m);let x=0,b=0;for(let R=0,M=f.length;R<M;R++){c.isInterleavedBufferAttribute?x=f[R]*c.data.stride+c.offset:x=f[R]*m;for(let T=0;T<m;T++)v[b++]=p[x++]}return new Zn(v,m,y)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new yn,n=this.index.array,s=this.attributes;for(const c in s){const f=s[c],p=e(f,n);t.setAttribute(c,p)}const r=this.morphAttributes;for(const c in r){const f=[],p=r[c];for(let m=0,y=p.length;m<y;m++){const v=p[m],x=e(v,n);f.push(x)}t.morphAttributes[c]=f}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,f=o.length;c<f;c++){const p=o[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const p in f)f[p]!==void 0&&(e[p]=f[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const p=n[f];e.data.attributes[f]=p.toJSON(e.data)}const s={};let r=!1;for(const f in this.morphAttributes){const p=this.morphAttributes[f],m=[];for(let y=0,v=p.length;y<v;y++){const x=p[y];m.push(x.toJSON(e.data))}m.length>0&&(s[f]=m,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const s=e.attributes;for(const p in s){const m=s[p];this.setAttribute(p,m.clone(t))}const r=e.morphAttributes;for(const p in r){const m=[],y=r[p];for(let v=0,x=y.length;v<x;v++)m.push(y[v].clone(t));this.morphAttributes[p]=m}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let p=0,m=o.length;p<m;p++){const y=o[p];this.addGroup(y.start,y.count,y.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const U2=new Jt,ud=new op,V0=new zs,P2=new $,H0=new $,k0=new $,G0=new $,zb=new $,j0=new $,F2=new $,q0=new $;class vs extends jn{constructor(e=new yn,t=new co){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const c=this.morphTargetInfluences;if(r&&c){j0.set(0,0,0);for(let f=0,p=r.length;f<p;f++){const m=c[f],y=r[f];m!==0&&(zb.fromBufferAttribute(y,e),o?j0.addScaledVector(zb,m):j0.addScaledVector(zb.sub(t),m))}t.add(j0)}return t}raycast(e,t){const n=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),V0.copy(n.boundingSphere),V0.applyMatrix4(r),ud.copy(e.ray).recast(e.near),!(V0.containsPoint(ud.origin)===!1&&(ud.intersectSphere(V0,P2)===null||ud.origin.distanceToSquared(P2)>(e.far-e.near)**2))&&(U2.copy(r).invert(),ud.copy(e.ray).applyMatrix4(U2),!(n.boundingBox!==null&&ud.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,ud)))}_computeIntersections(e,t,n){let s;const r=this.geometry,o=this.material,c=r.index,f=r.attributes.position,p=r.attributes.uv,m=r.attributes.uv1,y=r.attributes.normal,v=r.groups,x=r.drawRange;if(c!==null)if(Array.isArray(o))for(let b=0,R=v.length;b<R;b++){const M=v[b],T=o[M.materialIndex],D=Math.max(M.start,x.start),B=Math.min(c.count,Math.min(M.start+M.count,x.start+x.count));for(let L=D,G=B;L<G;L+=3){const H=c.getX(L),F=c.getX(L+1),U=c.getX(L+2);s=X0(this,T,e,n,p,m,y,H,F,U),s&&(s.faceIndex=Math.floor(L/3),s.face.materialIndex=M.materialIndex,t.push(s))}}else{const b=Math.max(0,x.start),R=Math.min(c.count,x.start+x.count);for(let M=b,T=R;M<T;M+=3){const D=c.getX(M),B=c.getX(M+1),L=c.getX(M+2);s=X0(this,o,e,n,p,m,y,D,B,L),s&&(s.faceIndex=Math.floor(M/3),t.push(s))}}else if(f!==void 0)if(Array.isArray(o))for(let b=0,R=v.length;b<R;b++){const M=v[b],T=o[M.materialIndex],D=Math.max(M.start,x.start),B=Math.min(f.count,Math.min(M.start+M.count,x.start+x.count));for(let L=D,G=B;L<G;L+=3){const H=L,F=L+1,U=L+2;s=X0(this,T,e,n,p,m,y,H,F,U),s&&(s.faceIndex=Math.floor(L/3),s.face.materialIndex=M.materialIndex,t.push(s))}}else{const b=Math.max(0,x.start),R=Math.min(f.count,x.start+x.count);for(let M=b,T=R;M<T;M+=3){const D=M,B=M+1,L=M+2;s=X0(this,o,e,n,p,m,y,D,B,L),s&&(s.faceIndex=Math.floor(M/3),t.push(s))}}}}function x5(i,e,t,n,s,r,o,c){let f;if(e.side===ua?f=n.intersectTriangle(o,r,s,!0,c):f=n.intersectTriangle(s,r,o,e.side===Ic,c),f===null)return null;q0.copy(c),q0.applyMatrix4(i.matrixWorld);const p=t.ray.origin.distanceTo(q0);return p<t.near||p>t.far?null:{distance:p,point:q0.clone(),object:i}}function X0(i,e,t,n,s,r,o,c,f,p){i.getVertexPosition(c,H0),i.getVertexPosition(f,k0),i.getVertexPosition(p,G0);const m=x5(i,e,t,n,H0,k0,G0,F2);if(m){const y=new $;Fa.getBarycoord(F2,H0,k0,G0,y),s&&(m.uv=Fa.getInterpolatedAttribute(s,c,f,p,y,new Xe)),r&&(m.uv1=Fa.getInterpolatedAttribute(r,c,f,p,y,new Xe)),o&&(m.normal=Fa.getInterpolatedAttribute(o,c,f,p,y,new $),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const v={a:c,b:f,c:p,normal:new $,materialIndex:0};Fa.getNormal(H0,k0,G0,v.normal),m.face=v,m.barycoord=y}return m}class lp extends yn{constructor(e=1,t=1,n=1,s=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:r,depthSegments:o};const c=this;s=Math.floor(s),r=Math.floor(r),o=Math.floor(o);const f=[],p=[],m=[],y=[];let v=0,x=0;b("z","y","x",-1,-1,n,t,e,o,r,0),b("z","y","x",1,-1,n,t,-e,o,r,1),b("x","z","y",1,1,e,n,t,s,o,2),b("x","z","y",1,-1,e,n,-t,s,o,3),b("x","y","z",1,-1,e,t,n,s,r,4),b("x","y","z",-1,-1,e,t,-n,s,r,5),this.setIndex(f),this.setAttribute("position",new Pt(p,3)),this.setAttribute("normal",new Pt(m,3)),this.setAttribute("uv",new Pt(y,2));function b(R,M,T,D,B,L,G,H,F,U,I){const N=L/F,z=G/U,W=L/2,k=G/2,he=H/2,me=F+1,q=U+1;let ee=0,ne=0;const ye=new $;for(let K=0;K<q;K++){const ce=K*z-k;for(let Ee=0;Ee<me;Ee++){const Me=Ee*N-W;ye[R]=Me*D,ye[M]=ce*B,ye[T]=he,p.push(ye.x,ye.y,ye.z),ye[R]=0,ye[M]=0,ye[T]=H>0?1:-1,m.push(ye.x,ye.y,ye.z),y.push(Ee/F),y.push(1-K/U),ee+=1}}for(let K=0;K<U;K++)for(let ce=0;ce<F;ce++){const Ee=v+ce+me*K,Me=v+ce+me*(K+1),Ve=v+(ce+1)+me*(K+1),ge=v+(ce+1)+me*K;f.push(Ee,Me,ge),f.push(Me,Ve,ge),ne+=6}c.addGroup(x,ne,I),x+=ne,v+=ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cg(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const s=i[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function ra(i){const e={};for(let t=0;t<i.length;t++){const n=cg(i[t]);for(const s in n)e[s]=n[s]}return e}function S5(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function AL(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Gn.workingColorSpace}const xL={clone:cg,merge:ra};var E5=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,b5=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Cl extends Vs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=E5,this.fragmentShader=b5,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cg(e.uniforms),this.uniformsGroups=S5(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?t.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[s]={type:"m4",value:o.toArray()}:t.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class YS extends jn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jt,this.projectionMatrix=new Jt,this.projectionMatrixInverse=new Jt,this.coordinateSystem=lo,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const zh=new $,z2=new Xe,V2=new Xe;class Hi extends YS{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=og*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Gd*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return og*2*Math.atan(Math.tan(Gd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){zh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(zh.x,zh.y).multiplyScalar(-e/zh.z),zh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(zh.x,zh.y).multiplyScalar(-e/zh.z)}getViewSize(e,t){return this.getViewBounds(e,z2,V2),t.subVectors(V2,z2)}setViewOffset(e,t,n,s,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Gd*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const f=o.fullWidth,p=o.fullHeight;r+=o.offsetX*s/f,t-=o.offsetY*n/p,s*=o.width/f,n*=o.height/p}const c=this.filmOffset;c!==0&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const gm=-90,ym=1;class SL extends jn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Hi(gm,ym,e,t);s.layers=this.layers,this.add(s);const r=new Hi(gm,ym,e,t);r.layers=this.layers,this.add(r);const o=new Hi(gm,ym,e,t);o.layers=this.layers,this.add(o);const c=new Hi(gm,ym,e,t);c.layers=this.layers,this.add(c);const f=new Hi(gm,ym,e,t);f.layers=this.layers,this.add(f);const p=new Hi(gm,ym,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,r,o,c,f]=t;for(const p of t)this.remove(p);if(e===lo)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===ag)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,c,f,p,m]=this.children,y=e.getRenderTarget(),v=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(t,r),e.setRenderTarget(n,1,s),e.render(t,o),e.setRenderTarget(n,2,s),e.render(t,c),e.setRenderTarget(n,3,s),e.render(t,f),e.setRenderTarget(n,4,s),e.render(t,p),n.texture.generateMipmaps=R,e.setRenderTarget(n,5,s),e.render(t,m),e.setRenderTarget(y,v,x),e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}}class ev extends ki{constructor(e=[],t=Fu,n,s,r,o,c,f,p,m){super(e,t,n,s,r,o,c,f,p,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class EL extends Bc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new ev(s),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new lp(5,5,5),r=new Cl({name:"CubemapFromEquirect",uniforms:cg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ua,blending:wu});r.uniforms.tEquirect.value=t;const o=new vs(s,r),c=t.minFilter;return t.minFilter===zo&&(t.minFilter=_s),new SL(1,10,this).update(e,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,s=!0){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,s);e.setRenderTarget(r)}}class Cu extends jn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const T5={type:"move"};class jA{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Cu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Cu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Cu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,r=null,o=null;const c=this._targetRay,f=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){o=!0;for(const R of e.hand.values()){const M=t.getJointPose(R,n),T=this._getHandJoint(p,R);M!==null&&(T.matrix.fromArray(M.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=M.radius),T.visible=M!==null}const m=p.joints["index-finger-tip"],y=p.joints["thumb-tip"],v=m.position.distanceTo(y.position),x=.02,b=.005;p.inputState.pinching&&v>x+b?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&v<=x-b&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(f.matrix.fromArray(r.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,r.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(r.linearVelocity)):f.hasLinearVelocity=!1,r.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(r.angularVelocity)):f.hasAngularVelocity=!1));c!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&r!==null&&(s=r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(T5)))}return c!==null&&(c.visible=s!==null),f!==null&&(f.visible=r!==null),p!==null&&(p.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Cu;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class KS{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new St(e),this.density=t}clone(){return new KS(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class JS{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new St(e),this.near=t,this.far=n}clone(){return new JS(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class sC extends jn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ho,this.environmentIntensity=1,this.environmentRotation=new ho,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class tv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=D_,this.updateRanges=[],this.version=0,this.uuid=uo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const sa=new $;class df{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)sa.fromBufferAttribute(this,t),sa.applyMatrix4(e),this.setXYZ(t,sa.x,sa.y,sa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)sa.fromBufferAttribute(this,t),sa.applyNormalMatrix(e),this.setXYZ(t,sa.x,sa.y,sa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)sa.fromBufferAttribute(this,t),sa.transformDirection(e),this.setXYZ(t,sa.x,sa.y,sa.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=la(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=En(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=la(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=la(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=la(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=la(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array),s=En(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array),s=En(s,this.array),r=En(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new Zn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new df(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class rC extends Vs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let _m;const Py=new $,vm=new $,Am=new $,xm=new Xe,Fy=new Xe,bL=new Jt,W0=new $,zy=new $,Y0=new $,H2=new Xe,Vb=new Xe,k2=new Xe;class TL extends jn{constructor(e=new rC){if(super(),this.isSprite=!0,this.type="Sprite",_m===void 0){_m=new yn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new tv(t,5);_m.setIndex([0,1,2,0,2,3]),_m.setAttribute("position",new df(n,3,0,!1)),_m.setAttribute("uv",new df(n,2,3,!1))}this.geometry=_m,this.material=e,this.center=new Xe(.5,.5),this.count=1}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vm.setFromMatrixScale(this.matrixWorld),bL.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Am.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&vm.multiplyScalar(-Am.z);const n=this.material.rotation;let s,r;n!==0&&(r=Math.cos(n),s=Math.sin(n));const o=this.center;K0(W0.set(-.5,-.5,0),Am,o,vm,s,r),K0(zy.set(.5,-.5,0),Am,o,vm,s,r),K0(Y0.set(.5,.5,0),Am,o,vm,s,r),H2.set(0,0),Vb.set(1,0),k2.set(1,1);let c=e.ray.intersectTriangle(W0,zy,Y0,!1,Py);if(c===null&&(K0(zy.set(-.5,.5,0),Am,o,vm,s,r),Vb.set(0,1),c=e.ray.intersectTriangle(W0,Y0,zy,!1,Py),c===null))return;const f=e.ray.origin.distanceTo(Py);f<e.near||f>e.far||t.push({distance:f,point:Py.clone(),uv:Fa.getInterpolation(Py,W0,zy,Y0,H2,Vb,k2,new Xe),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function K0(i,e,t,n,s,r){xm.subVectors(i,t).addScalar(.5).multiply(n),s!==void 0?(Fy.x=r*xm.x-s*xm.y,Fy.y=s*xm.x+r*xm.y):Fy.copy(xm),i.copy(e),i.x+=Fy.x,i.y+=Fy.y,i.applyMatrix4(bL)}const J0=new $,G2=new $;class ML extends jn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let r;for(r=0;r<s.length&&!(t<s[r].distance);r++);return s.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){J0.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(J0);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){J0.setFromMatrixPosition(e.matrixWorld),G2.setFromMatrixPosition(this.matrixWorld);const n=J0.distanceTo(G2)/e.zoom;t[0].object.visible=!0;let s,r;for(s=1,r=t.length;s<r;s++){let o=t[s].distance;if(t[s].object.visible&&(o-=o*t[s].hysteresis),n>=o)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,r=n.length;s<r;s++){const o=n[s];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const j2=new $,q2=new Qn,X2=new Qn,M5=new $,W2=new Jt,Q0=new $,Hb=new zs,Y2=new Jt,kb=new op;class aC extends vs{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=mM,this.bindMatrix=new Jt,this.bindMatrixInverse=new Jt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new $s),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Q0),this.boundingBox.expandByPoint(Q0)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new zs),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Q0),this.boundingSphere.expandByPoint(Q0)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Hb.copy(this.boundingSphere),Hb.applyMatrix4(s),e.ray.intersectsSphere(Hb)!==!1&&(Y2.copy(s).invert(),kb.copy(e.ray).applyMatrix4(Y2),!(this.boundingBox!==null&&kb.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,kb)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Qn,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===mM?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===eL?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;q2.fromBufferAttribute(s.attributes.skinIndex,e),X2.fromBufferAttribute(s.attributes.skinWeight,e),j2.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=X2.getComponent(r);if(o!==0){const c=q2.getComponent(r);W2.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(M5.copy(j2).applyMatrix4(W2),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class QS extends jn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Rc extends ki{constructor(e=null,t=1,n=1,s,r,o,c,f,p=Qs,m=Qs,y,v){super(null,o,c,f,p,m,s,r,y,v),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const K2=new Jt,C5=new Jt;class nv{constructor(e=[],t=[]){this.uuid=uo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new Jt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Jt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const c=e[r]?e[r].matrixWorld:C5;K2.multiplyMatrices(c,t[r]),K2.toArray(n,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new nv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Rc(t,e,e,Lr,za);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const r=e.bones[n];let o=t[r];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),o=new QS),this.bones.push(o),this.boneInverses.push(new Jt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const o=t[s];e.bones.push(o.uuid);const c=n[s];e.boneInverses.push(c.toArray())}return e}}class Qd extends Zn{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Sm=new Jt,J2=new Jt,Z0=[],Q2=new $s,R5=new Jt,Vy=new vs,Hy=new zs;class oC extends vs{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Qd(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,R5)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new $s),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Sm),Q2.copy(e.boundingBox).applyMatrix4(Sm),this.boundingBox.union(Q2)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new zs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Sm),Hy.copy(e.boundingSphere).applyMatrix4(Sm),this.boundingSphere.union(Hy)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let c=0;c<n.length;c++)n[c]=s[o+c]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(Vy.geometry=this.geometry,Vy.material=this.material,Vy.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Hy.copy(this.boundingSphere),Hy.applyMatrix4(n),e.ray.intersectsSphere(Hy)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,Sm),J2.multiplyMatrices(n,Sm),Vy.matrixWorld=J2,Vy.raycast(e,Z0);for(let o=0,c=Z0.length;o<c;o++){const f=Z0[o];f.instanceId=r,f.object=this,t.push(f)}Z0.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Qd(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new Rc(new Float32Array(s*this.count),s,this.count,kS,za));const r=this.morphTexture.source.data.data;let o=0;for(let p=0;p<n.length;p++)o+=n[p];const c=this.geometry.morphTargetsRelative?1:1-o,f=s*e;r[f]=c,r.set(n,f+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Gb=new $,w5=new $,D5=new An;class Au{constructor(e=new $(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=Gb.subVectors(n,t).cross(w5.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Gb),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||D5.getNormalMatrix(e),s=this.coplanarPoint(Gb).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const hd=new zs,I5=new Xe(.5,.5),$0=new $;class bg{constructor(e=new Au,t=new Au,n=new Au,s=new Au,r=new Au,o=new Au){this.planes=[e,t,n,s,r,o]}set(e,t,n,s,r,o){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(s),c[4].copy(r),c[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=lo,n=!1){const s=this.planes,r=e.elements,o=r[0],c=r[1],f=r[2],p=r[3],m=r[4],y=r[5],v=r[6],x=r[7],b=r[8],R=r[9],M=r[10],T=r[11],D=r[12],B=r[13],L=r[14],G=r[15];if(s[0].setComponents(p-o,x-m,T-b,G-D).normalize(),s[1].setComponents(p+o,x+m,T+b,G+D).normalize(),s[2].setComponents(p+c,x+y,T+R,G+B).normalize(),s[3].setComponents(p-c,x-y,T-R,G-B).normalize(),n)s[4].setComponents(f,v,M,L).normalize(),s[5].setComponents(p-f,x-v,T-M,G-L).normalize();else if(s[4].setComponents(p-f,x-v,T-M,G-L).normalize(),t===lo)s[5].setComponents(p+f,x+v,T+M,G+L).normalize();else if(t===ag)s[5].setComponents(f,v,M,L).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),hd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),hd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(hd)}intersectsSprite(e){hd.center.set(0,0,0);const t=I5.distanceTo(e.center);return hd.radius=.7071067811865476+t,hd.applyMatrix4(e.matrixWorld),this.intersectsSphere(hd)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if($0.x=s.normal.x>0?e.max.x:e.min.x,$0.y=s.normal.y>0?e.max.y:e.min.y,$0.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint($0)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const pc=new Jt,mc=new bg;class ZS{constructor(){this.coordinateSystem=lo}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.containsPoint(e))return!0}return!1}clone(){return new ZS}}function jb(i,e){return i-e}function B5(i,e){return i.z-e.z}function N5(i,e){return e.z-i.z}class O5{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const c=r[this.index];o.push(c),this.index++,c.start=e,c.count=t,c.z=n,c.index=s}reset(){this.list.length=0,this.index=0}}const Na=new Jt,L5=new St(1,1,1),Z2=new bg,U5=new ZS,eA=new $s,fd=new zs,ky=new $,$2=new $,P5=new $,qb=new O5,Ir=new vs,tA=[];function F5(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const s=i.count;for(let r=0;r<s;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,i.getComponent(r,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function dd(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class CL extends vs{constructor(e,t,n=t*2,s){super(new yn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Rc(t,e,e,Lr,za);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Rc(t,e,e,$_,zu);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Rc(t,e,e,Lr,za);n.colorSpace=Gn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:c,itemSize:f,normalized:p}=o,m=new c.constructor(n*f),y=new Zn(m,f,p);t.setAttribute(r,y)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new Zn(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),r=t.getAttribute(n);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $s);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,Na),this.getBoundingBoxAt(r,eA).applyMatrix4(Na),e.union(eA)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zs);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,Na),this.getBoundingSphereAt(r,fd).applyMatrix4(Na),e.union(fd)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(jb),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;Na.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(L5.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?o.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let f;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(jb),f=this._availableGeometryIds.shift(),r[f]=s):(f=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(f,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,f}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),c=this._geometryInfo[e];if(s&&o.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const f=c.vertexStart,p=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const y=t.getAttribute(m),v=n.getAttribute(m);F5(y,v,f);const x=y.itemSize;for(let b=y.count,R=p;b<R;b++){const M=f+b;for(let T=0;T<x;T++)v.setComponent(M,T,0)}v.needsUpdate=!0,v.addUpdateRange(f*x,p*x)}if(s){const m=c.indexStart,y=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let v=0;v<o.count;v++)r.setX(m+v,f+o.getX(v));for(let v=o.count,x=y;v<x;v++)r.setX(m+v,f);r.needsUpdate=!0,r.addUpdateRange(m,c.reservedIndexCount)}return c.start=s?c.indexStart:c.vertexStart,c.count=s?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,r=n.length;s<r;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((o,c)=>c).sort((o,c)=>n[o].vertexStart-n[c].vertexStart),r=this.geometry;for(let o=0,c=n.length;o<c;o++){const f=s[o],p=n[f];if(p.active!==!1){if(r.index!==null){if(p.indexStart!==t){const{indexStart:m,vertexStart:y,reservedIndexCount:v}=p,x=r.index,b=x.array,R=e-y;for(let M=m;M<m+v;M++)b[M]=b[M]+R;x.array.copyWithin(t,m,m+v),x.addUpdateRange(t,v),p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:m,reservedVertexCount:y}=p,v=r.attributes;for(const x in v){const b=v[x],{array:R,itemSize:M}=b;R.copyWithin(e*M,m*M,(m+y)*M),b.addUpdateRange(e*M,y*M)}p.vertexStart=e}e+=p.reservedVertexCount,p.start=r.index?p.indexStart:p.vertexStart,this._nextIndexStart=r.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new $s,o=n.index,c=n.attributes.position;for(let f=s.start,p=s.start+s.count;f<p;f++){let m=f;o&&(m=o.getX(m)),r.expandByPoint(ky.fromBufferAttribute(c,m))}s.boundingBox=r}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new zs;this.getBoundingBoxAt(e,eA),eA.getCenter(r.center);const o=n.index,c=n.attributes.position;let f=0;for(let p=s.start,m=s.start+s.count;p<m;p++){let y=p;o&&(y=o.getX(y)),ky.fromBufferAttribute(c,y),f=Math.max(f,r.center.distanceToSquared(ky))}r.radius=Math.sqrt(f),s.boundingSphere=r}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(jb);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);dd(this._multiDrawCounts,s),dd(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,c=this._matricesTexture,f=this._colorsTexture;o.dispose(),this._initIndirectTexture(),dd(o.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),dd(c.image.data,this._matricesTexture.image.data),f&&(f.dispose(),this._initColorsTexture(),dd(f.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...n.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(f=>f.indexStart+f.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new yn,this._initializeGeometry(r));const o=this.geometry;r.index&&dd(r.index.array,o.index.array);for(const c in r.attributes)dd(r.attributes[c].array,o.attributes[c].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,o=this.geometry;Ir.material=this.material,Ir.geometry.index=o.index,Ir.geometry.attributes=o.attributes,Ir.geometry.boundingBox===null&&(Ir.geometry.boundingBox=new $s),Ir.geometry.boundingSphere===null&&(Ir.geometry.boundingSphere=new zs);for(let c=0,f=n.length;c<f;c++){if(!n[c].visible||!n[c].active)continue;const p=n[c].geometryIndex,m=s[p];Ir.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(c,Ir.matrixWorld).premultiply(r),this.getBoundingBoxAt(p,Ir.geometry.boundingBox),this.getBoundingSphereAt(p,Ir.geometry.boundingSphere),Ir.raycast(e,tA);for(let y=0,v=tA.length;y<v;y++){const x=tA[y];x.object=this,x.batchId=c,t.push(x)}tA.length=0}Ir.material=null,Ir.geometry.index=null,Ir.geometry.attributes={},Ir.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),c=o===null?1:o.array.BYTES_PER_ELEMENT,f=this._instanceInfo,p=this._multiDrawStarts,m=this._multiDrawCounts,y=this._geometryInfo,v=this.perObjectFrustumCulled,x=this._indirectTexture,b=x.image.data,R=n.isArrayCamera?U5:Z2;v&&!n.isArrayCamera&&(Na.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),Z2.setFromProjectionMatrix(Na,n.coordinateSystem,n.reversedDepth));let M=0;if(this.sortObjects){Na.copy(this.matrixWorld).invert(),ky.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Na),$2.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Na);for(let B=0,L=f.length;B<L;B++)if(f[B].visible&&f[B].active){const G=f[B].geometryIndex;this.getMatrixAt(B,Na),this.getBoundingSphereAt(G,fd).applyMatrix4(Na);let H=!1;if(v&&(H=!R.intersectsSphere(fd,n)),!H){const F=y[G],U=P5.subVectors(fd.center,ky).dot($2);qb.push(F.start,F.count,U,B)}}const T=qb.list,D=this.customSort;D===null?T.sort(r.transparent?N5:B5):D.call(this,T,n);for(let B=0,L=T.length;B<L;B++){const G=T[B];p[M]=G.start*c,m[M]=G.count,b[M]=G.index,M++}qb.reset()}else for(let T=0,D=f.length;T<D;T++)if(f[T].visible&&f[T].active){const B=f[T].geometryIndex;let L=!1;if(v&&(this.getMatrixAt(T,Na),this.getBoundingSphereAt(B,fd).applyMatrix4(Na),L=!R.intersectsSphere(fd,n)),!L){const G=y[B];p[M]=G.start*c,m[M]=G.count,b[M]=T,M++}}x.needsUpdate=!0,this._multiDrawCount=M,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,r,o){this.onBeforeRender(e,null,s,r,o)}}class Pr extends Vs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Qx=new $,Zx=new $,eD=new Jt,Gy=new op,nA=new zs,Xb=new $,tD=new $;class Vu extends jn{constructor(e=new yn,t=new Pr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,r=t.count;s<r;s++)Qx.fromBufferAttribute(t,s-1),Zx.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=Qx.distanceTo(Zx);e.setAttribute("lineDistance",new Pt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),nA.copy(n.boundingSphere),nA.applyMatrix4(s),nA.radius+=r,e.ray.intersectsSphere(nA)===!1)return;eD.copy(s).invert(),Gy.copy(e.ray).applyMatrix4(eD);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,p=this.isLineSegments?2:1,m=n.index,v=n.attributes.position;if(m!==null){const x=Math.max(0,o.start),b=Math.min(m.count,o.start+o.count);for(let R=x,M=b-1;R<M;R+=p){const T=m.getX(R),D=m.getX(R+1),B=iA(this,e,Gy,f,T,D,R);B&&t.push(B)}if(this.isLineLoop){const R=m.getX(b-1),M=m.getX(x),T=iA(this,e,Gy,f,R,M,b-1);T&&t.push(T)}}else{const x=Math.max(0,o.start),b=Math.min(v.count,o.start+o.count);for(let R=x,M=b-1;R<M;R+=p){const T=iA(this,e,Gy,f,R,R+1,R);T&&t.push(T)}if(this.isLineLoop){const R=iA(this,e,Gy,f,b-1,x,b-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function iA(i,e,t,n,s,r,o){const c=i.geometry.attributes.position;if(Qx.fromBufferAttribute(c,s),Zx.fromBufferAttribute(c,r),t.distanceSqToSegment(Qx,Zx,Xb,tD)>n)return;Xb.applyMatrix4(i.matrixWorld);const p=e.ray.origin.distanceTo(Xb);if(!(p<e.near||p>e.far))return{distance:p,point:tD.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const nD=new $,iD=new $;class Rl extends Vu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,r=t.count;s<r;s+=2)nD.fromBufferAttribute(t,s),iD.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+nD.distanceTo(iD);e.setAttribute("lineDistance",new Pt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class lC extends Vu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class $S extends Vs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const sD=new Jt,_M=new op,sA=new zs,rA=new $;class cC extends jn{constructor(e=new yn,t=new $S){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),sA.copy(n.boundingSphere),sA.applyMatrix4(s),sA.radius+=r,e.ray.intersectsSphere(sA)===!1)return;sD.copy(s).invert(),_M.copy(e.ray).applyMatrix4(sD);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,p=n.index,y=n.attributes.position;if(p!==null){const v=Math.max(0,o.start),x=Math.min(p.count,o.start+o.count);for(let b=v,R=x;b<R;b++){const M=p.getX(b);rA.fromBufferAttribute(y,M),rD(rA,M,f,s,e,t,this)}}else{const v=Math.max(0,o.start),x=Math.min(y.count,o.start+o.count);for(let b=v,R=x;b<R;b++)rA.fromBufferAttribute(y,b),rD(rA,b,f,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function rD(i,e,t,n,s,r,o){const c=_M.distanceSqToPoint(i);if(c<t){const f=new $;_M.closestPointToPoint(i,f),f.applyMatrix4(n);const p=s.ray.origin.distanceTo(f);if(p<s.near||p>s.far)return;r.push({distance:p,distanceToRay:Math.sqrt(c),point:f,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class RL extends ki{constructor(e,t,n,s,r=_s,o=_s,c,f,p){super(e,t,n,s,r,o,c,f,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const m=this;function y(){m.needsUpdate=!0,m._requestVideoFrameCallbackId=e.requestVideoFrameCallback(y)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(y))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),super.dispose()}}class z5 extends RL{constructor(e,t,n,s,r,o,c,f){super({},e,t,n,s,r,o,c,f),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class V5 extends ki{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Qs,this.minFilter=Qs,this.generateMipmaps=!1,this.needsUpdate=!0}}class eE extends ki{constructor(e,t,n,s,r,o,c,f,p,m,y,v){super(null,o,c,f,p,m,s,r,y,v),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class H5 extends eE{constructor(e,t,n,s,r,o){super(e,t,n,r,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=oo,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class k5 extends eE{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Fu),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class G5 extends ki{constructor(e,t,n,s,r,o,c,f,p){super(e,t,n,s,r,o,c,f,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class uC extends ki{constructor(e,t,n=zu,s,r,o,c=Qs,f=Qs,p,m=ng,y=1){if(m!==ng&&m!==ig)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const v={width:e,height:t,depth:y};super(v,s,r,o,c,f,m,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Kh(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class tE extends yn{constructor(e=1,t=1,n=4,s=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:s,heightSegments:r},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),s=Math.max(3,Math.floor(s)),r=Math.max(1,Math.floor(r));const o=[],c=[],f=[],p=[],m=t/2,y=Math.PI/2*e,v=t,x=2*y+v,b=n*2+r,R=s+1,M=new $,T=new $;for(let D=0;D<=b;D++){let B=0,L=0,G=0,H=0;if(D<=n){const I=D/n,N=I*Math.PI/2;L=-m-e*Math.cos(N),G=e*Math.sin(N),H=-e*Math.cos(N),B=I*y}else if(D<=n+r){const I=(D-n)/r;L=-m+I*t,G=e,H=0,B=y+I*v}else{const I=(D-n-r)/n,N=I*Math.PI/2;L=m+e*Math.sin(N),G=e*Math.cos(N),H=e*Math.sin(N),B=y+v+I*y}const F=Math.max(0,Math.min(1,B/x));let U=0;D===0?U=.5/s:D===b&&(U=-.5/s);for(let I=0;I<=s;I++){const N=I/s,z=N*Math.PI*2,W=Math.sin(z),k=Math.cos(z);T.x=-G*k,T.y=L,T.z=G*W,c.push(T.x,T.y,T.z),M.set(-G*k,H,G*W),M.normalize(),f.push(M.x,M.y,M.z),p.push(N+U,F)}if(D>0){const I=(D-1)*R;for(let N=0;N<s;N++){const z=I+N,W=I+N+1,k=D*R+N,he=D*R+N+1;o.push(z,W,k),o.push(W,he,k)}}}this.setIndex(o),this.setAttribute("position",new Pt(c,3)),this.setAttribute("normal",new Pt(f,3)),this.setAttribute("uv",new Pt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tE(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class nE extends yn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const r=[],o=[],c=[],f=[],p=new $,m=new Xe;o.push(0,0,0),c.push(0,0,1),f.push(.5,.5);for(let y=0,v=3;y<=t;y++,v+=3){const x=n+y/t*s;p.x=e*Math.cos(x),p.y=e*Math.sin(x),o.push(p.x,p.y,p.z),c.push(0,0,1),m.x=(o[v]/e+1)/2,m.y=(o[v+1]/e+1)/2,f.push(m.x,m.y)}for(let y=1;y<=t;y++)r.push(y,y+1,0);this.setIndex(r),this.setAttribute("position",new Pt(o,3)),this.setAttribute("normal",new Pt(c,3)),this.setAttribute("uv",new Pt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nE(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class iv extends yn{constructor(e=1,t=1,n=1,s=32,r=1,o=!1,c=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:c,thetaLength:f};const p=this;s=Math.floor(s),r=Math.floor(r);const m=[],y=[],v=[],x=[];let b=0;const R=[],M=n/2;let T=0;D(),o===!1&&(e>0&&B(!0),t>0&&B(!1)),this.setIndex(m),this.setAttribute("position",new Pt(y,3)),this.setAttribute("normal",new Pt(v,3)),this.setAttribute("uv",new Pt(x,2));function D(){const L=new $,G=new $;let H=0;const F=(t-e)/n;for(let U=0;U<=r;U++){const I=[],N=U/r,z=N*(t-e)+e;for(let W=0;W<=s;W++){const k=W/s,he=k*f+c,me=Math.sin(he),q=Math.cos(he);G.x=z*me,G.y=-N*n+M,G.z=z*q,y.push(G.x,G.y,G.z),L.set(me,F,q).normalize(),v.push(L.x,L.y,L.z),x.push(k,1-N),I.push(b++)}R.push(I)}for(let U=0;U<s;U++)for(let I=0;I<r;I++){const N=R[I][U],z=R[I+1][U],W=R[I+1][U+1],k=R[I][U+1];(e>0||I!==0)&&(m.push(N,z,k),H+=3),(t>0||I!==r-1)&&(m.push(z,W,k),H+=3)}p.addGroup(T,H,0),T+=H}function B(L){const G=b,H=new Xe,F=new $;let U=0;const I=L===!0?e:t,N=L===!0?1:-1;for(let W=1;W<=s;W++)y.push(0,M*N,0),v.push(0,N,0),x.push(.5,.5),b++;const z=b;for(let W=0;W<=s;W++){const he=W/s*f+c,me=Math.cos(he),q=Math.sin(he);F.x=I*q,F.y=M*N,F.z=I*me,y.push(F.x,F.y,F.z),v.push(0,N,0),H.x=me*.5+.5,H.y=q*.5*N+.5,x.push(H.x,H.y),b++}for(let W=0;W<s;W++){const k=G+W,he=z+W;L===!0?m.push(he,he+1,k):m.push(he+1,he,k),U+=3}p.addGroup(T,U,L===!0?1:2),T+=U}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iv(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class sv extends iv{constructor(e=1,t=1,n=32,s=1,r=!1,o=0,c=Math.PI*2){super(0,e,t,n,s,r,o,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:c}}static fromJSON(e){return new sv(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class vf extends yn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const r=[],o=[];c(s),p(n),m(),this.setAttribute("position",new Pt(r,3)),this.setAttribute("normal",new Pt(r.slice(),3)),this.setAttribute("uv",new Pt(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function c(D){const B=new $,L=new $,G=new $;for(let H=0;H<t.length;H+=3)x(t[H+0],B),x(t[H+1],L),x(t[H+2],G),f(B,L,G,D)}function f(D,B,L,G){const H=G+1,F=[];for(let U=0;U<=H;U++){F[U]=[];const I=D.clone().lerp(L,U/H),N=B.clone().lerp(L,U/H),z=H-U;for(let W=0;W<=z;W++)W===0&&U===H?F[U][W]=I:F[U][W]=I.clone().lerp(N,W/z)}for(let U=0;U<H;U++)for(let I=0;I<2*(H-U)-1;I++){const N=Math.floor(I/2);I%2===0?(v(F[U][N+1]),v(F[U+1][N]),v(F[U][N])):(v(F[U][N+1]),v(F[U+1][N+1]),v(F[U+1][N]))}}function p(D){const B=new $;for(let L=0;L<r.length;L+=3)B.x=r[L+0],B.y=r[L+1],B.z=r[L+2],B.normalize().multiplyScalar(D),r[L+0]=B.x,r[L+1]=B.y,r[L+2]=B.z}function m(){const D=new $;for(let B=0;B<r.length;B+=3){D.x=r[B+0],D.y=r[B+1],D.z=r[B+2];const L=M(D)/2/Math.PI+.5,G=T(D)/Math.PI+.5;o.push(L,1-G)}b(),y()}function y(){for(let D=0;D<o.length;D+=6){const B=o[D+0],L=o[D+2],G=o[D+4],H=Math.max(B,L,G),F=Math.min(B,L,G);H>.9&&F<.1&&(B<.2&&(o[D+0]+=1),L<.2&&(o[D+2]+=1),G<.2&&(o[D+4]+=1))}}function v(D){r.push(D.x,D.y,D.z)}function x(D,B){const L=D*3;B.x=e[L+0],B.y=e[L+1],B.z=e[L+2]}function b(){const D=new $,B=new $,L=new $,G=new $,H=new Xe,F=new Xe,U=new Xe;for(let I=0,N=0;I<r.length;I+=9,N+=6){D.set(r[I+0],r[I+1],r[I+2]),B.set(r[I+3],r[I+4],r[I+5]),L.set(r[I+6],r[I+7],r[I+8]),H.set(o[N+0],o[N+1]),F.set(o[N+2],o[N+3]),U.set(o[N+4],o[N+5]),G.copy(D).add(B).add(L).divideScalar(3);const z=M(G);R(H,N+0,D,z),R(F,N+2,B,z),R(U,N+4,L,z)}}function R(D,B,L,G){G<0&&D.x===1&&(o[B]=D.x-1),L.x===0&&L.z===0&&(o[B]=G/2/Math.PI+.5)}function M(D){return Math.atan2(D.z,-D.x)}function T(D){return Math.atan2(-D.y,Math.sqrt(D.x*D.x+D.z*D.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vf(e.vertices,e.indices,e.radius,e.details)}}class iE extends vf{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new iE(e.radius,e.detail)}}const aA=new $,oA=new $,Wb=new $,lA=new Fa;class wL extends yn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),r=Math.cos(Gd*t),o=e.getIndex(),c=e.getAttribute("position"),f=o?o.count:c.count,p=[0,0,0],m=["a","b","c"],y=new Array(3),v={},x=[];for(let b=0;b<f;b+=3){o?(p[0]=o.getX(b),p[1]=o.getX(b+1),p[2]=o.getX(b+2)):(p[0]=b,p[1]=b+1,p[2]=b+2);const{a:R,b:M,c:T}=lA;if(R.fromBufferAttribute(c,p[0]),M.fromBufferAttribute(c,p[1]),T.fromBufferAttribute(c,p[2]),lA.getNormal(Wb),y[0]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,y[1]=`${Math.round(M.x*s)},${Math.round(M.y*s)},${Math.round(M.z*s)}`,y[2]=`${Math.round(T.x*s)},${Math.round(T.y*s)},${Math.round(T.z*s)}`,!(y[0]===y[1]||y[1]===y[2]||y[2]===y[0]))for(let D=0;D<3;D++){const B=(D+1)%3,L=y[D],G=y[B],H=lA[m[D]],F=lA[m[B]],U=`${L}_${G}`,I=`${G}_${L}`;I in v&&v[I]?(Wb.dot(v[I].normal)<=r&&(x.push(H.x,H.y,H.z),x.push(F.x,F.y,F.z)),v[I]=null):U in v||(v[U]={index0:p[D],index1:p[B],normal:Wb.clone()})}}for(const b in v)if(v[b]){const{index0:R,index1:M}=v[b];aA.fromBufferAttribute(c,R),oA.fromBufferAttribute(c,M),x.push(aA.x,aA.y,aA.z),x.push(oA.x,oA.y,oA.z)}this.setAttribute("position",new Pt(x,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class wl{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(s),t.push(r),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const r=n.length;let o;t?o=t:o=e*n[r-1];let c=0,f=r-1,p;for(;c<=f;)if(s=Math.floor(c+(f-c)/2),p=n[s]-o,p<0)c=s+1;else if(p>0)f=s-1;else{f=s;break}if(s=f,n[s]===o)return s/(r-1);const m=n[s],v=n[s+1]-m,x=(o-m)/v;return(s+x)/(r-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const o=this.getPoint(s),c=this.getPoint(r),f=t||(o.isVector2?new Xe:new $);return f.copy(c).sub(o).normalize(),f}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new $,s=[],r=[],o=[],c=new $,f=new Jt;for(let x=0;x<=e;x++){const b=x/e;s[x]=this.getTangentAt(b,new $)}r[0]=new $,o[0]=new $;let p=Number.MAX_VALUE;const m=Math.abs(s[0].x),y=Math.abs(s[0].y),v=Math.abs(s[0].z);m<=p&&(p=m,n.set(1,0,0)),y<=p&&(p=y,n.set(0,1,0)),v<=p&&n.set(0,0,1),c.crossVectors(s[0],n).normalize(),r[0].crossVectors(s[0],c),o[0].crossVectors(s[0],r[0]);for(let x=1;x<=e;x++){if(r[x]=r[x-1].clone(),o[x]=o[x-1].clone(),c.crossVectors(s[x-1],s[x]),c.length()>Number.EPSILON){c.normalize();const b=Math.acos(nn(s[x-1].dot(s[x]),-1,1));r[x].applyMatrix4(f.makeRotationAxis(c,b))}o[x].crossVectors(s[x],r[x])}if(t===!0){let x=Math.acos(nn(r[0].dot(r[e]),-1,1));x/=e,s[0].dot(c.crossVectors(r[0],r[e]))>0&&(x=-x);for(let b=1;b<=e;b++)r[b].applyMatrix4(f.makeRotationAxis(s[b],x*b)),o[b].crossVectors(s[b],r[b])}return{tangents:s,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class sE extends wl{constructor(e=0,t=0,n=1,s=1,r=0,o=Math.PI*2,c=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=c,this.aRotation=f}getPoint(e,t=new Xe){const n=t,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(o?r=0:r=s),this.aClockwise===!0&&!o&&(r===s?r=-s:r=r-s);const c=this.aStartAngle+e*r;let f=this.aX+this.xRadius*Math.cos(c),p=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const m=Math.cos(this.aRotation),y=Math.sin(this.aRotation),v=f-this.aX,x=p-this.aY;f=v*m-x*y+this.aX,p=v*y+x*m+this.aY}return n.set(f,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class DL extends sE{constructor(e,t,n,s,r,o){super(e,t,n,n,s,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function hC(){let i=0,e=0,t=0,n=0;function s(r,o,c,f){i=r,e=c,t=-3*r+3*o-2*c-f,n=2*r-2*o+c+f}return{initCatmullRom:function(r,o,c,f,p){s(o,c,p*(c-r),p*(f-o))},initNonuniformCatmullRom:function(r,o,c,f,p,m,y){let v=(o-r)/p-(c-r)/(p+m)+(c-o)/m,x=(c-o)/m-(f-o)/(m+y)+(f-c)/y;v*=m,x*=m,s(o,c,v,x)},calc:function(r){const o=r*r,c=o*r;return i+e*r+t*o+n*c}}}const cA=new $,Yb=new hC,Kb=new hC,Jb=new hC;class IL extends wl{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new $){const n=t,s=this.points,r=s.length,o=(r-(this.closed?0:1))*e;let c=Math.floor(o),f=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:f===0&&c===r-1&&(c=r-2,f=1);let p,m;this.closed||c>0?p=s[(c-1)%r]:(cA.subVectors(s[0],s[1]).add(s[0]),p=cA);const y=s[c%r],v=s[(c+1)%r];if(this.closed||c+2<r?m=s[(c+2)%r]:(cA.subVectors(s[r-1],s[r-2]).add(s[r-1]),m=cA),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let b=Math.pow(p.distanceToSquared(y),x),R=Math.pow(y.distanceToSquared(v),x),M=Math.pow(v.distanceToSquared(m),x);R<1e-4&&(R=1),b<1e-4&&(b=R),M<1e-4&&(M=R),Yb.initNonuniformCatmullRom(p.x,y.x,v.x,m.x,b,R,M),Kb.initNonuniformCatmullRom(p.y,y.y,v.y,m.y,b,R,M),Jb.initNonuniformCatmullRom(p.z,y.z,v.z,m.z,b,R,M)}else this.curveType==="catmullrom"&&(Yb.initCatmullRom(p.x,y.x,v.x,m.x,this.tension),Kb.initCatmullRom(p.y,y.y,v.y,m.y,this.tension),Jb.initCatmullRom(p.z,y.z,v.z,m.z,this.tension));return n.set(Yb.calc(f),Kb.calc(f),Jb.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new $().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function aD(i,e,t,n,s){const r=(n-e)*.5,o=(s-t)*.5,c=i*i,f=i*c;return(2*t-2*n+r+o)*f+(-3*t+3*n-2*r-o)*c+r*i+t}function j5(i,e){const t=1-i;return t*t*e}function q5(i,e){return 2*(1-i)*i*e}function X5(i,e){return i*i*e}function d_(i,e,t,n){return j5(i,e)+q5(i,t)+X5(i,n)}function W5(i,e){const t=1-i;return t*t*t*e}function Y5(i,e){const t=1-i;return 3*t*t*i*e}function K5(i,e){return 3*(1-i)*i*i*e}function J5(i,e){return i*i*i*e}function p_(i,e,t,n,s){return W5(i,e)+Y5(i,t)+K5(i,n)+J5(i,s)}class fC extends wl{constructor(e=new Xe,t=new Xe,n=new Xe,s=new Xe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new Xe){const n=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(p_(e,s.x,r.x,o.x,c.x),p_(e,s.y,r.y,o.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class BL extends wl{constructor(e=new $,t=new $,n=new $,s=new $){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new $){const n=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(p_(e,s.x,r.x,o.x,c.x),p_(e,s.y,r.y,o.y,c.y),p_(e,s.z,r.z,o.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class dC extends wl{constructor(e=new Xe,t=new Xe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Xe){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Xe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class NL extends wl{constructor(e=new $,t=new $){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new $){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new $){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class pC extends wl{constructor(e=new Xe,t=new Xe,n=new Xe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Xe){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(d_(e,s.x,r.x,o.x),d_(e,s.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mC extends wl{constructor(e=new $,t=new $,n=new $){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new $){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(d_(e,s.x,r.x,o.x),d_(e,s.y,r.y,o.y),d_(e,s.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gC extends wl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Xe){const n=t,s=this.points,r=(s.length-1)*e,o=Math.floor(r),c=r-o,f=s[o===0?o:o-1],p=s[o],m=s[o>s.length-2?s.length-1:o+1],y=s[o>s.length-3?s.length-1:o+2];return n.set(aD(c,f.x,p.x,m.x,y.x),aD(c,f.y,p.y,m.y,y.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new Xe().fromArray(s))}return this}}var $x=Object.freeze({__proto__:null,ArcCurve:DL,CatmullRomCurve3:IL,CubicBezierCurve:fC,CubicBezierCurve3:BL,EllipseCurve:sE,LineCurve:dC,LineCurve3:NL,QuadraticBezierCurve:pC,QuadraticBezierCurve3:mC,SplineCurve:gC});class OL extends wl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new $x[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=n){const o=s[r]-n,c=this.curves[r],f=c.getLength(),p=f===0?0:1-o/f;return c.getPointAt(p,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,r=this.curves;s<r.length;s++){const o=r[s],c=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,f=o.getPoints(c);for(let p=0;p<f.length;p++){const m=f[p];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new $x[s.type]().fromJSON(s))}return this}}class eS extends OL{constructor(e){super(),this.type="Path",this.currentPoint=new Xe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new dC(this.currentPoint.clone(),new Xe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const r=new pC(this.currentPoint.clone(),new Xe(e,t),new Xe(n,s));return this.curves.push(r),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,r,o){const c=new fC(this.currentPoint.clone(),new Xe(e,t),new Xe(n,s),new Xe(r,o));return this.curves.push(c),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new gC(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,r,o){const c=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+c,t+f,n,s,r,o),this}absarc(e,t,n,s,r,o){return this.absellipse(e,t,n,n,s,r,o),this}ellipse(e,t,n,s,r,o,c,f){const p=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+p,t+m,n,s,r,o,c,f),this}absellipse(e,t,n,s,r,o,c,f){const p=new sE(e,t,n,s,r,o,c,f);if(this.curves.length>0){const y=p.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(p);const m=p.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class jd extends eS{constructor(e){super(e),this.uuid=uo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new eS().fromJSON(s))}return this}}function Q5(i,e,t=2){const n=e&&e.length,s=n?e[0]*t:i.length;let r=LL(i,0,s,t,!0);const o=[];if(!r||r.next===r.prev)return o;let c,f,p;if(n&&(r=n8(i,e,r,t)),i.length>80*t){c=1/0,f=1/0;let m=-1/0,y=-1/0;for(let v=t;v<s;v+=t){const x=i[v],b=i[v+1];x<c&&(c=x),b<f&&(f=b),x>m&&(m=x),b>y&&(y=b)}p=Math.max(m-c,y-f),p=p!==0?32767/p:0}return B_(r,o,t,c,f,p,0),o}function LL(i,e,t,n,s){let r;if(s===d8(i,e,t,n)>0)for(let o=e;o<t;o+=n)r=oD(o/n|0,i[o],i[o+1],r);else for(let o=t-n;o>=e;o-=n)r=oD(o/n|0,i[o],i[o+1],r);return r&&ug(r,r.next)&&(O_(r),r=r.next),r}function Zd(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(ug(t,t.next)||$i(t.prev,t,t.next)===0)){if(O_(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function B_(i,e,t,n,s,r,o){if(!i)return;!o&&r&&o8(i,n,s,r);let c=i;for(;i.prev!==i.next;){const f=i.prev,p=i.next;if(r?$5(i,n,s,r):Z5(i)){e.push(f.i,i.i,p.i),O_(i),i=p.next,c=p.next;continue}if(i=p,i===c){o?o===1?(i=e8(Zd(i),e),B_(i,e,t,n,s,r,2)):o===2&&t8(i,e,t,n,s,r):B_(Zd(i),e,t,n,s,r,1);break}}}function Z5(i){const e=i.prev,t=i,n=i.next;if($i(e,t,n)>=0)return!1;const s=e.x,r=t.x,o=n.x,c=e.y,f=t.y,p=n.y,m=Math.min(s,r,o),y=Math.min(c,f,p),v=Math.max(s,r,o),x=Math.max(c,f,p);let b=n.next;for(;b!==e;){if(b.x>=m&&b.x<=v&&b.y>=y&&b.y<=x&&Qy(s,c,r,f,o,p,b.x,b.y)&&$i(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function $5(i,e,t,n){const s=i.prev,r=i,o=i.next;if($i(s,r,o)>=0)return!1;const c=s.x,f=r.x,p=o.x,m=s.y,y=r.y,v=o.y,x=Math.min(c,f,p),b=Math.min(m,y,v),R=Math.max(c,f,p),M=Math.max(m,y,v),T=vM(x,b,e,t,n),D=vM(R,M,e,t,n);let B=i.prevZ,L=i.nextZ;for(;B&&B.z>=T&&L&&L.z<=D;){if(B.x>=x&&B.x<=R&&B.y>=b&&B.y<=M&&B!==s&&B!==o&&Qy(c,m,f,y,p,v,B.x,B.y)&&$i(B.prev,B,B.next)>=0||(B=B.prevZ,L.x>=x&&L.x<=R&&L.y>=b&&L.y<=M&&L!==s&&L!==o&&Qy(c,m,f,y,p,v,L.x,L.y)&&$i(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;B&&B.z>=T;){if(B.x>=x&&B.x<=R&&B.y>=b&&B.y<=M&&B!==s&&B!==o&&Qy(c,m,f,y,p,v,B.x,B.y)&&$i(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;L&&L.z<=D;){if(L.x>=x&&L.x<=R&&L.y>=b&&L.y<=M&&L!==s&&L!==o&&Qy(c,m,f,y,p,v,L.x,L.y)&&$i(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function e8(i,e){let t=i;do{const n=t.prev,s=t.next.next;!ug(n,s)&&PL(n,t,t.next,s)&&N_(n,s)&&N_(s,n)&&(e.push(n.i,t.i,s.i),O_(t),O_(t.next),t=i=s),t=t.next}while(t!==i);return Zd(t)}function t8(i,e,t,n,s,r){let o=i;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&u8(o,c)){let f=FL(o,c);o=Zd(o,o.next),f=Zd(f,f.next),B_(o,e,t,n,s,r,0),B_(f,e,t,n,s,r,0);return}c=c.next}o=o.next}while(o!==i)}function n8(i,e,t,n){const s=[];for(let r=0,o=e.length;r<o;r++){const c=e[r]*n,f=r<o-1?e[r+1]*n:i.length,p=LL(i,c,f,n,!1);p===p.next&&(p.steiner=!0),s.push(c8(p))}s.sort(i8);for(let r=0;r<s.length;r++)t=s8(s[r],t);return t}function i8(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),s=(e.next.y-e.y)/(e.next.x-e.x);t=n-s}return t}function s8(i,e){const t=r8(i,e);if(!t)return e;const n=FL(t,i);return Zd(n,n.next),Zd(t,t.next)}function r8(i,e){let t=e;const n=i.x,s=i.y;let r=-1/0,o;if(ug(i,t))return t;do{if(ug(i,t.next))return t.next;if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const y=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=n&&y>r&&(r=y,o=t.x<t.next.x?t:t.next,y===n))return o}t=t.next}while(t!==e);if(!o)return null;const c=o,f=o.x,p=o.y;let m=1/0;t=o;do{if(n>=t.x&&t.x>=f&&n!==t.x&&UL(s<p?n:r,s,f,p,s<p?r:n,s,t.x,t.y)){const y=Math.abs(s-t.y)/(n-t.x);N_(t,i)&&(y<m||y===m&&(t.x>o.x||t.x===o.x&&a8(o,t)))&&(o=t,m=y)}t=t.next}while(t!==c);return o}function a8(i,e){return $i(i.prev,i,e.prev)<0&&$i(e.next,i,i.next)<0}function o8(i,e,t,n){let s=i;do s.z===0&&(s.z=vM(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,l8(s)}function l8(i){let e,t=1;do{let n=i,s;i=null;let r=null;for(e=0;n;){e++;let o=n,c=0;for(let p=0;p<t&&(c++,o=o.nextZ,!!o);p++);let f=t;for(;c>0||f>0&&o;)c!==0&&(f===0||!o||n.z<=o.z)?(s=n,n=n.nextZ,c--):(s=o,o=o.nextZ,f--),r?r.nextZ=s:i=s,s.prevZ=r,r=s;n=o}r.nextZ=null,t*=2}while(e>1);return i}function vM(i,e,t,n,s){return i=(i-t)*s|0,e=(e-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function c8(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function UL(i,e,t,n,s,r,o,c){return(s-o)*(e-c)>=(i-o)*(r-c)&&(i-o)*(n-c)>=(t-o)*(e-c)&&(t-o)*(r-c)>=(s-o)*(n-c)}function Qy(i,e,t,n,s,r,o,c){return!(i===o&&e===c)&&UL(i,e,t,n,s,r,o,c)}function u8(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!h8(i,e)&&(N_(i,e)&&N_(e,i)&&f8(i,e)&&($i(i.prev,i,e.prev)||$i(i,e.prev,e))||ug(i,e)&&$i(i.prev,i,i.next)>0&&$i(e.prev,e,e.next)>0)}function $i(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function ug(i,e){return i.x===e.x&&i.y===e.y}function PL(i,e,t,n){const s=hA($i(i,e,t)),r=hA($i(i,e,n)),o=hA($i(t,n,i)),c=hA($i(t,n,e));return!!(s!==r&&o!==c||s===0&&uA(i,t,e)||r===0&&uA(i,n,e)||o===0&&uA(t,i,n)||c===0&&uA(t,e,n))}function uA(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function hA(i){return i>0?1:i<0?-1:0}function h8(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&PL(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function N_(i,e){return $i(i.prev,i,i.next)<0?$i(i,e,i.next)>=0&&$i(i,i.prev,e)>=0:$i(i,e,i.prev)<0||$i(i,i.next,e)<0}function f8(i,e){let t=i,n=!1;const s=(i.x+e.x)/2,r=(i.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&s<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function FL(i,e){const t=AM(i.i,i.x,i.y),n=AM(e.i,e.x,e.y),s=i.next,r=e.prev;return i.next=e,e.prev=i,t.next=s,s.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function oD(i,e,t,n){const s=AM(i,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function O_(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function AM(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function d8(i,e,t,n){let s=0;for(let r=e,o=t-n;r<t;r+=n)s+=(i[o]-i[r])*(i[r+1]+i[o+1]),o=r;return s}class p8{static triangulate(e,t,n=2){return Q5(e,t,n)}}class El{static area(e){const t=e.length;let n=0;for(let s=t-1,r=0;r<t;s=r++)n+=e[s].x*e[r].y-e[r].x*e[s].y;return n*.5}static isClockWise(e){return El.area(e)<0}static triangulateShape(e,t){const n=[],s=[],r=[];lD(e),cD(n,e);let o=e.length;t.forEach(lD);for(let f=0;f<t.length;f++)s.push(o),o+=t[f].length,cD(n,t[f]);const c=p8.triangulate(n,s);for(let f=0;f<c.length;f+=3)r.push(c.slice(f,f+3));return r}}function lD(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function cD(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class rE extends yn{constructor(e=new jd([new Xe(.5,.5),new Xe(-.5,.5),new Xe(-.5,-.5),new Xe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],r=[];for(let c=0,f=e.length;c<f;c++){const p=e[c];o(p)}this.setAttribute("position",new Pt(s,3)),this.setAttribute("uv",new Pt(r,2)),this.computeVertexNormals();function o(c){const f=[],p=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,y=t.depth!==void 0?t.depth:1;let v=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:x-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,D=t.UVGenerator!==void 0?t.UVGenerator:m8;let B,L=!1,G,H,F,U;T&&(B=T.getSpacedPoints(m),L=!0,v=!1,G=T.computeFrenetFrames(m,!1),H=new $,F=new $,U=new $),v||(M=0,x=0,b=0,R=0);const I=c.extractPoints(p);let N=I.shape;const z=I.holes;if(!El.isClockWise(N)){N=N.reverse();for(let Ge=0,He=z.length;Ge<He;Ge++){const tt=z[Ge];El.isClockWise(tt)&&(z[Ge]=tt.reverse())}}function k(Ge){const tt=10000000000000001e-36;let Fe=Ge[0];for(let ut=1;ut<=Ge.length;ut++){const Qe=ut%Ge.length,st=Ge[Qe],Ft=st.x-Fe.x,Gt=st.y-Fe.y,te=Ft*Ft+Gt*Gt,X=Math.max(Math.abs(st.x),Math.abs(st.y),Math.abs(Fe.x),Math.abs(Fe.y)),xe=tt*X*X;if(te<=xe){Ge.splice(Qe,1),ut--;continue}Fe=st}}k(N),z.forEach(k);const he=z.length,me=N;for(let Ge=0;Ge<he;Ge++){const He=z[Ge];N=N.concat(He)}function q(Ge,He,tt){return He||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ge.clone().addScaledVector(He,tt)}const ee=N.length;function ne(Ge,He,tt){let Fe,ut,Qe;const st=Ge.x-He.x,Ft=Ge.y-He.y,Gt=tt.x-Ge.x,te=tt.y-Ge.y,X=st*st+Ft*Ft,xe=st*te-Ft*Gt;if(Math.abs(xe)>Number.EPSILON){const Re=Math.sqrt(X),Ue=Math.sqrt(Gt*Gt+te*te),Le=He.x-Ft/Re,_t=He.y+st/Re,ht=tt.x-te/Ue,wt=tt.y+Gt/Ue,Mt=((ht-Le)*te-(wt-_t)*Gt)/(st*te-Ft*Gt);Fe=Le+st*Mt-Ge.x,ut=_t+Ft*Mt-Ge.y;const et=Fe*Fe+ut*ut;if(et<=2)return new Xe(Fe,ut);Qe=Math.sqrt(et/2)}else{let Re=!1;st>Number.EPSILON?Gt>Number.EPSILON&&(Re=!0):st<-Number.EPSILON?Gt<-Number.EPSILON&&(Re=!0):Math.sign(Ft)===Math.sign(te)&&(Re=!0),Re?(Fe=-Ft,ut=st,Qe=Math.sqrt(X)):(Fe=st,ut=Ft,Qe=Math.sqrt(X/2))}return new Xe(Fe/Qe,ut/Qe)}const ye=[];for(let Ge=0,He=me.length,tt=He-1,Fe=Ge+1;Ge<He;Ge++,tt++,Fe++)tt===He&&(tt=0),Fe===He&&(Fe=0),ye[Ge]=ne(me[Ge],me[tt],me[Fe]);const K=[];let ce,Ee=ye.concat();for(let Ge=0,He=he;Ge<He;Ge++){const tt=z[Ge];ce=[];for(let Fe=0,ut=tt.length,Qe=ut-1,st=Fe+1;Fe<ut;Fe++,Qe++,st++)Qe===ut&&(Qe=0),st===ut&&(st=0),ce[Fe]=ne(tt[Fe],tt[Qe],tt[st]);K.push(ce),Ee=Ee.concat(ce)}let Me;if(M===0)Me=El.triangulateShape(me,z);else{const Ge=[],He=[];for(let tt=0;tt<M;tt++){const Fe=tt/M,ut=x*Math.cos(Fe*Math.PI/2),Qe=b*Math.sin(Fe*Math.PI/2)+R;for(let st=0,Ft=me.length;st<Ft;st++){const Gt=q(me[st],ye[st],Qe);At(Gt.x,Gt.y,-ut),Fe===0&&Ge.push(Gt)}for(let st=0,Ft=he;st<Ft;st++){const Gt=z[st];ce=K[st];const te=[];for(let X=0,xe=Gt.length;X<xe;X++){const Re=q(Gt[X],ce[X],Qe);At(Re.x,Re.y,-ut),Fe===0&&te.push(Re)}Fe===0&&He.push(te)}}Me=El.triangulateShape(Ge,He)}const Ve=Me.length,ge=b+R;for(let Ge=0;Ge<ee;Ge++){const He=v?q(N[Ge],Ee[Ge],ge):N[Ge];L?(F.copy(G.normals[0]).multiplyScalar(He.x),H.copy(G.binormals[0]).multiplyScalar(He.y),U.copy(B[0]).add(F).add(H),At(U.x,U.y,U.z)):At(He.x,He.y,0)}for(let Ge=1;Ge<=m;Ge++)for(let He=0;He<ee;He++){const tt=v?q(N[He],Ee[He],ge):N[He];L?(F.copy(G.normals[Ge]).multiplyScalar(tt.x),H.copy(G.binormals[Ge]).multiplyScalar(tt.y),U.copy(B[Ge]).add(F).add(H),At(U.x,U.y,U.z)):At(tt.x,tt.y,y/m*Ge)}for(let Ge=M-1;Ge>=0;Ge--){const He=Ge/M,tt=x*Math.cos(He*Math.PI/2),Fe=b*Math.sin(He*Math.PI/2)+R;for(let ut=0,Qe=me.length;ut<Qe;ut++){const st=q(me[ut],ye[ut],Fe);At(st.x,st.y,y+tt)}for(let ut=0,Qe=z.length;ut<Qe;ut++){const st=z[ut];ce=K[ut];for(let Ft=0,Gt=st.length;Ft<Gt;Ft++){const te=q(st[Ft],ce[Ft],Fe);L?At(te.x,te.y+B[m-1].y,B[m-1].x+tt):At(te.x,te.y,y+tt)}}}ze(),Je();function ze(){const Ge=s.length/3;if(v){let He=0,tt=ee*He;for(let Fe=0;Fe<Ve;Fe++){const ut=Me[Fe];Et(ut[2]+tt,ut[1]+tt,ut[0]+tt)}He=m+M*2,tt=ee*He;for(let Fe=0;Fe<Ve;Fe++){const ut=Me[Fe];Et(ut[0]+tt,ut[1]+tt,ut[2]+tt)}}else{for(let He=0;He<Ve;He++){const tt=Me[He];Et(tt[2],tt[1],tt[0])}for(let He=0;He<Ve;He++){const tt=Me[He];Et(tt[0]+ee*m,tt[1]+ee*m,tt[2]+ee*m)}}n.addGroup(Ge,s.length/3-Ge,0)}function Je(){const Ge=s.length/3;let He=0;lt(me,He),He+=me.length;for(let tt=0,Fe=z.length;tt<Fe;tt++){const ut=z[tt];lt(ut,He),He+=ut.length}n.addGroup(Ge,s.length/3-Ge,1)}function lt(Ge,He){let tt=Ge.length;for(;--tt>=0;){const Fe=tt;let ut=tt-1;ut<0&&(ut=Ge.length-1);for(let Qe=0,st=m+M*2;Qe<st;Qe++){const Ft=ee*Qe,Gt=ee*(Qe+1),te=He+Fe+Ft,X=He+ut+Ft,xe=He+ut+Gt,Re=He+Fe+Gt;Nt(te,X,xe,Re)}}}function At(Ge,He,tt){f.push(Ge),f.push(He),f.push(tt)}function Et(Ge,He,tt){It(Ge),It(He),It(tt);const Fe=s.length/3,ut=D.generateTopUV(n,s,Fe-3,Fe-2,Fe-1);se(ut[0]),se(ut[1]),se(ut[2])}function Nt(Ge,He,tt,Fe){It(Ge),It(He),It(Fe),It(He),It(tt),It(Fe);const ut=s.length/3,Qe=D.generateSideWallUV(n,s,ut-6,ut-3,ut-2,ut-1);se(Qe[0]),se(Qe[1]),se(Qe[3]),se(Qe[1]),se(Qe[2]),se(Qe[3])}function It(Ge){s.push(f[Ge*3+0]),s.push(f[Ge*3+1]),s.push(f[Ge*3+2])}function se(Ge){r.push(Ge.x),r.push(Ge.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return g8(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const c=t[e.shapes[r]];n.push(c)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new $x[s.type]().fromJSON(s)),new rE(n,e.options)}}const m8={generateTopUV:function(i,e,t,n,s){const r=e[t*3],o=e[t*3+1],c=e[n*3],f=e[n*3+1],p=e[s*3],m=e[s*3+1];return[new Xe(r,o),new Xe(c,f),new Xe(p,m)]},generateSideWallUV:function(i,e,t,n,s,r){const o=e[t*3],c=e[t*3+1],f=e[t*3+2],p=e[n*3],m=e[n*3+1],y=e[n*3+2],v=e[s*3],x=e[s*3+1],b=e[s*3+2],R=e[r*3],M=e[r*3+1],T=e[r*3+2];return Math.abs(c-m)<Math.abs(o-p)?[new Xe(o,1-f),new Xe(p,1-y),new Xe(v,1-b),new Xe(R,1-T)]:[new Xe(c,1-f),new Xe(m,1-y),new Xe(x,1-b),new Xe(M,1-T)]}};function g8(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,s=i.length;n<s;n++){const r=i[n];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class aE extends vf{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new aE(e.radius,e.detail)}}class oE extends yn{constructor(e=[new Xe(0,-.5),new Xe(.5,0),new Xe(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=nn(s,0,Math.PI*2);const r=[],o=[],c=[],f=[],p=[],m=1/t,y=new $,v=new Xe,x=new $,b=new $,R=new $;let M=0,T=0;for(let D=0;D<=e.length-1;D++)switch(D){case 0:M=e[D+1].x-e[D].x,T=e[D+1].y-e[D].y,x.x=T*1,x.y=-M,x.z=T*0,R.copy(x),x.normalize(),f.push(x.x,x.y,x.z);break;case e.length-1:f.push(R.x,R.y,R.z);break;default:M=e[D+1].x-e[D].x,T=e[D+1].y-e[D].y,x.x=T*1,x.y=-M,x.z=T*0,b.copy(x),x.x+=R.x,x.y+=R.y,x.z+=R.z,x.normalize(),f.push(x.x,x.y,x.z),R.copy(b)}for(let D=0;D<=t;D++){const B=n+D*m*s,L=Math.sin(B),G=Math.cos(B);for(let H=0;H<=e.length-1;H++){y.x=e[H].x*L,y.y=e[H].y,y.z=e[H].x*G,o.push(y.x,y.y,y.z),v.x=D/t,v.y=H/(e.length-1),c.push(v.x,v.y);const F=f[3*H+0]*L,U=f[3*H+1],I=f[3*H+0]*G;p.push(F,U,I)}}for(let D=0;D<t;D++)for(let B=0;B<e.length-1;B++){const L=B+D*e.length,G=L,H=L+e.length,F=L+e.length+1,U=L+1;r.push(G,H,U),r.push(F,U,H)}this.setIndex(r),this.setAttribute("position",new Pt(o,3)),this.setAttribute("uv",new Pt(c,2)),this.setAttribute("normal",new Pt(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oE(e.points,e.segments,e.phiStart,e.phiLength)}}class rv extends vf{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new rv(e.radius,e.detail)}}class Tg extends yn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const r=e/2,o=t/2,c=Math.floor(n),f=Math.floor(s),p=c+1,m=f+1,y=e/c,v=t/f,x=[],b=[],R=[],M=[];for(let T=0;T<m;T++){const D=T*v-o;for(let B=0;B<p;B++){const L=B*y-r;b.push(L,-D,0),R.push(0,0,1),M.push(B/c),M.push(1-T/f)}}for(let T=0;T<f;T++)for(let D=0;D<c;D++){const B=D+p*T,L=D+p*(T+1),G=D+1+p*(T+1),H=D+1+p*T;x.push(B,L,H),x.push(L,G,H)}this.setIndex(x),this.setAttribute("position",new Pt(b,3)),this.setAttribute("normal",new Pt(R,3)),this.setAttribute("uv",new Pt(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tg(e.width,e.height,e.widthSegments,e.heightSegments)}}class lE extends yn{constructor(e=.5,t=1,n=32,s=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:r,thetaLength:o},n=Math.max(3,n),s=Math.max(1,s);const c=[],f=[],p=[],m=[];let y=e;const v=(t-e)/s,x=new $,b=new Xe;for(let R=0;R<=s;R++){for(let M=0;M<=n;M++){const T=r+M/n*o;x.x=y*Math.cos(T),x.y=y*Math.sin(T),f.push(x.x,x.y,x.z),p.push(0,0,1),b.x=(x.x/t+1)/2,b.y=(x.y/t+1)/2,m.push(b.x,b.y)}y+=v}for(let R=0;R<s;R++){const M=R*(n+1);for(let T=0;T<n;T++){const D=T+M,B=D,L=D+n+1,G=D+n+2,H=D+1;c.push(B,L,H),c.push(L,G,H)}}this.setIndex(c),this.setAttribute("position",new Pt(f,3)),this.setAttribute("normal",new Pt(p,3)),this.setAttribute("uv",new Pt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lE(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class cE extends yn{constructor(e=new jd([new Xe(0,.5),new Xe(-.5,-.5),new Xe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],r=[],o=[];let c=0,f=0;if(Array.isArray(e)===!1)p(e);else for(let m=0;m<e.length;m++)p(e[m]),this.addGroup(c,f,m),c+=f,f=0;this.setIndex(n),this.setAttribute("position",new Pt(s,3)),this.setAttribute("normal",new Pt(r,3)),this.setAttribute("uv",new Pt(o,2));function p(m){const y=s.length/3,v=m.extractPoints(t);let x=v.shape;const b=v.holes;El.isClockWise(x)===!1&&(x=x.reverse());for(let M=0,T=b.length;M<T;M++){const D=b[M];El.isClockWise(D)===!0&&(b[M]=D.reverse())}const R=El.triangulateShape(x,b);for(let M=0,T=b.length;M<T;M++){const D=b[M];x=x.concat(D)}for(let M=0,T=x.length;M<T;M++){const D=x[M];s.push(D.x,D.y,0),r.push(0,0,1),o.push(D.x,D.y)}for(let M=0,T=R.length;M<T;M++){const D=R[M],B=D[0]+y,L=D[1]+y,G=D[2]+y;n.push(B,L,G),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return y8(t,e)}static fromJSON(e,t){const n=[];for(let s=0,r=e.shapes.length;s<r;s++){const o=t[e.shapes[s]];n.push(o)}return new cE(n,e.curveSegments)}}function y8(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const s=i[t];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class av extends yn{constructor(e=1,t=32,n=16,s=0,r=Math.PI*2,o=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:r,thetaStart:o,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const f=Math.min(o+c,Math.PI);let p=0;const m=[],y=new $,v=new $,x=[],b=[],R=[],M=[];for(let T=0;T<=n;T++){const D=[],B=T/n;let L=0;T===0&&o===0?L=.5/t:T===n&&f===Math.PI&&(L=-.5/t);for(let G=0;G<=t;G++){const H=G/t;y.x=-e*Math.cos(s+H*r)*Math.sin(o+B*c),y.y=e*Math.cos(o+B*c),y.z=e*Math.sin(s+H*r)*Math.sin(o+B*c),b.push(y.x,y.y,y.z),v.copy(y).normalize(),R.push(v.x,v.y,v.z),M.push(H+L,1-B),D.push(p++)}m.push(D)}for(let T=0;T<n;T++)for(let D=0;D<t;D++){const B=m[T][D+1],L=m[T][D],G=m[T+1][D],H=m[T+1][D+1];(T!==0||o>0)&&x.push(B,L,H),(T!==n-1||f<Math.PI)&&x.push(L,G,H)}this.setIndex(x),this.setAttribute("position",new Pt(b,3)),this.setAttribute("normal",new Pt(R,3)),this.setAttribute("uv",new Pt(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new av(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class uE extends vf{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new uE(e.radius,e.detail)}}class hE extends yn{constructor(e=1,t=.4,n=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:r},n=Math.floor(n),s=Math.floor(s);const o=[],c=[],f=[],p=[],m=new $,y=new $,v=new $;for(let x=0;x<=n;x++)for(let b=0;b<=s;b++){const R=b/s*r,M=x/n*Math.PI*2;y.x=(e+t*Math.cos(M))*Math.cos(R),y.y=(e+t*Math.cos(M))*Math.sin(R),y.z=t*Math.sin(M),c.push(y.x,y.y,y.z),m.x=e*Math.cos(R),m.y=e*Math.sin(R),v.subVectors(y,m).normalize(),f.push(v.x,v.y,v.z),p.push(b/s),p.push(x/n)}for(let x=1;x<=n;x++)for(let b=1;b<=s;b++){const R=(s+1)*x+b-1,M=(s+1)*(x-1)+b-1,T=(s+1)*(x-1)+b,D=(s+1)*x+b;o.push(R,M,D),o.push(M,T,D)}this.setIndex(o),this.setAttribute("position",new Pt(c,3)),this.setAttribute("normal",new Pt(f,3)),this.setAttribute("uv",new Pt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hE(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class fE extends yn{constructor(e=1,t=.4,n=64,s=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:r,q:o},n=Math.floor(n),s=Math.floor(s);const c=[],f=[],p=[],m=[],y=new $,v=new $,x=new $,b=new $,R=new $,M=new $,T=new $;for(let B=0;B<=n;++B){const L=B/n*r*Math.PI*2;D(L,r,o,e,x),D(L+.01,r,o,e,b),M.subVectors(b,x),T.addVectors(b,x),R.crossVectors(M,T),T.crossVectors(R,M),R.normalize(),T.normalize();for(let G=0;G<=s;++G){const H=G/s*Math.PI*2,F=-t*Math.cos(H),U=t*Math.sin(H);y.x=x.x+(F*T.x+U*R.x),y.y=x.y+(F*T.y+U*R.y),y.z=x.z+(F*T.z+U*R.z),f.push(y.x,y.y,y.z),v.subVectors(y,x).normalize(),p.push(v.x,v.y,v.z),m.push(B/n),m.push(G/s)}}for(let B=1;B<=n;B++)for(let L=1;L<=s;L++){const G=(s+1)*(B-1)+(L-1),H=(s+1)*B+(L-1),F=(s+1)*B+L,U=(s+1)*(B-1)+L;c.push(G,H,U),c.push(H,F,U)}this.setIndex(c),this.setAttribute("position",new Pt(f,3)),this.setAttribute("normal",new Pt(p,3)),this.setAttribute("uv",new Pt(m,2));function D(B,L,G,H,F){const U=Math.cos(B),I=Math.sin(B),N=G/L*B,z=Math.cos(N);F.x=H*(2+z)*.5*U,F.y=H*(2+z)*I*.5,F.z=H*Math.sin(N)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fE(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class dE extends yn{constructor(e=new mC(new $(-1,-1,0),new $(-1,1,0),new $(1,1,0)),t=64,n=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const c=new $,f=new $,p=new Xe;let m=new $;const y=[],v=[],x=[],b=[];R(),this.setIndex(b),this.setAttribute("position",new Pt(y,3)),this.setAttribute("normal",new Pt(v,3)),this.setAttribute("uv",new Pt(x,2));function R(){for(let B=0;B<t;B++)M(B);M(r===!1?t:0),D(),T()}function M(B){m=e.getPointAt(B/t,m);const L=o.normals[B],G=o.binormals[B];for(let H=0;H<=s;H++){const F=H/s*Math.PI*2,U=Math.sin(F),I=-Math.cos(F);f.x=I*L.x+U*G.x,f.y=I*L.y+U*G.y,f.z=I*L.z+U*G.z,f.normalize(),v.push(f.x,f.y,f.z),c.x=m.x+n*f.x,c.y=m.y+n*f.y,c.z=m.z+n*f.z,y.push(c.x,c.y,c.z)}}function T(){for(let B=1;B<=t;B++)for(let L=1;L<=s;L++){const G=(s+1)*(B-1)+(L-1),H=(s+1)*B+(L-1),F=(s+1)*B+L,U=(s+1)*(B-1)+L;b.push(G,H,U),b.push(H,F,U)}}function D(){for(let B=0;B<=t;B++)for(let L=0;L<=s;L++)p.x=B/t,p.y=L/s,x.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new dE(new $x[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class zL extends yn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new $,r=new $;if(e.index!==null){const o=e.attributes.position,c=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:c.count,materialIndex:0}]);for(let p=0,m=f.length;p<m;++p){const y=f[p],v=y.start,x=y.count;for(let b=v,R=v+x;b<R;b+=3)for(let M=0;M<3;M++){const T=c.getX(b+M),D=c.getX(b+(M+1)%3);s.fromBufferAttribute(o,T),r.fromBufferAttribute(o,D),uD(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let c=0,f=o.count/3;c<f;c++)for(let p=0;p<3;p++){const m=3*c+p,y=3*c+(p+1)%3;s.fromBufferAttribute(o,m),r.fromBufferAttribute(o,y),uD(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Pt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function uD(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var hD=Object.freeze({__proto__:null,BoxGeometry:lp,CapsuleGeometry:tE,CircleGeometry:nE,ConeGeometry:sv,CylinderGeometry:iv,DodecahedronGeometry:iE,EdgesGeometry:wL,ExtrudeGeometry:rE,IcosahedronGeometry:aE,LatheGeometry:oE,OctahedronGeometry:rv,PlaneGeometry:Tg,PolyhedronGeometry:vf,RingGeometry:lE,ShapeGeometry:cE,SphereGeometry:av,TetrahedronGeometry:uE,TorusGeometry:hE,TorusKnotGeometry:fE,TubeGeometry:dE,WireframeGeometry:zL});class VL extends Vs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new St(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class HL extends Cl{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class ov extends Vs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_f,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Go extends ov{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return nn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class kL extends Vs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new St(16777215),this.specular=new St(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_f,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.combine=Z_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class GL extends Vs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new St(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_f,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class jL extends Vs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_f,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class qL extends Vs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_f,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.combine=Z_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yC extends Vs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=rL,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class _C extends Vs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class XL extends Vs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new St(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_f,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class WL extends Pr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ld(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function YL(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function KL(i){function e(s,r){return i[s]-i[r]}const t=i.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function xM(i,e,t){const n=i.length,s=new i.constructor(n);for(let r=0,o=0;o!==n;++r){const c=t[r]*e;for(let f=0;f!==e;++f)s[o++]=i[c+f]}return s}function vC(i,e,t,n){let s=1,r=i[0];for(;r!==void 0&&r[n]===void 0;)r=i[s++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push(...o)),r=i[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=i[s++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=i[s++];while(r!==void 0)}function _8(i,e,t,n,s=30){const r=i.clone();r.name=e;const o=[];for(let f=0;f<r.tracks.length;++f){const p=r.tracks[f],m=p.getValueSize(),y=[],v=[];for(let x=0;x<p.times.length;++x){const b=p.times[x]*s;if(!(b<t||b>=n)){y.push(p.times[x]);for(let R=0;R<m;++R)v.push(p.values[x*m+R])}}y.length!==0&&(p.times=Ld(y,p.times.constructor),p.values=Ld(v,p.values.constructor),o.push(p))}r.tracks=o;let c=1/0;for(let f=0;f<r.tracks.length;++f)c>r.tracks[f].times[0]&&(c=r.tracks[f].times[0]);for(let f=0;f<r.tracks.length;++f)r.tracks[f].shift(-1*c);return r.resetDuration(),r}function v8(i,e=0,t=i,n=30){n<=0&&(n=30);const s=t.tracks.length,r=e/n;for(let o=0;o<s;++o){const c=t.tracks[o],f=c.ValueTypeName;if(f==="bool"||f==="string")continue;const p=i.tracks.find(function(T){return T.name===c.name&&T.ValueTypeName===f});if(p===void 0)continue;let m=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=y/3);let v=0;const x=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=x/3);const b=c.times.length-1;let R;if(r<=c.times[0]){const T=m,D=y-m;R=c.values.slice(T,D)}else if(r>=c.times[b]){const T=b*y+m,D=T+y-m;R=c.values.slice(T,D)}else{const T=c.createInterpolant(),D=m,B=y-m;T.evaluate(r),R=T.resultBuffer.slice(D,B)}f==="quaternion"&&new Zs().fromArray(R).normalize().conjugate().toArray(R);const M=p.times.length;for(let T=0;T<M;++T){const D=T*x+v;if(f==="quaternion")Zs.multiplyQuaternionsFlat(p.values,D,R,0,p.values,D);else{const B=x-v*2;for(let L=0;L<B;++L)p.values[D+L]-=R[L]}}}return i.blendMode=Q1,i}class A8{static convertArray(e,t){return Ld(e,t)}static isTypedArray(e){return YL(e)}static getKeyframeOrder(e){return KL(e)}static sortedArray(e,t,n){return xM(e,t,n)}static flattenJSON(e,t,n,s){vC(e,t,n,s)}static subclip(e,t,n,s,r=30){return _8(e,t,n,s,r)}static makeClipAdditive(e,t=0,n=e,s=30){return v8(e,t,n,s)}}class Mg{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<s)){for(let c=n+2;;){if(s===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(r=s,s=t[++n],e<s)break t}o=t.length;break n}if(!(e>=r)){const c=t[1];e<c&&(n=2,r=c);for(let f=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(s=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){const c=n+o>>>1;e<t[c]?o=c:n=c+1}if(s=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,s)}return this.interpolate_(n,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class JL extends Mg{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Nd,endingEnd:Nd}}intervalChanged_(e,t,n){const s=this.parameterPositions;let r=e-2,o=e+1,c=s[r],f=s[o];if(c===void 0)switch(this.getSettings_().endingStart){case Od:r=e,c=2*t-n;break;case R_:r=s.length-2,c=t+s[r]-s[r+1];break;default:r=e,c=n}if(f===void 0)switch(this.getSettings_().endingEnd){case Od:o=e,f=2*n-t;break;case R_:o=1,f=n+s[1]-s[0];break;default:o=e-1,f=t}const p=(n-t)*.5,m=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(f-n),this._offsetPrev=r*m,this._offsetNext=o*m}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,f=e*c,p=f-c,m=this._offsetPrev,y=this._offsetNext,v=this._weightPrev,x=this._weightNext,b=(n-t)/(s-t),R=b*b,M=R*b,T=-v*M+2*v*R-v*b,D=(1+v)*M+(-1.5-2*v)*R+(-.5+v)*b+1,B=(-1-x)*M+(1.5+x)*R+.5*b,L=x*M-x*R;for(let G=0;G!==c;++G)r[G]=T*o[m+G]+D*o[p+G]+B*o[f+G]+L*o[y+G];return r}}class AC extends Mg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,f=e*c,p=f-c,m=(n-t)/(s-t),y=1-m;for(let v=0;v!==c;++v)r[v]=o[p+v]*y+o[f+v]*m;return r}}class QL extends Mg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class jo{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ld(t,this.TimeBufferType),this.values=Ld(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ld(e.times,Array),values:Ld(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new QL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new AC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new JL(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case sg:t=this.InterpolantFactoryMethodDiscrete;break;case rg:t=this.InterpolantFactoryMethodLinear;break;case GA:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return sg;case this.InterpolantFactoryMethodLinear:return rg;case this.InterpolantFactoryMethodSmooth:return GA}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let r=0,o=s-1;for(;r!==s&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const c=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*c,o*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let c=0;c!==r;c++){const f=n[c];if(typeof f=="number"&&isNaN(f)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,f),e=!1;break}if(o!==null&&o>f){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,f,o),e=!1;break}o=f}if(s!==void 0&&YL(s))for(let c=0,f=s.length;c!==f;++c){const p=s[c];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===GA,r=e.length-1;let o=1;for(let c=1;c<r;++c){let f=!1;const p=e[c],m=e[c+1];if(p!==m&&(c!==1||p!==e[0]))if(s)f=!0;else{const y=c*n,v=y-n,x=y+n;for(let b=0;b!==n;++b){const R=t[y+b];if(R!==t[v+b]||R!==t[x+b]){f=!0;break}}}if(f){if(c!==o){e[o]=e[c];const y=c*n,v=o*n;for(let x=0;x!==n;++x)t[v+x]=t[y+x]}++o}}if(r>0){e[o]=e[r];for(let c=r*n,f=o*n,p=0;p!==n;++p)t[f+p]=t[c+p];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}jo.prototype.ValueTypeName="";jo.prototype.TimeBufferType=Float32Array;jo.prototype.ValueBufferType=Float32Array;jo.prototype.DefaultInterpolation=rg;class cp extends jo{constructor(e,t,n){super(e,t,n)}}cp.prototype.ValueTypeName="bool";cp.prototype.ValueBufferType=Array;cp.prototype.DefaultInterpolation=sg;cp.prototype.InterpolantFactoryMethodLinear=void 0;cp.prototype.InterpolantFactoryMethodSmooth=void 0;class xC extends jo{constructor(e,t,n,s){super(e,t,n,s)}}xC.prototype.ValueTypeName="color";class $d extends jo{constructor(e,t,n,s){super(e,t,n,s)}}$d.prototype.ValueTypeName="number";class ZL extends Mg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,f=(n-t)/(s-t);let p=e*c;for(let m=p+c;p!==m;p+=4)Zs.slerpFlat(r,0,o,p-c,o,p,f);return r}}class ep extends jo{constructor(e,t,n,s){super(e,t,n,s)}InterpolantFactoryMethodLinear(e){return new ZL(this.times,this.values,this.getValueSize(),e)}}ep.prototype.ValueTypeName="quaternion";ep.prototype.InterpolantFactoryMethodSmooth=void 0;class up extends jo{constructor(e,t,n){super(e,t,n)}}up.prototype.ValueTypeName="string";up.prototype.ValueBufferType=Array;up.prototype.DefaultInterpolation=sg;up.prototype.InterpolantFactoryMethodLinear=void 0;up.prototype.InterpolantFactoryMethodSmooth=void 0;class tp extends jo{constructor(e,t,n,s){super(e,t,n,s)}}tp.prototype.ValueTypeName="vector";class hg{constructor(e="",t=-1,n=[],s=qS){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=uo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let o=0,c=n.length;o!==c;++o)t.push(S8(n[o]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,o=n.length;r!==o;++r)t.push(jo.toJSON(n[r]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const r=t.length,o=[];for(let c=0;c<r;c++){let f=[],p=[];f.push((c+r-1)%r,c,(c+1)%r),p.push(0,1,0);const m=KL(f);f=xM(f,1,m),p=xM(p,1,m),!s&&f[0]===0&&(f.push(r),p.push(p[0])),o.push(new $d(".morphTargetInfluences["+t[c].name+"]",f,p).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},r=/^([\w-]*?)([\d]+)$/;for(let c=0,f=e.length;c<f;c++){const p=e[c],m=p.name.match(r);if(m&&m.length>1){const y=m[1];let v=s[y];v||(s[y]=v=[]),v.push(p)}}const o=[];for(const c in s)o.push(this.CreateFromMorphTargetSequence(c,s[c],t,n));return o}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(y,v,x,b,R){if(x.length!==0){const M=[],T=[];vC(x,M,T,b),M.length!==0&&R.push(new y(v,M,T))}},s=[],r=e.name||"default",o=e.fps||30,c=e.blendMode;let f=e.length||-1;const p=e.hierarchy||[];for(let y=0;y<p.length;y++){const v=p[y].keys;if(!(!v||v.length===0))if(v[0].morphTargets){const x={};let b;for(b=0;b<v.length;b++)if(v[b].morphTargets)for(let R=0;R<v[b].morphTargets.length;R++)x[v[b].morphTargets[R]]=-1;for(const R in x){const M=[],T=[];for(let D=0;D!==v[b].morphTargets.length;++D){const B=v[b];M.push(B.time),T.push(B.morphTarget===R?1:0)}s.push(new $d(".morphTargetInfluence["+R+"]",M,T))}f=x.length*o}else{const x=".bones["+t[y].name+"]";n(tp,x+".position",v,"pos",s),n(ep,x+".quaternion",v,"rot",s),n(tp,x+".scale",v,"scl",s)}}return s.length===0?null:new this(r,f,s,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function x8(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $d;case"vector":case"vector2":case"vector3":case"vector4":return tp;case"color":return xC;case"quaternion":return ep;case"bool":case"boolean":return cp;case"string":return up}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function S8(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=x8(i.type);if(i.times===void 0){const t=[],n=[];vC(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Ac={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class SC{constructor(e,t,n){const s=this;let r=!1,o=0,c=0,f;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.abortController=new AbortController,this.itemStart=function(m){c++,r===!1&&s.onStart!==void 0&&s.onStart(m,o,c),r=!0},this.itemEnd=function(m){o++,s.onProgress!==void 0&&s.onProgress(m,o,c),o===c&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(m){s.onError!==void 0&&s.onError(m)},this.resolveURL=function(m){return f?f(m):m},this.setURLModifier=function(m){return f=m,this},this.addHandler=function(m,y){return p.push(m,y),this},this.removeHandler=function(m){const y=p.indexOf(m);return y!==-1&&p.splice(y,2),this},this.getHandler=function(m){for(let y=0,v=p.length;y<v;y+=2){const x=p[y],b=p[y+1];if(x.global&&(x.lastIndex=0),x.test(m))return b}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}const $L=new SC;class Fr{constructor(e){this.manager=e!==void 0?e:$L,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,r){n.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}Fr.DEFAULT_MATERIAL_NAME="__DEFAULT";const yu={};class E8 extends Error{constructor(e,t){super(e),this.response=t}}class fo extends Fr{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Ac.get(`file:${e}`);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(yu[e]!==void 0){yu[e].push({onLoad:t,onProgress:n,onError:s});return}yu[e]=[],yu[e].push({onLoad:t,onProgress:n,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),c=this.mimeType,f=this.responseType;fetch(o).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const m=yu[e],y=p.body.getReader(),v=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),x=v?parseInt(v):0,b=x!==0;let R=0;const M=new ReadableStream({start(T){D();function D(){y.read().then(({done:B,value:L})=>{if(B)T.close();else{R+=L.byteLength;const G=new ProgressEvent("progress",{lengthComputable:b,loaded:R,total:x});for(let H=0,F=m.length;H<F;H++){const U=m[H];U.onProgress&&U.onProgress(G)}T.enqueue(L),D()}},B=>{T.error(B)})}}});return new Response(M)}else throw new E8(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(f){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(m=>new DOMParser().parseFromString(m,c));case"json":return p.json();default:if(c==="")return p.text();{const y=/charset="?([^;"\s]*)"?/i.exec(c),v=y&&y[1]?y[1].toLowerCase():void 0,x=new TextDecoder(v);return p.arrayBuffer().then(b=>x.decode(b))}}}).then(p=>{Ac.add(`file:${e}`,p);const m=yu[e];delete yu[e];for(let y=0,v=m.length;y<v;y++){const x=m[y];x.onLoad&&x.onLoad(p)}}).catch(p=>{const m=yu[e];if(m===void 0)throw this.manager.itemError(e),p;delete yu[e];for(let y=0,v=m.length;y<v;y++){const x=m[y];x.onError&&x.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class b8 extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new fo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(f){s?s(f):console.error(f),r.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=hg.parse(e[n]);t.push(s)}return t}}class T8 extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=this,o=[],c=new eE,f=new fo(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(r.withCredentials);let p=0;function m(y){f.load(e[y],function(v){const x=r.parse(v,!0);o[y]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},p+=1,p===6&&(x.mipmapCount===1&&(c.minFilter=_s),c.image=o,c.format=x.format,c.needsUpdate=!0,t&&t(c))},n,s)}if(Array.isArray(e))for(let y=0,v=e.length;y<v;++y)m(y);else f.load(e,function(y){const v=r.parse(y,!0);if(v.isCubemap){const x=v.mipmaps.length/v.mipmapCount;for(let b=0;b<x;b++){o[b]={mipmaps:[]};for(let R=0;R<v.mipmapCount;R++)o[b].mipmaps.push(v.mipmaps[b*v.mipmapCount+R]),o[b].format=v.format,o[b].width=v.width,o[b].height=v.height}c.image=o}else c.image.width=v.width,c.image.height=v.height,c.mipmaps=v.mipmaps;v.mipmapCount===1&&(c.minFilter=_s),c.format=v.format,c.needsUpdate=!0,t&&t(c)},n,s);return c}}const Em=new WeakMap;class L_ extends Fr{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Ac.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0);else{let y=Em.get(o);y===void 0&&(y=[],Em.set(o,y)),y.push({onLoad:t,onError:s})}return o}const c=I_("img");function f(){m(),t&&t(this);const y=Em.get(this)||[];for(let v=0;v<y.length;v++){const x=y[v];x.onLoad&&x.onLoad(this)}Em.delete(this),r.manager.itemEnd(e)}function p(y){m(),s&&s(y),Ac.remove(`image:${e}`);const v=Em.get(this)||[];for(let x=0;x<v.length;x++){const b=v[x];b.onError&&b.onError(y)}Em.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function m(){c.removeEventListener("load",f,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",f,!1),c.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),Ac.add(`image:${e}`,c),r.manager.itemStart(e),c.src=e,c}}class M8 extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=new ev;r.colorSpace=Nr;const o=new L_(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function f(p){o.load(e[p],function(m){r.images[p]=m,c++,c===6&&(r.needsUpdate=!0,t&&t(r))},void 0,s)}for(let p=0;p<e.length;++p)f(p);return r}}class C8 extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Rc,c=new fo(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(r.withCredentials),c.load(e,function(f){let p;try{p=r.parse(f)}catch(m){if(s!==void 0)s(m);else{console.error(m);return}}p.image!==void 0?o.image=p.image:p.data!==void 0&&(o.image.width=p.width,o.image.height=p.height,o.image.data=p.data),o.wrapS=p.wrapS!==void 0?p.wrapS:oo,o.wrapT=p.wrapT!==void 0?p.wrapT:oo,o.magFilter=p.magFilter!==void 0?p.magFilter:_s,o.minFilter=p.minFilter!==void 0?p.minFilter:_s,o.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(o.colorSpace=p.colorSpace),p.flipY!==void 0&&(o.flipY=p.flipY),p.format!==void 0&&(o.format=p.format),p.type!==void 0&&(o.type=p.type),p.mipmaps!==void 0&&(o.mipmaps=p.mipmaps,o.minFilter=zo),p.mipmapCount===1&&(o.minFilter=_s),p.generateMipmaps!==void 0&&(o.generateMipmaps=p.generateMipmaps),o.needsUpdate=!0,t&&t(o,p)},n,s),o}}class eU extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=new ki,o=new L_(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(c){r.image=c,r.needsUpdate=!0,t!==void 0&&t(r)},n,s),r}}class Af extends jn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class tU extends Af{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(jn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new St(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Qb=new Jt,fD=new $,dD=new $;class EC{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xe(512,512),this.mapType=ko,this.map=null,this.mapPass=null,this.matrix=new Jt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new bg,this._frameExtents=new Xe(1,1),this._viewportCount=1,this._viewports=[new Qn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;fD.setFromMatrixPosition(e.matrixWorld),t.position.copy(fD),dD.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(dD),t.updateMatrixWorld(),Qb.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Qb,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Qb)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class R8 extends EC{constructor(){super(new Hi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=og*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||t.far;(n!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class bC extends Af{constructor(e,t,n=0,s=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(jn.DEFAULT_UP),this.updateMatrix(),this.target=new jn,this.distance=n,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new R8}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const pD=new Jt,jy=new $,Zb=new $;class w8 extends EC{constructor(){super(new Hi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Xe(4,2),this._viewportCount=6,this._viewports=[new Qn(2,1,1,1),new Qn(0,1,1,1),new Qn(3,1,1,1),new Qn(1,1,1,1),new Qn(3,0,1,1),new Qn(1,0,1,1)],this._cubeDirections=[new $(1,0,0),new $(-1,0,0),new $(0,0,1),new $(0,0,-1),new $(0,1,0),new $(0,-1,0)],this._cubeUps=[new $(0,1,0),new $(0,1,0),new $(0,1,0),new $(0,1,0),new $(0,0,1),new $(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),jy.setFromMatrixPosition(e.matrixWorld),n.position.copy(jy),Zb.copy(n.position),Zb.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Zb),n.updateMatrixWorld(),s.makeTranslation(-jy.x,-jy.y,-jy.z),pD.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pD,n.coordinateSystem,n.reversedDepth)}}class TC extends Af{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new w8}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Tl extends YS{constructor(e=-1,t=1,n=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=n-e,o=n+e,c=s+t,f=s-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=p*this.view.offsetX,o=r+p*this.view.width,c-=m*this.view.offsetY,f=c-m*this.view.height}this.projectionMatrix.makeOrthographic(r,o,c,f,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class D8 extends EC{constructor(){super(new Tl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class MC extends Af{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(jn.DEFAULT_UP),this.updateMatrix(),this.target=new jn,this.shadow=new D8}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class nU extends Af{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class iU extends Af{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class sU{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new $)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*s),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*s)),t.addScaledVector(o[5],1.092548*(s*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*s),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*s),t.addScaledVector(o[5],2*.429043*s*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*n*r),t.addScaledVector(o[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,r=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-s*s)}}class rU extends Af{constructor(e=new sU,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class pE extends Fr{constructor(e){super(e),this.textures={}}load(e,t,n,s){const r=this,o=new fo(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(f){s?s(f):console.error(f),r.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new St().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(s.uniforms[r]={},o.type){case"t":s.uniforms[r].value=n(o.value);break;case"c":s.uniforms[r].value=new St().setHex(o.value);break;case"v2":s.uniforms[r].value=new Xe().fromArray(o.value);break;case"v3":s.uniforms[r].value=new $().fromArray(o.value);break;case"v4":s.uniforms[r].value=new Qn().fromArray(o.value);break;case"m3":s.uniforms[r].value=new An().fromArray(o.value);break;case"m4":s.uniforms[r].value=new Jt().fromArray(o.value);break;default:s.uniforms[r].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new Xe().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Xe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return pE.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:VL,SpriteMaterial:rC,RawShaderMaterial:HL,ShaderMaterial:Cl,PointsMaterial:$S,MeshPhysicalMaterial:Go,MeshStandardMaterial:ov,MeshPhongMaterial:kL,MeshToonMaterial:GL,MeshNormalMaterial:jL,MeshLambertMaterial:qL,MeshDepthMaterial:yC,MeshDistanceMaterial:_C,MeshBasicMaterial:co,MeshMatcapMaterial:XL,LineDashedMaterial:WL,LineBasicMaterial:Pr,Material:Vs};return new t[e]}}class tf{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class aU extends yn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class oU extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new fo(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(f){s?s(f):console.error(f),r.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(x,b){if(t[b]!==void 0)return t[b];const M=x.interleavedBuffers[b],T=r(x,M.buffer),D=Om(M.type,T),B=new tv(D,M.stride);return B.uuid=M.uuid,t[b]=B,B}function r(x,b){if(n[b]!==void 0)return n[b];const M=x.arrayBuffers[b],T=new Uint32Array(M).buffer;return n[b]=T,T}const o=e.isInstancedBufferGeometry?new aU:new yn,c=e.data.index;if(c!==void 0){const x=Om(c.type,c.array);o.setIndex(new Zn(x,1))}const f=e.data.attributes;for(const x in f){const b=f[x];let R;if(b.isInterleavedBufferAttribute){const M=s(e.data,b.data);R=new df(M,b.itemSize,b.offset,b.normalized)}else{const M=Om(b.type,b.array),T=b.isInstancedBufferAttribute?Qd:Zn;R=new T(M,b.itemSize,b.normalized)}b.name!==void 0&&(R.name=b.name),b.usage!==void 0&&R.setUsage(b.usage),o.setAttribute(x,R)}const p=e.data.morphAttributes;if(p)for(const x in p){const b=p[x],R=[];for(let M=0,T=b.length;M<T;M++){const D=b[M];let B;if(D.isInterleavedBufferAttribute){const L=s(e.data,D.data);B=new df(L,D.itemSize,D.offset,D.normalized)}else{const L=Om(D.type,D.array);B=new Zn(L,D.itemSize,D.normalized)}D.name!==void 0&&(B.name=D.name),R.push(B)}o.morphAttributes[x]=R}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const y=e.data.groups||e.data.drawcalls||e.data.offsets;if(y!==void 0)for(let x=0,b=y.length;x!==b;++x){const R=y[x];o.addGroup(R.start,R.count,R.materialIndex)}const v=e.data.boundingSphere;return v!==void 0&&(o.boundingSphere=new zs().fromJSON(v)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class I8 extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=this,o=this.path===""?tf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const c=new fo(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(f){let p=null;try{p=JSON.parse(f)}catch(y){s!==void 0&&s(y),console.error("THREE:ObjectLoader: Can't parse "+e+".",y.message);return}const m=p.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(p,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?tf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new fo(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),c=JSON.parse(o),f=c.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){t!==void 0&&t(p)}),c=this.parseTextures(e.textures,o),f=this.parseMaterials(e.materials,c),p=this.parseObject(e.object,r,f,c,n),m=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,m),this.bindLightTargets(p),t!==void 0){let y=!1;for(const v in o)if(o[v].data instanceof HTMLImageElement){y=!0;break}y===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),c=this.parseMaterials(e.materials,o),f=this.parseObject(e.object,s,c,o,t),p=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,p),this.bindLightTargets(f),f}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const r=new jd().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=new nv().fromJSON(e[r],s);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new oU;for(let r=0,o=e.length;r<o;r++){let c;const f=e[r];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":c=s.parse(f);break;default:f.type in hD?c=hD[f.type].fromJSON(f,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${f.type}"`)}c.uuid=f.uuid,f.name!==void 0&&(c.name=f.name),f.userData!==void 0&&(c.userData=f.userData),n[f.uuid]=c}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const r=new pE;r.setTextures(t);for(let o=0,c=e.length;o<c;o++){const f=e[o];n[f.uuid]===void 0&&(n[f.uuid]=r.parse(f)),s[f.uuid]=n[f.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],r=hg.parse(s);t[r.uuid]=r}return t}parseImages(e,t){const n=this,s={};let r;function o(f){return n.manager.itemStart(f),r.load(f,function(){n.manager.itemEnd(f)},void 0,function(){n.manager.itemError(f),n.manager.itemEnd(f)})}function c(f){if(typeof f=="string"){const p=f,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return o(m)}else return f.data?{data:Om(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new SC(t);r=new L_(f),r.setCrossOrigin(this.crossOrigin);for(let p=0,m=e.length;p<m;p++){const y=e[p],v=y.url;if(Array.isArray(v)){const x=[];for(let b=0,R=v.length;b<R;b++){const M=v[b],T=c(M);T!==null&&(T instanceof HTMLImageElement?x.push(T):x.push(new Rc(T.data,T.width,T.height)))}s[y.uuid]=new Kh(x)}else{const x=c(y.url);s[y.uuid]=new Kh(x)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function r(o){if(typeof o=="string"){const c=o,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await s.loadAsync(f)}else return o.data?{data:Om(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new L_(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,c=e.length;o<c;o++){const f=e[o],p=f.url;if(Array.isArray(p)){const m=[];for(let y=0,v=p.length;y<v;y++){const x=p[y],b=await r(x);b!==null&&(b instanceof HTMLImageElement?m.push(b):m.push(new Rc(b.data,b.width,b.height)))}n[f.uuid]=new Kh(m)}else{const m=await r(f.url);n[f.uuid]=new Kh(m)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const s={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=e[r];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const f=t[c.image],p=f.data;let m;Array.isArray(p)?(m=new ev,p.length===6&&(m.needsUpdate=!0)):(p&&p.data?m=new Rc:m=new ki,p&&(m.needsUpdate=!0)),m.source=f,m.uuid=c.uuid,c.name!==void 0&&(m.name=c.name),c.mapping!==void 0&&(m.mapping=n(c.mapping,B8)),c.channel!==void 0&&(m.channel=c.channel),c.offset!==void 0&&m.offset.fromArray(c.offset),c.repeat!==void 0&&m.repeat.fromArray(c.repeat),c.center!==void 0&&m.center.fromArray(c.center),c.rotation!==void 0&&(m.rotation=c.rotation),c.wrap!==void 0&&(m.wrapS=n(c.wrap[0],mD),m.wrapT=n(c.wrap[1],mD)),c.format!==void 0&&(m.format=c.format),c.internalFormat!==void 0&&(m.internalFormat=c.internalFormat),c.type!==void 0&&(m.type=c.type),c.colorSpace!==void 0&&(m.colorSpace=c.colorSpace),c.minFilter!==void 0&&(m.minFilter=n(c.minFilter,gD)),c.magFilter!==void 0&&(m.magFilter=n(c.magFilter,gD)),c.anisotropy!==void 0&&(m.anisotropy=c.anisotropy),c.flipY!==void 0&&(m.flipY=c.flipY),c.generateMipmaps!==void 0&&(m.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(m.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(m.compareFunction=c.compareFunction),c.userData!==void 0&&(m.userData=c.userData),s[c.uuid]=m}return s}parseObject(e,t,n,s,r){let o;function c(v){return t[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",v),t[v]}function f(v){if(v!==void 0){if(Array.isArray(v)){const x=[];for(let b=0,R=v.length;b<R;b++){const M=v[b];n[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),x.push(n[M])}return x}return n[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),n[v]}}function p(v){return s[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",v),s[v]}let m,y;switch(e.type){case"Scene":o=new sC,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new St(e.background):o.background=p(e.background)),e.environment!==void 0&&(o.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new JS(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new KS(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Hi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Tl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new nU(e.color,e.intensity);break;case"DirectionalLight":o=new MC(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new TC(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new iU(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new bC(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new tU(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new rU().fromJSON(e);break;case"SkinnedMesh":m=c(e.geometry),y=f(e.material),o=new aC(m,y),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":m=c(e.geometry),y=f(e.material),o=new vs(m,y);break;case"InstancedMesh":m=c(e.geometry),y=f(e.material);const v=e.count,x=e.instanceMatrix,b=e.instanceColor;o=new oC(m,y,v),o.instanceMatrix=new Qd(new Float32Array(x.array),16),b!==void 0&&(o.instanceColor=new Qd(new Float32Array(b.array),b.itemSize));break;case"BatchedMesh":m=c(e.geometry),y=f(e.material),o=new CL(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,y),o.geometry=m,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(R=>{let M=null,T=null;return R.boundingBox!==void 0&&(M=new $s().fromJSON(R.boundingBox)),R.boundingSphere!==void 0&&(T=new zs().fromJSON(R.boundingSphere)),{...R,boundingBox:M,boundingSphere:T}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=p(e.matricesTexture.uuid),o._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new zs().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new $s().fromJSON(e.boundingBox));break;case"LOD":o=new ML;break;case"Line":o=new Vu(c(e.geometry),f(e.material));break;case"LineLoop":o=new lC(c(e.geometry),f(e.material));break;case"LineSegments":o=new Rl(c(e.geometry),f(e.material));break;case"PointCloud":case"Points":o=new cC(c(e.geometry),f(e.material));break;case"Sprite":o=new TL(f(e.material));break;case"Group":o=new Cu;break;case"Bone":o=new QS;break;default:o=new jn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const v=e.children;for(let x=0;x<v.length;x++)o.add(this.parseObject(v[x],t,n,s,r))}if(e.animations!==void 0){const v=e.animations;for(let x=0;x<v.length;x++){const b=v[x];o.animations.push(r[b])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const v=e.levels;for(let x=0;x<v.length;x++){const b=v[x],R=o.getObjectByProperty("uuid",b.object);R!==void 0&&o.addLevel(R,b.distance,b.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new jn}})}}const B8={UVMapping:PS,CubeReflectionMapping:Fu,CubeRefractionMapping:uf,EquirectangularReflectionMapping:M_,EquirectangularRefractionMapping:C_,CubeUVReflectionMapping:Sg},mD={RepeatWrapping:hf,ClampToEdgeWrapping:oo,MirroredRepeatWrapping:$m},gD={NearestFilter:Qs,NearestMipmapNearestFilter:FS,NearestMipmapLinearFilter:Bd,LinearFilter:_s,LinearMipmapNearestFilter:Vm,LinearMipmapLinearFilter:zo},$b=new WeakMap;class lU extends Fr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Ac.get(`image-bitmap:${e}`);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(p=>{if($b.has(o)===!0)s&&s($b.get(o)),r.manager.itemError(e),r.manager.itemEnd(e);else return t&&t(p),r.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,c.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const f=fetch(e,c).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(p){return Ac.add(`image-bitmap:${e}`,p),t&&t(p),r.manager.itemEnd(e),p}).catch(function(p){s&&s(p),$b.set(f,p),Ac.remove(`image-bitmap:${e}`),r.manager.itemError(e),r.manager.itemEnd(e)});Ac.add(`image-bitmap:${e}`,f),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let fA;class CC{static getContext(){return fA===void 0&&(fA=new(window.AudioContext||window.webkitAudioContext)),fA}static setContext(e){fA=e}}class N8 extends Fr{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new fo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(f){try{const p=f.slice(0);CC.getContext().decodeAudioData(p,function(y){t(y)}).catch(c)}catch(p){c(p)}},n,s);function c(f){s?s(f):console.error(f),r.manager.itemError(e)}}}const yD=new Jt,_D=new Jt,pd=new Jt;class O8{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Hi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Hi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,pd.copy(e.projectionMatrix);const s=t.eyeSep/2,r=s*t.near/t.focus,o=t.near*Math.tan(Gd*t.fov*.5)/t.zoom;let c,f;_D.elements[12]=-s,yD.elements[12]=s,c=-o*t.aspect+r,f=o*t.aspect+r,pd.elements[0]=2*t.near/(f-c),pd.elements[8]=(f+c)/(f-c),this.cameraL.projectionMatrix.copy(pd),c=-o*t.aspect-r,f=o*t.aspect-r,pd.elements[0]=2*t.near/(f-c),pd.elements[8]=(f+c)/(f-c),this.cameraR.projectionMatrix.copy(pd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(_D),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(yD)}}class cU extends Hi{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class RC{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const md=new $,eT=new Zs,L8=new $,gd=new $,yd=new $;class U8 extends jn{constructor(){super(),this.type="AudioListener",this.context=CC.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new RC}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(md,eT,L8),gd.set(0,0,-1).applyQuaternion(eT),yd.set(0,1,0).applyQuaternion(eT),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(md.x,n),t.positionY.linearRampToValueAtTime(md.y,n),t.positionZ.linearRampToValueAtTime(md.z,n),t.forwardX.linearRampToValueAtTime(gd.x,n),t.forwardY.linearRampToValueAtTime(gd.y,n),t.forwardZ.linearRampToValueAtTime(gd.z,n),t.upX.linearRampToValueAtTime(yd.x,n),t.upY.linearRampToValueAtTime(yd.y,n),t.upZ.linearRampToValueAtTime(yd.z,n)}else t.setPosition(md.x,md.y,md.z),t.setOrientation(gd.x,gd.y,gd.z,yd.x,yd.y,yd.z)}}class uU extends jn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const _d=new $,vD=new Zs,P8=new $,vd=new $;class F8 extends uU{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_d,vD,P8),vd.set(0,0,1).applyQuaternion(vD);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(_d.x,n),t.positionY.linearRampToValueAtTime(_d.y,n),t.positionZ.linearRampToValueAtTime(_d.z,n),t.orientationX.linearRampToValueAtTime(vd.x,n),t.orientationY.linearRampToValueAtTime(vd.y,n),t.orientationZ.linearRampToValueAtTime(vd.z,n)}else t.setPosition(_d.x,_d.y,_d.z),t.setOrientation(vd.x,vd.y,vd.z)}}class z8{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class hU{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,r,o;switch(t){case"quaternion":s=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,r=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==s;++c)n[r+c]=n[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(n,r,0,c,s)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const f=t*this._origIndex;this._mixBufferRegion(n,s,f,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let f=t,p=t+t;f!==p;++f)if(n[f]!==n[f+t]){c.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let r=n,o=s;r!==o;++r)t[r]=t[s+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,r){if(s>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,s){Zs.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,r){const o=this._workIndex*r;Zs.multiplyQuaternionsFlat(e,o,e,t,e,n),Zs.slerpFlat(e,t,e,t,e,o,s)}_lerp(e,t,n,s,r){const o=1-s;for(let c=0;c!==r;++c){const f=t+c;e[f]=e[f]*o+e[n+c]*s}}_lerpAdditive(e,t,n,s,r){for(let o=0;o!==r;++o){const c=t+o;e[c]=e[c]+e[n+o]*s}}}const wC="\\[\\]\\.:\\/",V8=new RegExp("["+wC+"]","g"),DC="[^"+wC+"]",H8="[^"+wC.replace("\\.","")+"]",k8=/((?:WC+[\/:])*)/.source.replace("WC",DC),G8=/(WCOD+)?/.source.replace("WCOD",H8),j8=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",DC),q8=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",DC),X8=new RegExp("^"+k8+G8+j8+q8+"$"),W8=["material","materials","bones","map"];class Y8{constructor(e,t,n){const s=n||Yn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=n.length;s!==r;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Yn{constructor(e,t,n){this.path=t,this.parsedPath=n||Yn.parseTrackName(t),this.node=Yn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Yn.Composite(e,t,n):new Yn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(V8,"")}static parseTrackName(e){const t=X8.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=n.nodeName.substring(s+1);W8.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let o=0;o<r.length;o++){const c=r[o];if(c.name===t||c.uuid===t)return c;const f=n(c.children);if(f)return f}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=Yn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===p){p=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const o=e[s];if(o===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+s+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}f=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(f=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Yn.Composite=Y8;Yn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Yn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Yn.prototype.GetterByBindingType=[Yn.prototype._getValue_direct,Yn.prototype._getValue_array,Yn.prototype._getValue_arrayElement,Yn.prototype._getValue_toArray];Yn.prototype.SetterByBindingTypeAndVersioning=[[Yn.prototype._setValue_direct,Yn.prototype._setValue_direct_setNeedsUpdate,Yn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_array,Yn.prototype._setValue_array_setNeedsUpdate,Yn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_arrayElement,Yn.prototype._setValue_arrayElement_setNeedsUpdate,Yn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_fromArray,Yn.prototype._setValue_fromArray_setNeedsUpdate,Yn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class K8{constructor(){this.isAnimationObjectGroup=!0,this.uuid=uo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length;let c,f=e.length,p=this.nCachedObjects_;for(let m=0,y=arguments.length;m!==y;++m){const v=arguments[m],x=v.uuid;let b=t[x];if(b===void 0){b=f++,t[x]=b,e.push(v);for(let R=0,M=o;R!==M;++R)r[R].push(new Yn(v,n[R],s[R]))}else if(b<p){c=e[b];const R=--p,M=e[R];t[M.uuid]=b,e[b]=M,t[x]=R,e[R]=v;for(let T=0,D=o;T!==D;++T){const B=r[T],L=B[R];let G=B[b];B[b]=L,G===void 0&&(G=new Yn(v,n[T],s[T])),B[R]=G}}else e[b]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const f=arguments[o],p=f.uuid,m=t[p];if(m!==void 0&&m>=r){const y=r++,v=e[y];t[v.uuid]=m,e[m]=v,t[p]=y,e[y]=f;for(let x=0,b=s;x!==b;++x){const R=n[x],M=R[y],T=R[m];R[m]=M,R[y]=T}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_,o=e.length;for(let c=0,f=arguments.length;c!==f;++c){const p=arguments[c],m=p.uuid,y=t[m];if(y!==void 0)if(delete t[m],y<r){const v=--r,x=e[v],b=--o,R=e[b];t[x.uuid]=y,e[y]=x,t[R.uuid]=v,e[v]=R,e.pop();for(let M=0,T=s;M!==T;++M){const D=n[M],B=D[v],L=D[b];D[y]=B,D[v]=L,D.pop()}}else{const v=--o,x=e[v];v>0&&(t[x.uuid]=y),e[y]=x,e.pop();for(let b=0,R=s;b!==R;++b){const M=n[b];M[y]=M[v],M.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const r=this._bindings;if(s!==void 0)return r[s];const o=this._paths,c=this._parsedPaths,f=this._objects,p=f.length,m=this.nCachedObjects_,y=new Array(p);s=r.length,n[e]=s,o.push(e),c.push(t),r.push(y);for(let v=m,x=f.length;v!==x;++v){const b=f[v];y[v]=new Yn(b,e,t)}return y}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,r=this._parsedPaths,o=this._bindings,c=o.length-1,f=o[c],p=e[c];t[p]=n,o[n]=f,o.pop(),r[n]=r[c],r.pop(),s[n]=s[c],s.pop()}}}class fU{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const r=t.tracks,o=r.length,c=new Array(o),f={endingStart:Nd,endingEnd:Nd};for(let p=0;p!==o;++p){const m=r[p].createInterpolant(null);c[p]=m,m.settings=f}this._interpolantSettings=f,this._interpolants=c,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=nL,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const s=this._clip.duration,r=e._clip.duration,o=r/s,c=s/r;e.warp(1,o,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,r=s.time,o=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=s._lendControlInterpolant(),this._timeScaleInterpolant=c);const f=c.parameterPositions,p=c.sampleValues;return f[0]=r,f[1]=r+n,p[0]=e/o,p[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const f=(e-r)*n;f<0||n===0?t=0:(this._startTime=null,t=n*f)}t*=this._updateTimeScale(e);const o=this._updateTime(t),c=this._updateWeight(e);if(c>0){const f=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case Q1:for(let m=0,y=f.length;m!==y;++m)f[m].evaluate(o),p[m].accumulateAdditive(c);break;case qS:default:for(let m=0,y=f.length;m!==y;++m)f[m].evaluate(o),p[m].accumulate(s,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,r=this._loopCount;const o=n===iL;if(e===0)return r===-1?s:o&&(r&1)===1?t-s:s;if(n===tL){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=t||s<0){const c=Math.floor(s/t);s-=t*c,r+=Math.abs(c);const f=this.repetitions-r;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const p=e<0;this._setEndings(p,!p,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=s;if(o&&(r&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=Od,s.endingEnd=Od):(e?s.endingStart=this.zeroSlopeAtStart?Od:Nd:s.endingStart=R_,t?s.endingEnd=this.zeroSlopeAtEnd?Od:Nd:s.endingEnd=R_)}_scheduleFading(e,t,n){const s=this._mixer,r=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const c=o.parameterPositions,f=o.sampleValues;return c[0]=r,f[0]=t,c[1]=r+e,f[1]=n,this}}const J8=new Float32Array(1);class Q8 extends Oc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,r=s.length,o=e._propertyBindings,c=e._interpolants,f=n.uuid,p=this._bindingsByRootAndName;let m=p[f];m===void 0&&(m={},p[f]=m);for(let y=0;y!==r;++y){const v=s[y],x=v.name;let b=m[x];if(b!==void 0)++b.referenceCount,o[y]=b;else{if(b=o[y],b!==void 0){b._cacheIndex===null&&(++b.referenceCount,this._addInactiveBinding(b,f,x));continue}const R=t&&t._propertyBindings[y].binding.parsedPath;b=new hU(Yn.create(n,x,R),v.ValueTypeName,v.getValueSize()),++b.referenceCount,this._addInactiveBinding(b,f,x),o[y]=b}c[y].resultBuffer=b.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const c=o.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,c=o[r],f=c.knownActions,p=f[f.length-1],m=e._byClipCacheIndex;p._byClipCacheIndex=m,f[m]=p,f.pop(),e._byClipCacheIndex=null;const y=c.actionByRoot,v=(e._localRoot||this._root).uuid;delete y[v],f.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,r=this._bindings;let o=s[t];o===void 0&&(o={},s[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,c=o[s],f=t[t.length-1],p=e._cacheIndex;f._cacheIndex=p,t[p]=f,t.pop(),delete c[r],Object.keys(c).length===0&&delete o[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new AC(new Float32Array(2),new Float32Array(2),1,J8),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=t[s];e.__cacheIndex=s,t[s]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const s=t||this._root,r=s.uuid;let o=typeof e=="string"?hg.findByName(s,e):e;const c=o!==null?o.uuid:e,f=this._actionsByClip[c];let p=null;if(n===void 0&&(o!==null?n=o.blendMode:n=qS),f!==void 0){const y=f.actionByRoot[r];if(y!==void 0&&y.blendMode===n)return y;p=f.knownActions[0],o===null&&(o=p._clip)}if(o===null)return null;const m=new fU(this,o,t,n);return this._bindAction(m,p),this._addInactiveAction(m,c,r),m}existingAction(e,t){const n=t||this._root,s=n.uuid,r=typeof e=="string"?hg.findByName(n,e):e,o=r?r.uuid:e,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(s,e,r,o);const c=this._bindings,f=this._nActiveBindings;for(let p=0;p!==f;++p)c[p].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,r=s[n];if(r!==void 0){const o=r.knownActions;for(let c=0,f=o.length;c!==f;++c){const p=o[c];this._deactivateAction(p);const m=p._cacheIndex,y=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,y._cacheIndex=m,t[m]=y,t.pop(),this._removeInactiveBindingsForAction(p)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const c=n[o].actionByRoot,f=c[t];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const s=this._bindingsByRootAndName,r=s[t];if(r!==void 0)for(const o in r){const c=r[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Z8 extends tC{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new WS(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class IC{constructor(e){this.value=e}clone(){return new IC(this.value.clone===void 0?this.value:this.value.clone())}}let $8=0;class e7 extends Oc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:$8++}),this.name="",this.usage=D_,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class t7 extends tv{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class n7{constructor(e,t,n,s,r,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=r,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const AD=new Jt;class dU{constructor(e,t,n=0,s=1/0){this.ray=new op(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new lg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return AD.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(AD),this}intersectObject(e,t=!0,n=[]){return SM(e,this,n,t),n.sort(xD),n}intersectObjects(e,t=!0,n=[]){for(let s=0,r=e.length;s<r;s++)SM(e[s],this,n,t);return n.sort(xD),n}}function xD(i,e){return i.distance-e.distance}function SM(i,e,t,n){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const r=i.children;for(let o=0,c=r.length;o<c;o++)SM(r[o],e,t,!0)}}class i7{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=s7.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function s7(){this._document.hidden===!1&&this.reset()}class EM{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=nn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(nn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class r7{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class BC{constructor(e,t,n,s){BC.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=s,this}}const SD=new Xe;class a7{constructor(e=new Xe(1/0,1/0),t=new Xe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=SD.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,SD).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ED=new $,dA=new $,bm=new $,Tm=new $,tT=new $,o7=new $,l7=new $;class c7{constructor(e=new $,t=new $){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){ED.subVectors(e,this.start),dA.subVectors(this.end,this.start);const n=dA.dot(dA);let r=dA.dot(ED)/n;return t&&(r=nn(r,0,1)),r}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}distanceSqToLine3(e,t=o7,n=l7){const s=10000000000000001e-32;let r,o;const c=this.start,f=e.start,p=this.end,m=e.end;bm.subVectors(p,c),Tm.subVectors(m,f),tT.subVectors(c,f);const y=bm.dot(bm),v=Tm.dot(Tm),x=Tm.dot(tT);if(y<=s&&v<=s)return t.copy(c),n.copy(f),t.sub(n),t.dot(t);if(y<=s)r=0,o=x/v,o=nn(o,0,1);else{const b=bm.dot(tT);if(v<=s)o=0,r=nn(-b/y,0,1);else{const R=bm.dot(Tm),M=y*v-R*R;M!==0?r=nn((R*x-b*v)/M,0,1):r=0,o=(R*r+x)/v,o<0?(o=0,r=nn(-b/y,0,1)):o>1&&(o=1,r=nn((R-b)/y,0,1))}}return t.copy(c).add(bm.multiplyScalar(r)),n.copy(f).add(Tm.multiplyScalar(o)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const bD=new $;class u7 extends jn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new yn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,f=32;o<f;o++,c++){const p=o/f*Math.PI*2,m=c/f*Math.PI*2;s.push(Math.cos(p),Math.sin(p),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new Pt(s,3));const r=new Pr({fog:!1,toneMapped:!1});this.cone=new Rl(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),bD.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(bD),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Vh=new $,pA=new Jt,nT=new Jt;class h7 extends Rl{constructor(e){const t=pU(e),n=new yn,s=[],r=[];for(let p=0;p<t.length;p++){const m=t[p];m.parent&&m.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}n.setAttribute("position",new Pt(s,3)),n.setAttribute("color",new Pt(r,3));const o=new Pr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const c=new St(255),f=new St(65280);this.setColors(c,f)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");nT.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const c=t[r];c.parent&&c.parent.isBone&&(pA.multiplyMatrices(nT,c.matrixWorld),Vh.setFromMatrixPosition(pA),s.setXYZ(o,Vh.x,Vh.y,Vh.z),pA.multiplyMatrices(nT,c.parent.matrixWorld),Vh.setFromMatrixPosition(pA),s.setXYZ(o+1,Vh.x,Vh.y,Vh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const s=this.geometry.getAttribute("color");for(let r=0;r<s.count;r+=2)s.setXYZ(r,e.r,e.g,e.b),s.setXYZ(r+1,t.r,t.g,t.b);return s.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function pU(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...pU(i.children[t]));return e}class f7 extends vs{constructor(e,t,n){const s=new av(t,4,2),r=new co({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const d7=new $,TD=new St,MD=new St;class p7 extends jn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new rv(t);s.rotateY(Math.PI*.5),this.material=new co({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),o=new Float32Array(r.count*3);s.setAttribute("color",new Zn(o,3)),this.add(new vs(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");TD.copy(this.light.color),MD.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const r=n<s/2?TD:MD;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(d7.setFromMatrixPosition(this.light.matrixWorld).negate())}}class m7 extends Rl{constructor(e=10,t=10,n=4473924,s=8947848){n=new St(n),s=new St(s);const r=t/2,o=e/t,c=e/2,f=[],p=[];for(let v=0,x=0,b=-c;v<=t;v++,b+=o){f.push(-c,0,b,c,0,b),f.push(b,0,-c,b,0,c);const R=v===r?n:s;R.toArray(p,x),x+=3,R.toArray(p,x),x+=3,R.toArray(p,x),x+=3,R.toArray(p,x),x+=3}const m=new yn;m.setAttribute("position",new Pt(f,3)),m.setAttribute("color",new Pt(p,3));const y=new Pr({vertexColors:!0,toneMapped:!1});super(m,y),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class g7 extends Rl{constructor(e=10,t=16,n=8,s=64,r=4473924,o=8947848){r=new St(r),o=new St(o);const c=[],f=[];if(t>1)for(let y=0;y<t;y++){const v=y/t*(Math.PI*2),x=Math.sin(v)*e,b=Math.cos(v)*e;c.push(0,0,0),c.push(x,0,b);const R=y&1?r:o;f.push(R.r,R.g,R.b),f.push(R.r,R.g,R.b)}for(let y=0;y<n;y++){const v=y&1?r:o,x=e-e/n*y;for(let b=0;b<s;b++){let R=b/s*(Math.PI*2),M=Math.sin(R)*x,T=Math.cos(R)*x;c.push(M,0,T),f.push(v.r,v.g,v.b),R=(b+1)/s*(Math.PI*2),M=Math.sin(R)*x,T=Math.cos(R)*x,c.push(M,0,T),f.push(v.r,v.g,v.b)}}const p=new yn;p.setAttribute("position",new Pt(c,3)),p.setAttribute("color",new Pt(f,3));const m=new Pr({vertexColors:!0,toneMapped:!1});super(p,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const CD=new $,mA=new $,RD=new $;class y7 extends jn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new yn;s.setAttribute("position",new Pt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Pr({fog:!1,toneMapped:!1});this.lightPlane=new Vu(s,r),this.add(this.lightPlane),s=new yn,s.setAttribute("position",new Pt([0,0,0,0,0,1],3)),this.targetLine=new Vu(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),CD.setFromMatrixPosition(this.light.matrixWorld),mA.setFromMatrixPosition(this.light.target.matrixWorld),RD.subVectors(mA,CD),this.lightPlane.lookAt(mA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(mA),this.targetLine.scale.z=RD.length()}}const gA=new $,ls=new YS;class _7 extends Rl{constructor(e){const t=new yn,n=new Pr({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(b,R){f(b),f(R)}function f(b){s.push(0,0,0),r.push(0,0,0),o[b]===void 0&&(o[b]=[]),o[b].push(s.length/3-1)}t.setAttribute("position",new Pt(s,3)),t.setAttribute("color",new Pt(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const p=new St(16755200),m=new St(16711680),y=new St(43775),v=new St(16777215),x=new St(3355443);this.setColors(p,m,y,v,x)}setColors(e,t,n,s,r){const c=this.geometry.getAttribute("color");return c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,s.r,s.g,s.b),c.setXYZ(39,s.r,s.g,s.b),c.setXYZ(40,r.r,r.g,r.b),c.setXYZ(41,r.r,r.g,r.b),c.setXYZ(42,r.r,r.g,r.b),c.setXYZ(43,r.r,r.g,r.b),c.setXYZ(44,r.r,r.g,r.b),c.setXYZ(45,r.r,r.g,r.b),c.setXYZ(46,r.r,r.g,r.b),c.setXYZ(47,r.r,r.g,r.b),c.setXYZ(48,r.r,r.g,r.b),c.setXYZ(49,r.r,r.g,r.b),c.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;let r,o;if(ls.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)r=1,o=0;else if(this.camera.coordinateSystem===lo)r=-1,o=1;else if(this.camera.coordinateSystem===ag)r=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);gs("c",t,e,ls,0,0,r),gs("t",t,e,ls,0,0,o),gs("n1",t,e,ls,-n,-s,r),gs("n2",t,e,ls,n,-s,r),gs("n3",t,e,ls,-n,s,r),gs("n4",t,e,ls,n,s,r),gs("f1",t,e,ls,-n,-s,o),gs("f2",t,e,ls,n,-s,o),gs("f3",t,e,ls,-n,s,o),gs("f4",t,e,ls,n,s,o),gs("u1",t,e,ls,n*.7,s*1.1,r),gs("u2",t,e,ls,-n*.7,s*1.1,r),gs("u3",t,e,ls,0,s*2,r),gs("cf1",t,e,ls,-n,0,o),gs("cf2",t,e,ls,n,0,o),gs("cf3",t,e,ls,0,-s,o),gs("cf4",t,e,ls,0,s,o),gs("cn1",t,e,ls,-n,0,r),gs("cn2",t,e,ls,n,0,r),gs("cn3",t,e,ls,0,-s,r),gs("cn4",t,e,ls,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function gs(i,e,t,n,s,r,o){gA.set(s,r,o).unproject(n);const c=e[i];if(c!==void 0){const f=t.getAttribute("position");for(let p=0,m=c.length;p<m;p++)f.setXYZ(c[p],gA.x,gA.y,gA.z)}}const yA=new $s;class v7 extends Rl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),r=new yn;r.setIndex(new Zn(n,1)),r.setAttribute("position",new Zn(s,3)),super(r,new Pr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&yA.setFromObject(this.object),yA.isEmpty())return;const e=yA.min,t=yA.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class A7 extends Rl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new yn;r.setIndex(new Zn(n,1)),r.setAttribute("position",new Pt(s,3)),super(r,new Pr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class x7 extends Vu{constructor(e,t=1,n=16776960){const s=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new yn;o.setAttribute("position",new Pt(r,3)),o.computeBoundingSphere(),super(o,new Pr({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new yn;f.setAttribute("position",new Pt(c,3)),f.computeBoundingSphere(),this.add(new vs(f,new co({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const wD=new $;let _A,iT;class S7 extends jn{constructor(e=new $(0,0,1),t=new $(0,0,0),n=1,s=16776960,r=n*.2,o=r*.2){super(),this.type="ArrowHelper",_A===void 0&&(_A=new yn,_A.setAttribute("position",new Pt([0,0,0,0,1,0],3)),iT=new sv(.5,1,5,1),iT.translate(0,-.5,0)),this.position.copy(t),this.line=new Vu(_A,new Pr({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new vs(iT,new co({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{wD.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(wD,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class E7 extends Rl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new yn;s.setAttribute("position",new Pt(t,3)),s.setAttribute("color",new Pt(n,3));const r=new Pr({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,t,n){const s=new St,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(t),s.toArray(r,6),s.toArray(r,9),s.set(n),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class b7{constructor(){this.type="ShapePath",this.color=new St,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new eS,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,r,o){return this.currentPath.bezierCurveTo(e,t,n,s,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(T){const D=[];for(let B=0,L=T.length;B<L;B++){const G=T[B],H=new jd;H.curves=G.curves,D.push(H)}return D}function n(T,D){const B=D.length;let L=!1;for(let G=B-1,H=0;H<B;G=H++){let F=D[G],U=D[H],I=U.x-F.x,N=U.y-F.y;if(Math.abs(N)>Number.EPSILON){if(N<0&&(F=D[H],I=-I,U=D[G],N=-N),T.y<F.y||T.y>U.y)continue;if(T.y===F.y){if(T.x===F.x)return!0}else{const z=N*(T.x-F.x)-I*(T.y-F.y);if(z===0)return!0;if(z<0)continue;L=!L}}else{if(T.y!==F.y)continue;if(U.x<=T.x&&T.x<=F.x||F.x<=T.x&&T.x<=U.x)return!0}}return L}const s=El.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,c,f;const p=[];if(r.length===1)return c=r[0],f=new jd,f.curves=c.curves,p.push(f),p;let m=!s(r[0].getPoints());m=e?!m:m;const y=[],v=[];let x=[],b=0,R;v[b]=void 0,x[b]=[];for(let T=0,D=r.length;T<D;T++)c=r[T],R=c.getPoints(),o=s(R),o=e?!o:o,o?(!m&&v[b]&&b++,v[b]={s:new jd,p:R},v[b].s.curves=c.curves,m&&b++,x[b]=[]):x[b].push({h:c,p:R[0]});if(!v[0])return t(r);if(v.length>1){let T=!1,D=0;for(let B=0,L=v.length;B<L;B++)y[B]=[];for(let B=0,L=v.length;B<L;B++){const G=x[B];for(let H=0;H<G.length;H++){const F=G[H];let U=!0;for(let I=0;I<v.length;I++)n(F.p,v[I].p)&&(B!==I&&D++,U?(U=!1,y[I].push(F)):T=!0);U&&y[B].push(F)}}D>0&&T===!1&&(x=y)}let M;for(let T=0,D=v.length;T<D;T++){f=v[T].s,p.push(f),M=x[T];for(let B=0,L=M.length;B<L;B++)f.holes.push(M[B].h)}return p}}class T7 extends Oc{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function M7(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function C7(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function R7(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function bM(i,e,t,n){const s=w7(n);switch(t){case W1:return i*e;case kS:return i*e/s.components*s.byteLength;case $_:return i*e/s.components*s.byteLength;case K1:return i*e*2/s.components*s.byteLength;case GS:return i*e*2/s.components*s.byteLength;case Y1:return i*e*3/s.components*s.byteLength;case Lr:return i*e*4/s.components*s.byteLength;case jS:return i*e*4/s.components*s.byteLength;case o_:case l_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case c_:case u_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Tx:case Cx:return Math.max(i,16)*Math.max(e,8)/4;case bx:case Mx:return Math.max(i,8)*Math.max(e,8)/2;case Rx:case wx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Dx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Ix:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Bx:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Nx:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case Ox:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case Lx:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Ux:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Px:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Fx:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case zx:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Vx:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Hx:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case kx:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Gx:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case jx:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case h_:case qx:case Xx:return Math.ceil(i/4)*Math.ceil(e/4)*16;case J1:case Wx:return Math.ceil(i/4)*Math.ceil(e/4)*8;case Yx:case Kx:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function w7(i){switch(i){case ko:case j1:return{byteLength:1,components:1};case eg:case q1:case Eg:return{byteLength:2,components:1};case VS:case HS:return{byteLength:2,components:4};case zu:case zS:case za:return{byteLength:4,components:1};case X1:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class D7{static contain(e,t){return M7(e,t)}static cover(e,t){return C7(e,t)}static fill(e){return R7(e)}static getByteLength(e,t,n,s){return bM(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Q_}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Q_);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function mU(){let i=null,e=!1,t=null,n=null;function s(r,o){t(r,o),n=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){i=r}}}function I7(i){const e=new WeakMap;function t(c,f){const p=c.array,m=c.usage,y=p.byteLength,v=i.createBuffer();i.bindBuffer(f,v),i.bufferData(f,p,m),c.onUploadCallback();let x;if(p instanceof Float32Array)x=i.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)x=i.HALF_FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?x=i.HALF_FLOAT:x=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)x=i.SHORT;else if(p instanceof Uint32Array)x=i.UNSIGNED_INT;else if(p instanceof Int32Array)x=i.INT;else if(p instanceof Int8Array)x=i.BYTE;else if(p instanceof Uint8Array)x=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)x=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:v,type:x,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:y}}function n(c,f,p){const m=f.array,y=f.updateRanges;if(i.bindBuffer(p,c),y.length===0)i.bufferSubData(p,0,m);else{y.sort((x,b)=>x.start-b.start);let v=0;for(let x=1;x<y.length;x++){const b=y[v],R=y[x];R.start<=b.start+b.count+1?b.count=Math.max(b.count,R.start+R.count-b.start):(++v,y[v]=R)}y.length=v+1;for(let x=0,b=y.length;x<b;x++){const R=y[x];i.bufferSubData(p,R.start*m.BYTES_PER_ELEMENT,m,R.start,R.count)}f.clearUpdateRanges()}f.onUploadCallback()}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function r(c){c.isInterleavedBufferAttribute&&(c=c.data);const f=e.get(c);f&&(i.deleteBuffer(f.buffer),e.delete(c))}function o(c,f){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const m=e.get(c);(!m||m.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const p=e.get(c);if(p===void 0)e.set(c,t(c,f));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,c,f),p.version=c.version}}return{get:s,remove:r,update:o}}var B7=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,N7=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,O7=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,L7=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,U7=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,P7=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,F7=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,z7=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,V7=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,H7=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,k7=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,G7=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,j7=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,q7=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,X7=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,W7=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Y7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,K7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,J7=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Q7=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Z7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,$7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,ej=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,tj=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,nj=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,ij=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,sj=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,rj=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,aj=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,oj=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,lj="gl_FragColor = linearToOutputTexel( gl_FragColor );",cj=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,uj=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,hj=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,fj=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,dj=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,pj=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,mj=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,gj=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,yj=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_j=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,vj=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Aj=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,xj=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Sj=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Ej=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,bj=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Tj=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Mj=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Cj=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Rj=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,wj=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Dj=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ij=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Bj=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Nj=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Oj=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Lj=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Uj=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Pj=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Fj=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,zj=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Vj=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Hj=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,kj=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Gj=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,jj=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,qj=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Xj=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Wj=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Yj=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Kj=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Jj=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Qj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Zj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$j=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,eq=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,tq=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,nq=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,iq=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,sq=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,rq=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,aq=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,oq=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,lq=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,cq=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,uq=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,hq=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fq=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,dq=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSEDEPTHBUF
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSEDEPTHBUF
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare , distribution.x );
		#endif
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,pq=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,mq=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,gq=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,yq=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_q=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,vq=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Aq=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,xq=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Sq=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Eq=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,bq=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Tq=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Mq=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Cq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Rq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,wq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Dq=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Iq=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Bq=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Nq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Oq=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Lq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Uq=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Pq=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Fq=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSEDEPTHBUF
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,zq=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Vq=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Hq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,kq=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Gq=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,jq=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,qq=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Xq=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wq=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yq=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kq=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Jq=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qq=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Zq=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,$q=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,eX=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tX=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,nX=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iX=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sX=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rX=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,aX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,oX=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lX=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,cX=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,uX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Tn={alphahash_fragment:B7,alphahash_pars_fragment:N7,alphamap_fragment:O7,alphamap_pars_fragment:L7,alphatest_fragment:U7,alphatest_pars_fragment:P7,aomap_fragment:F7,aomap_pars_fragment:z7,batching_pars_vertex:V7,batching_vertex:H7,begin_vertex:k7,beginnormal_vertex:G7,bsdfs:j7,iridescence_fragment:q7,bumpmap_pars_fragment:X7,clipping_planes_fragment:W7,clipping_planes_pars_fragment:Y7,clipping_planes_pars_vertex:K7,clipping_planes_vertex:J7,color_fragment:Q7,color_pars_fragment:Z7,color_pars_vertex:$7,color_vertex:ej,common:tj,cube_uv_reflection_fragment:nj,defaultnormal_vertex:ij,displacementmap_pars_vertex:sj,displacementmap_vertex:rj,emissivemap_fragment:aj,emissivemap_pars_fragment:oj,colorspace_fragment:lj,colorspace_pars_fragment:cj,envmap_fragment:uj,envmap_common_pars_fragment:hj,envmap_pars_fragment:fj,envmap_pars_vertex:dj,envmap_physical_pars_fragment:bj,envmap_vertex:pj,fog_vertex:mj,fog_pars_vertex:gj,fog_fragment:yj,fog_pars_fragment:_j,gradientmap_pars_fragment:vj,lightmap_pars_fragment:Aj,lights_lambert_fragment:xj,lights_lambert_pars_fragment:Sj,lights_pars_begin:Ej,lights_toon_fragment:Tj,lights_toon_pars_fragment:Mj,lights_phong_fragment:Cj,lights_phong_pars_fragment:Rj,lights_physical_fragment:wj,lights_physical_pars_fragment:Dj,lights_fragment_begin:Ij,lights_fragment_maps:Bj,lights_fragment_end:Nj,logdepthbuf_fragment:Oj,logdepthbuf_pars_fragment:Lj,logdepthbuf_pars_vertex:Uj,logdepthbuf_vertex:Pj,map_fragment:Fj,map_pars_fragment:zj,map_particle_fragment:Vj,map_particle_pars_fragment:Hj,metalnessmap_fragment:kj,metalnessmap_pars_fragment:Gj,morphinstance_vertex:jj,morphcolor_vertex:qj,morphnormal_vertex:Xj,morphtarget_pars_vertex:Wj,morphtarget_vertex:Yj,normal_fragment_begin:Kj,normal_fragment_maps:Jj,normal_pars_fragment:Qj,normal_pars_vertex:Zj,normal_vertex:$j,normalmap_pars_fragment:eq,clearcoat_normal_fragment_begin:tq,clearcoat_normal_fragment_maps:nq,clearcoat_pars_fragment:iq,iridescence_pars_fragment:sq,opaque_fragment:rq,packing:aq,premultiplied_alpha_fragment:oq,project_vertex:lq,dithering_fragment:cq,dithering_pars_fragment:uq,roughnessmap_fragment:hq,roughnessmap_pars_fragment:fq,shadowmap_pars_fragment:dq,shadowmap_pars_vertex:pq,shadowmap_vertex:mq,shadowmask_pars_fragment:gq,skinbase_vertex:yq,skinning_pars_vertex:_q,skinning_vertex:vq,skinnormal_vertex:Aq,specularmap_fragment:xq,specularmap_pars_fragment:Sq,tonemapping_fragment:Eq,tonemapping_pars_fragment:bq,transmission_fragment:Tq,transmission_pars_fragment:Mq,uv_pars_fragment:Cq,uv_pars_vertex:Rq,uv_vertex:wq,worldpos_vertex:Dq,background_vert:Iq,background_frag:Bq,backgroundCube_vert:Nq,backgroundCube_frag:Oq,cube_vert:Lq,cube_frag:Uq,depth_vert:Pq,depth_frag:Fq,distanceRGBA_vert:zq,distanceRGBA_frag:Vq,equirect_vert:Hq,equirect_frag:kq,linedashed_vert:Gq,linedashed_frag:jq,meshbasic_vert:qq,meshbasic_frag:Xq,meshlambert_vert:Wq,meshlambert_frag:Yq,meshmatcap_vert:Kq,meshmatcap_frag:Jq,meshnormal_vert:Qq,meshnormal_frag:Zq,meshphong_vert:$q,meshphong_frag:eX,meshphysical_vert:tX,meshphysical_frag:nX,meshtoon_vert:iX,meshtoon_frag:sX,points_vert:rX,points_frag:aX,shadow_vert:oX,shadow_frag:lX,sprite_vert:cX,sprite_frag:uX},Tt={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new An},alphaMap:{value:null},alphaMapTransform:{value:new An},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new An}},envmap:{envMap:{value:null},envMapRotation:{value:new An},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new An}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new An}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new An},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new An},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new An},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new An}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new An}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new An}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new An},alphaTest:{value:0},uvTransform:{value:new An}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new An},alphaMap:{value:null},alphaMapTransform:{value:new An},alphaTest:{value:0}}},xl={basic:{uniforms:ra([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.fog]),vertexShader:Tn.meshbasic_vert,fragmentShader:Tn.meshbasic_frag},lambert:{uniforms:ra([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,Tt.lights,{emissive:{value:new St(0)}}]),vertexShader:Tn.meshlambert_vert,fragmentShader:Tn.meshlambert_frag},phong:{uniforms:ra([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,Tt.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:Tn.meshphong_vert,fragmentShader:Tn.meshphong_frag},standard:{uniforms:ra([Tt.common,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.roughnessmap,Tt.metalnessmap,Tt.fog,Tt.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Tn.meshphysical_vert,fragmentShader:Tn.meshphysical_frag},toon:{uniforms:ra([Tt.common,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.gradientmap,Tt.fog,Tt.lights,{emissive:{value:new St(0)}}]),vertexShader:Tn.meshtoon_vert,fragmentShader:Tn.meshtoon_frag},matcap:{uniforms:ra([Tt.common,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,{matcap:{value:null}}]),vertexShader:Tn.meshmatcap_vert,fragmentShader:Tn.meshmatcap_frag},points:{uniforms:ra([Tt.points,Tt.fog]),vertexShader:Tn.points_vert,fragmentShader:Tn.points_frag},dashed:{uniforms:ra([Tt.common,Tt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tn.linedashed_vert,fragmentShader:Tn.linedashed_frag},depth:{uniforms:ra([Tt.common,Tt.displacementmap]),vertexShader:Tn.depth_vert,fragmentShader:Tn.depth_frag},normal:{uniforms:ra([Tt.common,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,{opacity:{value:1}}]),vertexShader:Tn.meshnormal_vert,fragmentShader:Tn.meshnormal_frag},sprite:{uniforms:ra([Tt.sprite,Tt.fog]),vertexShader:Tn.sprite_vert,fragmentShader:Tn.sprite_frag},background:{uniforms:{uvTransform:{value:new An},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Tn.background_vert,fragmentShader:Tn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new An}},vertexShader:Tn.backgroundCube_vert,fragmentShader:Tn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Tn.cube_vert,fragmentShader:Tn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tn.equirect_vert,fragmentShader:Tn.equirect_frag},distanceRGBA:{uniforms:ra([Tt.common,Tt.displacementmap,{referencePosition:{value:new $},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tn.distanceRGBA_vert,fragmentShader:Tn.distanceRGBA_frag},shadow:{uniforms:ra([Tt.lights,Tt.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:Tn.shadow_vert,fragmentShader:Tn.shadow_frag}};xl.physical={uniforms:ra([xl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new An},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new An},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new An},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new An},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new An},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new An},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new An},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new An},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new An},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new An},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new An},anisotropyVector:{value:new Xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new An}}]),vertexShader:Tn.meshphysical_vert,fragmentShader:Tn.meshphysical_frag};const vA={r:0,b:0,g:0},Ad=new ho,hX=new Jt;function fX(i,e,t,n,s,r,o){const c=new St(0);let f=r===!0?0:1,p,m,y=null,v=0,x=null;function b(B){let L=B.isScene===!0?B.background:null;return L&&L.isTexture&&(L=(B.backgroundBlurriness>0?t:e).get(L)),L}function R(B){let L=!1;const G=b(B);G===null?T(c,f):G&&G.isColor&&(T(G,1),L=!0);const H=i.xr.getEnvironmentBlendMode();H==="additive"?n.buffers.color.setClear(0,0,0,1,o):H==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||L)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function M(B,L){const G=b(L);G&&(G.isCubeTexture||G.mapping===Sg)?(m===void 0&&(m=new vs(new lp(1,1,1),new Cl({name:"BackgroundCubeMaterial",uniforms:cg(xl.backgroundCube.uniforms),vertexShader:xl.backgroundCube.vertexShader,fragmentShader:xl.backgroundCube.fragmentShader,side:ua,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(H,F,U){this.matrixWorld.copyPosition(U.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(m)),Ad.copy(L.backgroundRotation),Ad.x*=-1,Ad.y*=-1,Ad.z*=-1,G.isCubeTexture&&G.isRenderTargetTexture===!1&&(Ad.y*=-1,Ad.z*=-1),m.material.uniforms.envMap.value=G,m.material.uniforms.flipEnvMap.value=G.isCubeTexture&&G.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(hX.makeRotationFromEuler(Ad)),m.material.toneMapped=Gn.getTransfer(G.colorSpace)!==pi,(y!==G||v!==G.version||x!==i.toneMapping)&&(m.material.needsUpdate=!0,y=G,v=G.version,x=i.toneMapping),m.layers.enableAll(),B.unshift(m,m.geometry,m.material,0,0,null)):G&&G.isTexture&&(p===void 0&&(p=new vs(new Tg(2,2),new Cl({name:"BackgroundMaterial",uniforms:cg(xl.background.uniforms),vertexShader:xl.background.vertexShader,fragmentShader:xl.background.fragmentShader,side:Ic,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(p)),p.material.uniforms.t2D.value=G,p.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,p.material.toneMapped=Gn.getTransfer(G.colorSpace)!==pi,G.matrixAutoUpdate===!0&&G.updateMatrix(),p.material.uniforms.uvTransform.value.copy(G.matrix),(y!==G||v!==G.version||x!==i.toneMapping)&&(p.material.needsUpdate=!0,y=G,v=G.version,x=i.toneMapping),p.layers.enableAll(),B.unshift(p,p.geometry,p.material,0,0,null))}function T(B,L){B.getRGB(vA,AL(i)),n.buffers.color.setClear(vA.r,vA.g,vA.b,L,o)}function D(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return c},setClearColor:function(B,L=1){c.set(B),f=L,T(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(B){f=B,T(c,f)},render:R,addToRenderList:M,dispose:D}}function dX(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},s=v(null);let r=s,o=!1;function c(N,z,W,k,he){let me=!1;const q=y(k,W,z);r!==q&&(r=q,p(r.object)),me=x(N,k,W,he),me&&b(N,k,W,he),he!==null&&e.update(he,i.ELEMENT_ARRAY_BUFFER),(me||o)&&(o=!1,L(N,z,W,k),he!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(he).buffer))}function f(){return i.createVertexArray()}function p(N){return i.bindVertexArray(N)}function m(N){return i.deleteVertexArray(N)}function y(N,z,W){const k=W.wireframe===!0;let he=n[N.id];he===void 0&&(he={},n[N.id]=he);let me=he[z.id];me===void 0&&(me={},he[z.id]=me);let q=me[k];return q===void 0&&(q=v(f()),me[k]=q),q}function v(N){const z=[],W=[],k=[];for(let he=0;he<t;he++)z[he]=0,W[he]=0,k[he]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:W,attributeDivisors:k,object:N,attributes:{},index:null}}function x(N,z,W,k){const he=r.attributes,me=z.attributes;let q=0;const ee=W.getAttributes();for(const ne in ee)if(ee[ne].location>=0){const K=he[ne];let ce=me[ne];if(ce===void 0&&(ne==="instanceMatrix"&&N.instanceMatrix&&(ce=N.instanceMatrix),ne==="instanceColor"&&N.instanceColor&&(ce=N.instanceColor)),K===void 0||K.attribute!==ce||ce&&K.data!==ce.data)return!0;q++}return r.attributesNum!==q||r.index!==k}function b(N,z,W,k){const he={},me=z.attributes;let q=0;const ee=W.getAttributes();for(const ne in ee)if(ee[ne].location>=0){let K=me[ne];K===void 0&&(ne==="instanceMatrix"&&N.instanceMatrix&&(K=N.instanceMatrix),ne==="instanceColor"&&N.instanceColor&&(K=N.instanceColor));const ce={};ce.attribute=K,K&&K.data&&(ce.data=K.data),he[ne]=ce,q++}r.attributes=he,r.attributesNum=q,r.index=k}function R(){const N=r.newAttributes;for(let z=0,W=N.length;z<W;z++)N[z]=0}function M(N){T(N,0)}function T(N,z){const W=r.newAttributes,k=r.enabledAttributes,he=r.attributeDivisors;W[N]=1,k[N]===0&&(i.enableVertexAttribArray(N),k[N]=1),he[N]!==z&&(i.vertexAttribDivisor(N,z),he[N]=z)}function D(){const N=r.newAttributes,z=r.enabledAttributes;for(let W=0,k=z.length;W<k;W++)z[W]!==N[W]&&(i.disableVertexAttribArray(W),z[W]=0)}function B(N,z,W,k,he,me,q){q===!0?i.vertexAttribIPointer(N,z,W,he,me):i.vertexAttribPointer(N,z,W,k,he,me)}function L(N,z,W,k){R();const he=k.attributes,me=W.getAttributes(),q=z.defaultAttributeValues;for(const ee in me){const ne=me[ee];if(ne.location>=0){let ye=he[ee];if(ye===void 0&&(ee==="instanceMatrix"&&N.instanceMatrix&&(ye=N.instanceMatrix),ee==="instanceColor"&&N.instanceColor&&(ye=N.instanceColor)),ye!==void 0){const K=ye.normalized,ce=ye.itemSize,Ee=e.get(ye);if(Ee===void 0)continue;const Me=Ee.buffer,Ve=Ee.type,ge=Ee.bytesPerElement,ze=Ve===i.INT||Ve===i.UNSIGNED_INT||ye.gpuType===zS;if(ye.isInterleavedBufferAttribute){const Je=ye.data,lt=Je.stride,At=ye.offset;if(Je.isInstancedInterleavedBuffer){for(let Et=0;Et<ne.locationSize;Et++)T(ne.location+Et,Je.meshPerAttribute);N.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=Je.meshPerAttribute*Je.count)}else for(let Et=0;Et<ne.locationSize;Et++)M(ne.location+Et);i.bindBuffer(i.ARRAY_BUFFER,Me);for(let Et=0;Et<ne.locationSize;Et++)B(ne.location+Et,ce/ne.locationSize,Ve,K,lt*ge,(At+ce/ne.locationSize*Et)*ge,ze)}else{if(ye.isInstancedBufferAttribute){for(let Je=0;Je<ne.locationSize;Je++)T(ne.location+Je,ye.meshPerAttribute);N.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=ye.meshPerAttribute*ye.count)}else for(let Je=0;Je<ne.locationSize;Je++)M(ne.location+Je);i.bindBuffer(i.ARRAY_BUFFER,Me);for(let Je=0;Je<ne.locationSize;Je++)B(ne.location+Je,ce/ne.locationSize,Ve,K,ce*ge,ce/ne.locationSize*Je*ge,ze)}}else if(q!==void 0){const K=q[ee];if(K!==void 0)switch(K.length){case 2:i.vertexAttrib2fv(ne.location,K);break;case 3:i.vertexAttrib3fv(ne.location,K);break;case 4:i.vertexAttrib4fv(ne.location,K);break;default:i.vertexAttrib1fv(ne.location,K)}}}}D()}function G(){U();for(const N in n){const z=n[N];for(const W in z){const k=z[W];for(const he in k)m(k[he].object),delete k[he];delete z[W]}delete n[N]}}function H(N){if(n[N.id]===void 0)return;const z=n[N.id];for(const W in z){const k=z[W];for(const he in k)m(k[he].object),delete k[he];delete z[W]}delete n[N.id]}function F(N){for(const z in n){const W=n[z];if(W[N.id]===void 0)continue;const k=W[N.id];for(const he in k)m(k[he].object),delete k[he];delete W[N.id]}}function U(){I(),o=!0,r!==s&&(r=s,p(r.object))}function I(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:c,reset:U,resetDefaultState:I,dispose:G,releaseStatesOfGeometry:H,releaseStatesOfProgram:F,initAttributes:R,enableAttribute:M,disableUnusedAttributes:D}}function pX(i,e,t){let n;function s(p){n=p}function r(p,m){i.drawArrays(n,p,m),t.update(m,n,1)}function o(p,m,y){y!==0&&(i.drawArraysInstanced(n,p,m,y),t.update(m,n,y))}function c(p,m,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,m,0,y);let x=0;for(let b=0;b<y;b++)x+=m[b];t.update(x,n,1)}function f(p,m,y,v){if(y===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let b=0;b<p.length;b++)o(p[b],m[b],v[b]);else{x.multiDrawArraysInstancedWEBGL(n,p,0,m,0,v,0,y);let b=0;for(let R=0;R<y;R++)b+=m[R]*v[R];t.update(b,n,1)}}this.setMode=s,this.render=r,this.renderInstances=o,this.renderMultiDraw=c,this.renderMultiDrawInstances=f}function mX(i,e,t,n){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const F=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(F){return!(F!==Lr&&n.convert(F)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(F){const U=F===Eg&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(F!==ko&&n.convert(F)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&F!==za&&!U)}function f(F){if(F==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";F="mediump"}return F==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const m=f(p);m!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",m,"instead."),p=m);const y=t.logarithmicDepthBuffer===!0,v=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),x=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),b=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=i.getParameter(i.MAX_TEXTURE_SIZE),M=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),T=i.getParameter(i.MAX_VERTEX_ATTRIBS),D=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),B=i.getParameter(i.MAX_VARYING_VECTORS),L=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),G=b>0,H=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:f,textureFormatReadable:o,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:y,reversedDepthBuffer:v,maxTextures:x,maxVertexTextures:b,maxTextureSize:R,maxCubemapSize:M,maxAttributes:T,maxVertexUniforms:D,maxVaryings:B,maxFragmentUniforms:L,vertexTextures:G,maxSamples:H}}function gX(i){const e=this;let t=null,n=0,s=!1,r=!1;const o=new Au,c=new An,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(y,v){const x=y.length!==0||v||n!==0||s;return s=v,n=y.length,x},this.beginShadows=function(){r=!0,m(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(y,v){t=m(y,v,0)},this.setState=function(y,v,x){const b=y.clippingPlanes,R=y.clipIntersection,M=y.clipShadows,T=i.get(y);if(!s||b===null||b.length===0||r&&!M)r?m(null):p();else{const D=r?0:n,B=D*4;let L=T.clippingState||null;f.value=L,L=m(b,v,B,x);for(let G=0;G!==B;++G)L[G]=t[G];T.clippingState=L,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=D}};function p(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(y,v,x,b){const R=y!==null?y.length:0;let M=null;if(R!==0){if(M=f.value,b!==!0||M===null){const T=x+R*4,D=v.matrixWorldInverse;c.getNormalMatrix(D),(M===null||M.length<T)&&(M=new Float32Array(T));for(let B=0,L=x;B!==R;++B,L+=4)o.copy(y[B]).applyMatrix4(D,c),o.normal.toArray(M,L),M[L+3]=o.constant}f.value=M,f.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,M}}function yX(i){let e=new WeakMap;function t(o,c){return c===M_?o.mapping=Fu:c===C_&&(o.mapping=uf),o}function n(o){if(o&&o.isTexture){const c=o.mapping;if(c===M_||c===C_)if(e.has(o)){const f=e.get(o).texture;return t(f,o.mapping)}else{const f=o.image;if(f&&f.height>0){const p=new EL(f.height);return p.fromEquirectangularTexture(i,o),e.set(o,p),o.addEventListener("dispose",s),t(p.texture,o.mapping)}else return null}}return o}function s(o){const c=o.target;c.removeEventListener("dispose",s);const f=e.get(c);f!==void 0&&(e.delete(c),f.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const Lm=4,DD=[.125,.215,.35,.446,.526,.582],Rd=20,sT=new Tl,ID=new St;let rT=null,aT=0,oT=0,lT=!1;const Cd=(1+Math.sqrt(5))/2,Mm=1/Cd,BD=[new $(-Cd,Mm,0),new $(Cd,Mm,0),new $(-Mm,0,Cd),new $(Mm,0,Cd),new $(0,Cd,-Mm),new $(0,Cd,Mm),new $(-1,1,-1),new $(1,1,-1),new $(-1,1,1),new $(1,1,1)],_X=new $;class TM{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100,r={}){const{size:o=256,position:c=_X}=r;rT=this._renderer.getRenderTarget(),aT=this._renderer.getActiveCubeFace(),oT=this._renderer.getActiveMipmapLevel(),lT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(e,n,s,f,c),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=LD(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=OD(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(rT,aT,oT),this._renderer.xr.enabled=lT,e.scissorTest=!1,AA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Fu||e.mapping===uf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),rT=this._renderer.getRenderTarget(),aT=this._renderer.getActiveCubeFace(),oT=this._renderer.getActiveMipmapLevel(),lT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:_s,minFilter:_s,generateMipmaps:!1,type:Eg,format:Lr,colorSpace:ff,depthBuffer:!1},s=ND(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=ND(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=vX(r)),this._blurMaterial=AX(r,e,t)}return s}_compileMaterial(e){const t=new vs(this._lodPlanes[0],e);this._renderer.compile(t,sT)}_sceneToCubeUV(e,t,n,s,r){const f=new Hi(90,1,t,n),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,v=y.autoClear,x=y.toneMapping;y.getClearColor(ID),y.toneMapping=Cc,y.autoClear=!1,y.state.buffers.depth.getReversed()&&(y.setRenderTarget(s),y.clearDepth(),y.setRenderTarget(null));const R=new co({name:"PMREM.Background",side:ua,depthWrite:!1,depthTest:!1}),M=new vs(new lp,R);let T=!1;const D=e.background;D?D.isColor&&(R.color.copy(D),e.background=null,T=!0):(R.color.copy(ID),T=!0);for(let B=0;B<6;B++){const L=B%3;L===0?(f.up.set(0,p[B],0),f.position.set(r.x,r.y,r.z),f.lookAt(r.x+m[B],r.y,r.z)):L===1?(f.up.set(0,0,p[B]),f.position.set(r.x,r.y,r.z),f.lookAt(r.x,r.y+m[B],r.z)):(f.up.set(0,p[B],0),f.position.set(r.x,r.y,r.z),f.lookAt(r.x,r.y,r.z+m[B]));const G=this._cubeSize;AA(s,L*G,B>2?G:0,G,G),y.setRenderTarget(s),T&&y.render(M,f),y.render(e,f)}M.geometry.dispose(),M.material.dispose(),y.toneMapping=x,y.autoClear=v,e.background=D}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===Fu||e.mapping===uf;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=LD()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=OD());const r=s?this._cubemapMaterial:this._equirectMaterial,o=new vs(this._lodPlanes[0],r),c=r.uniforms;c.envMap.value=e;const f=this._cubeSize;AA(t,0,0,3*f,2*f),n.setRenderTarget(t),n.render(o,sT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let r=1;r<s;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),c=BD[(s-r-1)%BD.length];this._blur(e,r-1,r,o,c)}t.autoClear=n}_blur(e,t,n,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,s,"latitudinal",r),this._halfBlur(o,e,n,n,s,"longitudinal",r)}_halfBlur(e,t,n,s,r,o,c){const f=this._renderer,p=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,y=new vs(this._lodPlanes[s],p),v=p.uniforms,x=this._sizeLods[n]-1,b=isFinite(r)?Math.PI/(2*x):2*Math.PI/(2*Rd-1),R=r/b,M=isFinite(r)?1+Math.floor(m*R):Rd;M>Rd&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${Rd}`);const T=[];let D=0;for(let F=0;F<Rd;++F){const U=F/R,I=Math.exp(-U*U/2);T.push(I),F===0?D+=I:F<M&&(D+=2*I)}for(let F=0;F<T.length;F++)T[F]=T[F]/D;v.envMap.value=e.texture,v.samples.value=M,v.weights.value=T,v.latitudinal.value=o==="latitudinal",c&&(v.poleAxis.value=c);const{_lodMax:B}=this;v.dTheta.value=b,v.mipInt.value=B-n;const L=this._sizeLods[s],G=3*L*(s>B-Lm?s-B+Lm:0),H=4*(this._cubeSize-L);AA(t,G,H,3*L,2*L),f.setRenderTarget(t),f.render(y,sT)}}function vX(i){const e=[],t=[],n=[];let s=i;const r=i-Lm+1+DD.length;for(let o=0;o<r;o++){const c=Math.pow(2,s);t.push(c);let f=1/c;o>i-Lm?f=DD[o-i+Lm-1]:o===0&&(f=0),n.push(f);const p=1/(c-2),m=-p,y=1+p,v=[m,m,y,m,y,y,m,m,y,y,m,y],x=6,b=6,R=3,M=2,T=1,D=new Float32Array(R*b*x),B=new Float32Array(M*b*x),L=new Float32Array(T*b*x);for(let H=0;H<x;H++){const F=H%3*2/3-1,U=H>2?0:-1,I=[F,U,0,F+2/3,U,0,F+2/3,U+1,0,F,U,0,F+2/3,U+1,0,F,U+1,0];D.set(I,R*b*H),B.set(v,M*b*H);const N=[H,H,H,H,H,H];L.set(N,T*b*H)}const G=new yn;G.setAttribute("position",new Zn(D,R)),G.setAttribute("uv",new Zn(B,M)),G.setAttribute("faceIndex",new Zn(L,T)),e.push(G),s>Lm&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function ND(i,e,t){const n=new Bc(i,e,t);return n.texture.mapping=Sg,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function AA(i,e,t,n,s){i.viewport.set(e,t,n,s),i.scissor.set(e,t,n,s)}function AX(i,e,t){const n=new Float32Array(Rd),s=new $(0,1,0);return new Cl({name:"SphericalGaussianBlur",defines:{n:Rd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:NC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:wu,depthTest:!1,depthWrite:!1})}function OD(){return new Cl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:NC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:wu,depthTest:!1,depthWrite:!1})}function LD(){return new Cl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:NC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:wu,depthTest:!1,depthWrite:!1})}function NC(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function xX(i){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const f=c.mapping,p=f===M_||f===C_,m=f===Fu||f===uf;if(p||m){let y=e.get(c);const v=y!==void 0?y.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==v)return t===null&&(t=new TM(i)),y=p?t.fromEquirectangular(c,y):t.fromCubemap(c,y),y.texture.pmremVersion=c.pmremVersion,e.set(c,y),y.texture;if(y!==void 0)return y.texture;{const x=c.image;return p&&x&&x.height>0||m&&x&&s(x)?(t===null&&(t=new TM(i)),y=p?t.fromEquirectangular(c):t.fromCubemap(c),y.texture.pmremVersion=c.pmremVersion,e.set(c,y),c.addEventListener("dispose",r),y.texture):null}}}return c}function s(c){let f=0;const p=6;for(let m=0;m<p;m++)c[m]!==void 0&&f++;return f===p}function r(c){const f=c.target;f.removeEventListener("dispose",r);const p=e.get(f);p!==void 0&&(e.delete(f),p.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function SX(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(n)}return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&Hm("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function EX(i,e,t,n){const s={},r=new WeakMap;function o(y){const v=y.target;v.index!==null&&e.remove(v.index);for(const b in v.attributes)e.remove(v.attributes[b]);v.removeEventListener("dispose",o),delete s[v.id];const x=r.get(v);x&&(e.remove(x),r.delete(v)),n.releaseStatesOfGeometry(v),v.isInstancedBufferGeometry===!0&&delete v._maxInstanceCount,t.memory.geometries--}function c(y,v){return s[v.id]===!0||(v.addEventListener("dispose",o),s[v.id]=!0,t.memory.geometries++),v}function f(y){const v=y.attributes;for(const x in v)e.update(v[x],i.ARRAY_BUFFER)}function p(y){const v=[],x=y.index,b=y.attributes.position;let R=0;if(x!==null){const D=x.array;R=x.version;for(let B=0,L=D.length;B<L;B+=3){const G=D[B+0],H=D[B+1],F=D[B+2];v.push(G,H,H,F,F,G)}}else if(b!==void 0){const D=b.array;R=b.version;for(let B=0,L=D.length/3-1;B<L;B+=3){const G=B+0,H=B+1,F=B+2;v.push(G,H,H,F,F,G)}}else return;const M=new(gL(v)?iC:nC)(v,1);M.version=R;const T=r.get(y);T&&e.remove(T),r.set(y,M)}function m(y){const v=r.get(y);if(v){const x=y.index;x!==null&&v.version<x.version&&p(y)}else p(y);return r.get(y)}return{get:c,update:f,getWireframeAttribute:m}}function bX(i,e,t){let n;function s(v){n=v}let r,o;function c(v){r=v.type,o=v.bytesPerElement}function f(v,x){i.drawElements(n,x,r,v*o),t.update(x,n,1)}function p(v,x,b){b!==0&&(i.drawElementsInstanced(n,x,r,v*o,b),t.update(x,n,b))}function m(v,x,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,x,0,r,v,0,b);let M=0;for(let T=0;T<b;T++)M+=x[T];t.update(M,n,1)}function y(v,x,b,R){if(b===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let T=0;T<v.length;T++)p(v[T]/o,x[T],R[T]);else{M.multiDrawElementsInstancedWEBGL(n,x,0,r,v,0,R,0,b);let T=0;for(let D=0;D<b;D++)T+=x[D]*R[D];t.update(T,n,1)}}this.setMode=s,this.setIndex=c,this.render=f,this.renderInstances=p,this.renderMultiDraw=m,this.renderMultiDrawInstances=y}function TX(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,c){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=c*(r/3);break;case i.LINES:t.lines+=c*(r/2);break;case i.LINE_STRIP:t.lines+=c*(r-1);break;case i.LINE_LOOP:t.lines+=c*r;break;case i.POINTS:t.points+=c*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function MX(i,e,t){const n=new WeakMap,s=new Qn;function r(o,c,f){const p=o.morphTargetInfluences,m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,y=m!==void 0?m.length:0;let v=n.get(c);if(v===void 0||v.count!==y){let N=function(){U.dispose(),n.delete(c),c.removeEventListener("dispose",N)};var x=N;v!==void 0&&v.texture.dispose();const b=c.morphAttributes.position!==void 0,R=c.morphAttributes.normal!==void 0,M=c.morphAttributes.color!==void 0,T=c.morphAttributes.position||[],D=c.morphAttributes.normal||[],B=c.morphAttributes.color||[];let L=0;b===!0&&(L=1),R===!0&&(L=2),M===!0&&(L=3);let G=c.attributes.position.count*L,H=1;G>e.maxTextureSize&&(H=Math.ceil(G/e.maxTextureSize),G=e.maxTextureSize);const F=new Float32Array(G*H*4*y),U=new XS(F,G,H,y);U.type=za,U.needsUpdate=!0;const I=L*4;for(let z=0;z<y;z++){const W=T[z],k=D[z],he=B[z],me=G*H*4*z;for(let q=0;q<W.count;q++){const ee=q*I;b===!0&&(s.fromBufferAttribute(W,q),F[me+ee+0]=s.x,F[me+ee+1]=s.y,F[me+ee+2]=s.z,F[me+ee+3]=0),R===!0&&(s.fromBufferAttribute(k,q),F[me+ee+4]=s.x,F[me+ee+5]=s.y,F[me+ee+6]=s.z,F[me+ee+7]=0),M===!0&&(s.fromBufferAttribute(he,q),F[me+ee+8]=s.x,F[me+ee+9]=s.y,F[me+ee+10]=s.z,F[me+ee+11]=he.itemSize===4?s.w:1)}}v={count:y,texture:U,size:new Xe(G,H)},n.set(c,v),c.addEventListener("dispose",N)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)f.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let b=0;for(let M=0;M<p.length;M++)b+=p[M];const R=c.morphTargetsRelative?1:1-b;f.getUniforms().setValue(i,"morphTargetBaseInfluence",R),f.getUniforms().setValue(i,"morphTargetInfluences",p)}f.getUniforms().setValue(i,"morphTargetsTexture",v.texture,t),f.getUniforms().setValue(i,"morphTargetsTextureSize",v.size)}return{update:r}}function CX(i,e,t,n){let s=new WeakMap;function r(f){const p=n.render.frame,m=f.geometry,y=e.get(f,m);if(s.get(y)!==p&&(e.update(y),s.set(y,p)),f.isInstancedMesh&&(f.hasEventListener("dispose",c)===!1&&f.addEventListener("dispose",c),s.get(f)!==p&&(t.update(f.instanceMatrix,i.ARRAY_BUFFER),f.instanceColor!==null&&t.update(f.instanceColor,i.ARRAY_BUFFER),s.set(f,p))),f.isSkinnedMesh){const v=f.skeleton;s.get(v)!==p&&(v.update(),s.set(v,p))}return y}function o(){s=new WeakMap}function c(f){const p=f.target;p.removeEventListener("dispose",c),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:r,dispose:o}}const gU=new ki,UD=new uC(1,1),yU=new XS,_U=new WS,vU=new ev,PD=[],FD=[],zD=new Float32Array(16),VD=new Float32Array(9),HD=new Float32Array(4);function Cg(i,e,t){const n=i[0];if(n<=0||n>0)return i;const s=e*t;let r=PD[s];if(r===void 0&&(r=new Float32Array(s),PD[s]=r),e!==0){n.toArray(r,0);for(let o=1,c=0;o!==e;++o)c+=t,i[o].toArray(r,c)}return r}function Hs(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function ks(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function mE(i,e){let t=FD[e];t===void 0&&(t=new Int32Array(e),FD[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function RX(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function wX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hs(t,e))return;i.uniform2fv(this.addr,e),ks(t,e)}}function DX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Hs(t,e))return;i.uniform3fv(this.addr,e),ks(t,e)}}function IX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hs(t,e))return;i.uniform4fv(this.addr,e),ks(t,e)}}function BX(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Hs(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ks(t,e)}else{if(Hs(t,n))return;HD.set(n),i.uniformMatrix2fv(this.addr,!1,HD),ks(t,n)}}function NX(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Hs(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ks(t,e)}else{if(Hs(t,n))return;VD.set(n),i.uniformMatrix3fv(this.addr,!1,VD),ks(t,n)}}function OX(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Hs(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ks(t,e)}else{if(Hs(t,n))return;zD.set(n),i.uniformMatrix4fv(this.addr,!1,zD),ks(t,n)}}function LX(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function UX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hs(t,e))return;i.uniform2iv(this.addr,e),ks(t,e)}}function PX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hs(t,e))return;i.uniform3iv(this.addr,e),ks(t,e)}}function FX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hs(t,e))return;i.uniform4iv(this.addr,e),ks(t,e)}}function zX(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function VX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hs(t,e))return;i.uniform2uiv(this.addr,e),ks(t,e)}}function HX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hs(t,e))return;i.uniform3uiv(this.addr,e),ks(t,e)}}function kX(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hs(t,e))return;i.uniform4uiv(this.addr,e),ks(t,e)}}function GX(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s);let r;this.type===i.SAMPLER_2D_SHADOW?(UD.compareFunction=$1,r=UD):r=gU,t.setTexture2D(e||r,s)}function jX(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||_U,s)}function qX(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||vU,s)}function XX(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||yU,s)}function WX(i){switch(i){case 5126:return RX;case 35664:return wX;case 35665:return DX;case 35666:return IX;case 35674:return BX;case 35675:return NX;case 35676:return OX;case 5124:case 35670:return LX;case 35667:case 35671:return UX;case 35668:case 35672:return PX;case 35669:case 35673:return FX;case 5125:return zX;case 36294:return VX;case 36295:return HX;case 36296:return kX;case 35678:case 36198:case 36298:case 36306:case 35682:return GX;case 35679:case 36299:case 36307:return jX;case 35680:case 36300:case 36308:case 36293:return qX;case 36289:case 36303:case 36311:case 36292:return XX}}function YX(i,e){i.uniform1fv(this.addr,e)}function KX(i,e){const t=Cg(e,this.size,2);i.uniform2fv(this.addr,t)}function JX(i,e){const t=Cg(e,this.size,3);i.uniform3fv(this.addr,t)}function QX(i,e){const t=Cg(e,this.size,4);i.uniform4fv(this.addr,t)}function ZX(i,e){const t=Cg(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function $X(i,e){const t=Cg(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function eW(i,e){const t=Cg(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function tW(i,e){i.uniform1iv(this.addr,e)}function nW(i,e){i.uniform2iv(this.addr,e)}function iW(i,e){i.uniform3iv(this.addr,e)}function sW(i,e){i.uniform4iv(this.addr,e)}function rW(i,e){i.uniform1uiv(this.addr,e)}function aW(i,e){i.uniform2uiv(this.addr,e)}function oW(i,e){i.uniform3uiv(this.addr,e)}function lW(i,e){i.uniform4uiv(this.addr,e)}function cW(i,e,t){const n=this.cache,s=e.length,r=mE(t,s);Hs(n,r)||(i.uniform1iv(this.addr,r),ks(n,r));for(let o=0;o!==s;++o)t.setTexture2D(e[o]||gU,r[o])}function uW(i,e,t){const n=this.cache,s=e.length,r=mE(t,s);Hs(n,r)||(i.uniform1iv(this.addr,r),ks(n,r));for(let o=0;o!==s;++o)t.setTexture3D(e[o]||_U,r[o])}function hW(i,e,t){const n=this.cache,s=e.length,r=mE(t,s);Hs(n,r)||(i.uniform1iv(this.addr,r),ks(n,r));for(let o=0;o!==s;++o)t.setTextureCube(e[o]||vU,r[o])}function fW(i,e,t){const n=this.cache,s=e.length,r=mE(t,s);Hs(n,r)||(i.uniform1iv(this.addr,r),ks(n,r));for(let o=0;o!==s;++o)t.setTexture2DArray(e[o]||yU,r[o])}function dW(i){switch(i){case 5126:return YX;case 35664:return KX;case 35665:return JX;case 35666:return QX;case 35674:return ZX;case 35675:return $X;case 35676:return eW;case 5124:case 35670:return tW;case 35667:case 35671:return nW;case 35668:case 35672:return iW;case 35669:case 35673:return sW;case 5125:return rW;case 36294:return aW;case 36295:return oW;case 36296:return lW;case 35678:case 36198:case 36298:case 36306:case 35682:return cW;case 35679:case 36299:case 36307:return uW;case 35680:case 36300:case 36308:case 36293:return hW;case 36289:case 36303:case 36311:case 36292:return fW}}class pW{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=WX(t.type)}}class mW{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=dW(t.type)}}class gW{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let r=0,o=s.length;r!==o;++r){const c=s[r];c.setValue(e,t[c.id],n)}}}const cT=/(\w+)(\])?(\[|\.)?/g;function kD(i,e){i.seq.push(e),i.map[e.id]=e}function yW(i,e,t){const n=i.name,s=n.length;for(cT.lastIndex=0;;){const r=cT.exec(n),o=cT.lastIndex;let c=r[1];const f=r[2]==="]",p=r[3];if(f&&(c=c|0),p===void 0||p==="["&&o+2===s){kD(t,p===void 0?new pW(c,i,e):new mW(c,i,e));break}else{let y=t.map[c];y===void 0&&(y=new gW(c),kD(t,y)),t=y}}}class qA{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const r=e.getActiveUniform(t,s),o=e.getUniformLocation(t,r.name);yW(r,o,this)}}setValue(e,t,n,s){const r=this.map[t];r!==void 0&&r.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let r=0,o=t.length;r!==o;++r){const c=t[r],f=n[c.id];f.needsUpdate!==!1&&c.setValue(e,f.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,r=e.length;s!==r;++s){const o=e[s];o.id in t&&n.push(o)}return n}}function GD(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const _W=37297;let vW=0;function AW(i,e){const t=i.split(`
`),n=[],s=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=s;o<r;o++){const c=o+1;n.push(`${c===e?">":" "} ${c}: ${t[o]}`)}return n.join(`
`)}const jD=new An;function xW(i){Gn._getMatrix(jD,Gn.workingColorSpace,i);const e=`mat3( ${jD.elements.map(t=>t.toFixed(4))} )`;switch(Gn.getTransfer(i)){case w_:return[e,"LinearTransferOETF"];case pi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function qD(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),r=(i.getShaderInfoLog(e)||"").trim();if(n&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const c=parseInt(o[1]);return t.toUpperCase()+`

`+r+`

`+AW(i.getShaderSource(e),c)}else return r}function SW(i,e){const t=xW(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function EW(i,e){let t;switch(e){case YO:t="Linear";break;case KO:t="Reinhard";break;case JO:t="Cineon";break;case G1:t="ACESFilmic";break;case ZO:t="AgX";break;case $O:t="Neutral";break;case QO:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const xA=new $;function bW(){Gn.getLuminanceCoefficients(xA);const i=xA.x.toFixed(4),e=xA.y.toFixed(4),t=xA.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function TW(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Zy).join(`
`)}function MW(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function CW(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const r=i.getActiveAttrib(e,s),o=r.name;let c=1;r.type===i.FLOAT_MAT2&&(c=2),r.type===i.FLOAT_MAT3&&(c=3),r.type===i.FLOAT_MAT4&&(c=4),t[o]={type:r.type,location:i.getAttribLocation(e,o),locationSize:c}}return t}function Zy(i){return i!==""}function XD(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function WD(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const RW=/^[ \t]*#include +<([\w\d./]+)>/gm;function MM(i){return i.replace(RW,DW)}const wW=new Map;function DW(i,e){let t=Tn[e];if(t===void 0){const n=wW.get(e);if(n!==void 0)t=Tn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return MM(t)}const IW=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function YD(i){return i.replace(IW,BW)}function BW(i,e,t,n){let s="";for(let r=parseInt(e);r<parseInt(t);r++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function KD(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function NW(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===US?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===a_?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Al&&(e="SHADOWMAP_TYPE_VSM"),e}function OW(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Fu:case uf:e="ENVMAP_TYPE_CUBE";break;case Sg:e="ENVMAP_TYPE_CUBE_UV";break}return e}function LW(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case uf:e="ENVMAP_MODE_REFRACTION";break}return e}function UW(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Z_:e="ENVMAP_BLENDING_MULTIPLY";break;case XO:e="ENVMAP_BLENDING_MIX";break;case WO:e="ENVMAP_BLENDING_ADD";break}return e}function PW(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function FW(i,e,t,n){const s=i.getContext(),r=t.defines;let o=t.vertexShader,c=t.fragmentShader;const f=NW(t),p=OW(t),m=LW(t),y=UW(t),v=PW(t),x=TW(t),b=MW(r),R=s.createProgram();let M,T,D=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Zy).join(`
`),M.length>0&&(M+=`
`),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Zy).join(`
`),T.length>0&&(T+=`
`)):(M=[KD(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zy).join(`
`),T=[KD(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+m:"",t.envMap?"#define "+y:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Cc?"#define TONE_MAPPING":"",t.toneMapping!==Cc?Tn.tonemapping_pars_fragment:"",t.toneMapping!==Cc?EW("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Tn.colorspace_pars_fragment,SW("linearToOutputTexel",t.outputColorSpace),bW(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Zy).join(`
`)),o=MM(o),o=XD(o,t),o=WD(o,t),c=MM(c),c=XD(c,t),c=WD(c,t),o=YD(o),c=YD(c),t.isRawShaderMaterial!==!0&&(D=`#version 300 es
`,M=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,T=["#define varying in",t.glslVersion===yM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===yM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const B=D+M+o,L=D+T+c,G=GD(s,s.VERTEX_SHADER,B),H=GD(s,s.FRAGMENT_SHADER,L);s.attachShader(R,G),s.attachShader(R,H),t.index0AttributeName!==void 0?s.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(R,0,"position"),s.linkProgram(R);function F(z){if(i.debug.checkShaderErrors){const W=s.getProgramInfoLog(R)||"",k=s.getShaderInfoLog(G)||"",he=s.getShaderInfoLog(H)||"",me=W.trim(),q=k.trim(),ee=he.trim();let ne=!0,ye=!0;if(s.getProgramParameter(R,s.LINK_STATUS)===!1)if(ne=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,R,G,H);else{const K=qD(s,G,"vertex"),ce=qD(s,H,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(R,s.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+me+`
`+K+`
`+ce)}else me!==""?console.warn("THREE.WebGLProgram: Program Info Log:",me):(q===""||ee==="")&&(ye=!1);ye&&(z.diagnostics={runnable:ne,programLog:me,vertexShader:{log:q,prefix:M},fragmentShader:{log:ee,prefix:T}})}s.deleteShader(G),s.deleteShader(H),U=new qA(s,R),I=CW(s,R)}let U;this.getUniforms=function(){return U===void 0&&F(this),U};let I;this.getAttributes=function(){return I===void 0&&F(this),I};let N=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return N===!1&&(N=s.getProgramParameter(R,_W)),N},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=vW++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=G,this.fragmentShader=H,this}let zW=0;class VW{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new HW(e),t.set(e,n)),n}}class HW{constructor(e){this.id=zW++,this.code=e,this.usedTimes=0}}function kW(i,e,t,n,s,r,o){const c=new lg,f=new VW,p=new Set,m=[],y=s.logarithmicDepthBuffer,v=s.vertexTextures;let x=s.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(I){return p.add(I),I===0?"uv":`uv${I}`}function M(I,N,z,W,k){const he=W.fog,me=k.geometry,q=I.isMeshStandardMaterial?W.environment:null,ee=(I.isMeshStandardMaterial?t:e).get(I.envMap||q),ne=ee&&ee.mapping===Sg?ee.image.height:null,ye=b[I.type];I.precision!==null&&(x=s.getMaxPrecision(I.precision),x!==I.precision&&console.warn("THREE.WebGLProgram.getParameters:",I.precision,"not supported, using",x,"instead."));const K=me.morphAttributes.position||me.morphAttributes.normal||me.morphAttributes.color,ce=K!==void 0?K.length:0;let Ee=0;me.morphAttributes.position!==void 0&&(Ee=1),me.morphAttributes.normal!==void 0&&(Ee=2),me.morphAttributes.color!==void 0&&(Ee=3);let Me,Ve,ge,ze;if(ye){const Zt=xl[ye];Me=Zt.vertexShader,Ve=Zt.fragmentShader}else Me=I.vertexShader,Ve=I.fragmentShader,f.update(I),ge=f.getVertexShaderID(I),ze=f.getFragmentShaderID(I);const Je=i.getRenderTarget(),lt=i.state.buffers.depth.getReversed(),At=k.isInstancedMesh===!0,Et=k.isBatchedMesh===!0,Nt=!!I.map,It=!!I.matcap,se=!!ee,Ge=!!I.aoMap,He=!!I.lightMap,tt=!!I.bumpMap,Fe=!!I.normalMap,ut=!!I.displacementMap,Qe=!!I.emissiveMap,st=!!I.metalnessMap,Ft=!!I.roughnessMap,Gt=I.anisotropy>0,te=I.clearcoat>0,X=I.dispersion>0,xe=I.iridescence>0,Re=I.sheen>0,Ue=I.transmission>0,Le=Gt&&!!I.anisotropyMap,_t=te&&!!I.clearcoatMap,ht=te&&!!I.clearcoatNormalMap,wt=te&&!!I.clearcoatRoughnessMap,Mt=xe&&!!I.iridescenceMap,et=xe&&!!I.iridescenceThicknessMap,ft=Re&&!!I.sheenColorMap,Dt=Re&&!!I.sheenRoughnessMap,re=!!I.specularMap,Te=!!I.specularColorMap,rt=!!I.specularIntensityMap,oe=Ue&&!!I.transmissionMap,Ke=Ue&&!!I.thicknessMap,nt=!!I.gradientMap,yt=!!I.alphaMap,it=I.alphaTest>0,ke=!!I.alphaHash,vt=!!I.extensions;let Ot=Cc;I.toneMapped&&(Je===null||Je.isXRRenderTarget===!0)&&(Ot=i.toneMapping);const cn={shaderID:ye,shaderType:I.type,shaderName:I.name,vertexShader:Me,fragmentShader:Ve,defines:I.defines,customVertexShaderID:ge,customFragmentShaderID:ze,isRawShaderMaterial:I.isRawShaderMaterial===!0,glslVersion:I.glslVersion,precision:x,batching:Et,batchingColor:Et&&k._colorsTexture!==null,instancing:At,instancingColor:At&&k.instanceColor!==null,instancingMorph:At&&k.morphTexture!==null,supportsVertexTextures:v,outputColorSpace:Je===null?i.outputColorSpace:Je.isXRRenderTarget===!0?Je.texture.colorSpace:ff,alphaToCoverage:!!I.alphaToCoverage,map:Nt,matcap:It,envMap:se,envMapMode:se&&ee.mapping,envMapCubeUVHeight:ne,aoMap:Ge,lightMap:He,bumpMap:tt,normalMap:Fe,displacementMap:v&&ut,emissiveMap:Qe,normalMapObjectSpace:Fe&&I.normalMapType===oL,normalMapTangentSpace:Fe&&I.normalMapType===_f,metalnessMap:st,roughnessMap:Ft,anisotropy:Gt,anisotropyMap:Le,clearcoat:te,clearcoatMap:_t,clearcoatNormalMap:ht,clearcoatRoughnessMap:wt,dispersion:X,iridescence:xe,iridescenceMap:Mt,iridescenceThicknessMap:et,sheen:Re,sheenColorMap:ft,sheenRoughnessMap:Dt,specularMap:re,specularColorMap:Te,specularIntensityMap:rt,transmission:Ue,transmissionMap:oe,thicknessMap:Ke,gradientMap:nt,opaque:I.transparent===!1&&I.blending===kd&&I.alphaToCoverage===!1,alphaMap:yt,alphaTest:it,alphaHash:ke,combine:I.combine,mapUv:Nt&&R(I.map.channel),aoMapUv:Ge&&R(I.aoMap.channel),lightMapUv:He&&R(I.lightMap.channel),bumpMapUv:tt&&R(I.bumpMap.channel),normalMapUv:Fe&&R(I.normalMap.channel),displacementMapUv:ut&&R(I.displacementMap.channel),emissiveMapUv:Qe&&R(I.emissiveMap.channel),metalnessMapUv:st&&R(I.metalnessMap.channel),roughnessMapUv:Ft&&R(I.roughnessMap.channel),anisotropyMapUv:Le&&R(I.anisotropyMap.channel),clearcoatMapUv:_t&&R(I.clearcoatMap.channel),clearcoatNormalMapUv:ht&&R(I.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:wt&&R(I.clearcoatRoughnessMap.channel),iridescenceMapUv:Mt&&R(I.iridescenceMap.channel),iridescenceThicknessMapUv:et&&R(I.iridescenceThicknessMap.channel),sheenColorMapUv:ft&&R(I.sheenColorMap.channel),sheenRoughnessMapUv:Dt&&R(I.sheenRoughnessMap.channel),specularMapUv:re&&R(I.specularMap.channel),specularColorMapUv:Te&&R(I.specularColorMap.channel),specularIntensityMapUv:rt&&R(I.specularIntensityMap.channel),transmissionMapUv:oe&&R(I.transmissionMap.channel),thicknessMapUv:Ke&&R(I.thicknessMap.channel),alphaMapUv:yt&&R(I.alphaMap.channel),vertexTangents:!!me.attributes.tangent&&(Fe||Gt),vertexColors:I.vertexColors,vertexAlphas:I.vertexColors===!0&&!!me.attributes.color&&me.attributes.color.itemSize===4,pointsUvs:k.isPoints===!0&&!!me.attributes.uv&&(Nt||yt),fog:!!he,useFog:I.fog===!0,fogExp2:!!he&&he.isFogExp2,flatShading:I.flatShading===!0&&I.wireframe===!1,sizeAttenuation:I.sizeAttenuation===!0,logarithmicDepthBuffer:y,reversedDepthBuffer:lt,skinning:k.isSkinnedMesh===!0,morphTargets:me.morphAttributes.position!==void 0,morphNormals:me.morphAttributes.normal!==void 0,morphColors:me.morphAttributes.color!==void 0,morphTargetsCount:ce,morphTextureStride:Ee,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:I.dithering,shadowMapEnabled:i.shadowMap.enabled&&z.length>0,shadowMapType:i.shadowMap.type,toneMapping:Ot,decodeVideoTexture:Nt&&I.map.isVideoTexture===!0&&Gn.getTransfer(I.map.colorSpace)===pi,decodeVideoTextureEmissive:Qe&&I.emissiveMap.isVideoTexture===!0&&Gn.getTransfer(I.emissiveMap.colorSpace)===pi,premultipliedAlpha:I.premultipliedAlpha,doubleSided:I.side===Fo,flipSided:I.side===ua,useDepthPacking:I.depthPacking>=0,depthPacking:I.depthPacking||0,index0AttributeName:I.index0AttributeName,extensionClipCullDistance:vt&&I.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(vt&&I.extensions.multiDraw===!0||Et)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:I.customProgramCacheKey()};return cn.vertexUv1s=p.has(1),cn.vertexUv2s=p.has(2),cn.vertexUv3s=p.has(3),p.clear(),cn}function T(I){const N=[];if(I.shaderID?N.push(I.shaderID):(N.push(I.customVertexShaderID),N.push(I.customFragmentShaderID)),I.defines!==void 0)for(const z in I.defines)N.push(z),N.push(I.defines[z]);return I.isRawShaderMaterial===!1&&(D(N,I),B(N,I),N.push(i.outputColorSpace)),N.push(I.customProgramCacheKey),N.join()}function D(I,N){I.push(N.precision),I.push(N.outputColorSpace),I.push(N.envMapMode),I.push(N.envMapCubeUVHeight),I.push(N.mapUv),I.push(N.alphaMapUv),I.push(N.lightMapUv),I.push(N.aoMapUv),I.push(N.bumpMapUv),I.push(N.normalMapUv),I.push(N.displacementMapUv),I.push(N.emissiveMapUv),I.push(N.metalnessMapUv),I.push(N.roughnessMapUv),I.push(N.anisotropyMapUv),I.push(N.clearcoatMapUv),I.push(N.clearcoatNormalMapUv),I.push(N.clearcoatRoughnessMapUv),I.push(N.iridescenceMapUv),I.push(N.iridescenceThicknessMapUv),I.push(N.sheenColorMapUv),I.push(N.sheenRoughnessMapUv),I.push(N.specularMapUv),I.push(N.specularColorMapUv),I.push(N.specularIntensityMapUv),I.push(N.transmissionMapUv),I.push(N.thicknessMapUv),I.push(N.combine),I.push(N.fogExp2),I.push(N.sizeAttenuation),I.push(N.morphTargetsCount),I.push(N.morphAttributeCount),I.push(N.numDirLights),I.push(N.numPointLights),I.push(N.numSpotLights),I.push(N.numSpotLightMaps),I.push(N.numHemiLights),I.push(N.numRectAreaLights),I.push(N.numDirLightShadows),I.push(N.numPointLightShadows),I.push(N.numSpotLightShadows),I.push(N.numSpotLightShadowsWithMaps),I.push(N.numLightProbes),I.push(N.shadowMapType),I.push(N.toneMapping),I.push(N.numClippingPlanes),I.push(N.numClipIntersection),I.push(N.depthPacking)}function B(I,N){c.disableAll(),N.supportsVertexTextures&&c.enable(0),N.instancing&&c.enable(1),N.instancingColor&&c.enable(2),N.instancingMorph&&c.enable(3),N.matcap&&c.enable(4),N.envMap&&c.enable(5),N.normalMapObjectSpace&&c.enable(6),N.normalMapTangentSpace&&c.enable(7),N.clearcoat&&c.enable(8),N.iridescence&&c.enable(9),N.alphaTest&&c.enable(10),N.vertexColors&&c.enable(11),N.vertexAlphas&&c.enable(12),N.vertexUv1s&&c.enable(13),N.vertexUv2s&&c.enable(14),N.vertexUv3s&&c.enable(15),N.vertexTangents&&c.enable(16),N.anisotropy&&c.enable(17),N.alphaHash&&c.enable(18),N.batching&&c.enable(19),N.dispersion&&c.enable(20),N.batchingColor&&c.enable(21),N.gradientMap&&c.enable(22),I.push(c.mask),c.disableAll(),N.fog&&c.enable(0),N.useFog&&c.enable(1),N.flatShading&&c.enable(2),N.logarithmicDepthBuffer&&c.enable(3),N.reversedDepthBuffer&&c.enable(4),N.skinning&&c.enable(5),N.morphTargets&&c.enable(6),N.morphNormals&&c.enable(7),N.morphColors&&c.enable(8),N.premultipliedAlpha&&c.enable(9),N.shadowMapEnabled&&c.enable(10),N.doubleSided&&c.enable(11),N.flipSided&&c.enable(12),N.useDepthPacking&&c.enable(13),N.dithering&&c.enable(14),N.transmission&&c.enable(15),N.sheen&&c.enable(16),N.opaque&&c.enable(17),N.pointsUvs&&c.enable(18),N.decodeVideoTexture&&c.enable(19),N.decodeVideoTextureEmissive&&c.enable(20),N.alphaToCoverage&&c.enable(21),I.push(c.mask)}function L(I){const N=b[I.type];let z;if(N){const W=xl[N];z=xL.clone(W.uniforms)}else z=I.uniforms;return z}function G(I,N){let z;for(let W=0,k=m.length;W<k;W++){const he=m[W];if(he.cacheKey===N){z=he,++z.usedTimes;break}}return z===void 0&&(z=new FW(i,N,I,r),m.push(z)),z}function H(I){if(--I.usedTimes===0){const N=m.indexOf(I);m[N]=m[m.length-1],m.pop(),I.destroy()}}function F(I){f.remove(I)}function U(){f.dispose()}return{getParameters:M,getProgramCacheKey:T,getUniforms:L,acquireProgram:G,releaseProgram:H,releaseShaderCache:F,programs:m,dispose:U}}function GW(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let c=i.get(o);return c===void 0&&(c={},i.set(o,c)),c}function n(o){i.delete(o)}function s(o,c,f){i.get(o)[c]=f}function r(){i=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:r}}function jW(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function JD(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function QD(){const i=[];let e=0;const t=[],n=[],s=[];function r(){e=0,t.length=0,n.length=0,s.length=0}function o(y,v,x,b,R,M){let T=i[e];return T===void 0?(T={id:y.id,object:y,geometry:v,material:x,groupOrder:b,renderOrder:y.renderOrder,z:R,group:M},i[e]=T):(T.id=y.id,T.object=y,T.geometry=v,T.material=x,T.groupOrder=b,T.renderOrder=y.renderOrder,T.z=R,T.group=M),e++,T}function c(y,v,x,b,R,M){const T=o(y,v,x,b,R,M);x.transmission>0?n.push(T):x.transparent===!0?s.push(T):t.push(T)}function f(y,v,x,b,R,M){const T=o(y,v,x,b,R,M);x.transmission>0?n.unshift(T):x.transparent===!0?s.unshift(T):t.unshift(T)}function p(y,v){t.length>1&&t.sort(y||jW),n.length>1&&n.sort(v||JD),s.length>1&&s.sort(v||JD)}function m(){for(let y=e,v=i.length;y<v;y++){const x=i[y];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:n,transparent:s,init:r,push:c,unshift:f,finish:m,sort:p}}function qW(){let i=new WeakMap;function e(n,s){const r=i.get(n);let o;return r===void 0?(o=new QD,i.set(n,[o])):s>=r.length?(o=new QD,r.push(o)):o=r[s],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function XW(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new $,color:new St};break;case"SpotLight":t={position:new $,direction:new $,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new $,color:new St,distance:0,decay:0};break;case"HemisphereLight":t={direction:new $,skyColor:new St,groundColor:new St};break;case"RectAreaLight":t={color:new St,position:new $,halfWidth:new $,halfHeight:new $};break}return i[e.id]=t,t}}}function WW(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let YW=0;function KW(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function JW(i){const e=new XW,t=WW(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new $);const s=new $,r=new Jt,o=new Jt;function c(p){let m=0,y=0,v=0;for(let I=0;I<9;I++)n.probe[I].set(0,0,0);let x=0,b=0,R=0,M=0,T=0,D=0,B=0,L=0,G=0,H=0,F=0;p.sort(KW);for(let I=0,N=p.length;I<N;I++){const z=p[I],W=z.color,k=z.intensity,he=z.distance,me=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)m+=W.r*k,y+=W.g*k,v+=W.b*k;else if(z.isLightProbe){for(let q=0;q<9;q++)n.probe[q].addScaledVector(z.sh.coefficients[q],k);F++}else if(z.isDirectionalLight){const q=e.get(z);if(q.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const ee=z.shadow,ne=t.get(z);ne.shadowIntensity=ee.intensity,ne.shadowBias=ee.bias,ne.shadowNormalBias=ee.normalBias,ne.shadowRadius=ee.radius,ne.shadowMapSize=ee.mapSize,n.directionalShadow[x]=ne,n.directionalShadowMap[x]=me,n.directionalShadowMatrix[x]=z.shadow.matrix,D++}n.directional[x]=q,x++}else if(z.isSpotLight){const q=e.get(z);q.position.setFromMatrixPosition(z.matrixWorld),q.color.copy(W).multiplyScalar(k),q.distance=he,q.coneCos=Math.cos(z.angle),q.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),q.decay=z.decay,n.spot[R]=q;const ee=z.shadow;if(z.map&&(n.spotLightMap[G]=z.map,G++,ee.updateMatrices(z),z.castShadow&&H++),n.spotLightMatrix[R]=ee.matrix,z.castShadow){const ne=t.get(z);ne.shadowIntensity=ee.intensity,ne.shadowBias=ee.bias,ne.shadowNormalBias=ee.normalBias,ne.shadowRadius=ee.radius,ne.shadowMapSize=ee.mapSize,n.spotShadow[R]=ne,n.spotShadowMap[R]=me,L++}R++}else if(z.isRectAreaLight){const q=e.get(z);q.color.copy(W).multiplyScalar(k),q.halfWidth.set(z.width*.5,0,0),q.halfHeight.set(0,z.height*.5,0),n.rectArea[M]=q,M++}else if(z.isPointLight){const q=e.get(z);if(q.color.copy(z.color).multiplyScalar(z.intensity),q.distance=z.distance,q.decay=z.decay,z.castShadow){const ee=z.shadow,ne=t.get(z);ne.shadowIntensity=ee.intensity,ne.shadowBias=ee.bias,ne.shadowNormalBias=ee.normalBias,ne.shadowRadius=ee.radius,ne.shadowMapSize=ee.mapSize,ne.shadowCameraNear=ee.camera.near,ne.shadowCameraFar=ee.camera.far,n.pointShadow[b]=ne,n.pointShadowMap[b]=me,n.pointShadowMatrix[b]=z.shadow.matrix,B++}n.point[b]=q,b++}else if(z.isHemisphereLight){const q=e.get(z);q.skyColor.copy(z.color).multiplyScalar(k),q.groundColor.copy(z.groundColor).multiplyScalar(k),n.hemi[T]=q,T++}}M>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Tt.LTC_FLOAT_1,n.rectAreaLTC2=Tt.LTC_FLOAT_2):(n.rectAreaLTC1=Tt.LTC_HALF_1,n.rectAreaLTC2=Tt.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=y,n.ambient[2]=v;const U=n.hash;(U.directionalLength!==x||U.pointLength!==b||U.spotLength!==R||U.rectAreaLength!==M||U.hemiLength!==T||U.numDirectionalShadows!==D||U.numPointShadows!==B||U.numSpotShadows!==L||U.numSpotMaps!==G||U.numLightProbes!==F)&&(n.directional.length=x,n.spot.length=R,n.rectArea.length=M,n.point.length=b,n.hemi.length=T,n.directionalShadow.length=D,n.directionalShadowMap.length=D,n.pointShadow.length=B,n.pointShadowMap.length=B,n.spotShadow.length=L,n.spotShadowMap.length=L,n.directionalShadowMatrix.length=D,n.pointShadowMatrix.length=B,n.spotLightMatrix.length=L+G-H,n.spotLightMap.length=G,n.numSpotLightShadowsWithMaps=H,n.numLightProbes=F,U.directionalLength=x,U.pointLength=b,U.spotLength=R,U.rectAreaLength=M,U.hemiLength=T,U.numDirectionalShadows=D,U.numPointShadows=B,U.numSpotShadows=L,U.numSpotMaps=G,U.numLightProbes=F,n.version=YW++)}function f(p,m){let y=0,v=0,x=0,b=0,R=0;const M=m.matrixWorldInverse;for(let T=0,D=p.length;T<D;T++){const B=p[T];if(B.isDirectionalLight){const L=n.directional[y];L.direction.setFromMatrixPosition(B.matrixWorld),s.setFromMatrixPosition(B.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(M),y++}else if(B.isSpotLight){const L=n.spot[x];L.position.setFromMatrixPosition(B.matrixWorld),L.position.applyMatrix4(M),L.direction.setFromMatrixPosition(B.matrixWorld),s.setFromMatrixPosition(B.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(M),x++}else if(B.isRectAreaLight){const L=n.rectArea[b];L.position.setFromMatrixPosition(B.matrixWorld),L.position.applyMatrix4(M),o.identity(),r.copy(B.matrixWorld),r.premultiply(M),o.extractRotation(r),L.halfWidth.set(B.width*.5,0,0),L.halfHeight.set(0,B.height*.5,0),L.halfWidth.applyMatrix4(o),L.halfHeight.applyMatrix4(o),b++}else if(B.isPointLight){const L=n.point[v];L.position.setFromMatrixPosition(B.matrixWorld),L.position.applyMatrix4(M),v++}else if(B.isHemisphereLight){const L=n.hemi[R];L.direction.setFromMatrixPosition(B.matrixWorld),L.direction.transformDirection(M),R++}}}return{setup:c,setupView:f,state:n}}function ZD(i){const e=new JW(i),t=[],n=[];function s(m){p.camera=m,t.length=0,n.length=0}function r(m){t.push(m)}function o(m){n.push(m)}function c(){e.setup(t)}function f(m){e.setupView(t,m)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:p,setupLights:c,setupLightsView:f,pushLight:r,pushShadow:o}}function QW(i){let e=new WeakMap;function t(s,r=0){const o=e.get(s);let c;return o===void 0?(c=new ZD(i),e.set(s,[c])):r>=o.length?(c=new ZD(i),o.push(c)):c=o[r],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const ZW=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,$W=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function eY(i,e,t){let n=new bg;const s=new Xe,r=new Xe,o=new Qn,c=new yC({depthPacking:aL}),f=new _C,p={},m=t.maxTextureSize,y={[Ic]:ua,[ua]:Ic,[Fo]:Fo},v=new Cl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:ZW,fragmentShader:$W}),x=v.clone();x.defines.HORIZONTAL_PASS=1;const b=new yn;b.setAttribute("position",new Zn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new vs(b,v),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=US;let T=this.type;this.render=function(H,F,U){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||H.length===0)return;const I=i.getRenderTarget(),N=i.getActiveCubeFace(),z=i.getActiveMipmapLevel(),W=i.state;W.setBlending(wu),W.buffers.depth.getReversed()?W.buffers.color.setClear(0,0,0,0):W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);const k=T!==Al&&this.type===Al,he=T===Al&&this.type!==Al;for(let me=0,q=H.length;me<q;me++){const ee=H[me],ne=ee.shadow;if(ne===void 0){console.warn("THREE.WebGLShadowMap:",ee,"has no shadow.");continue}if(ne.autoUpdate===!1&&ne.needsUpdate===!1)continue;s.copy(ne.mapSize);const ye=ne.getFrameExtents();if(s.multiply(ye),r.copy(ne.mapSize),(s.x>m||s.y>m)&&(s.x>m&&(r.x=Math.floor(m/ye.x),s.x=r.x*ye.x,ne.mapSize.x=r.x),s.y>m&&(r.y=Math.floor(m/ye.y),s.y=r.y*ye.y,ne.mapSize.y=r.y)),ne.map===null||k===!0||he===!0){const ce=this.type!==Al?{minFilter:Qs,magFilter:Qs}:{};ne.map!==null&&ne.map.dispose(),ne.map=new Bc(s.x,s.y,ce),ne.map.texture.name=ee.name+".shadowMap",ne.camera.updateProjectionMatrix()}i.setRenderTarget(ne.map),i.clear();const K=ne.getViewportCount();for(let ce=0;ce<K;ce++){const Ee=ne.getViewport(ce);o.set(r.x*Ee.x,r.y*Ee.y,r.x*Ee.z,r.y*Ee.w),W.viewport(o),ne.updateMatrices(ee,ce),n=ne.getFrustum(),L(F,U,ne.camera,ee,this.type)}ne.isPointLightShadow!==!0&&this.type===Al&&D(ne,U),ne.needsUpdate=!1}T=this.type,M.needsUpdate=!1,i.setRenderTarget(I,N,z)};function D(H,F){const U=e.update(R);v.defines.VSM_SAMPLES!==H.blurSamples&&(v.defines.VSM_SAMPLES=H.blurSamples,x.defines.VSM_SAMPLES=H.blurSamples,v.needsUpdate=!0,x.needsUpdate=!0),H.mapPass===null&&(H.mapPass=new Bc(s.x,s.y)),v.uniforms.shadow_pass.value=H.map.texture,v.uniforms.resolution.value=H.mapSize,v.uniforms.radius.value=H.radius,i.setRenderTarget(H.mapPass),i.clear(),i.renderBufferDirect(F,null,U,v,R,null),x.uniforms.shadow_pass.value=H.mapPass.texture,x.uniforms.resolution.value=H.mapSize,x.uniforms.radius.value=H.radius,i.setRenderTarget(H.map),i.clear(),i.renderBufferDirect(F,null,U,x,R,null)}function B(H,F,U,I){let N=null;const z=U.isPointLight===!0?H.customDistanceMaterial:H.customDepthMaterial;if(z!==void 0)N=z;else if(N=U.isPointLight===!0?f:c,i.localClippingEnabled&&F.clipShadows===!0&&Array.isArray(F.clippingPlanes)&&F.clippingPlanes.length!==0||F.displacementMap&&F.displacementScale!==0||F.alphaMap&&F.alphaTest>0||F.map&&F.alphaTest>0||F.alphaToCoverage===!0){const W=N.uuid,k=F.uuid;let he=p[W];he===void 0&&(he={},p[W]=he);let me=he[k];me===void 0&&(me=N.clone(),he[k]=me,F.addEventListener("dispose",G)),N=me}if(N.visible=F.visible,N.wireframe=F.wireframe,I===Al?N.side=F.shadowSide!==null?F.shadowSide:F.side:N.side=F.shadowSide!==null?F.shadowSide:y[F.side],N.alphaMap=F.alphaMap,N.alphaTest=F.alphaToCoverage===!0?.5:F.alphaTest,N.map=F.map,N.clipShadows=F.clipShadows,N.clippingPlanes=F.clippingPlanes,N.clipIntersection=F.clipIntersection,N.displacementMap=F.displacementMap,N.displacementScale=F.displacementScale,N.displacementBias=F.displacementBias,N.wireframeLinewidth=F.wireframeLinewidth,N.linewidth=F.linewidth,U.isPointLight===!0&&N.isMeshDistanceMaterial===!0){const W=i.properties.get(N);W.light=U}return N}function L(H,F,U,I,N){if(H.visible===!1)return;if(H.layers.test(F.layers)&&(H.isMesh||H.isLine||H.isPoints)&&(H.castShadow||H.receiveShadow&&N===Al)&&(!H.frustumCulled||n.intersectsObject(H))){H.modelViewMatrix.multiplyMatrices(U.matrixWorldInverse,H.matrixWorld);const k=e.update(H),he=H.material;if(Array.isArray(he)){const me=k.groups;for(let q=0,ee=me.length;q<ee;q++){const ne=me[q],ye=he[ne.materialIndex];if(ye&&ye.visible){const K=B(H,ye,I,N);H.onBeforeShadow(i,H,F,U,k,K,ne),i.renderBufferDirect(U,null,k,K,H,ne),H.onAfterShadow(i,H,F,U,k,K,ne)}}}else if(he.visible){const me=B(H,he,I,N);H.onBeforeShadow(i,H,F,U,k,me,null),i.renderBufferDirect(U,null,k,me,H,null),H.onAfterShadow(i,H,F,U,k,me,null)}}const W=H.children;for(let k=0,he=W.length;k<he;k++)L(W[k],F,U,I,N)}function G(H){H.target.removeEventListener("dispose",G);for(const U in p){const I=p[U],N=H.target.uuid;N in I&&(I[N].dispose(),delete I[N])}}}const tY={[yx]:_x,[vx]:Sx,[Ax]:Ex,[Jd]:xx,[_x]:yx,[Sx]:vx,[Ex]:Ax,[xx]:Jd};function nY(i,e){function t(){let oe=!1;const Ke=new Qn;let nt=null;const yt=new Qn(0,0,0,0);return{setMask:function(it){nt!==it&&!oe&&(i.colorMask(it,it,it,it),nt=it)},setLocked:function(it){oe=it},setClear:function(it,ke,vt,Ot,cn){cn===!0&&(it*=Ot,ke*=Ot,vt*=Ot),Ke.set(it,ke,vt,Ot),yt.equals(Ke)===!1&&(i.clearColor(it,ke,vt,Ot),yt.copy(Ke))},reset:function(){oe=!1,nt=null,yt.set(-1,0,0,0)}}}function n(){let oe=!1,Ke=!1,nt=null,yt=null,it=null;return{setReversed:function(ke){if(Ke!==ke){const vt=e.get("EXT_clip_control");ke?vt.clipControlEXT(vt.LOWER_LEFT_EXT,vt.ZERO_TO_ONE_EXT):vt.clipControlEXT(vt.LOWER_LEFT_EXT,vt.NEGATIVE_ONE_TO_ONE_EXT),Ke=ke;const Ot=it;it=null,this.setClear(Ot)}},getReversed:function(){return Ke},setTest:function(ke){ke?Je(i.DEPTH_TEST):lt(i.DEPTH_TEST)},setMask:function(ke){nt!==ke&&!oe&&(i.depthMask(ke),nt=ke)},setFunc:function(ke){if(Ke&&(ke=tY[ke]),yt!==ke){switch(ke){case yx:i.depthFunc(i.NEVER);break;case _x:i.depthFunc(i.ALWAYS);break;case vx:i.depthFunc(i.LESS);break;case Jd:i.depthFunc(i.LEQUAL);break;case Ax:i.depthFunc(i.EQUAL);break;case xx:i.depthFunc(i.GEQUAL);break;case Sx:i.depthFunc(i.GREATER);break;case Ex:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}yt=ke}},setLocked:function(ke){oe=ke},setClear:function(ke){it!==ke&&(Ke&&(ke=1-ke),i.clearDepth(ke),it=ke)},reset:function(){oe=!1,nt=null,yt=null,it=null,Ke=!1}}}function s(){let oe=!1,Ke=null,nt=null,yt=null,it=null,ke=null,vt=null,Ot=null,cn=null;return{setTest:function(Zt){oe||(Zt?Je(i.STENCIL_TEST):lt(i.STENCIL_TEST))},setMask:function(Zt){Ke!==Zt&&!oe&&(i.stencilMask(Zt),Ke=Zt)},setFunc:function(Zt,Gi,_n){(nt!==Zt||yt!==Gi||it!==_n)&&(i.stencilFunc(Zt,Gi,_n),nt=Zt,yt=Gi,it=_n)},setOp:function(Zt,Gi,_n){(ke!==Zt||vt!==Gi||Ot!==_n)&&(i.stencilOp(Zt,Gi,_n),ke=Zt,vt=Gi,Ot=_n)},setLocked:function(Zt){oe=Zt},setClear:function(Zt){cn!==Zt&&(i.clearStencil(Zt),cn=Zt)},reset:function(){oe=!1,Ke=null,nt=null,yt=null,it=null,ke=null,vt=null,Ot=null,cn=null}}}const r=new t,o=new n,c=new s,f=new WeakMap,p=new WeakMap;let m={},y={},v=new WeakMap,x=[],b=null,R=!1,M=null,T=null,D=null,B=null,L=null,G=null,H=null,F=new St(0,0,0),U=0,I=!1,N=null,z=null,W=null,k=null,he=null;const me=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let q=!1,ee=0;const ne=i.getParameter(i.VERSION);ne.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(ne)[1]),q=ee>=1):ne.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(ne)[1]),q=ee>=2);let ye=null,K={};const ce=i.getParameter(i.SCISSOR_BOX),Ee=i.getParameter(i.VIEWPORT),Me=new Qn().fromArray(ce),Ve=new Qn().fromArray(Ee);function ge(oe,Ke,nt,yt){const it=new Uint8Array(4),ke=i.createTexture();i.bindTexture(oe,ke),i.texParameteri(oe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(oe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let vt=0;vt<nt;vt++)oe===i.TEXTURE_3D||oe===i.TEXTURE_2D_ARRAY?i.texImage3D(Ke,0,i.RGBA,1,1,yt,0,i.RGBA,i.UNSIGNED_BYTE,it):i.texImage2D(Ke+vt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,it);return ke}const ze={};ze[i.TEXTURE_2D]=ge(i.TEXTURE_2D,i.TEXTURE_2D,1),ze[i.TEXTURE_CUBE_MAP]=ge(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),ze[i.TEXTURE_2D_ARRAY]=ge(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),ze[i.TEXTURE_3D]=ge(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),c.setClear(0),Je(i.DEPTH_TEST),o.setFunc(Jd),tt(!1),Fe(hM),Je(i.CULL_FACE),Ge(wu);function Je(oe){m[oe]!==!0&&(i.enable(oe),m[oe]=!0)}function lt(oe){m[oe]!==!1&&(i.disable(oe),m[oe]=!1)}function At(oe,Ke){return y[oe]!==Ke?(i.bindFramebuffer(oe,Ke),y[oe]=Ke,oe===i.DRAW_FRAMEBUFFER&&(y[i.FRAMEBUFFER]=Ke),oe===i.FRAMEBUFFER&&(y[i.DRAW_FRAMEBUFFER]=Ke),!0):!1}function Et(oe,Ke){let nt=x,yt=!1;if(oe){nt=v.get(Ke),nt===void 0&&(nt=[],v.set(Ke,nt));const it=oe.textures;if(nt.length!==it.length||nt[0]!==i.COLOR_ATTACHMENT0){for(let ke=0,vt=it.length;ke<vt;ke++)nt[ke]=i.COLOR_ATTACHMENT0+ke;nt.length=it.length,yt=!0}}else nt[0]!==i.BACK&&(nt[0]=i.BACK,yt=!0);yt&&i.drawBuffers(nt)}function Nt(oe){return b!==oe?(i.useProgram(oe),b=oe,!0):!1}const It={[qh]:i.FUNC_ADD,[wO]:i.FUNC_SUBTRACT,[DO]:i.FUNC_REVERSE_SUBTRACT};It[IO]=i.MIN,It[BO]=i.MAX;const se={[NO]:i.ZERO,[OO]:i.ONE,[LO]:i.SRC_COLOR,[mx]:i.SRC_ALPHA,[HO]:i.SRC_ALPHA_SATURATE,[zO]:i.DST_COLOR,[PO]:i.DST_ALPHA,[UO]:i.ONE_MINUS_SRC_COLOR,[gx]:i.ONE_MINUS_SRC_ALPHA,[VO]:i.ONE_MINUS_DST_COLOR,[FO]:i.ONE_MINUS_DST_ALPHA,[kO]:i.CONSTANT_COLOR,[GO]:i.ONE_MINUS_CONSTANT_COLOR,[jO]:i.CONSTANT_ALPHA,[qO]:i.ONE_MINUS_CONSTANT_ALPHA};function Ge(oe,Ke,nt,yt,it,ke,vt,Ot,cn,Zt){if(oe===wu){R===!0&&(lt(i.BLEND),R=!1);return}if(R===!1&&(Je(i.BLEND),R=!0),oe!==RO){if(oe!==M||Zt!==I){if((T!==qh||L!==qh)&&(i.blendEquation(i.FUNC_ADD),T=qh,L=qh),Zt)switch(oe){case kd:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case fM:i.blendFunc(i.ONE,i.ONE);break;case dM:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case pM:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}else switch(oe){case kd:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case fM:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case dM:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case pM:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}D=null,B=null,G=null,H=null,F.set(0,0,0),U=0,M=oe,I=Zt}return}it=it||Ke,ke=ke||nt,vt=vt||yt,(Ke!==T||it!==L)&&(i.blendEquationSeparate(It[Ke],It[it]),T=Ke,L=it),(nt!==D||yt!==B||ke!==G||vt!==H)&&(i.blendFuncSeparate(se[nt],se[yt],se[ke],se[vt]),D=nt,B=yt,G=ke,H=vt),(Ot.equals(F)===!1||cn!==U)&&(i.blendColor(Ot.r,Ot.g,Ot.b,cn),F.copy(Ot),U=cn),M=oe,I=!1}function He(oe,Ke){oe.side===Fo?lt(i.CULL_FACE):Je(i.CULL_FACE);let nt=oe.side===ua;Ke&&(nt=!nt),tt(nt),oe.blending===kd&&oe.transparent===!1?Ge(wu):Ge(oe.blending,oe.blendEquation,oe.blendSrc,oe.blendDst,oe.blendEquationAlpha,oe.blendSrcAlpha,oe.blendDstAlpha,oe.blendColor,oe.blendAlpha,oe.premultipliedAlpha),o.setFunc(oe.depthFunc),o.setTest(oe.depthTest),o.setMask(oe.depthWrite),r.setMask(oe.colorWrite);const yt=oe.stencilWrite;c.setTest(yt),yt&&(c.setMask(oe.stencilWriteMask),c.setFunc(oe.stencilFunc,oe.stencilRef,oe.stencilFuncMask),c.setOp(oe.stencilFail,oe.stencilZFail,oe.stencilZPass)),Qe(oe.polygonOffset,oe.polygonOffsetFactor,oe.polygonOffsetUnits),oe.alphaToCoverage===!0?Je(i.SAMPLE_ALPHA_TO_COVERAGE):lt(i.SAMPLE_ALPHA_TO_COVERAGE)}function tt(oe){N!==oe&&(oe?i.frontFace(i.CW):i.frontFace(i.CCW),N=oe)}function Fe(oe){oe!==TO?(Je(i.CULL_FACE),oe!==z&&(oe===hM?i.cullFace(i.BACK):oe===MO?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):lt(i.CULL_FACE),z=oe}function ut(oe){oe!==W&&(q&&i.lineWidth(oe),W=oe)}function Qe(oe,Ke,nt){oe?(Je(i.POLYGON_OFFSET_FILL),(k!==Ke||he!==nt)&&(i.polygonOffset(Ke,nt),k=Ke,he=nt)):lt(i.POLYGON_OFFSET_FILL)}function st(oe){oe?Je(i.SCISSOR_TEST):lt(i.SCISSOR_TEST)}function Ft(oe){oe===void 0&&(oe=i.TEXTURE0+me-1),ye!==oe&&(i.activeTexture(oe),ye=oe)}function Gt(oe,Ke,nt){nt===void 0&&(ye===null?nt=i.TEXTURE0+me-1:nt=ye);let yt=K[nt];yt===void 0&&(yt={type:void 0,texture:void 0},K[nt]=yt),(yt.type!==oe||yt.texture!==Ke)&&(ye!==nt&&(i.activeTexture(nt),ye=nt),i.bindTexture(oe,Ke||ze[oe]),yt.type=oe,yt.texture=Ke)}function te(){const oe=K[ye];oe!==void 0&&oe.type!==void 0&&(i.bindTexture(oe.type,null),oe.type=void 0,oe.texture=void 0)}function X(){try{i.compressedTexImage2D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function xe(){try{i.compressedTexImage3D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function Re(){try{i.texSubImage2D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function Ue(){try{i.texSubImage3D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function Le(){try{i.compressedTexSubImage2D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function _t(){try{i.compressedTexSubImage3D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ht(){try{i.texStorage2D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function wt(){try{i.texStorage3D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function Mt(){try{i.texImage2D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function et(){try{i.texImage3D(...arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ft(oe){Me.equals(oe)===!1&&(i.scissor(oe.x,oe.y,oe.z,oe.w),Me.copy(oe))}function Dt(oe){Ve.equals(oe)===!1&&(i.viewport(oe.x,oe.y,oe.z,oe.w),Ve.copy(oe))}function re(oe,Ke){let nt=p.get(Ke);nt===void 0&&(nt=new WeakMap,p.set(Ke,nt));let yt=nt.get(oe);yt===void 0&&(yt=i.getUniformBlockIndex(Ke,oe.name),nt.set(oe,yt))}function Te(oe,Ke){const yt=p.get(Ke).get(oe);f.get(Ke)!==yt&&(i.uniformBlockBinding(Ke,yt,oe.__bindingPointIndex),f.set(Ke,yt))}function rt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},ye=null,K={},y={},v=new WeakMap,x=[],b=null,R=!1,M=null,T=null,D=null,B=null,L=null,G=null,H=null,F=new St(0,0,0),U=0,I=!1,N=null,z=null,W=null,k=null,he=null,Me.set(0,0,i.canvas.width,i.canvas.height),Ve.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),c.reset()}return{buffers:{color:r,depth:o,stencil:c},enable:Je,disable:lt,bindFramebuffer:At,drawBuffers:Et,useProgram:Nt,setBlending:Ge,setMaterial:He,setFlipSided:tt,setCullFace:Fe,setLineWidth:ut,setPolygonOffset:Qe,setScissorTest:st,activeTexture:Ft,bindTexture:Gt,unbindTexture:te,compressedTexImage2D:X,compressedTexImage3D:xe,texImage2D:Mt,texImage3D:et,updateUBOMapping:re,uniformBlockBinding:Te,texStorage2D:ht,texStorage3D:wt,texSubImage2D:Re,texSubImage3D:Ue,compressedTexSubImage2D:Le,compressedTexSubImage3D:_t,scissor:ft,viewport:Dt,reset:rt}}function iY(i,e,t,n,s,r,o){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Xe,m=new WeakMap;let y;const v=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(te,X){return x?new OffscreenCanvas(te,X):I_("canvas")}function R(te,X,xe){let Re=1;const Ue=Gt(te);if((Ue.width>xe||Ue.height>xe)&&(Re=xe/Math.max(Ue.width,Ue.height)),Re<1)if(typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&te instanceof ImageBitmap||typeof VideoFrame<"u"&&te instanceof VideoFrame){const Le=Math.floor(Re*Ue.width),_t=Math.floor(Re*Ue.height);y===void 0&&(y=b(Le,_t));const ht=X?b(Le,_t):y;return ht.width=Le,ht.height=_t,ht.getContext("2d").drawImage(te,0,0,Le,_t),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ue.width+"x"+Ue.height+") to ("+Le+"x"+_t+")."),ht}else return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ue.width+"x"+Ue.height+")."),te;return te}function M(te){return te.generateMipmaps}function T(te){i.generateMipmap(te)}function D(te){return te.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:te.isWebGL3DRenderTarget?i.TEXTURE_3D:te.isWebGLArrayRenderTarget||te.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function B(te,X,xe,Re,Ue=!1){if(te!==null){if(i[te]!==void 0)return i[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let Le=X;if(X===i.RED&&(xe===i.FLOAT&&(Le=i.R32F),xe===i.HALF_FLOAT&&(Le=i.R16F),xe===i.UNSIGNED_BYTE&&(Le=i.R8)),X===i.RED_INTEGER&&(xe===i.UNSIGNED_BYTE&&(Le=i.R8UI),xe===i.UNSIGNED_SHORT&&(Le=i.R16UI),xe===i.UNSIGNED_INT&&(Le=i.R32UI),xe===i.BYTE&&(Le=i.R8I),xe===i.SHORT&&(Le=i.R16I),xe===i.INT&&(Le=i.R32I)),X===i.RG&&(xe===i.FLOAT&&(Le=i.RG32F),xe===i.HALF_FLOAT&&(Le=i.RG16F),xe===i.UNSIGNED_BYTE&&(Le=i.RG8)),X===i.RG_INTEGER&&(xe===i.UNSIGNED_BYTE&&(Le=i.RG8UI),xe===i.UNSIGNED_SHORT&&(Le=i.RG16UI),xe===i.UNSIGNED_INT&&(Le=i.RG32UI),xe===i.BYTE&&(Le=i.RG8I),xe===i.SHORT&&(Le=i.RG16I),xe===i.INT&&(Le=i.RG32I)),X===i.RGB_INTEGER&&(xe===i.UNSIGNED_BYTE&&(Le=i.RGB8UI),xe===i.UNSIGNED_SHORT&&(Le=i.RGB16UI),xe===i.UNSIGNED_INT&&(Le=i.RGB32UI),xe===i.BYTE&&(Le=i.RGB8I),xe===i.SHORT&&(Le=i.RGB16I),xe===i.INT&&(Le=i.RGB32I)),X===i.RGBA_INTEGER&&(xe===i.UNSIGNED_BYTE&&(Le=i.RGBA8UI),xe===i.UNSIGNED_SHORT&&(Le=i.RGBA16UI),xe===i.UNSIGNED_INT&&(Le=i.RGBA32UI),xe===i.BYTE&&(Le=i.RGBA8I),xe===i.SHORT&&(Le=i.RGBA16I),xe===i.INT&&(Le=i.RGBA32I)),X===i.RGB&&xe===i.UNSIGNED_INT_5_9_9_9_REV&&(Le=i.RGB9_E5),X===i.RGBA){const _t=Ue?w_:Gn.getTransfer(Re);xe===i.FLOAT&&(Le=i.RGBA32F),xe===i.HALF_FLOAT&&(Le=i.RGBA16F),xe===i.UNSIGNED_BYTE&&(Le=_t===pi?i.SRGB8_ALPHA8:i.RGBA8),xe===i.UNSIGNED_SHORT_4_4_4_4&&(Le=i.RGBA4),xe===i.UNSIGNED_SHORT_5_5_5_1&&(Le=i.RGB5_A1)}return(Le===i.R16F||Le===i.R32F||Le===i.RG16F||Le===i.RG32F||Le===i.RGBA16F||Le===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Le}function L(te,X){let xe;return te?X===null||X===zu||X===tg?xe=i.DEPTH24_STENCIL8:X===za?xe=i.DEPTH32F_STENCIL8:X===eg&&(xe=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):X===null||X===zu||X===tg?xe=i.DEPTH_COMPONENT24:X===za?xe=i.DEPTH_COMPONENT32F:X===eg&&(xe=i.DEPTH_COMPONENT16),xe}function G(te,X){return M(te)===!0||te.isFramebufferTexture&&te.minFilter!==Qs&&te.minFilter!==_s?Math.log2(Math.max(X.width,X.height))+1:te.mipmaps!==void 0&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?X.mipmaps.length:1}function H(te){const X=te.target;X.removeEventListener("dispose",H),U(X),X.isVideoTexture&&m.delete(X)}function F(te){const X=te.target;X.removeEventListener("dispose",F),N(X)}function U(te){const X=n.get(te);if(X.__webglInit===void 0)return;const xe=te.source,Re=v.get(xe);if(Re){const Ue=Re[X.__cacheKey];Ue.usedTimes--,Ue.usedTimes===0&&I(te),Object.keys(Re).length===0&&v.delete(xe)}n.remove(te)}function I(te){const X=n.get(te);i.deleteTexture(X.__webglTexture);const xe=te.source,Re=v.get(xe);delete Re[X.__cacheKey],o.memory.textures--}function N(te){const X=n.get(te);if(te.depthTexture&&(te.depthTexture.dispose(),n.remove(te.depthTexture)),te.isWebGLCubeRenderTarget)for(let Re=0;Re<6;Re++){if(Array.isArray(X.__webglFramebuffer[Re]))for(let Ue=0;Ue<X.__webglFramebuffer[Re].length;Ue++)i.deleteFramebuffer(X.__webglFramebuffer[Re][Ue]);else i.deleteFramebuffer(X.__webglFramebuffer[Re]);X.__webglDepthbuffer&&i.deleteRenderbuffer(X.__webglDepthbuffer[Re])}else{if(Array.isArray(X.__webglFramebuffer))for(let Re=0;Re<X.__webglFramebuffer.length;Re++)i.deleteFramebuffer(X.__webglFramebuffer[Re]);else i.deleteFramebuffer(X.__webglFramebuffer);if(X.__webglDepthbuffer&&i.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&i.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer)for(let Re=0;Re<X.__webglColorRenderbuffer.length;Re++)X.__webglColorRenderbuffer[Re]&&i.deleteRenderbuffer(X.__webglColorRenderbuffer[Re]);X.__webglDepthRenderbuffer&&i.deleteRenderbuffer(X.__webglDepthRenderbuffer)}const xe=te.textures;for(let Re=0,Ue=xe.length;Re<Ue;Re++){const Le=n.get(xe[Re]);Le.__webglTexture&&(i.deleteTexture(Le.__webglTexture),o.memory.textures--),n.remove(xe[Re])}n.remove(te)}let z=0;function W(){z=0}function k(){const te=z;return te>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+s.maxTextures),z+=1,te}function he(te){const X=[];return X.push(te.wrapS),X.push(te.wrapT),X.push(te.wrapR||0),X.push(te.magFilter),X.push(te.minFilter),X.push(te.anisotropy),X.push(te.internalFormat),X.push(te.format),X.push(te.type),X.push(te.generateMipmaps),X.push(te.premultiplyAlpha),X.push(te.flipY),X.push(te.unpackAlignment),X.push(te.colorSpace),X.join()}function me(te,X){const xe=n.get(te);if(te.isVideoTexture&&st(te),te.isRenderTargetTexture===!1&&te.isExternalTexture!==!0&&te.version>0&&xe.__version!==te.version){const Re=te.image;if(Re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ze(xe,te,X);return}}else te.isExternalTexture&&(xe.__webglTexture=te.sourceTexture?te.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,xe.__webglTexture,i.TEXTURE0+X)}function q(te,X){const xe=n.get(te);if(te.isRenderTargetTexture===!1&&te.version>0&&xe.__version!==te.version){ze(xe,te,X);return}t.bindTexture(i.TEXTURE_2D_ARRAY,xe.__webglTexture,i.TEXTURE0+X)}function ee(te,X){const xe=n.get(te);if(te.isRenderTargetTexture===!1&&te.version>0&&xe.__version!==te.version){ze(xe,te,X);return}t.bindTexture(i.TEXTURE_3D,xe.__webglTexture,i.TEXTURE0+X)}function ne(te,X){const xe=n.get(te);if(te.version>0&&xe.__version!==te.version){Je(xe,te,X);return}t.bindTexture(i.TEXTURE_CUBE_MAP,xe.__webglTexture,i.TEXTURE0+X)}const ye={[hf]:i.REPEAT,[oo]:i.CLAMP_TO_EDGE,[$m]:i.MIRRORED_REPEAT},K={[Qs]:i.NEAREST,[FS]:i.NEAREST_MIPMAP_NEAREST,[Bd]:i.NEAREST_MIPMAP_LINEAR,[_s]:i.LINEAR,[Vm]:i.LINEAR_MIPMAP_NEAREST,[zo]:i.LINEAR_MIPMAP_LINEAR},ce={[lL]:i.NEVER,[pL]:i.ALWAYS,[cL]:i.LESS,[$1]:i.LEQUAL,[uL]:i.EQUAL,[dL]:i.GEQUAL,[hL]:i.GREATER,[fL]:i.NOTEQUAL};function Ee(te,X){if(X.type===za&&e.has("OES_texture_float_linear")===!1&&(X.magFilter===_s||X.magFilter===Vm||X.magFilter===Bd||X.magFilter===zo||X.minFilter===_s||X.minFilter===Vm||X.minFilter===Bd||X.minFilter===zo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(te,i.TEXTURE_WRAP_S,ye[X.wrapS]),i.texParameteri(te,i.TEXTURE_WRAP_T,ye[X.wrapT]),(te===i.TEXTURE_3D||te===i.TEXTURE_2D_ARRAY)&&i.texParameteri(te,i.TEXTURE_WRAP_R,ye[X.wrapR]),i.texParameteri(te,i.TEXTURE_MAG_FILTER,K[X.magFilter]),i.texParameteri(te,i.TEXTURE_MIN_FILTER,K[X.minFilter]),X.compareFunction&&(i.texParameteri(te,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(te,i.TEXTURE_COMPARE_FUNC,ce[X.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(X.magFilter===Qs||X.minFilter!==Bd&&X.minFilter!==zo||X.type===za&&e.has("OES_texture_float_linear")===!1)return;if(X.anisotropy>1||n.get(X).__currentAnisotropy){const xe=e.get("EXT_texture_filter_anisotropic");i.texParameterf(te,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,s.getMaxAnisotropy())),n.get(X).__currentAnisotropy=X.anisotropy}}}function Me(te,X){let xe=!1;te.__webglInit===void 0&&(te.__webglInit=!0,X.addEventListener("dispose",H));const Re=X.source;let Ue=v.get(Re);Ue===void 0&&(Ue={},v.set(Re,Ue));const Le=he(X);if(Le!==te.__cacheKey){Ue[Le]===void 0&&(Ue[Le]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,xe=!0),Ue[Le].usedTimes++;const _t=Ue[te.__cacheKey];_t!==void 0&&(Ue[te.__cacheKey].usedTimes--,_t.usedTimes===0&&I(X)),te.__cacheKey=Le,te.__webglTexture=Ue[Le].texture}return xe}function Ve(te,X,xe){return Math.floor(Math.floor(te/xe)/X)}function ge(te,X,xe,Re){const Le=te.updateRanges;if(Le.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,X.width,X.height,xe,Re,X.data);else{Le.sort((et,ft)=>et.start-ft.start);let _t=0;for(let et=1;et<Le.length;et++){const ft=Le[_t],Dt=Le[et],re=ft.start+ft.count,Te=Ve(Dt.start,X.width,4),rt=Ve(ft.start,X.width,4);Dt.start<=re+1&&Te===rt&&Ve(Dt.start+Dt.count-1,X.width,4)===Te?ft.count=Math.max(ft.count,Dt.start+Dt.count-ft.start):(++_t,Le[_t]=Dt)}Le.length=_t+1;const ht=i.getParameter(i.UNPACK_ROW_LENGTH),wt=i.getParameter(i.UNPACK_SKIP_PIXELS),Mt=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,X.width);for(let et=0,ft=Le.length;et<ft;et++){const Dt=Le[et],re=Math.floor(Dt.start/4),Te=Math.ceil(Dt.count/4),rt=re%X.width,oe=Math.floor(re/X.width),Ke=Te,nt=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,rt),i.pixelStorei(i.UNPACK_SKIP_ROWS,oe),t.texSubImage2D(i.TEXTURE_2D,0,rt,oe,Ke,nt,xe,Re,X.data)}te.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,ht),i.pixelStorei(i.UNPACK_SKIP_PIXELS,wt),i.pixelStorei(i.UNPACK_SKIP_ROWS,Mt)}}function ze(te,X,xe){let Re=i.TEXTURE_2D;(X.isDataArrayTexture||X.isCompressedArrayTexture)&&(Re=i.TEXTURE_2D_ARRAY),X.isData3DTexture&&(Re=i.TEXTURE_3D);const Ue=Me(te,X),Le=X.source;t.bindTexture(Re,te.__webglTexture,i.TEXTURE0+xe);const _t=n.get(Le);if(Le.version!==_t.__version||Ue===!0){t.activeTexture(i.TEXTURE0+xe);const ht=Gn.getPrimaries(Gn.workingColorSpace),wt=X.colorSpace===Eu?null:Gn.getPrimaries(X.colorSpace),Mt=X.colorSpace===Eu||ht===wt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,X.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,X.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Mt);let et=R(X.image,!1,s.maxTextureSize);et=Ft(X,et);const ft=r.convert(X.format,X.colorSpace),Dt=r.convert(X.type);let re=B(X.internalFormat,ft,Dt,X.colorSpace,X.isVideoTexture);Ee(Re,X);let Te;const rt=X.mipmaps,oe=X.isVideoTexture!==!0,Ke=_t.__version===void 0||Ue===!0,nt=Le.dataReady,yt=G(X,et);if(X.isDepthTexture)re=L(X.format===ig,X.type),Ke&&(oe?t.texStorage2D(i.TEXTURE_2D,1,re,et.width,et.height):t.texImage2D(i.TEXTURE_2D,0,re,et.width,et.height,0,ft,Dt,null));else if(X.isDataTexture)if(rt.length>0){oe&&Ke&&t.texStorage2D(i.TEXTURE_2D,yt,re,rt[0].width,rt[0].height);for(let it=0,ke=rt.length;it<ke;it++)Te=rt[it],oe?nt&&t.texSubImage2D(i.TEXTURE_2D,it,0,0,Te.width,Te.height,ft,Dt,Te.data):t.texImage2D(i.TEXTURE_2D,it,re,Te.width,Te.height,0,ft,Dt,Te.data);X.generateMipmaps=!1}else oe?(Ke&&t.texStorage2D(i.TEXTURE_2D,yt,re,et.width,et.height),nt&&ge(X,et,ft,Dt)):t.texImage2D(i.TEXTURE_2D,0,re,et.width,et.height,0,ft,Dt,et.data);else if(X.isCompressedTexture)if(X.isCompressedArrayTexture){oe&&Ke&&t.texStorage3D(i.TEXTURE_2D_ARRAY,yt,re,rt[0].width,rt[0].height,et.depth);for(let it=0,ke=rt.length;it<ke;it++)if(Te=rt[it],X.format!==Lr)if(ft!==null)if(oe){if(nt)if(X.layerUpdates.size>0){const vt=bM(Te.width,Te.height,X.format,X.type);for(const Ot of X.layerUpdates){const cn=Te.data.subarray(Ot*vt/Te.data.BYTES_PER_ELEMENT,(Ot+1)*vt/Te.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,it,0,0,Ot,Te.width,Te.height,1,ft,cn)}X.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,it,0,0,0,Te.width,Te.height,et.depth,ft,Te.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,it,re,Te.width,Te.height,et.depth,0,Te.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else oe?nt&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,it,0,0,0,Te.width,Te.height,et.depth,ft,Dt,Te.data):t.texImage3D(i.TEXTURE_2D_ARRAY,it,re,Te.width,Te.height,et.depth,0,ft,Dt,Te.data)}else{oe&&Ke&&t.texStorage2D(i.TEXTURE_2D,yt,re,rt[0].width,rt[0].height);for(let it=0,ke=rt.length;it<ke;it++)Te=rt[it],X.format!==Lr?ft!==null?oe?nt&&t.compressedTexSubImage2D(i.TEXTURE_2D,it,0,0,Te.width,Te.height,ft,Te.data):t.compressedTexImage2D(i.TEXTURE_2D,it,re,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):oe?nt&&t.texSubImage2D(i.TEXTURE_2D,it,0,0,Te.width,Te.height,ft,Dt,Te.data):t.texImage2D(i.TEXTURE_2D,it,re,Te.width,Te.height,0,ft,Dt,Te.data)}else if(X.isDataArrayTexture)if(oe){if(Ke&&t.texStorage3D(i.TEXTURE_2D_ARRAY,yt,re,et.width,et.height,et.depth),nt)if(X.layerUpdates.size>0){const it=bM(et.width,et.height,X.format,X.type);for(const ke of X.layerUpdates){const vt=et.data.subarray(ke*it/et.data.BYTES_PER_ELEMENT,(ke+1)*it/et.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,ke,et.width,et.height,1,ft,Dt,vt)}X.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,et.width,et.height,et.depth,ft,Dt,et.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,re,et.width,et.height,et.depth,0,ft,Dt,et.data);else if(X.isData3DTexture)oe?(Ke&&t.texStorage3D(i.TEXTURE_3D,yt,re,et.width,et.height,et.depth),nt&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,et.width,et.height,et.depth,ft,Dt,et.data)):t.texImage3D(i.TEXTURE_3D,0,re,et.width,et.height,et.depth,0,ft,Dt,et.data);else if(X.isFramebufferTexture){if(Ke)if(oe)t.texStorage2D(i.TEXTURE_2D,yt,re,et.width,et.height);else{let it=et.width,ke=et.height;for(let vt=0;vt<yt;vt++)t.texImage2D(i.TEXTURE_2D,vt,re,it,ke,0,ft,Dt,null),it>>=1,ke>>=1}}else if(rt.length>0){if(oe&&Ke){const it=Gt(rt[0]);t.texStorage2D(i.TEXTURE_2D,yt,re,it.width,it.height)}for(let it=0,ke=rt.length;it<ke;it++)Te=rt[it],oe?nt&&t.texSubImage2D(i.TEXTURE_2D,it,0,0,ft,Dt,Te):t.texImage2D(i.TEXTURE_2D,it,re,ft,Dt,Te);X.generateMipmaps=!1}else if(oe){if(Ke){const it=Gt(et);t.texStorage2D(i.TEXTURE_2D,yt,re,it.width,it.height)}nt&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,ft,Dt,et)}else t.texImage2D(i.TEXTURE_2D,0,re,ft,Dt,et);M(X)&&T(Re),_t.__version=Le.version,X.onUpdate&&X.onUpdate(X)}te.__version=X.version}function Je(te,X,xe){if(X.image.length!==6)return;const Re=Me(te,X),Ue=X.source;t.bindTexture(i.TEXTURE_CUBE_MAP,te.__webglTexture,i.TEXTURE0+xe);const Le=n.get(Ue);if(Ue.version!==Le.__version||Re===!0){t.activeTexture(i.TEXTURE0+xe);const _t=Gn.getPrimaries(Gn.workingColorSpace),ht=X.colorSpace===Eu?null:Gn.getPrimaries(X.colorSpace),wt=X.colorSpace===Eu||_t===ht?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,X.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,X.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,wt);const Mt=X.isCompressedTexture||X.image[0].isCompressedTexture,et=X.image[0]&&X.image[0].isDataTexture,ft=[];for(let ke=0;ke<6;ke++)!Mt&&!et?ft[ke]=R(X.image[ke],!0,s.maxCubemapSize):ft[ke]=et?X.image[ke].image:X.image[ke],ft[ke]=Ft(X,ft[ke]);const Dt=ft[0],re=r.convert(X.format,X.colorSpace),Te=r.convert(X.type),rt=B(X.internalFormat,re,Te,X.colorSpace),oe=X.isVideoTexture!==!0,Ke=Le.__version===void 0||Re===!0,nt=Ue.dataReady;let yt=G(X,Dt);Ee(i.TEXTURE_CUBE_MAP,X);let it;if(Mt){oe&&Ke&&t.texStorage2D(i.TEXTURE_CUBE_MAP,yt,rt,Dt.width,Dt.height);for(let ke=0;ke<6;ke++){it=ft[ke].mipmaps;for(let vt=0;vt<it.length;vt++){const Ot=it[vt];X.format!==Lr?re!==null?oe?nt&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt,0,0,Ot.width,Ot.height,re,Ot.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt,rt,Ot.width,Ot.height,0,Ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):oe?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt,0,0,Ot.width,Ot.height,re,Te,Ot.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt,rt,Ot.width,Ot.height,0,re,Te,Ot.data)}}}else{if(it=X.mipmaps,oe&&Ke){it.length>0&&yt++;const ke=Gt(ft[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,yt,rt,ke.width,ke.height)}for(let ke=0;ke<6;ke++)if(et){oe?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,ft[ke].width,ft[ke].height,re,Te,ft[ke].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,rt,ft[ke].width,ft[ke].height,0,re,Te,ft[ke].data);for(let vt=0;vt<it.length;vt++){const cn=it[vt].image[ke].image;oe?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt+1,0,0,cn.width,cn.height,re,Te,cn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt+1,rt,cn.width,cn.height,0,re,Te,cn.data)}}else{oe?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,re,Te,ft[ke]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,rt,re,Te,ft[ke]);for(let vt=0;vt<it.length;vt++){const Ot=it[vt];oe?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt+1,0,0,re,Te,Ot.image[ke]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ke,vt+1,rt,re,Te,Ot.image[ke])}}}M(X)&&T(i.TEXTURE_CUBE_MAP),Le.__version=Ue.version,X.onUpdate&&X.onUpdate(X)}te.__version=X.version}function lt(te,X,xe,Re,Ue,Le){const _t=r.convert(xe.format,xe.colorSpace),ht=r.convert(xe.type),wt=B(xe.internalFormat,_t,ht,xe.colorSpace),Mt=n.get(X),et=n.get(xe);if(et.__renderTarget=X,!Mt.__hasExternalTextures){const ft=Math.max(1,X.width>>Le),Dt=Math.max(1,X.height>>Le);Ue===i.TEXTURE_3D||Ue===i.TEXTURE_2D_ARRAY?t.texImage3D(Ue,Le,wt,ft,Dt,X.depth,0,_t,ht,null):t.texImage2D(Ue,Le,wt,ft,Dt,0,_t,ht,null)}t.bindFramebuffer(i.FRAMEBUFFER,te),Qe(X)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Re,Ue,et.__webglTexture,0,ut(X)):(Ue===i.TEXTURE_2D||Ue>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Ue<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Re,Ue,et.__webglTexture,Le),t.bindFramebuffer(i.FRAMEBUFFER,null)}function At(te,X,xe){if(i.bindRenderbuffer(i.RENDERBUFFER,te),X.depthBuffer){const Re=X.depthTexture,Ue=Re&&Re.isDepthTexture?Re.type:null,Le=L(X.stencilBuffer,Ue),_t=X.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ht=ut(X);Qe(X)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,ht,Le,X.width,X.height):xe?i.renderbufferStorageMultisample(i.RENDERBUFFER,ht,Le,X.width,X.height):i.renderbufferStorage(i.RENDERBUFFER,Le,X.width,X.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,_t,i.RENDERBUFFER,te)}else{const Re=X.textures;for(let Ue=0;Ue<Re.length;Ue++){const Le=Re[Ue],_t=r.convert(Le.format,Le.colorSpace),ht=r.convert(Le.type),wt=B(Le.internalFormat,_t,ht,Le.colorSpace),Mt=ut(X);xe&&Qe(X)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Mt,wt,X.width,X.height):Qe(X)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Mt,wt,X.width,X.height):i.renderbufferStorage(i.RENDERBUFFER,wt,X.width,X.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Et(te,X){if(X&&X.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,te),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Re=n.get(X.depthTexture);Re.__renderTarget=X,(!Re.__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),me(X.depthTexture,0);const Ue=Re.__webglTexture,Le=ut(X);if(X.depthTexture.format===ng)Qe(X)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ue,0,Le):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ue,0);else if(X.depthTexture.format===ig)Qe(X)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ue,0,Le):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ue,0);else throw new Error("Unknown depthTexture format")}function Nt(te){const X=n.get(te),xe=te.isWebGLCubeRenderTarget===!0;if(X.__boundDepthTexture!==te.depthTexture){const Re=te.depthTexture;if(X.__depthDisposeCallback&&X.__depthDisposeCallback(),Re){const Ue=()=>{delete X.__boundDepthTexture,delete X.__depthDisposeCallback,Re.removeEventListener("dispose",Ue)};Re.addEventListener("dispose",Ue),X.__depthDisposeCallback=Ue}X.__boundDepthTexture=Re}if(te.depthTexture&&!X.__autoAllocateDepthBuffer){if(xe)throw new Error("target.depthTexture not supported in Cube render targets");const Re=te.texture.mipmaps;Re&&Re.length>0?Et(X.__webglFramebuffer[0],te):Et(X.__webglFramebuffer,te)}else if(xe){X.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)if(t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer[Re]),X.__webglDepthbuffer[Re]===void 0)X.__webglDepthbuffer[Re]=i.createRenderbuffer(),At(X.__webglDepthbuffer[Re],te,!1);else{const Ue=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Le=X.__webglDepthbuffer[Re];i.bindRenderbuffer(i.RENDERBUFFER,Le),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ue,i.RENDERBUFFER,Le)}}else{const Re=te.texture.mipmaps;if(Re&&Re.length>0?t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,X.__webglFramebuffer),X.__webglDepthbuffer===void 0)X.__webglDepthbuffer=i.createRenderbuffer(),At(X.__webglDepthbuffer,te,!1);else{const Ue=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Le=X.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Le),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ue,i.RENDERBUFFER,Le)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function It(te,X,xe){const Re=n.get(te);X!==void 0&&lt(Re.__webglFramebuffer,te,te.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),xe!==void 0&&Nt(te)}function se(te){const X=te.texture,xe=n.get(te),Re=n.get(X);te.addEventListener("dispose",F);const Ue=te.textures,Le=te.isWebGLCubeRenderTarget===!0,_t=Ue.length>1;if(_t||(Re.__webglTexture===void 0&&(Re.__webglTexture=i.createTexture()),Re.__version=X.version,o.memory.textures++),Le){xe.__webglFramebuffer=[];for(let ht=0;ht<6;ht++)if(X.mipmaps&&X.mipmaps.length>0){xe.__webglFramebuffer[ht]=[];for(let wt=0;wt<X.mipmaps.length;wt++)xe.__webglFramebuffer[ht][wt]=i.createFramebuffer()}else xe.__webglFramebuffer[ht]=i.createFramebuffer()}else{if(X.mipmaps&&X.mipmaps.length>0){xe.__webglFramebuffer=[];for(let ht=0;ht<X.mipmaps.length;ht++)xe.__webglFramebuffer[ht]=i.createFramebuffer()}else xe.__webglFramebuffer=i.createFramebuffer();if(_t)for(let ht=0,wt=Ue.length;ht<wt;ht++){const Mt=n.get(Ue[ht]);Mt.__webglTexture===void 0&&(Mt.__webglTexture=i.createTexture(),o.memory.textures++)}if(te.samples>0&&Qe(te)===!1){xe.__webglMultisampledFramebuffer=i.createFramebuffer(),xe.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,xe.__webglMultisampledFramebuffer);for(let ht=0;ht<Ue.length;ht++){const wt=Ue[ht];xe.__webglColorRenderbuffer[ht]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,xe.__webglColorRenderbuffer[ht]);const Mt=r.convert(wt.format,wt.colorSpace),et=r.convert(wt.type),ft=B(wt.internalFormat,Mt,et,wt.colorSpace,te.isXRRenderTarget===!0),Dt=ut(te);i.renderbufferStorageMultisample(i.RENDERBUFFER,Dt,ft,te.width,te.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ht,i.RENDERBUFFER,xe.__webglColorRenderbuffer[ht])}i.bindRenderbuffer(i.RENDERBUFFER,null),te.depthBuffer&&(xe.__webglDepthRenderbuffer=i.createRenderbuffer(),At(xe.__webglDepthRenderbuffer,te,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Le){t.bindTexture(i.TEXTURE_CUBE_MAP,Re.__webglTexture),Ee(i.TEXTURE_CUBE_MAP,X);for(let ht=0;ht<6;ht++)if(X.mipmaps&&X.mipmaps.length>0)for(let wt=0;wt<X.mipmaps.length;wt++)lt(xe.__webglFramebuffer[ht][wt],te,X,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ht,wt);else lt(xe.__webglFramebuffer[ht],te,X,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ht,0);M(X)&&T(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(_t){for(let ht=0,wt=Ue.length;ht<wt;ht++){const Mt=Ue[ht],et=n.get(Mt);let ft=i.TEXTURE_2D;(te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(ft=te.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(ft,et.__webglTexture),Ee(ft,Mt),lt(xe.__webglFramebuffer,te,Mt,i.COLOR_ATTACHMENT0+ht,ft,0),M(Mt)&&T(ft)}t.unbindTexture()}else{let ht=i.TEXTURE_2D;if((te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(ht=te.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(ht,Re.__webglTexture),Ee(ht,X),X.mipmaps&&X.mipmaps.length>0)for(let wt=0;wt<X.mipmaps.length;wt++)lt(xe.__webglFramebuffer[wt],te,X,i.COLOR_ATTACHMENT0,ht,wt);else lt(xe.__webglFramebuffer,te,X,i.COLOR_ATTACHMENT0,ht,0);M(X)&&T(ht),t.unbindTexture()}te.depthBuffer&&Nt(te)}function Ge(te){const X=te.textures;for(let xe=0,Re=X.length;xe<Re;xe++){const Ue=X[xe];if(M(Ue)){const Le=D(te),_t=n.get(Ue).__webglTexture;t.bindTexture(Le,_t),T(Le),t.unbindTexture()}}}const He=[],tt=[];function Fe(te){if(te.samples>0){if(Qe(te)===!1){const X=te.textures,xe=te.width,Re=te.height;let Ue=i.COLOR_BUFFER_BIT;const Le=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,_t=n.get(te),ht=X.length>1;if(ht)for(let Mt=0;Mt<X.length;Mt++)t.bindFramebuffer(i.FRAMEBUFFER,_t.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,_t.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,_t.__webglMultisampledFramebuffer);const wt=te.texture.mipmaps;wt&&wt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,_t.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,_t.__webglFramebuffer);for(let Mt=0;Mt<X.length;Mt++){if(te.resolveDepthBuffer&&(te.depthBuffer&&(Ue|=i.DEPTH_BUFFER_BIT),te.stencilBuffer&&te.resolveStencilBuffer&&(Ue|=i.STENCIL_BUFFER_BIT)),ht){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,_t.__webglColorRenderbuffer[Mt]);const et=n.get(X[Mt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,et,0)}i.blitFramebuffer(0,0,xe,Re,0,0,xe,Re,Ue,i.NEAREST),f===!0&&(He.length=0,tt.length=0,He.push(i.COLOR_ATTACHMENT0+Mt),te.depthBuffer&&te.resolveDepthBuffer===!1&&(He.push(Le),tt.push(Le),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,tt)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,He))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),ht)for(let Mt=0;Mt<X.length;Mt++){t.bindFramebuffer(i.FRAMEBUFFER,_t.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mt,i.RENDERBUFFER,_t.__webglColorRenderbuffer[Mt]);const et=n.get(X[Mt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,_t.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mt,i.TEXTURE_2D,et,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,_t.__webglMultisampledFramebuffer)}else if(te.depthBuffer&&te.resolveDepthBuffer===!1&&f){const X=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[X])}}}function ut(te){return Math.min(s.maxSamples,te.samples)}function Qe(te){const X=n.get(te);return te.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&X.__useRenderToTexture!==!1}function st(te){const X=o.render.frame;m.get(te)!==X&&(m.set(te,X),te.update())}function Ft(te,X){const xe=te.colorSpace,Re=te.format,Ue=te.type;return te.isCompressedTexture===!0||te.isVideoTexture===!0||xe!==ff&&xe!==Eu&&(Gn.getTransfer(xe)===pi?(Re!==Lr||Ue!==ko)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",xe)),X}function Gt(te){return typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement?(p.width=te.naturalWidth||te.width,p.height=te.naturalHeight||te.height):typeof VideoFrame<"u"&&te instanceof VideoFrame?(p.width=te.displayWidth,p.height=te.displayHeight):(p.width=te.width,p.height=te.height),p}this.allocateTextureUnit=k,this.resetTextureUnits=W,this.setTexture2D=me,this.setTexture2DArray=q,this.setTexture3D=ee,this.setTextureCube=ne,this.rebindTextures=It,this.setupRenderTarget=se,this.updateRenderTargetMipmap=Ge,this.updateMultisampleRenderTarget=Fe,this.setupDepthRenderbuffer=Nt,this.setupFrameBufferTexture=lt,this.useMultisampledRTT=Qe}function AU(i,e){function t(n,s=Eu){let r;const o=Gn.getTransfer(s);if(n===ko)return i.UNSIGNED_BYTE;if(n===VS)return i.UNSIGNED_SHORT_4_4_4_4;if(n===HS)return i.UNSIGNED_SHORT_5_5_5_1;if(n===X1)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===j1)return i.BYTE;if(n===q1)return i.SHORT;if(n===eg)return i.UNSIGNED_SHORT;if(n===zS)return i.INT;if(n===zu)return i.UNSIGNED_INT;if(n===za)return i.FLOAT;if(n===Eg)return i.HALF_FLOAT;if(n===W1)return i.ALPHA;if(n===Y1)return i.RGB;if(n===Lr)return i.RGBA;if(n===ng)return i.DEPTH_COMPONENT;if(n===ig)return i.DEPTH_STENCIL;if(n===kS)return i.RED;if(n===$_)return i.RED_INTEGER;if(n===K1)return i.RG;if(n===GS)return i.RG_INTEGER;if(n===jS)return i.RGBA_INTEGER;if(n===o_||n===l_||n===c_||n===u_)if(o===pi)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===o_)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===l_)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===c_)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===u_)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===o_)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===l_)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===c_)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===u_)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===bx||n===Tx||n===Mx||n===Cx)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===bx)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Tx)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Mx)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Cx)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Rx||n===wx||n===Dx)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===Rx||n===wx)return o===pi?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===Dx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Ix||n===Bx||n===Nx||n===Ox||n===Lx||n===Ux||n===Px||n===Fx||n===zx||n===Vx||n===Hx||n===kx||n===Gx||n===jx)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===Ix)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Bx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Nx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Ox)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Lx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ux)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Px)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Fx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===zx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Vx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Hx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===kx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Gx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===jx)return o===pi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===h_||n===qx||n===Xx)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===h_)return o===pi?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===qx)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Xx)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===J1||n===Wx||n===Yx||n===Kx)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===h_)return r.COMPRESSED_RED_RGTC1_EXT;if(n===Wx)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Yx)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Kx)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===tg?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}class xU extends ki{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}}const sY=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,rY=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class aY{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new xU(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Cl({vertexShader:sY,fragmentShader:rY,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new vs(new Tg(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class oY extends Oc{constructor(e,t){super();const n=this;let s=null,r=1,o=null,c="local-floor",f=1,p=null,m=null,y=null,v=null,x=null,b=null;const R=new aY,M={},T=t.getContextAttributes();let D=null,B=null;const L=[],G=[],H=new Xe;let F=null;const U=new Hi;U.viewport=new Qn;const I=new Hi;I.viewport=new Qn;const N=[U,I],z=new cU;let W=null,k=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ge){let ze=L[ge];return ze===void 0&&(ze=new jA,L[ge]=ze),ze.getTargetRaySpace()},this.getControllerGrip=function(ge){let ze=L[ge];return ze===void 0&&(ze=new jA,L[ge]=ze),ze.getGripSpace()},this.getHand=function(ge){let ze=L[ge];return ze===void 0&&(ze=new jA,L[ge]=ze),ze.getHandSpace()};function he(ge){const ze=G.indexOf(ge.inputSource);if(ze===-1)return;const Je=L[ze];Je!==void 0&&(Je.update(ge.inputSource,ge.frame,p||o),Je.dispatchEvent({type:ge.type,data:ge.inputSource}))}function me(){s.removeEventListener("select",he),s.removeEventListener("selectstart",he),s.removeEventListener("selectend",he),s.removeEventListener("squeeze",he),s.removeEventListener("squeezestart",he),s.removeEventListener("squeezeend",he),s.removeEventListener("end",me),s.removeEventListener("inputsourceschange",q);for(let ge=0;ge<L.length;ge++){const ze=G[ge];ze!==null&&(G[ge]=null,L[ge].disconnect(ze))}W=null,k=null,R.reset();for(const ge in M)delete M[ge];e.setRenderTarget(D),x=null,v=null,y=null,s=null,B=null,Ve.stop(),n.isPresenting=!1,e.setPixelRatio(F),e.setSize(H.width,H.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ge){r=ge,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ge){c=ge,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||o},this.setReferenceSpace=function(ge){p=ge},this.getBaseLayer=function(){return v!==null?v:x},this.getBinding=function(){return y},this.getFrame=function(){return b},this.getSession=function(){return s},this.setSession=async function(ge){if(s=ge,s!==null){if(D=e.getRenderTarget(),s.addEventListener("select",he),s.addEventListener("selectstart",he),s.addEventListener("selectend",he),s.addEventListener("squeeze",he),s.addEventListener("squeezestart",he),s.addEventListener("squeezeend",he),s.addEventListener("end",me),s.addEventListener("inputsourceschange",q),T.xrCompatible!==!0&&await t.makeXRCompatible(),F=e.getPixelRatio(),e.getSize(H),typeof XRWebGLBinding<"u"&&(y=new XRWebGLBinding(s,t)),y!==null&&"createProjectionLayer"in XRWebGLBinding.prototype){let Je=null,lt=null,At=null;T.depth&&(At=T.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Je=T.stencil?ig:ng,lt=T.stencil?tg:zu);const Et={colorFormat:t.RGBA8,depthFormat:At,scaleFactor:r};v=y.createProjectionLayer(Et),s.updateRenderState({layers:[v]}),e.setPixelRatio(1),e.setSize(v.textureWidth,v.textureHeight,!1),B=new Bc(v.textureWidth,v.textureHeight,{format:Lr,type:ko,depthTexture:new uC(v.textureWidth,v.textureHeight,lt,void 0,void 0,void 0,void 0,void 0,void 0,Je),stencilBuffer:T.stencil,colorSpace:e.outputColorSpace,samples:T.antialias?4:0,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}else{const Je={antialias:T.antialias,alpha:!0,depth:T.depth,stencil:T.stencil,framebufferScaleFactor:r};x=new XRWebGLLayer(s,t,Je),s.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),B=new Bc(x.framebufferWidth,x.framebufferHeight,{format:Lr,type:ko,colorSpace:e.outputColorSpace,stencilBuffer:T.stencil,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}B.isXRRenderTarget=!0,this.setFoveation(f),p=null,o=await s.requestReferenceSpace(c),Ve.setContext(s),Ve.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return R.getDepthTexture()};function q(ge){for(let ze=0;ze<ge.removed.length;ze++){const Je=ge.removed[ze],lt=G.indexOf(Je);lt>=0&&(G[lt]=null,L[lt].disconnect(Je))}for(let ze=0;ze<ge.added.length;ze++){const Je=ge.added[ze];let lt=G.indexOf(Je);if(lt===-1){for(let Et=0;Et<L.length;Et++)if(Et>=G.length){G.push(Je),lt=Et;break}else if(G[Et]===null){G[Et]=Je,lt=Et;break}if(lt===-1)break}const At=L[lt];At&&At.connect(Je)}}const ee=new $,ne=new $;function ye(ge,ze,Je){ee.setFromMatrixPosition(ze.matrixWorld),ne.setFromMatrixPosition(Je.matrixWorld);const lt=ee.distanceTo(ne),At=ze.projectionMatrix.elements,Et=Je.projectionMatrix.elements,Nt=At[14]/(At[10]-1),It=At[14]/(At[10]+1),se=(At[9]+1)/At[5],Ge=(At[9]-1)/At[5],He=(At[8]-1)/At[0],tt=(Et[8]+1)/Et[0],Fe=Nt*He,ut=Nt*tt,Qe=lt/(-He+tt),st=Qe*-He;if(ze.matrixWorld.decompose(ge.position,ge.quaternion,ge.scale),ge.translateX(st),ge.translateZ(Qe),ge.matrixWorld.compose(ge.position,ge.quaternion,ge.scale),ge.matrixWorldInverse.copy(ge.matrixWorld).invert(),At[10]===-1)ge.projectionMatrix.copy(ze.projectionMatrix),ge.projectionMatrixInverse.copy(ze.projectionMatrixInverse);else{const Ft=Nt+Qe,Gt=It+Qe,te=Fe-st,X=ut+(lt-st),xe=se*It/Gt*Ft,Re=Ge*It/Gt*Ft;ge.projectionMatrix.makePerspective(te,X,xe,Re,Ft,Gt),ge.projectionMatrixInverse.copy(ge.projectionMatrix).invert()}}function K(ge,ze){ze===null?ge.matrixWorld.copy(ge.matrix):ge.matrixWorld.multiplyMatrices(ze.matrixWorld,ge.matrix),ge.matrixWorldInverse.copy(ge.matrixWorld).invert()}this.updateCamera=function(ge){if(s===null)return;let ze=ge.near,Je=ge.far;R.texture!==null&&(R.depthNear>0&&(ze=R.depthNear),R.depthFar>0&&(Je=R.depthFar)),z.near=I.near=U.near=ze,z.far=I.far=U.far=Je,(W!==z.near||k!==z.far)&&(s.updateRenderState({depthNear:z.near,depthFar:z.far}),W=z.near,k=z.far),z.layers.mask=ge.layers.mask|6,U.layers.mask=z.layers.mask&3,I.layers.mask=z.layers.mask&5;const lt=ge.parent,At=z.cameras;K(z,lt);for(let Et=0;Et<At.length;Et++)K(At[Et],lt);At.length===2?ye(z,U,I):z.projectionMatrix.copy(U.projectionMatrix),ce(ge,z,lt)};function ce(ge,ze,Je){Je===null?ge.matrix.copy(ze.matrixWorld):(ge.matrix.copy(Je.matrixWorld),ge.matrix.invert(),ge.matrix.multiply(ze.matrixWorld)),ge.matrix.decompose(ge.position,ge.quaternion,ge.scale),ge.updateMatrixWorld(!0),ge.projectionMatrix.copy(ze.projectionMatrix),ge.projectionMatrixInverse.copy(ze.projectionMatrixInverse),ge.isPerspectiveCamera&&(ge.fov=og*2*Math.atan(1/ge.projectionMatrix.elements[5]),ge.zoom=1)}this.getCamera=function(){return z},this.getFoveation=function(){if(!(v===null&&x===null))return f},this.setFoveation=function(ge){f=ge,v!==null&&(v.fixedFoveation=ge),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=ge)},this.hasDepthSensing=function(){return R.texture!==null},this.getDepthSensingMesh=function(){return R.getMesh(z)},this.getCameraTexture=function(ge){return M[ge]};let Ee=null;function Me(ge,ze){if(m=ze.getViewerPose(p||o),b=ze,m!==null){const Je=m.views;x!==null&&(e.setRenderTargetFramebuffer(B,x.framebuffer),e.setRenderTarget(B));let lt=!1;Je.length!==z.cameras.length&&(z.cameras.length=0,lt=!0);for(let It=0;It<Je.length;It++){const se=Je[It];let Ge=null;if(x!==null)Ge=x.getViewport(se);else{const tt=y.getViewSubImage(v,se);Ge=tt.viewport,It===0&&(e.setRenderTargetTextures(B,tt.colorTexture,tt.depthStencilTexture),e.setRenderTarget(B))}let He=N[It];He===void 0&&(He=new Hi,He.layers.enable(It),He.viewport=new Qn,N[It]=He),He.matrix.fromArray(se.transform.matrix),He.matrix.decompose(He.position,He.quaternion,He.scale),He.projectionMatrix.fromArray(se.projectionMatrix),He.projectionMatrixInverse.copy(He.projectionMatrix).invert(),He.viewport.set(Ge.x,Ge.y,Ge.width,Ge.height),It===0&&(z.matrix.copy(He.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale)),lt===!0&&z.cameras.push(He)}const At=s.enabledFeatures;if(At&&At.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&y){const It=y.getDepthInformation(Je[0]);It&&It.isValid&&It.texture&&R.init(It,s.renderState)}if(At&&At.includes("camera-access")&&(e.state.unbindTexture(),y))for(let It=0;It<Je.length;It++){const se=Je[It].camera;if(se){let Ge=M[se];Ge||(Ge=new xU,M[se]=Ge);const He=y.getCameraImage(se);Ge.sourceTexture=He}}}for(let Je=0;Je<L.length;Je++){const lt=G[Je],At=L[Je];lt!==null&&At!==void 0&&At.update(lt,ze,p||o)}Ee&&Ee(ge,ze),ze.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:ze}),b=null}const Ve=new mU;Ve.setAnimationLoop(Me),this.setAnimationLoop=function(ge){Ee=ge},this.dispose=function(){}}}const xd=new ho,lY=new Jt;function cY(i,e){function t(M,T){M.matrixAutoUpdate===!0&&M.updateMatrix(),T.value.copy(M.matrix)}function n(M,T){T.color.getRGB(M.fogColor.value,AL(i)),T.isFog?(M.fogNear.value=T.near,M.fogFar.value=T.far):T.isFogExp2&&(M.fogDensity.value=T.density)}function s(M,T,D,B,L){T.isMeshBasicMaterial||T.isMeshLambertMaterial?r(M,T):T.isMeshToonMaterial?(r(M,T),y(M,T)):T.isMeshPhongMaterial?(r(M,T),m(M,T)):T.isMeshStandardMaterial?(r(M,T),v(M,T),T.isMeshPhysicalMaterial&&x(M,T,L)):T.isMeshMatcapMaterial?(r(M,T),b(M,T)):T.isMeshDepthMaterial?r(M,T):T.isMeshDistanceMaterial?(r(M,T),R(M,T)):T.isMeshNormalMaterial?r(M,T):T.isLineBasicMaterial?(o(M,T),T.isLineDashedMaterial&&c(M,T)):T.isPointsMaterial?f(M,T,D,B):T.isSpriteMaterial?p(M,T):T.isShadowMaterial?(M.color.value.copy(T.color),M.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function r(M,T){M.opacity.value=T.opacity,T.color&&M.diffuse.value.copy(T.color),T.emissive&&M.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(M.map.value=T.map,t(T.map,M.mapTransform)),T.alphaMap&&(M.alphaMap.value=T.alphaMap,t(T.alphaMap,M.alphaMapTransform)),T.bumpMap&&(M.bumpMap.value=T.bumpMap,t(T.bumpMap,M.bumpMapTransform),M.bumpScale.value=T.bumpScale,T.side===ua&&(M.bumpScale.value*=-1)),T.normalMap&&(M.normalMap.value=T.normalMap,t(T.normalMap,M.normalMapTransform),M.normalScale.value.copy(T.normalScale),T.side===ua&&M.normalScale.value.negate()),T.displacementMap&&(M.displacementMap.value=T.displacementMap,t(T.displacementMap,M.displacementMapTransform),M.displacementScale.value=T.displacementScale,M.displacementBias.value=T.displacementBias),T.emissiveMap&&(M.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,M.emissiveMapTransform)),T.specularMap&&(M.specularMap.value=T.specularMap,t(T.specularMap,M.specularMapTransform)),T.alphaTest>0&&(M.alphaTest.value=T.alphaTest);const D=e.get(T),B=D.envMap,L=D.envMapRotation;B&&(M.envMap.value=B,xd.copy(L),xd.x*=-1,xd.y*=-1,xd.z*=-1,B.isCubeTexture&&B.isRenderTargetTexture===!1&&(xd.y*=-1,xd.z*=-1),M.envMapRotation.value.setFromMatrix4(lY.makeRotationFromEuler(xd)),M.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=T.reflectivity,M.ior.value=T.ior,M.refractionRatio.value=T.refractionRatio),T.lightMap&&(M.lightMap.value=T.lightMap,M.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,M.lightMapTransform)),T.aoMap&&(M.aoMap.value=T.aoMap,M.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,M.aoMapTransform))}function o(M,T){M.diffuse.value.copy(T.color),M.opacity.value=T.opacity,T.map&&(M.map.value=T.map,t(T.map,M.mapTransform))}function c(M,T){M.dashSize.value=T.dashSize,M.totalSize.value=T.dashSize+T.gapSize,M.scale.value=T.scale}function f(M,T,D,B){M.diffuse.value.copy(T.color),M.opacity.value=T.opacity,M.size.value=T.size*D,M.scale.value=B*.5,T.map&&(M.map.value=T.map,t(T.map,M.uvTransform)),T.alphaMap&&(M.alphaMap.value=T.alphaMap,t(T.alphaMap,M.alphaMapTransform)),T.alphaTest>0&&(M.alphaTest.value=T.alphaTest)}function p(M,T){M.diffuse.value.copy(T.color),M.opacity.value=T.opacity,M.rotation.value=T.rotation,T.map&&(M.map.value=T.map,t(T.map,M.mapTransform)),T.alphaMap&&(M.alphaMap.value=T.alphaMap,t(T.alphaMap,M.alphaMapTransform)),T.alphaTest>0&&(M.alphaTest.value=T.alphaTest)}function m(M,T){M.specular.value.copy(T.specular),M.shininess.value=Math.max(T.shininess,1e-4)}function y(M,T){T.gradientMap&&(M.gradientMap.value=T.gradientMap)}function v(M,T){M.metalness.value=T.metalness,T.metalnessMap&&(M.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,M.metalnessMapTransform)),M.roughness.value=T.roughness,T.roughnessMap&&(M.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,M.roughnessMapTransform)),T.envMap&&(M.envMapIntensity.value=T.envMapIntensity)}function x(M,T,D){M.ior.value=T.ior,T.sheen>0&&(M.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),M.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(M.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,M.sheenColorMapTransform)),T.sheenRoughnessMap&&(M.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,M.sheenRoughnessMapTransform))),T.clearcoat>0&&(M.clearcoat.value=T.clearcoat,M.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(M.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,M.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(M.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===ua&&M.clearcoatNormalScale.value.negate())),T.dispersion>0&&(M.dispersion.value=T.dispersion),T.iridescence>0&&(M.iridescence.value=T.iridescence,M.iridescenceIOR.value=T.iridescenceIOR,M.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(M.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,M.iridescenceMapTransform)),T.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),T.transmission>0&&(M.transmission.value=T.transmission,M.transmissionSamplerMap.value=D.texture,M.transmissionSamplerSize.value.set(D.width,D.height),T.transmissionMap&&(M.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,M.transmissionMapTransform)),M.thickness.value=T.thickness,T.thicknessMap&&(M.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=T.attenuationDistance,M.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(M.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(M.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=T.specularIntensity,M.specularColor.value.copy(T.specularColor),T.specularColorMap&&(M.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,M.specularColorMapTransform)),T.specularIntensityMap&&(M.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,M.specularIntensityMapTransform))}function b(M,T){T.matcap&&(M.matcap.value=T.matcap)}function R(M,T){const D=e.get(T).light;M.referencePosition.value.setFromMatrixPosition(D.matrixWorld),M.nearDistance.value=D.shadow.camera.near,M.farDistance.value=D.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function uY(i,e,t,n){let s={},r={},o=[];const c=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function f(D,B){const L=B.program;n.uniformBlockBinding(D,L)}function p(D,B){let L=s[D.id];L===void 0&&(b(D),L=m(D),s[D.id]=L,D.addEventListener("dispose",M));const G=B.program;n.updateUBOMapping(D,G);const H=e.render.frame;r[D.id]!==H&&(v(D),r[D.id]=H)}function m(D){const B=y();D.__bindingPointIndex=B;const L=i.createBuffer(),G=D.__size,H=D.usage;return i.bindBuffer(i.UNIFORM_BUFFER,L),i.bufferData(i.UNIFORM_BUFFER,G,H),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,B,L),L}function y(){for(let D=0;D<c;D++)if(o.indexOf(D)===-1)return o.push(D),D;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function v(D){const B=s[D.id],L=D.uniforms,G=D.__cache;i.bindBuffer(i.UNIFORM_BUFFER,B);for(let H=0,F=L.length;H<F;H++){const U=Array.isArray(L[H])?L[H]:[L[H]];for(let I=0,N=U.length;I<N;I++){const z=U[I];if(x(z,H,I,G)===!0){const W=z.__offset,k=Array.isArray(z.value)?z.value:[z.value];let he=0;for(let me=0;me<k.length;me++){const q=k[me],ee=R(q);typeof q=="number"||typeof q=="boolean"?(z.__data[0]=q,i.bufferSubData(i.UNIFORM_BUFFER,W+he,z.__data)):q.isMatrix3?(z.__data[0]=q.elements[0],z.__data[1]=q.elements[1],z.__data[2]=q.elements[2],z.__data[3]=0,z.__data[4]=q.elements[3],z.__data[5]=q.elements[4],z.__data[6]=q.elements[5],z.__data[7]=0,z.__data[8]=q.elements[6],z.__data[9]=q.elements[7],z.__data[10]=q.elements[8],z.__data[11]=0):(q.toArray(z.__data,he),he+=ee.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,W,z.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function x(D,B,L,G){const H=D.value,F=B+"_"+L;if(G[F]===void 0)return typeof H=="number"||typeof H=="boolean"?G[F]=H:G[F]=H.clone(),!0;{const U=G[F];if(typeof H=="number"||typeof H=="boolean"){if(U!==H)return G[F]=H,!0}else if(U.equals(H)===!1)return U.copy(H),!0}return!1}function b(D){const B=D.uniforms;let L=0;const G=16;for(let F=0,U=B.length;F<U;F++){const I=Array.isArray(B[F])?B[F]:[B[F]];for(let N=0,z=I.length;N<z;N++){const W=I[N],k=Array.isArray(W.value)?W.value:[W.value];for(let he=0,me=k.length;he<me;he++){const q=k[he],ee=R(q),ne=L%G,ye=ne%ee.boundary,K=ne+ye;L+=ye,K!==0&&G-K<ee.storage&&(L+=G-K),W.__data=new Float32Array(ee.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=L,L+=ee.storage}}}const H=L%G;return H>0&&(L+=G-H),D.__size=L,D.__cache={},this}function R(D){const B={boundary:0,storage:0};return typeof D=="number"||typeof D=="boolean"?(B.boundary=4,B.storage=4):D.isVector2?(B.boundary=8,B.storage=8):D.isVector3||D.isColor?(B.boundary=16,B.storage=12):D.isVector4?(B.boundary=16,B.storage=16):D.isMatrix3?(B.boundary=48,B.storage=48):D.isMatrix4?(B.boundary=64,B.storage=64):D.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",D),B}function M(D){const B=D.target;B.removeEventListener("dispose",M);const L=o.indexOf(B.__bindingPointIndex);o.splice(L,1),i.deleteBuffer(s[B.id]),delete s[B.id],delete r[B.id]}function T(){for(const D in s)i.deleteBuffer(s[D]);o=[],s={},r={}}return{bind:f,update:p,dispose:T}}class SU{constructor(e={}){const{canvas:t=yL(),context:n=null,depth:s=!0,stencil:r=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:p=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:y=!1,reversedDepthBuffer:v=!1}=e;this.isWebGLRenderer=!0;let x;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");x=n.getContextAttributes().alpha}else x=o;const b=new Uint32Array(4),R=new Int32Array(4);let M=null,T=null;const D=[],B=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Cc,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let G=!1;this._outputColorSpace=Nr;let H=0,F=0,U=null,I=-1,N=null;const z=new Qn,W=new Qn;let k=null;const he=new St(0);let me=0,q=t.width,ee=t.height,ne=1,ye=null,K=null;const ce=new Qn(0,0,q,ee),Ee=new Qn(0,0,q,ee);let Me=!1;const Ve=new bg;let ge=!1,ze=!1;const Je=new Jt,lt=new $,At=new Qn,Et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Nt=!1;function It(){return U===null?ne:1}let se=n;function Ge(J,de){return t.getContext(J,de)}try{const J={alpha:!0,depth:s,stencil:r,antialias:c,premultipliedAlpha:f,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Q_}`),t.addEventListener("webglcontextlost",nt,!1),t.addEventListener("webglcontextrestored",yt,!1),t.addEventListener("webglcontextcreationerror",it,!1),se===null){const de="webgl2";if(se=Ge(de,J),se===null)throw Ge(de)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(J){throw console.error("THREE.WebGLRenderer: "+J.message),J}let He,tt,Fe,ut,Qe,st,Ft,Gt,te,X,xe,Re,Ue,Le,_t,ht,wt,Mt,et,ft,Dt,re,Te,rt;function oe(){He=new SX(se),He.init(),re=new AU(se,He),tt=new mX(se,He,e,re),Fe=new nY(se,He),tt.reversedDepthBuffer&&v&&Fe.buffers.depth.setReversed(!0),ut=new TX(se),Qe=new GW,st=new iY(se,He,Fe,Qe,tt,re,ut),Ft=new yX(L),Gt=new xX(L),te=new I7(se),Te=new dX(se,te),X=new EX(se,te,ut,Te),xe=new CX(se,X,te,ut),et=new MX(se,tt,st),ht=new gX(Qe),Re=new kW(L,Ft,Gt,He,tt,Te,ht),Ue=new cY(L,Qe),Le=new qW,_t=new QW(He),Mt=new fX(L,Ft,Gt,Fe,xe,x,f),wt=new eY(L,xe,tt),rt=new uY(se,ut,tt,Fe),ft=new pX(se,He,ut),Dt=new bX(se,He,ut),ut.programs=Re.programs,L.capabilities=tt,L.extensions=He,L.properties=Qe,L.renderLists=Le,L.shadowMap=wt,L.state=Fe,L.info=ut}oe();const Ke=new oY(L,se);this.xr=Ke,this.getContext=function(){return se},this.getContextAttributes=function(){return se.getContextAttributes()},this.forceContextLoss=function(){const J=He.get("WEBGL_lose_context");J&&J.loseContext()},this.forceContextRestore=function(){const J=He.get("WEBGL_lose_context");J&&J.restoreContext()},this.getPixelRatio=function(){return ne},this.setPixelRatio=function(J){J!==void 0&&(ne=J,this.setSize(q,ee,!1))},this.getSize=function(J){return J.set(q,ee)},this.setSize=function(J,de,be=!0){if(Ke.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}q=J,ee=de,t.width=Math.floor(J*ne),t.height=Math.floor(de*ne),be===!0&&(t.style.width=J+"px",t.style.height=de+"px"),this.setViewport(0,0,J,de)},this.getDrawingBufferSize=function(J){return J.set(q*ne,ee*ne).floor()},this.setDrawingBufferSize=function(J,de,be){q=J,ee=de,ne=be,t.width=Math.floor(J*be),t.height=Math.floor(de*be),this.setViewport(0,0,J,de)},this.getCurrentViewport=function(J){return J.copy(z)},this.getViewport=function(J){return J.copy(ce)},this.setViewport=function(J,de,be,Be){J.isVector4?ce.set(J.x,J.y,J.z,J.w):ce.set(J,de,be,Be),Fe.viewport(z.copy(ce).multiplyScalar(ne).round())},this.getScissor=function(J){return J.copy(Ee)},this.setScissor=function(J,de,be,Be){J.isVector4?Ee.set(J.x,J.y,J.z,J.w):Ee.set(J,de,be,Be),Fe.scissor(W.copy(Ee).multiplyScalar(ne).round())},this.getScissorTest=function(){return Me},this.setScissorTest=function(J){Fe.setScissorTest(Me=J)},this.setOpaqueSort=function(J){ye=J},this.setTransparentSort=function(J){K=J},this.getClearColor=function(J){return J.copy(Mt.getClearColor())},this.setClearColor=function(){Mt.setClearColor(...arguments)},this.getClearAlpha=function(){return Mt.getClearAlpha()},this.setClearAlpha=function(){Mt.setClearAlpha(...arguments)},this.clear=function(J=!0,de=!0,be=!0){let Be=0;if(J){let _e=!1;if(U!==null){const at=U.texture.format;_e=at===jS||at===GS||at===$_}if(_e){const at=U.texture.type,dt=at===ko||at===zu||at===eg||at===tg||at===VS||at===HS,xt=Mt.getClearColor(),mt=Mt.getClearAlpha(),zt=xt.r,jt=xt.g,Lt=xt.b;dt?(b[0]=zt,b[1]=jt,b[2]=Lt,b[3]=mt,se.clearBufferuiv(se.COLOR,0,b)):(R[0]=zt,R[1]=jt,R[2]=Lt,R[3]=mt,se.clearBufferiv(se.COLOR,0,R))}else Be|=se.COLOR_BUFFER_BIT}de&&(Be|=se.DEPTH_BUFFER_BIT),be&&(Be|=se.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),se.clear(Be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",nt,!1),t.removeEventListener("webglcontextrestored",yt,!1),t.removeEventListener("webglcontextcreationerror",it,!1),Mt.dispose(),Le.dispose(),_t.dispose(),Qe.dispose(),Ft.dispose(),Gt.dispose(),xe.dispose(),Te.dispose(),rt.dispose(),Re.dispose(),Ke.dispose(),Ke.removeEventListener("sessionstart",_n),Ke.removeEventListener("sessionend",Ci),$n.stop()};function nt(J){J.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),G=!0}function yt(){console.log("THREE.WebGLRenderer: Context Restored."),G=!1;const J=ut.autoReset,de=wt.enabled,be=wt.autoUpdate,Be=wt.needsUpdate,_e=wt.type;oe(),ut.autoReset=J,wt.enabled=de,wt.autoUpdate=be,wt.needsUpdate=Be,wt.type=_e}function it(J){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",J.statusMessage)}function ke(J){const de=J.target;de.removeEventListener("dispose",ke),vt(de)}function vt(J){Ot(J),Qe.remove(J)}function Ot(J){const de=Qe.get(J).programs;de!==void 0&&(de.forEach(function(be){Re.releaseProgram(be)}),J.isShaderMaterial&&Re.releaseShaderCache(J))}this.renderBufferDirect=function(J,de,be,Be,_e,at){de===null&&(de=Et);const dt=_e.isMesh&&_e.matrixWorld.determinant()<0,xt=yr(J,de,be,Be,_e);Fe.setMaterial(Be,dt);let mt=be.index,zt=1;if(Be.wireframe===!0){if(mt=X.getWireframeAttribute(be),mt===void 0)return;zt=2}const jt=be.drawRange,Lt=be.attributes.position;let ln=jt.start*zt,wn=(jt.start+jt.count)*zt;at!==null&&(ln=Math.max(ln,at.start*zt),wn=Math.min(wn,(at.start+at.count)*zt)),mt!==null?(ln=Math.max(ln,0),wn=Math.min(wn,mt.count)):Lt!=null&&(ln=Math.max(ln,0),wn=Math.min(wn,Lt.count));const si=wn-ln;if(si<0||si===1/0)return;Te.setup(_e,Be,xt,be,mt);let Vn,an=ft;if(mt!==null&&(Vn=te.get(mt),an=Dt,an.setIndex(Vn)),_e.isMesh)Be.wireframe===!0?(Fe.setLineWidth(Be.wireframeLinewidth*It()),an.setMode(se.LINES)):an.setMode(se.TRIANGLES);else if(_e.isLine){let Vt=Be.linewidth;Vt===void 0&&(Vt=1),Fe.setLineWidth(Vt*It()),_e.isLineSegments?an.setMode(se.LINES):_e.isLineLoop?an.setMode(se.LINE_LOOP):an.setMode(se.LINE_STRIP)}else _e.isPoints?an.setMode(se.POINTS):_e.isSprite&&an.setMode(se.TRIANGLES);if(_e.isBatchedMesh)if(_e._multiDrawInstances!==null)Hm("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),an.renderMultiDrawInstances(_e._multiDrawStarts,_e._multiDrawCounts,_e._multiDrawCount,_e._multiDrawInstances);else if(He.get("WEBGL_multi_draw"))an.renderMultiDraw(_e._multiDrawStarts,_e._multiDrawCounts,_e._multiDrawCount);else{const Vt=_e._multiDrawStarts,li=_e._multiDrawCounts,xn=_e._multiDrawCount,is=mt?te.get(mt).bytesPerElement:1,ir=Qe.get(Be).currentProgram.getUniforms();for(let us=0;us<xn;us++)ir.setValue(se,"_gl_DrawID",us),an.render(Vt[us]/is,li[us])}else if(_e.isInstancedMesh)an.renderInstances(ln,si,_e.count);else if(be.isInstancedBufferGeometry){const Vt=be._maxInstanceCount!==void 0?be._maxInstanceCount:1/0,li=Math.min(be.instanceCount,Vt);an.renderInstances(ln,si,li)}else an.render(ln,si)};function cn(J,de,be){J.transparent===!0&&J.side===Fo&&J.forceSinglePass===!1?(J.side=ua,J.needsUpdate=!0,nr(J,de,be),J.side=Ic,J.needsUpdate=!0,nr(J,de,be),J.side=Fo):nr(J,de,be)}this.compile=function(J,de,be=null){be===null&&(be=J),T=_t.get(be),T.init(de),B.push(T),be.traverseVisible(function(_e){_e.isLight&&_e.layers.test(de.layers)&&(T.pushLight(_e),_e.castShadow&&T.pushShadow(_e))}),J!==be&&J.traverseVisible(function(_e){_e.isLight&&_e.layers.test(de.layers)&&(T.pushLight(_e),_e.castShadow&&T.pushShadow(_e))}),T.setupLights();const Be=new Set;return J.traverse(function(_e){if(!(_e.isMesh||_e.isPoints||_e.isLine||_e.isSprite))return;const at=_e.material;if(at)if(Array.isArray(at))for(let dt=0;dt<at.length;dt++){const xt=at[dt];cn(xt,be,_e),Be.add(xt)}else cn(at,be,_e),Be.add(at)}),T=B.pop(),Be},this.compileAsync=function(J,de,be=null){const Be=this.compile(J,de,be);return new Promise(_e=>{function at(){if(Be.forEach(function(dt){Qe.get(dt).currentProgram.isReady()&&Be.delete(dt)}),Be.size===0){_e(J);return}setTimeout(at,10)}He.get("KHR_parallel_shader_compile")!==null?at():setTimeout(at,10)})};let Zt=null;function Gi(J){Zt&&Zt(J)}function _n(){$n.stop()}function Ci(){$n.start()}const $n=new mU;$n.setAnimationLoop(Gi),typeof self<"u"&&$n.setContext(self),this.setAnimationLoop=function(J){Zt=J,Ke.setAnimationLoop(J),J===null?$n.stop():$n.start()},Ke.addEventListener("sessionstart",_n),Ke.addEventListener("sessionend",Ci),this.render=function(J,de){if(de!==void 0&&de.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(G===!0)return;if(J.matrixWorldAutoUpdate===!0&&J.updateMatrixWorld(),de.parent===null&&de.matrixWorldAutoUpdate===!0&&de.updateMatrixWorld(),Ke.enabled===!0&&Ke.isPresenting===!0&&(Ke.cameraAutoUpdate===!0&&Ke.updateCamera(de),de=Ke.getCamera()),J.isScene===!0&&J.onBeforeRender(L,J,de,U),T=_t.get(J,B.length),T.init(de),B.push(T),Je.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse),Ve.setFromProjectionMatrix(Je,lo,de.reversedDepth),ze=this.localClippingEnabled,ge=ht.init(this.clippingPlanes,ze),M=Le.get(J,D.length),M.init(),D.push(M),Ke.enabled===!0&&Ke.isPresenting===!0){const at=L.xr.getDepthSensingMesh();at!==null&&As(at,de,-1/0,L.sortObjects)}As(J,de,0,L.sortObjects),M.finish(),L.sortObjects===!0&&M.sort(ye,K),Nt=Ke.enabled===!1||Ke.isPresenting===!1||Ke.hasDepthSensing()===!1,Nt&&Mt.addToRenderList(M,J),this.info.render.frame++,ge===!0&&ht.beginShadows();const be=T.state.shadowsArray;wt.render(be,J,de),ge===!0&&ht.endShadows(),this.info.autoReset===!0&&this.info.reset();const Be=M.opaque,_e=M.transmissive;if(T.setupLights(),de.isArrayCamera){const at=de.cameras;if(_e.length>0)for(let dt=0,xt=at.length;dt<xt;dt++){const mt=at[dt];Lc(Be,_e,J,mt)}Nt&&Mt.render(J);for(let dt=0,xt=at.length;dt<xt;dt++){const mt=at[dt];er(M,J,mt,mt.viewport)}}else _e.length>0&&Lc(Be,_e,J,de),Nt&&Mt.render(J),er(M,J,de);U!==null&&F===0&&(st.updateMultisampleRenderTarget(U),st.updateRenderTargetMipmap(U)),J.isScene===!0&&J.onAfterRender(L,J,de),Te.resetDefaultState(),I=-1,N=null,B.pop(),B.length>0?(T=B[B.length-1],ge===!0&&ht.setGlobalState(L.clippingPlanes,T.state.camera)):T=null,D.pop(),D.length>0?M=D[D.length-1]:M=null};function As(J,de,be,Be){if(J.visible===!1)return;if(J.layers.test(de.layers)){if(J.isGroup)be=J.renderOrder;else if(J.isLOD)J.autoUpdate===!0&&J.update(de);else if(J.isLight)T.pushLight(J),J.castShadow&&T.pushShadow(J);else if(J.isSprite){if(!J.frustumCulled||Ve.intersectsSprite(J)){Be&&At.setFromMatrixPosition(J.matrixWorld).applyMatrix4(Je);const dt=xe.update(J),xt=J.material;xt.visible&&M.push(J,dt,xt,be,At.z,null)}}else if((J.isMesh||J.isLine||J.isPoints)&&(!J.frustumCulled||Ve.intersectsObject(J))){const dt=xe.update(J),xt=J.material;if(Be&&(J.boundingSphere!==void 0?(J.boundingSphere===null&&J.computeBoundingSphere(),At.copy(J.boundingSphere.center)):(dt.boundingSphere===null&&dt.computeBoundingSphere(),At.copy(dt.boundingSphere.center)),At.applyMatrix4(J.matrixWorld).applyMatrix4(Je)),Array.isArray(xt)){const mt=dt.groups;for(let zt=0,jt=mt.length;zt<jt;zt++){const Lt=mt[zt],ln=xt[Lt.materialIndex];ln&&ln.visible&&M.push(J,dt,ln,be,At.z,Lt)}}else xt.visible&&M.push(J,dt,xt,be,At.z,null)}}const at=J.children;for(let dt=0,xt=at.length;dt<xt;dt++)As(at[dt],de,be,Be)}function er(J,de,be,Be){const _e=J.opaque,at=J.transmissive,dt=J.transparent;T.setupLightsView(be),ge===!0&&ht.setGlobalState(L.clippingPlanes,be),Be&&Fe.viewport(z.copy(Be)),_e.length>0&&ns(_e,de,be),at.length>0&&ns(at,de,be),dt.length>0&&ns(dt,de,be),Fe.buffers.depth.setTest(!0),Fe.buffers.depth.setMask(!0),Fe.buffers.color.setMask(!0),Fe.setPolygonOffset(!1)}function Lc(J,de,be,Be){if((be.isScene===!0?be.overrideMaterial:null)!==null)return;T.state.transmissionRenderTarget[Be.id]===void 0&&(T.state.transmissionRenderTarget[Be.id]=new Bc(1,1,{generateMipmaps:!0,type:He.has("EXT_color_buffer_half_float")||He.has("EXT_color_buffer_float")?Eg:ko,minFilter:zo,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Gn.workingColorSpace}));const at=T.state.transmissionRenderTarget[Be.id],dt=Be.viewport||z;at.setSize(dt.z*L.transmissionResolutionScale,dt.w*L.transmissionResolutionScale);const xt=L.getRenderTarget(),mt=L.getActiveCubeFace(),zt=L.getActiveMipmapLevel();L.setRenderTarget(at),L.getClearColor(he),me=L.getClearAlpha(),me<1&&L.setClearColor(16777215,.5),L.clear(),Nt&&Mt.render(be);const jt=L.toneMapping;L.toneMapping=Cc;const Lt=Be.viewport;if(Be.viewport!==void 0&&(Be.viewport=void 0),T.setupLightsView(Be),ge===!0&&ht.setGlobalState(L.clippingPlanes,Be),ns(J,be,Be),st.updateMultisampleRenderTarget(at),st.updateRenderTargetMipmap(at),He.has("WEBGL_multisampled_render_to_texture")===!1){let ln=!1;for(let wn=0,si=de.length;wn<si;wn++){const Vn=de[wn],an=Vn.object,Vt=Vn.geometry,li=Vn.material,xn=Vn.group;if(li.side===Fo&&an.layers.test(Be.layers)){const is=li.side;li.side=ua,li.needsUpdate=!0,tr(an,be,Be,Vt,li,xn),li.side=is,li.needsUpdate=!0,ln=!0}}ln===!0&&(st.updateMultisampleRenderTarget(at),st.updateRenderTargetMipmap(at))}L.setRenderTarget(xt,mt,zt),L.setClearColor(he,me),Lt!==void 0&&(Be.viewport=Lt),L.toneMapping=jt}function ns(J,de,be){const Be=de.isScene===!0?de.overrideMaterial:null;for(let _e=0,at=J.length;_e<at;_e++){const dt=J[_e],xt=dt.object,mt=dt.geometry,zt=dt.group;let jt=dt.material;jt.allowOverride===!0&&Be!==null&&(jt=Be),xt.layers.test(be.layers)&&tr(xt,de,be,mt,jt,zt)}}function tr(J,de,be,Be,_e,at){J.onBeforeRender(L,de,be,Be,_e,at),J.modelViewMatrix.multiplyMatrices(be.matrixWorldInverse,J.matrixWorld),J.normalMatrix.getNormalMatrix(J.modelViewMatrix),_e.onBeforeRender(L,de,be,Be,J,at),_e.transparent===!0&&_e.side===Fo&&_e.forceSinglePass===!1?(_e.side=ua,_e.needsUpdate=!0,L.renderBufferDirect(be,de,Be,_e,J,at),_e.side=Ic,_e.needsUpdate=!0,L.renderBufferDirect(be,de,Be,_e,J,at),_e.side=Fo):L.renderBufferDirect(be,de,Be,_e,J,at),J.onAfterRender(L,de,be,Be,_e,at)}function nr(J,de,be){de.isScene!==!0&&(de=Et);const Be=Qe.get(J),_e=T.state.lights,at=T.state.shadowsArray,dt=_e.state.version,xt=Re.getParameters(J,_e.state,at,de,be),mt=Re.getProgramCacheKey(xt);let zt=Be.programs;Be.environment=J.isMeshStandardMaterial?de.environment:null,Be.fog=de.fog,Be.envMap=(J.isMeshStandardMaterial?Gt:Ft).get(J.envMap||Be.environment),Be.envMapRotation=Be.environment!==null&&J.envMap===null?de.environmentRotation:J.envMapRotation,zt===void 0&&(J.addEventListener("dispose",ke),zt=new Map,Be.programs=zt);let jt=zt.get(mt);if(jt!==void 0){if(Be.currentProgram===jt&&Be.lightsStateVersion===dt)return gr(J,xt),jt}else xt.uniforms=Re.getUniforms(J),J.onBeforeCompile(xt,L),jt=Re.acquireProgram(xt,mt),zt.set(mt,jt),Be.uniforms=xt.uniforms;const Lt=Be.uniforms;return(!J.isShaderMaterial&&!J.isRawShaderMaterial||J.clipping===!0)&&(Lt.clippingPlanes=ht.uniform),gr(J,xt),Be.needsLights=xs(J),Be.lightsStateVersion=dt,Be.needsLights&&(Lt.ambientLightColor.value=_e.state.ambient,Lt.lightProbe.value=_e.state.probe,Lt.directionalLights.value=_e.state.directional,Lt.directionalLightShadows.value=_e.state.directionalShadow,Lt.spotLights.value=_e.state.spot,Lt.spotLightShadows.value=_e.state.spotShadow,Lt.rectAreaLights.value=_e.state.rectArea,Lt.ltc_1.value=_e.state.rectAreaLTC1,Lt.ltc_2.value=_e.state.rectAreaLTC2,Lt.pointLights.value=_e.state.point,Lt.pointLightShadows.value=_e.state.pointShadow,Lt.hemisphereLights.value=_e.state.hemi,Lt.directionalShadowMap.value=_e.state.directionalShadowMap,Lt.directionalShadowMatrix.value=_e.state.directionalShadowMatrix,Lt.spotShadowMap.value=_e.state.spotShadowMap,Lt.spotLightMatrix.value=_e.state.spotLightMatrix,Lt.spotLightMap.value=_e.state.spotLightMap,Lt.pointShadowMap.value=_e.state.pointShadowMap,Lt.pointShadowMatrix.value=_e.state.pointShadowMatrix),Be.currentProgram=jt,Be.uniformsList=null,jt}function Kn(J){if(J.uniformsList===null){const de=J.currentProgram.getUniforms();J.uniformsList=qA.seqWithValue(de.seq,J.uniforms)}return J.uniformsList}function gr(J,de){const be=Qe.get(J);be.outputColorSpace=de.outputColorSpace,be.batching=de.batching,be.batchingColor=de.batchingColor,be.instancing=de.instancing,be.instancingColor=de.instancingColor,be.instancingMorph=de.instancingMorph,be.skinning=de.skinning,be.morphTargets=de.morphTargets,be.morphNormals=de.morphNormals,be.morphColors=de.morphColors,be.morphTargetsCount=de.morphTargetsCount,be.numClippingPlanes=de.numClippingPlanes,be.numIntersection=de.numClipIntersection,be.vertexAlphas=de.vertexAlphas,be.vertexTangents=de.vertexTangents,be.toneMapping=de.toneMapping}function yr(J,de,be,Be,_e){de.isScene!==!0&&(de=Et),st.resetTextureUnits();const at=de.fog,dt=Be.isMeshStandardMaterial?de.environment:null,xt=U===null?L.outputColorSpace:U.isXRRenderTarget===!0?U.texture.colorSpace:ff,mt=(Be.isMeshStandardMaterial?Gt:Ft).get(Be.envMap||dt),zt=Be.vertexColors===!0&&!!be.attributes.color&&be.attributes.color.itemSize===4,jt=!!be.attributes.tangent&&(!!Be.normalMap||Be.anisotropy>0),Lt=!!be.morphAttributes.position,ln=!!be.morphAttributes.normal,wn=!!be.morphAttributes.color;let si=Cc;Be.toneMapped&&(U===null||U.isXRRenderTarget===!0)&&(si=L.toneMapping);const Vn=be.morphAttributes.position||be.morphAttributes.normal||be.morphAttributes.color,an=Vn!==void 0?Vn.length:0,Vt=Qe.get(Be),li=T.state.lights;if(ge===!0&&(ze===!0||J!==N)){const mi=J===N&&Be.id===I;ht.setState(Be,J,mi)}let xn=!1;Be.version===Vt.__version?(Vt.needsLights&&Vt.lightsStateVersion!==li.state.version||Vt.outputColorSpace!==xt||_e.isBatchedMesh&&Vt.batching===!1||!_e.isBatchedMesh&&Vt.batching===!0||_e.isBatchedMesh&&Vt.batchingColor===!0&&_e.colorTexture===null||_e.isBatchedMesh&&Vt.batchingColor===!1&&_e.colorTexture!==null||_e.isInstancedMesh&&Vt.instancing===!1||!_e.isInstancedMesh&&Vt.instancing===!0||_e.isSkinnedMesh&&Vt.skinning===!1||!_e.isSkinnedMesh&&Vt.skinning===!0||_e.isInstancedMesh&&Vt.instancingColor===!0&&_e.instanceColor===null||_e.isInstancedMesh&&Vt.instancingColor===!1&&_e.instanceColor!==null||_e.isInstancedMesh&&Vt.instancingMorph===!0&&_e.morphTexture===null||_e.isInstancedMesh&&Vt.instancingMorph===!1&&_e.morphTexture!==null||Vt.envMap!==mt||Be.fog===!0&&Vt.fog!==at||Vt.numClippingPlanes!==void 0&&(Vt.numClippingPlanes!==ht.numPlanes||Vt.numIntersection!==ht.numIntersection)||Vt.vertexAlphas!==zt||Vt.vertexTangents!==jt||Vt.morphTargets!==Lt||Vt.morphNormals!==ln||Vt.morphColors!==wn||Vt.toneMapping!==si||Vt.morphTargetsCount!==an)&&(xn=!0):(xn=!0,Vt.__version=Be.version);let is=Vt.currentProgram;xn===!0&&(is=nr(Be,de,_e));let ir=!1,us=!1,ci=!1;const Mn=is.getUniforms(),ji=Vt.uniforms;if(Fe.useProgram(is.program)&&(ir=!0,us=!0,ci=!0),Be.id!==I&&(I=Be.id,us=!0),ir||N!==J){Fe.buffers.depth.getReversed()&&J.reversedDepth!==!0&&(J._reversedDepth=!0,J.updateProjectionMatrix()),Mn.setValue(se,"projectionMatrix",J.projectionMatrix),Mn.setValue(se,"viewMatrix",J.matrixWorldInverse);const un=Mn.map.cameraPosition;un!==void 0&&un.setValue(se,lt.setFromMatrixPosition(J.matrixWorld)),tt.logarithmicDepthBuffer&&Mn.setValue(se,"logDepthBufFC",2/(Math.log(J.far+1)/Math.LN2)),(Be.isMeshPhongMaterial||Be.isMeshToonMaterial||Be.isMeshLambertMaterial||Be.isMeshBasicMaterial||Be.isMeshStandardMaterial||Be.isShaderMaterial)&&Mn.setValue(se,"isOrthographic",J.isOrthographicCamera===!0),N!==J&&(N=J,us=!0,ci=!0)}if(_e.isSkinnedMesh){Mn.setOptional(se,_e,"bindMatrix"),Mn.setOptional(se,_e,"bindMatrixInverse");const mi=_e.skeleton;mi&&(mi.boneTexture===null&&mi.computeBoneTexture(),Mn.setValue(se,"boneTexture",mi.boneTexture,st))}_e.isBatchedMesh&&(Mn.setOptional(se,_e,"batchingTexture"),Mn.setValue(se,"batchingTexture",_e._matricesTexture,st),Mn.setOptional(se,_e,"batchingIdTexture"),Mn.setValue(se,"batchingIdTexture",_e._indirectTexture,st),Mn.setOptional(se,_e,"batchingColorTexture"),_e._colorsTexture!==null&&Mn.setValue(se,"batchingColorTexture",_e._colorsTexture,st));const Li=be.morphAttributes;if((Li.position!==void 0||Li.normal!==void 0||Li.color!==void 0)&&et.update(_e,be,is),(us||Vt.receiveShadow!==_e.receiveShadow)&&(Vt.receiveShadow=_e.receiveShadow,Mn.setValue(se,"receiveShadow",_e.receiveShadow)),Be.isMeshGouraudMaterial&&Be.envMap!==null&&(ji.envMap.value=mt,ji.flipEnvMap.value=mt.isCubeTexture&&mt.isRenderTargetTexture===!1?-1:1),Be.isMeshStandardMaterial&&Be.envMap===null&&de.environment!==null&&(ji.envMapIntensity.value=de.environmentIntensity),us&&(Mn.setValue(se,"toneMappingExposure",L.toneMappingExposure),Vt.needsLights&&zr(ji,ci),at&&Be.fog===!0&&Ue.refreshFogUniforms(ji,at),Ue.refreshMaterialUniforms(ji,Be,ne,ee,T.state.transmissionRenderTarget[J.id]),qA.upload(se,Kn(Vt),ji,st)),Be.isShaderMaterial&&Be.uniformsNeedUpdate===!0&&(qA.upload(se,Kn(Vt),ji,st),Be.uniformsNeedUpdate=!1),Be.isSpriteMaterial&&Mn.setValue(se,"center",_e.center),Mn.setValue(se,"modelViewMatrix",_e.modelViewMatrix),Mn.setValue(se,"normalMatrix",_e.normalMatrix),Mn.setValue(se,"modelMatrix",_e.matrixWorld),Be.isShaderMaterial||Be.isRawShaderMaterial){const mi=Be.uniformsGroups;for(let un=0,ha=mi.length;un<ha;un++){const Si=mi[un];rt.update(Si,is),rt.bind(Si,is)}}return is}function zr(J,de){J.ambientLightColor.needsUpdate=de,J.lightProbe.needsUpdate=de,J.directionalLights.needsUpdate=de,J.directionalLightShadows.needsUpdate=de,J.pointLights.needsUpdate=de,J.pointLightShadows.needsUpdate=de,J.spotLights.needsUpdate=de,J.spotLightShadows.needsUpdate=de,J.rectAreaLights.needsUpdate=de,J.hemisphereLights.needsUpdate=de}function xs(J){return J.isMeshLambertMaterial||J.isMeshToonMaterial||J.isMeshPhongMaterial||J.isMeshStandardMaterial||J.isShadowMaterial||J.isShaderMaterial&&J.lights===!0}this.getActiveCubeFace=function(){return H},this.getActiveMipmapLevel=function(){return F},this.getRenderTarget=function(){return U},this.setRenderTargetTextures=function(J,de,be){const Be=Qe.get(J);Be.__autoAllocateDepthBuffer=J.resolveDepthBuffer===!1,Be.__autoAllocateDepthBuffer===!1&&(Be.__useRenderToTexture=!1),Qe.get(J.texture).__webglTexture=de,Qe.get(J.depthTexture).__webglTexture=Be.__autoAllocateDepthBuffer?void 0:be,Be.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(J,de){const be=Qe.get(J);be.__webglFramebuffer=de,be.__useDefaultFramebuffer=de===void 0};const Ri=se.createFramebuffer();this.setRenderTarget=function(J,de=0,be=0){U=J,H=de,F=be;let Be=!0,_e=null,at=!1,dt=!1;if(J){const mt=Qe.get(J);if(mt.__useDefaultFramebuffer!==void 0)Fe.bindFramebuffer(se.FRAMEBUFFER,null),Be=!1;else if(mt.__webglFramebuffer===void 0)st.setupRenderTarget(J);else if(mt.__hasExternalTextures)st.rebindTextures(J,Qe.get(J.texture).__webglTexture,Qe.get(J.depthTexture).__webglTexture);else if(J.depthBuffer){const Lt=J.depthTexture;if(mt.__boundDepthTexture!==Lt){if(Lt!==null&&Qe.has(Lt)&&(J.width!==Lt.image.width||J.height!==Lt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");st.setupDepthRenderbuffer(J)}}const zt=J.texture;(zt.isData3DTexture||zt.isDataArrayTexture||zt.isCompressedArrayTexture)&&(dt=!0);const jt=Qe.get(J).__webglFramebuffer;J.isWebGLCubeRenderTarget?(Array.isArray(jt[de])?_e=jt[de][be]:_e=jt[de],at=!0):J.samples>0&&st.useMultisampledRTT(J)===!1?_e=Qe.get(J).__webglMultisampledFramebuffer:Array.isArray(jt)?_e=jt[be]:_e=jt,z.copy(J.viewport),W.copy(J.scissor),k=J.scissorTest}else z.copy(ce).multiplyScalar(ne).floor(),W.copy(Ee).multiplyScalar(ne).floor(),k=Me;if(be!==0&&(_e=Ri),Fe.bindFramebuffer(se.FRAMEBUFFER,_e)&&Be&&Fe.drawBuffers(J,_e),Fe.viewport(z),Fe.scissor(W),Fe.setScissorTest(k),at){const mt=Qe.get(J.texture);se.framebufferTexture2D(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_CUBE_MAP_POSITIVE_X+de,mt.__webglTexture,be)}else if(dt){const mt=de;for(let zt=0;zt<J.textures.length;zt++){const jt=Qe.get(J.textures[zt]);se.framebufferTextureLayer(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0+zt,jt.__webglTexture,be,mt)}}else if(J!==null&&be!==0){const mt=Qe.get(J.texture);se.framebufferTexture2D(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,mt.__webglTexture,be)}I=-1},this.readRenderTargetPixels=function(J,de,be,Be,_e,at,dt,xt=0){if(!(J&&J.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mt=Qe.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&dt!==void 0&&(mt=mt[dt]),mt){Fe.bindFramebuffer(se.FRAMEBUFFER,mt);try{const zt=J.textures[xt],jt=zt.format,Lt=zt.type;if(!tt.textureFormatReadable(jt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!tt.textureTypeReadable(Lt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}de>=0&&de<=J.width-Be&&be>=0&&be<=J.height-_e&&(J.textures.length>1&&se.readBuffer(se.COLOR_ATTACHMENT0+xt),se.readPixels(de,be,Be,_e,re.convert(jt),re.convert(Lt),at))}finally{const zt=U!==null?Qe.get(U).__webglFramebuffer:null;Fe.bindFramebuffer(se.FRAMEBUFFER,zt)}}},this.readRenderTargetPixelsAsync=async function(J,de,be,Be,_e,at,dt,xt=0){if(!(J&&J.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let mt=Qe.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&dt!==void 0&&(mt=mt[dt]),mt)if(de>=0&&de<=J.width-Be&&be>=0&&be<=J.height-_e){Fe.bindFramebuffer(se.FRAMEBUFFER,mt);const zt=J.textures[xt],jt=zt.format,Lt=zt.type;if(!tt.textureFormatReadable(jt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!tt.textureTypeReadable(Lt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const ln=se.createBuffer();se.bindBuffer(se.PIXEL_PACK_BUFFER,ln),se.bufferData(se.PIXEL_PACK_BUFFER,at.byteLength,se.STREAM_READ),J.textures.length>1&&se.readBuffer(se.COLOR_ATTACHMENT0+xt),se.readPixels(de,be,Be,_e,re.convert(jt),re.convert(Lt),0);const wn=U!==null?Qe.get(U).__webglFramebuffer:null;Fe.bindFramebuffer(se.FRAMEBUFFER,wn);const si=se.fenceSync(se.SYNC_GPU_COMMANDS_COMPLETE,0);return se.flush(),await Q6(se,si,4),se.bindBuffer(se.PIXEL_PACK_BUFFER,ln),se.getBufferSubData(se.PIXEL_PACK_BUFFER,0,at),se.deleteBuffer(ln),se.deleteSync(si),at}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(J,de=null,be=0){const Be=Math.pow(2,-be),_e=Math.floor(J.image.width*Be),at=Math.floor(J.image.height*Be),dt=de!==null?de.x:0,xt=de!==null?de.y:0;st.setTexture2D(J,0),se.copyTexSubImage2D(se.TEXTURE_2D,be,0,0,dt,xt,_e,at),Fe.unbindTexture()};const qo=se.createFramebuffer(),po=se.createFramebuffer();this.copyTextureToTexture=function(J,de,be=null,Be=null,_e=0,at=null){at===null&&(_e!==0?(Hm("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),at=_e,_e=0):at=0);let dt,xt,mt,zt,jt,Lt,ln,wn,si;const Vn=J.isCompressedTexture?J.mipmaps[at]:J.image;if(be!==null)dt=be.max.x-be.min.x,xt=be.max.y-be.min.y,mt=be.isBox3?be.max.z-be.min.z:1,zt=be.min.x,jt=be.min.y,Lt=be.isBox3?be.min.z:0;else{const Li=Math.pow(2,-_e);dt=Math.floor(Vn.width*Li),xt=Math.floor(Vn.height*Li),J.isDataArrayTexture?mt=Vn.depth:J.isData3DTexture?mt=Math.floor(Vn.depth*Li):mt=1,zt=0,jt=0,Lt=0}Be!==null?(ln=Be.x,wn=Be.y,si=Be.z):(ln=0,wn=0,si=0);const an=re.convert(de.format),Vt=re.convert(de.type);let li;de.isData3DTexture?(st.setTexture3D(de,0),li=se.TEXTURE_3D):de.isDataArrayTexture||de.isCompressedArrayTexture?(st.setTexture2DArray(de,0),li=se.TEXTURE_2D_ARRAY):(st.setTexture2D(de,0),li=se.TEXTURE_2D),se.pixelStorei(se.UNPACK_FLIP_Y_WEBGL,de.flipY),se.pixelStorei(se.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),se.pixelStorei(se.UNPACK_ALIGNMENT,de.unpackAlignment);const xn=se.getParameter(se.UNPACK_ROW_LENGTH),is=se.getParameter(se.UNPACK_IMAGE_HEIGHT),ir=se.getParameter(se.UNPACK_SKIP_PIXELS),us=se.getParameter(se.UNPACK_SKIP_ROWS),ci=se.getParameter(se.UNPACK_SKIP_IMAGES);se.pixelStorei(se.UNPACK_ROW_LENGTH,Vn.width),se.pixelStorei(se.UNPACK_IMAGE_HEIGHT,Vn.height),se.pixelStorei(se.UNPACK_SKIP_PIXELS,zt),se.pixelStorei(se.UNPACK_SKIP_ROWS,jt),se.pixelStorei(se.UNPACK_SKIP_IMAGES,Lt);const Mn=J.isDataArrayTexture||J.isData3DTexture,ji=de.isDataArrayTexture||de.isData3DTexture;if(J.isDepthTexture){const Li=Qe.get(J),mi=Qe.get(de),un=Qe.get(Li.__renderTarget),ha=Qe.get(mi.__renderTarget);Fe.bindFramebuffer(se.READ_FRAMEBUFFER,un.__webglFramebuffer),Fe.bindFramebuffer(se.DRAW_FRAMEBUFFER,ha.__webglFramebuffer);for(let Si=0;Si<mt;Si++)Mn&&(se.framebufferTextureLayer(se.READ_FRAMEBUFFER,se.COLOR_ATTACHMENT0,Qe.get(J).__webglTexture,_e,Lt+Si),se.framebufferTextureLayer(se.DRAW_FRAMEBUFFER,se.COLOR_ATTACHMENT0,Qe.get(de).__webglTexture,at,si+Si)),se.blitFramebuffer(zt,jt,dt,xt,ln,wn,dt,xt,se.DEPTH_BUFFER_BIT,se.NEAREST);Fe.bindFramebuffer(se.READ_FRAMEBUFFER,null),Fe.bindFramebuffer(se.DRAW_FRAMEBUFFER,null)}else if(_e!==0||J.isRenderTargetTexture||Qe.has(J)){const Li=Qe.get(J),mi=Qe.get(de);Fe.bindFramebuffer(se.READ_FRAMEBUFFER,qo),Fe.bindFramebuffer(se.DRAW_FRAMEBUFFER,po);for(let un=0;un<mt;un++)Mn?se.framebufferTextureLayer(se.READ_FRAMEBUFFER,se.COLOR_ATTACHMENT0,Li.__webglTexture,_e,Lt+un):se.framebufferTexture2D(se.READ_FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,Li.__webglTexture,_e),ji?se.framebufferTextureLayer(se.DRAW_FRAMEBUFFER,se.COLOR_ATTACHMENT0,mi.__webglTexture,at,si+un):se.framebufferTexture2D(se.DRAW_FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,mi.__webglTexture,at),_e!==0?se.blitFramebuffer(zt,jt,dt,xt,ln,wn,dt,xt,se.COLOR_BUFFER_BIT,se.NEAREST):ji?se.copyTexSubImage3D(li,at,ln,wn,si+un,zt,jt,dt,xt):se.copyTexSubImage2D(li,at,ln,wn,zt,jt,dt,xt);Fe.bindFramebuffer(se.READ_FRAMEBUFFER,null),Fe.bindFramebuffer(se.DRAW_FRAMEBUFFER,null)}else ji?J.isDataTexture||J.isData3DTexture?se.texSubImage3D(li,at,ln,wn,si,dt,xt,mt,an,Vt,Vn.data):de.isCompressedArrayTexture?se.compressedTexSubImage3D(li,at,ln,wn,si,dt,xt,mt,an,Vn.data):se.texSubImage3D(li,at,ln,wn,si,dt,xt,mt,an,Vt,Vn):J.isDataTexture?se.texSubImage2D(se.TEXTURE_2D,at,ln,wn,dt,xt,an,Vt,Vn.data):J.isCompressedTexture?se.compressedTexSubImage2D(se.TEXTURE_2D,at,ln,wn,Vn.width,Vn.height,an,Vn.data):se.texSubImage2D(se.TEXTURE_2D,at,ln,wn,dt,xt,an,Vt,Vn);se.pixelStorei(se.UNPACK_ROW_LENGTH,xn),se.pixelStorei(se.UNPACK_IMAGE_HEIGHT,is),se.pixelStorei(se.UNPACK_SKIP_PIXELS,ir),se.pixelStorei(se.UNPACK_SKIP_ROWS,us),se.pixelStorei(se.UNPACK_SKIP_IMAGES,ci),at===0&&de.generateMipmaps&&se.generateMipmap(li),Fe.unbindTexture()},this.copyTextureToTexture3D=function(J,de,be=null,Be=null,_e=0){return Hm('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(J,de,be,Be,_e)},this.initRenderTarget=function(J){Qe.get(J).__webglFramebuffer===void 0&&st.setupRenderTarget(J)},this.initTexture=function(J){J.isCubeTexture?st.setTextureCube(J,0):J.isData3DTexture?st.setTexture3D(J,0):J.isDataArrayTexture||J.isCompressedArrayTexture?st.setTexture2DArray(J,0):st.setTexture2D(J,0),Fe.unbindTexture()},this.resetState=function(){H=0,F=0,U=null,Fe.reset(),Te.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return lo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Gn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Gn._getUnpackColorSpace()}}const hY=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:G1,AddEquation:qh,AddOperation:WO,AdditiveAnimationBlendMode:Q1,AdditiveBlending:fM,AgXToneMapping:ZO,AlphaFormat:W1,AlwaysCompare:pL,AlwaysDepth:_x,AlwaysStencilFunc:gM,AmbientLight:nU,AnimationAction:fU,AnimationClip:hg,AnimationLoader:b8,AnimationMixer:Q8,AnimationObjectGroup:K8,AnimationUtils:A8,ArcCurve:DL,ArrayCamera:cU,ArrowHelper:S7,AttachedBindMode:mM,Audio:uU,AudioAnalyser:z8,AudioContext:CC,AudioListener:U8,AudioLoader:N8,AxesHelper:E7,BackSide:ua,BasicDepthPacking:rL,BasicShadowMap:CO,BatchedMesh:CL,Bone:QS,BooleanKeyframeTrack:cp,Box2:a7,Box3:$s,Box3Helper:A7,BoxGeometry:lp,BoxHelper:v7,BufferAttribute:Zn,BufferGeometry:yn,BufferGeometryLoader:oU,ByteType:j1,Cache:Ac,Camera:YS,CameraHelper:_7,CanvasTexture:G5,CapsuleGeometry:tE,CatmullRomCurve3:IL,CineonToneMapping:JO,CircleGeometry:nE,ClampToEdgeWrapping:oo,Clock:RC,Color:St,ColorKeyframeTrack:xC,ColorManagement:Gn,CompressedArrayTexture:H5,CompressedCubeTexture:k5,CompressedTexture:eE,CompressedTextureLoader:T8,ConeGeometry:sv,ConstantAlphaFactor:jO,ConstantColorFactor:kO,Controls:T7,CubeCamera:SL,CubeReflectionMapping:Fu,CubeRefractionMapping:uf,CubeTexture:ev,CubeTextureLoader:M8,CubeUVReflectionMapping:Sg,CubicBezierCurve:fC,CubicBezierCurve3:BL,CubicInterpolant:JL,CullFaceBack:hM,CullFaceFront:MO,CullFaceFrontBack:e6,CullFaceNone:TO,Curve:wl,CurvePath:OL,CustomBlending:RO,CustomToneMapping:QO,CylinderGeometry:iv,Cylindrical:r7,Data3DTexture:WS,DataArrayTexture:XS,DataTexture:Rc,DataTextureLoader:C8,DataUtils:f5,DecrementStencilOp:h6,DecrementWrapStencilOp:d6,DefaultLoadingManager:$L,DepthFormat:ng,DepthStencilFormat:ig,DepthTexture:uC,DetachedBindMode:eL,DirectionalLight:MC,DirectionalLightHelper:y7,DiscreteInterpolant:QL,DodecahedronGeometry:iE,DoubleSide:Fo,DstAlphaFactor:PO,DstColorFactor:zO,DynamicCopyUsage:R6,DynamicDrawUsage:S6,DynamicReadUsage:T6,EdgesGeometry:wL,EllipseCurve:sE,EqualCompare:uL,EqualDepth:Ax,EqualStencilFunc:y6,EquirectangularReflectionMapping:M_,EquirectangularRefractionMapping:C_,Euler:ho,EventDispatcher:Oc,ExtrudeGeometry:rE,FileLoader:fo,Float16BufferAttribute:v5,Float32BufferAttribute:Pt,FloatType:za,Fog:JS,FogExp2:KS,FramebufferTexture:V5,FrontSide:Ic,Frustum:bg,FrustumArray:ZS,GLBufferAttribute:n7,GLSL1:D6,GLSL3:yM,GreaterCompare:hL,GreaterDepth:Sx,GreaterEqualCompare:dL,GreaterEqualDepth:xx,GreaterEqualStencilFunc:x6,GreaterStencilFunc:v6,GridHelper:m7,Group:Cu,HalfFloatType:Eg,HemisphereLight:tU,HemisphereLightHelper:p7,IcosahedronGeometry:aE,ImageBitmapLoader:lU,ImageLoader:L_,ImageUtils:_L,IncrementStencilOp:u6,IncrementWrapStencilOp:f6,InstancedBufferAttribute:Qd,InstancedBufferGeometry:aU,InstancedInterleavedBuffer:t7,InstancedMesh:oC,Int16BufferAttribute:y5,Int32BufferAttribute:_5,Int8BufferAttribute:p5,IntType:zS,InterleavedBuffer:tv,InterleavedBufferAttribute:df,Interpolant:Mg,InterpolateDiscrete:sg,InterpolateLinear:rg,InterpolateSmooth:GA,InterpolationSamplingMode:N6,InterpolationSamplingType:B6,InvertStencilOp:p6,KeepStencilOp:Md,KeyframeTrack:jo,LOD:ML,LatheGeometry:oE,Layers:lg,LessCompare:cL,LessDepth:vx,LessEqualCompare:$1,LessEqualDepth:Jd,LessEqualStencilFunc:_6,LessStencilFunc:g6,Light:Af,LightProbe:rU,Line:Vu,Line3:c7,LineBasicMaterial:Pr,LineCurve:dC,LineCurve3:NL,LineDashedMaterial:WL,LineLoop:lC,LineSegments:Rl,LinearFilter:_s,LinearInterpolant:AC,LinearMipMapLinearFilter:s6,LinearMipMapNearestFilter:i6,LinearMipmapLinearFilter:zo,LinearMipmapNearestFilter:Vm,LinearSRGBColorSpace:ff,LinearToneMapping:YO,LinearTransfer:w_,Loader:Fr,LoaderUtils:tf,LoadingManager:SC,LoopOnce:tL,LoopPingPong:iL,LoopRepeat:nL,MOUSE:bd,Material:Vs,MaterialLoader:pE,MathUtils:mL,Matrix2:BC,Matrix3:An,Matrix4:Jt,MaxEquation:BO,Mesh:vs,MeshBasicMaterial:co,MeshDepthMaterial:yC,MeshDistanceMaterial:_C,MeshLambertMaterial:qL,MeshMatcapMaterial:XL,MeshNormalMaterial:jL,MeshPhongMaterial:kL,MeshPhysicalMaterial:Go,MeshStandardMaterial:ov,MeshToonMaterial:GL,MinEquation:IO,MirroredRepeatWrapping:$m,MixOperation:XO,MultiplyBlending:pM,MultiplyOperation:Z_,NearestFilter:Qs,NearestMipMapLinearFilter:n6,NearestMipMapNearestFilter:t6,NearestMipmapLinearFilter:Bd,NearestMipmapNearestFilter:FS,NeutralToneMapping:$O,NeverCompare:lL,NeverDepth:yx,NeverStencilFunc:m6,NoBlending:wu,NoColorSpace:Eu,NoToneMapping:Cc,NormalAnimationBlendMode:qS,NormalBlending:kd,NotEqualCompare:fL,NotEqualDepth:Ex,NotEqualStencilFunc:A6,NumberKeyframeTrack:$d,Object3D:jn,ObjectLoader:I8,ObjectSpaceNormalMap:oL,OctahedronGeometry:rv,OneFactor:OO,OneMinusConstantAlphaFactor:qO,OneMinusConstantColorFactor:GO,OneMinusDstAlphaFactor:FO,OneMinusDstColorFactor:VO,OneMinusSrcAlphaFactor:gx,OneMinusSrcColorFactor:UO,OrthographicCamera:Tl,PCFShadowMap:US,PCFSoftShadowMap:a_,PMREMGenerator:TM,Path:eS,PerspectiveCamera:Hi,Plane:Au,PlaneGeometry:Tg,PlaneHelper:x7,PointLight:TC,PointLightHelper:f7,Points:cC,PointsMaterial:$S,PolarGridHelper:g7,PolyhedronGeometry:vf,PositionalAudio:F8,PropertyBinding:Yn,PropertyMixer:hU,QuadraticBezierCurve:pC,QuadraticBezierCurve3:mC,Quaternion:Zs,QuaternionKeyframeTrack:ep,QuaternionLinearInterpolant:ZL,RED_GREEN_RGTC2_Format:Yx,RED_RGTC1_Format:J1,REVISION:Q_,RGBADepthPacking:aL,RGBAFormat:Lr,RGBAIntegerFormat:jS,RGBA_ASTC_10x10_Format:kx,RGBA_ASTC_10x5_Format:zx,RGBA_ASTC_10x6_Format:Vx,RGBA_ASTC_10x8_Format:Hx,RGBA_ASTC_12x10_Format:Gx,RGBA_ASTC_12x12_Format:jx,RGBA_ASTC_4x4_Format:Ix,RGBA_ASTC_5x4_Format:Bx,RGBA_ASTC_5x5_Format:Nx,RGBA_ASTC_6x5_Format:Ox,RGBA_ASTC_6x6_Format:Lx,RGBA_ASTC_8x5_Format:Ux,RGBA_ASTC_8x6_Format:Px,RGBA_ASTC_8x8_Format:Fx,RGBA_BPTC_Format:h_,RGBA_ETC2_EAC_Format:Dx,RGBA_PVRTC_2BPPV1_Format:Cx,RGBA_PVRTC_4BPPV1_Format:Mx,RGBA_S3TC_DXT1_Format:l_,RGBA_S3TC_DXT3_Format:c_,RGBA_S3TC_DXT5_Format:u_,RGBDepthPacking:a6,RGBFormat:Y1,RGBIntegerFormat:r6,RGB_BPTC_SIGNED_Format:qx,RGB_BPTC_UNSIGNED_Format:Xx,RGB_ETC1_Format:Rx,RGB_ETC2_Format:wx,RGB_PVRTC_2BPPV1_Format:Tx,RGB_PVRTC_4BPPV1_Format:bx,RGB_S3TC_DXT1_Format:o_,RGDepthPacking:o6,RGFormat:K1,RGIntegerFormat:GS,RawShaderMaterial:HL,Ray:op,Raycaster:dU,RectAreaLight:iU,RedFormat:kS,RedIntegerFormat:$_,ReinhardToneMapping:KO,RenderTarget:tC,RenderTarget3D:Z8,RepeatWrapping:hf,ReplaceStencilOp:c6,ReverseSubtractEquation:DO,RingGeometry:lE,SIGNED_RED_GREEN_RGTC2_Format:Kx,SIGNED_RED_RGTC1_Format:Wx,SRGBColorSpace:Nr,SRGBTransfer:pi,Scene:sC,ShaderChunk:Tn,ShaderLib:xl,ShaderMaterial:Cl,ShadowMaterial:VL,Shape:jd,ShapeGeometry:cE,ShapePath:b7,ShapeUtils:El,ShortType:q1,Skeleton:nv,SkeletonHelper:h7,SkinnedMesh:aC,Source:Kh,Sphere:zs,SphereGeometry:av,Spherical:EM,SphericalHarmonics3:sU,SplineCurve:gC,SpotLight:bC,SpotLightHelper:u7,Sprite:TL,SpriteMaterial:rC,SrcAlphaFactor:mx,SrcAlphaSaturateFactor:HO,SrcColorFactor:LO,StaticCopyUsage:C6,StaticDrawUsage:D_,StaticReadUsage:b6,StereoCamera:O8,StreamCopyUsage:w6,StreamDrawUsage:E6,StreamReadUsage:M6,StringKeyframeTrack:up,SubtractEquation:wO,SubtractiveBlending:dM,TOUCH:Td,TangentSpaceNormalMap:_f,TetrahedronGeometry:uE,Texture:ki,TextureLoader:eU,TextureUtils:D7,Timer:i7,TimestampQuery:I6,TorusGeometry:hE,TorusKnotGeometry:fE,Triangle:Fa,TriangleFanDrawMode:Jx,TriangleStripDrawMode:Z1,TrianglesDrawMode:sL,TubeGeometry:dE,UVMapping:PS,Uint16BufferAttribute:nC,Uint32BufferAttribute:iC,Uint8BufferAttribute:m5,Uint8ClampedBufferAttribute:g5,Uniform:IC,UniformsGroup:e7,UniformsLib:Tt,UniformsUtils:xL,UnsignedByteType:ko,UnsignedInt248Type:tg,UnsignedInt5999Type:X1,UnsignedIntType:zu,UnsignedShort4444Type:VS,UnsignedShort5551Type:HS,UnsignedShortType:eg,VSMShadowMap:Al,Vector2:Xe,Vector3:$,Vector4:Qn,VectorKeyframeTrack:tp,VideoFrameTexture:z5,VideoTexture:RL,WebGL3DRenderTarget:n5,WebGLArrayRenderTarget:t5,WebGLCoordinateSystem:lo,WebGLCubeRenderTarget:EL,WebGLRenderTarget:Bc,WebGLRenderer:SU,WebGLUtils:AU,WebGPUCoordinateSystem:ag,WebXRController:jA,WireframeGeometry:zL,WrapAroundEnding:R_,ZeroCurvatureEnding:Nd,ZeroFactor:NO,ZeroSlopeEnding:Od,ZeroStencilOp:l6,createCanvasElement:yL},Symbol.toStringTag,{value:"Module"}));var uT={exports:{}},hT={},fT={exports:{}},dT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $D;function fY(){if($D)return dT;$D=1;var i=pg();function e(y,v){return y===v&&(y!==0||1/y===1/v)||y!==y&&v!==v}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,s=i.useEffect,r=i.useLayoutEffect,o=i.useDebugValue;function c(y,v){var x=v(),b=n({inst:{value:x,getSnapshot:v}}),R=b[0].inst,M=b[1];return r(function(){R.value=x,R.getSnapshot=v,f(R)&&M({inst:R})},[y,x,v]),s(function(){return f(R)&&M({inst:R}),y(function(){f(R)&&M({inst:R})})},[y]),o(x),x}function f(y){var v=y.getSnapshot;y=y.value;try{var x=v();return!t(y,x)}catch{return!0}}function p(y,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:c;return dT.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:m,dT}var eI;function dY(){return eI||(eI=1,fT.exports=fY()),fT.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tI;function pY(){if(tI)return hT;tI=1;var i=pg(),e=dY();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=i.useRef,o=i.useEffect,c=i.useMemo,f=i.useDebugValue;return hT.useSyncExternalStoreWithSelector=function(p,m,y,v,x){var b=r(null);if(b.current===null){var R={hasValue:!1,value:null};b.current=R}else R=b.current;b=c(function(){function T(H){if(!D){if(D=!0,B=H,H=v(H),x!==void 0&&R.hasValue){var F=R.value;if(x(F,H))return L=F}return L=H}if(F=L,n(B,H))return F;var U=v(H);return x!==void 0&&x(F,U)?(B=H,F):(B=H,L=U)}var D=!1,B,L,G=y===void 0?null:y;return[function(){return T(m())},G===null?void 0:function(){return T(G())}]},[m,y,v,x]);var M=s(p,b[0],b[1]);return o(function(){R.hasValue=!0,R.value=M},[M]),f(M),M},hT}var nI;function mY(){return nI||(nI=1,uT.exports=pY()),uT.exports}var gY=mY();const yY=aS(gY),{useSyncExternalStoreWithSelector:_Y}=yY,vY=i=>i;function AY(i,e=vY,t){const n=_Y(i.subscribe,i.getState,i.getInitialState,e,t);return wd.useDebugValue(n),n}const iI=(i,e)=>{const t=bO(i),n=(s,r=e)=>AY(t,s,r);return Object.assign(n,t),n},xY=(i,e)=>i?iI(i,e):iI,SY=i=>typeof i=="object"&&typeof i.then=="function",Ud=[];function EU(i,e,t=(n,s)=>n===s){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let s=0;s<n;s++)if(!t(i[s],e[s]))return!1;return!0}function bU(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const r of Ud)if(EU(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const s={keys:e,equal:n.equal,remove:()=>{const r=Ud.indexOf(s);r!==-1&&Ud.splice(r,1)},promise:(SY(i)?i:i(...e)).then(r=>{s.response=r,n.lifespan&&n.lifespan>0&&(s.timeout=setTimeout(s.remove,n.lifespan))}).catch(r=>s.error=r)};if(Ud.push(s),!t)throw s.promise}const EY=(i,e,t)=>bU(i,e,!1,t),bY=(i,e,t)=>void bU(i,e,!0,t),TY=i=>{if(i===void 0||i.length===0)Ud.splice(0,Ud.length);else{const e=Ud.find(t=>EU(i,t.keys,t.equal));e&&e.remove()}};var pT={exports:{}},mT={exports:{}},gT={exports:{}},yT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sI;function MY(){return sI||(sI=1,function(i){function e(q,ee){var ne=q.length;q.push(ee);e:for(;0<ne;){var ye=ne-1>>>1,K=q[ye];if(0<s(K,ee))q[ye]=ee,q[ne]=K,ne=ye;else break e}}function t(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var ee=q[0],ne=q.pop();if(ne!==ee){q[0]=ne;e:for(var ye=0,K=q.length,ce=K>>>1;ye<ce;){var Ee=2*(ye+1)-1,Me=q[Ee],Ve=Ee+1,ge=q[Ve];if(0>s(Me,ne))Ve<K&&0>s(ge,Me)?(q[ye]=ge,q[Ve]=ne,ye=Ve):(q[ye]=Me,q[Ee]=ne,ye=Ee);else if(Ve<K&&0>s(ge,ne))q[ye]=ge,q[Ve]=ne,ye=Ve;else break e}}return ee}function s(q,ee){var ne=q.sortIndex-ee.sortIndex;return ne!==0?ne:q.id-ee.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var f=[],p=[],m=1,y=null,v=3,x=!1,b=!1,R=!1,M=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function B(q){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=q)n(p),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(p)}}function L(q){if(R=!1,B(q),!b)if(t(f)!==null)b=!0,he();else{var ee=t(p);ee!==null&&me(L,ee.startTime-q)}}var G=!1,H=-1,F=5,U=-1;function I(){return!(i.unstable_now()-U<F)}function N(){if(G){var q=i.unstable_now();U=q;var ee=!0;try{e:{b=!1,R&&(R=!1,T(H),H=-1),x=!0;var ne=v;try{t:{for(B(q),y=t(f);y!==null&&!(y.expirationTime>q&&I());){var ye=y.callback;if(typeof ye=="function"){y.callback=null,v=y.priorityLevel;var K=ye(y.expirationTime<=q);if(q=i.unstable_now(),typeof K=="function"){y.callback=K,B(q),ee=!0;break t}y===t(f)&&n(f),B(q)}else n(f);y=t(f)}if(y!==null)ee=!0;else{var ce=t(p);ce!==null&&me(L,ce.startTime-q),ee=!1}}break e}finally{y=null,v=ne,x=!1}ee=void 0}}finally{ee?z():G=!1}}}var z;if(typeof D=="function")z=function(){D(N)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,k=W.port2;W.port1.onmessage=N,z=function(){k.postMessage(null)}}else z=function(){M(N,0)};function he(){G||(G=!0,z())}function me(q,ee){H=M(function(){q(i.unstable_now())},ee)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(q){q.callback=null},i.unstable_continueExecution=function(){b||x||(b=!0,he())},i.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<q?Math.floor(1e3/q):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_getFirstCallbackNode=function(){return t(f)},i.unstable_next=function(q){switch(v){case 1:case 2:case 3:var ee=3;break;default:ee=v}var ne=v;v=ee;try{return q()}finally{v=ne}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ne=v;v=q;try{return ee()}finally{v=ne}},i.unstable_scheduleCallback=function(q,ee,ne){var ye=i.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ye+ne:ye):ne=ye,q){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ne+K,q={id:m++,callback:ee,priorityLevel:q,startTime:ne,expirationTime:K,sortIndex:-1},ne>ye?(q.sortIndex=ne,e(p,q),t(f)===null&&q===t(p)&&(R?(T(H),H=-1):R=!0,me(L,ne-ye))):(q.sortIndex=K,e(f,q),b||x||(b=!0,he())),q},i.unstable_shouldYield=I,i.unstable_wrapCallback=function(q){var ee=v;return function(){var ne=v;v=ee;try{return q.apply(this,arguments)}finally{v=ne}}}}(yT)),yT}var rI;function CY(){return rI||(rI=1,gT.exports=MY()),gT.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aI;function RY(){return aI||(aI=1,function(i){i.exports=function(e){function t(u,h,_,E){return new jg(u,h,_,E)}function n(){}function s(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)h+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return u===null||typeof u!="object"?null:(u=sl&&u[sl]||u["@@iterator"],typeof u=="function"?u:null)}function o(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===Yg?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case Kl:return"Fragment";case Ea:return"Portal";case Cp:return"Profiler";case jf:return"StrictMode";case Rp:return"Suspense";case oh:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case Wa:return(u.displayName||"Context")+".Provider";case Xg:return(u._context.displayName||"Context")+".Consumer";case Xf:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case wp:return h=u.displayName||null,h!==null?h:o(u.type)||"Memo";case ba:h=u._payload,u=u._init;try{return o(u(h))}catch{}}return null}function c(u){if(xo===void 0)try{throw Error()}catch(_){var h=_.stack.trim().match(/\n( *(at )?)/);xo=h&&h[1]||"",rl=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xo+u+rl}function f(u,h){if(!u||Xc)return"";Xc=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(h){var bt=function(){throw Error()};if(Object.defineProperty(bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(bt,[])}catch(fn){var Ct=fn}Reflect.construct(u,[],bt)}else{try{bt.call()}catch(fn){Ct=fn}u.call(bt.prototype)}}else{try{throw Error()}catch(fn){Ct=fn}(bt=u())&&typeof bt.catch=="function"&&bt.catch(function(){})}}catch(fn){if(fn&&Ct&&typeof fn.stack=="string")return[fn.stack,Ct.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=E.DetermineComponentFrameRoot(),Q=P[0],le=P[1];if(Q&&le){var Se=Q.split(`
`),je=le.split(`
`);for(w=E=0;E<Se.length&&!Se[E].includes("DetermineComponentFrameRoot");)E++;for(;w<je.length&&!je[w].includes("DetermineComponentFrameRoot");)w++;if(E===Se.length||w===je.length)for(E=Se.length-1,w=je.length-1;1<=E&&0<=w&&Se[E]!==je[w];)w--;for(;1<=E&&0<=w;E--,w--)if(Se[E]!==je[w]){if(E!==1||w!==1)do if(E--,w--,0>w||Se[E]!==je[w]){var pt=`
`+Se[E].replace(" at new "," at ");return u.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",u.displayName)),pt}while(1<=E&&0<=w);break}}}finally{Xc=!1,Error.prepareStackTrace=_}return(_=u?u.displayName||u.name:"")?c(_):""}function p(u){switch(u.tag){case 26:case 27:case 5:return c(u.type);case 16:return c("Lazy");case 13:return c("Suspense");case 19:return c("SuspenseList");case 0:case 15:return u=f(u.type,!1),u;case 11:return u=f(u.type.render,!1),u;case 1:return u=f(u.type,!0),u;default:return""}}function m(u){try{var h="";do h+=p(u),u=u.return;while(u);return h}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function y(u){var h=u,_=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(_=h.return),u=h.return;while(u)}return h.tag===3?_:null}function v(u){if(y(u)!==u)throw Error(s(188))}function x(u){var h=u.alternate;if(!h){if(h=y(u),h===null)throw Error(s(188));return h!==u?null:u}for(var _=u,E=h;;){var w=_.return;if(w===null)break;var P=w.alternate;if(P===null){if(E=w.return,E!==null){_=E;continue}break}if(w.child===P.child){for(P=w.child;P;){if(P===_)return v(w),u;if(P===E)return v(w),h;P=P.sibling}throw Error(s(188))}if(_.return!==E.return)_=w,E=P;else{for(var Q=!1,le=w.child;le;){if(le===_){Q=!0,_=w,E=P;break}if(le===E){Q=!0,E=w,_=P;break}le=le.sibling}if(!Q){for(le=P.child;le;){if(le===_){Q=!0,_=P,E=w;break}if(le===E){Q=!0,E=P,_=w;break}le=le.sibling}if(!Q)throw Error(s(189))}}if(_.alternate!==E)throw Error(s(190))}if(_.tag!==3)throw Error(s(188));return _.stateNode.current===_?u:h}function b(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(h=b(u),h!==null)return h;u=u.sibling}return null}function R(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(u.tag!==4&&(h=R(u),h!==null))return h;u=u.sibling}return null}function M(u){return{current:u}}function T(u){0>cl||(u.current=Ki[cl],Ki[cl]=null,cl--)}function D(u,h){cl++,Ki[cl]=u.current,u.current=h}function B(u){return u>>>=0,u===0?32:31-(e0(u)/t0|0)|0}function L(u){var h=u&42;if(h!==0)return h;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function G(u,h){var _=u.pendingLanes;if(_===0)return 0;var E=0,w=u.suspendedLanes,P=u.pingedLanes,Q=u.warmLanes;u=u.finishedLanes!==0;var le=_&134217727;return le!==0?(_=le&~w,_!==0?E=L(_):(P&=le,P!==0?E=L(P):u||(Q=le&~Q,Q!==0&&(E=L(Q))))):(le=_&~w,le!==0?E=L(le):P!==0?E=L(P):u||(Q=_&~Q,Q!==0&&(E=L(Q)))),E===0?0:h!==0&&h!==E&&(h&w)===0&&(w=E&-E,Q=h&-h,w>=Q||w===32&&(Q&4194176)!==0)?h:E}function H(u,h){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&h)===0}function F(u,h){switch(u){case 1:case 2:case 4:case 8:return h+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U(){var u=Eo;return Eo<<=1,(Eo&4194176)===0&&(Eo=128),u}function I(){var u=Kc;return Kc<<=1,(Kc&62914560)===0&&(Kc=4194304),u}function N(u){for(var h=[],_=0;31>_;_++)h.push(u);return h}function z(u,h){u.pendingLanes|=h,h!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function W(u,h,_,E,w,P){var Q=u.pendingLanes;u.pendingLanes=_,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=_,u.entangledLanes&=_,u.errorRecoveryDisabledLanes&=_,u.shellSuspendCounter=0;var le=u.entanglements,Se=u.expirationTimes,je=u.hiddenUpdates;for(_=Q&~_;0<_;){var pt=31-lr(_),bt=1<<pt;le[pt]=0,Se[pt]=-1;var Ct=je[pt];if(Ct!==null)for(je[pt]=null,pt=0;pt<Ct.length;pt++){var fn=Ct[pt];fn!==null&&(fn.lane&=-536870913)}_&=~bt}E!==0&&k(u,E,0),P!==0&&w===0&&u.tag!==0&&(u.suspendedLanes|=P&~(Q&~h))}function k(u,h,_){u.pendingLanes|=h,u.suspendedLanes&=~h;var E=31-lr(h);u.entangledLanes|=h,u.entanglements[E]=u.entanglements[E]|1073741824|_&4194218}function he(u,h){var _=u.entangledLanes|=h;for(u=u.entanglements;_;){var E=31-lr(_),w=1<<E;w&h|u[E]&h&&(u[E]|=h),_&=~w}}function me(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function q(u){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(Ji,u,void 0,(u.current.flags&128)===128)}catch{}}function ee(u){if(typeof s0=="function"&&Ts(u),Tr&&typeof Tr.setStrictMode=="function")try{Tr.setStrictMode(Ji,u)}catch{}}function ne(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}function ye(u,h){if(typeof u=="object"&&u!==null){var _=dy.get(u);return _!==void 0?_:(h={value:u,source:h,stack:m(h)},dy.set(u,h),h)}return{value:u,source:h,stack:m(h)}}function K(u,h){Jc[Qc++]=gh,Jc[Qc++]=Zc,Zc=u,gh=h}function ce(u,h,_){Xr[Wr++]=Ja,Xr[Wr++]=Qa,Xr[Wr++]=nc,nc=u;var E=Ja;u=Qa;var w=32-lr(E)-1;E&=~(1<<w),_+=1;var P=32-lr(h)+w;if(30<P){var Q=w-w%5;P=(E&(1<<Q)-1).toString(32),E>>=Q,w-=Q,Ja=1<<32-lr(h)+w|_<<w|E,Qa=P+u}else Ja=1<<P|_<<w|E,Qa=u}function Ee(u){u.return!==null&&(K(u,1),ce(u,1,0))}function Me(u){for(;u===Zc;)Zc=Jc[--Qc],Jc[Qc]=null,gh=Jc[--Qc],Jc[Qc]=null;for(;u===nc;)nc=Xr[--Wr],Xr[Wr]=null,Qa=Xr[--Wr],Xr[Wr]=null,Ja=Xr[--Wr],Xr[Wr]=null}function Ve(u,h){D(bo,h),D(yh,u),D(ds,null),u=vv(h),T(ds),D(ds,u)}function ge(){T(ds),T(yh),T(bo)}function ze(u){u.memoizedState!==null&&D($c,u);var h=ds.current,_=hh(h,u.type);h!==_&&(D(yh,u),D(ds,_))}function Je(u){yh.current===u&&(T(ds),T(yh)),$c.current===u&&(T($c),ar?Ya._currentValue=Ql:Ya._currentValue2=Ql)}function lt(u){var h=Error(s(418,""));throw se(ye(h,u)),td}function At(u,h){if(!Ls)throw Error(s(175));jv(u.stateNode,u.type,u.memoizedProps,h,u)||lt(u)}function Et(u){for(Us=u.return;Us;)switch(Us.tag){case 3:case 27:Ms=!0;return;case 5:case 13:Ms=!1;return;default:Us=Us.return}}function Nt(u){if(!Ls||u!==Us)return!1;if(!Un)return Et(u),Un=!0,!1;var h=!1;if(ui?u.tag!==3&&u.tag!==27&&(u.tag!==5||Fp(u.type)&&!mn(u.type,u.memoizedProps))&&(h=!0):u.tag!==3&&(u.tag!==5||Fp(u.type)&&!mn(u.type,u.memoizedProps))&&(h=!0),h&&Ps&&lt(u),Et(u),u.tag===13){if(!Ls)throw Error(s(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));Ps=Xv(u)}else Ps=Us?cy(u.stateNode):null;return!0}function It(){Ls&&(Ps=Us=null,Un=!1)}function se(u){Ca===null?Ca=[u]:Ca.push(u)}function Ge(){for(var u=eu,h=Za=eu=0;h<u;){var _=Ra[h];Ra[h++]=null;var E=Ra[h];Ra[h++]=null;var w=Ra[h];Ra[h++]=null;var P=Ra[h];if(Ra[h++]=null,E!==null&&w!==null){var Q=E.pending;Q===null?w.next=w:(w.next=Q.next,Q.next=w),E.pending=w}P!==0&&ut(_,w,P)}}function He(u,h,_,E){Ra[eu++]=u,Ra[eu++]=h,Ra[eu++]=_,Ra[eu++]=E,Za|=E,u.lanes|=E,u=u.alternate,u!==null&&(u.lanes|=E)}function tt(u,h,_,E){return He(u,h,_,E),Qe(u)}function Fe(u,h){return He(u,null,null,h),Qe(u)}function ut(u,h,_){u.lanes|=_;var E=u.alternate;E!==null&&(E.lanes|=_);for(var w=!1,P=u.return;P!==null;)P.childLanes|=_,E=P.alternate,E!==null&&(E.childLanes|=_),P.tag===22&&(u=P.stateNode,u===null||u._visibility&1||(w=!0)),u=P,P=P.return;w&&h!==null&&u.tag===3&&(P=u.stateNode,w=31-lr(_),P=P.hiddenUpdates,u=P[w],u===null?P[w]=[h]:u.push(h),h.lane=_|536870912)}function Qe(u){if(50<Mh)throw Mh=0,$p=null,Error(s(185));for(var h=u.return;h!==null;)u=h,h=u.return;return u.tag===3?u.stateNode:null}function st(u){u!==ul&&u.next===null&&(ul===null?nd=ul=u:ul=ul.next=u),gi=!0,tu||(tu=!0,Re(Gt))}function Ft(u,h){if(!py&&gi){py=!0;do for(var _=!1,E=nd;E!==null;){if(u!==0){var w=E.pendingLanes;if(w===0)var P=0;else{var Q=E.suspendedLanes,le=E.pingedLanes;P=(1<<31-lr(42|u)+1)-1,P&=w&~(Q&~le),P=P&201326677?P&201326677|1:P?P|2:0}P!==0&&(_=!0,xe(E,P))}else P=Bn,P=G(E,E===ni?P:0),(P&3)===0||H(E,P)||(_=!0,xe(E,P));E=E.next}while(_);py=!1}}function Gt(){gi=tu=!1;var u=0;_h!==0&&(Ev()&&(u=_h),_h=0);for(var h=Ma(),_=null,E=nd;E!==null;){var w=E.next,P=te(E,h);P===0?(E.next=null,_===null?nd=w:_.next=w,w===null&&(ul=_)):(_=E,(u!==0||(P&3)!==0)&&(gi=!0)),E=w}Ft(u)}function te(u,h){for(var _=u.suspendedLanes,E=u.pingedLanes,w=u.expirationTimes,P=u.pendingLanes&-62914561;0<P;){var Q=31-lr(P),le=1<<Q,Se=w[Q];Se===-1?((le&_)===0||(le&E)!==0)&&(w[Q]=F(le,h)):Se<=h&&(u.expiredLanes|=le),P&=~le}if(h=ni,_=Bn,_=G(u,u===h?_:0),E=u.callbackNode,_===0||u===h&&ai===2||u.cancelPendingCommit!==null)return E!==null&&E!==null&&kp(E),u.callbackNode=null,u.callbackPriority=0;if((_&3)===0||H(u,_)){if(h=_&-_,h===u.callbackPriority)return h;switch(E!==null&&kp(E),me(_)){case 2:case 8:_=i0;break;case 32:_=qp;break;case 268435456:_=ME;break;default:_=qp}return E=X.bind(null,u),_=ed(_,E),u.callbackPriority=h,u.callbackNode=_,h}return E!==null&&E!==null&&kp(E),u.callbackPriority=2,u.callbackNode=null,2}function X(u,h){var _=u.callbackNode;if(Xa()&&u.callbackNode!==_)return null;var E=Bn;return E=G(u,u===ni?E:0),E===0?null:(jl(u,E,h),te(u,Ma()),u.callbackNode!=null&&u.callbackNode===_?X.bind(null,u):null)}function xe(u,h){if(Xa())return null;jl(u,h,!0)}function Re(u){$g?ll(function(){(kn&6)!==0?ed(jp,u):u()}):ed(jp,u)}function Ue(){return _h===0&&(_h=U()),_h}function Le(u,h){if(vh===null){var _=vh=[];nu=0,Yr=Ue(),iu={status:"pending",value:void 0,then:function(E){_.push(E)}}}return nu++,h.then(_t,_t),h}function _t(){if(--nu===0&&vh!==null){iu!==null&&(iu.status="fulfilled");var u=vh;vh=null,Yr=0,iu=null;for(var h=0;h<u.length;h++)(0,u[h])()}}function ht(u,h){var _=[],E={status:"pending",value:null,reason:null,then:function(w){_.push(w)}};return u.then(function(){E.status="fulfilled",E.value=h;for(var w=0;w<_.length;w++)(0,_[w])(h)},function(w){for(E.status="rejected",E.reason=w,w=0;w<_.length;w++)(0,_[w])(void 0)}),E}function wt(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Mt(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function et(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function ft(u,h,_){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(kn&2)!==0){var w=E.pending;return w===null?h.next=h:(h.next=w.next,w.next=h),E.pending=h,h=Qe(u),ut(u,null,_),h}return He(u,E,h,_),Qe(u)}function Dt(u,h,_){if(h=h.updateQueue,h!==null&&(h=h.shared,(_&4194176)!==0)){var E=h.lanes;E&=u.pendingLanes,_|=E,h.lanes=_,he(u,_)}}function re(u,h){var _=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var w=null,P=null;if(_=_.firstBaseUpdate,_!==null){do{var Q={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};P===null?w=P=Q:P=P.next=Q,_=_.next}while(_!==null);P===null?w=P=h:P=P.next=h}else w=P=h;_={baseState:E.baseState,firstBaseUpdate:w,lastBaseUpdate:P,shared:E.shared,callbacks:E.callbacks},u.updateQueue=_;return}u=_.lastBaseUpdate,u===null?_.firstBaseUpdate=h:u.next=h,_.lastBaseUpdate=h}function Te(){if(su){var u=iu;if(u!==null)throw u}}function rt(u,h,_,E){su=!1;var w=u.updateQueue;hl=!1;var P=w.firstBaseUpdate,Q=w.lastBaseUpdate,le=w.shared.pending;if(le!==null){w.shared.pending=null;var Se=le,je=Se.next;Se.next=null,Q===null?P=je:Q.next=je,Q=Se;var pt=u.alternate;pt!==null&&(pt=pt.updateQueue,le=pt.lastBaseUpdate,le!==Q&&(le===null?pt.firstBaseUpdate=je:le.next=je,pt.lastBaseUpdate=Se))}if(P!==null){var bt=w.baseState;Q=0,pt=je=Se=null,le=P;do{var Ct=le.lane&-536870913,fn=Ct!==le.lane;if(fn?(Bn&Ct)===Ct:(E&Ct)===Ct){Ct!==0&&Ct===Yr&&(su=!0),pt!==null&&(pt=pt.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var na=u,hc=le;Ct=h;var fc=_;switch(hc.tag){case 1:if(na=hc.payload,typeof na=="function"){bt=na.call(fc,bt,Ct);break e}bt=na;break e;case 3:na.flags=na.flags&-65537|128;case 0:if(na=hc.payload,Ct=typeof na=="function"?na.call(fc,bt,Ct):na,Ct==null)break e;bt=Mp({},bt,Ct);break e;case 2:hl=!0}}Ct=le.callback,Ct!==null&&(u.flags|=64,fn&&(u.flags|=8192),fn=w.callbacks,fn===null?w.callbacks=[Ct]:fn.push(Ct))}else fn={lane:Ct,tag:le.tag,payload:le.payload,callback:le.callback,next:null},pt===null?(je=pt=fn,Se=bt):pt=pt.next=fn,Q|=Ct;if(le=le.next,le===null){if(le=w.shared.pending,le===null)break;fn=le,le=fn.next,fn.next=null,w.lastBaseUpdate=fn,w.shared.pending=null}}while(!0);pt===null&&(Se=bt),w.baseState=Se,w.firstBaseUpdate=je,w.lastBaseUpdate=pt,P===null&&(w.shared.lanes=0),ea|=Q,u.lanes=Q,u.memoizedState=bt}}function oe(u,h){if(typeof u!="function")throw Error(s(191,u));u.call(h)}function Ke(u,h){var _=u.callbacks;if(_!==null)for(u.callbacks=null,u=0;u<_.length;u++)oe(_[u],h)}function nt(u,h){if(Mr(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var _=Object.keys(u),E=Object.keys(h);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var w=_[E];if(!To.call(h,w)||!Mr(u[w],h[w]))return!1}return!0}function yt(u){return u=u.status,u==="fulfilled"||u==="rejected"}function it(){}function ke(u,h,_){switch(_=u[_],_===void 0?u.push(h):_!==h&&(h.then(it,it),h=_),h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,u===Ah?Error(s(483)):u;default:if(typeof h.status=="string")h.then(it,it);else{if(u=ni,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=h,u.status="pending",u.then(function(E){if(h.status==="pending"){var w=h;w.status="fulfilled",w.value=E}},function(E){if(h.status==="pending"){var w=h;w.status="rejected",w.reason=E}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,u===Ah?Error(s(483)):u}throw ic=h,Ah}}function vt(){if(ic===null)throw Error(s(459));var u=ic;return ic=null,u}function Ot(u){var h=rc;return rc+=1,sc===null&&(sc=[]),ke(sc,u,h)}function cn(u,h){h=h.props.ref,u.ref=h!==void 0?h:null}function Zt(u,h){throw h.$$typeof===vE?Error(s(525)):(u=Object.prototype.toString.call(h),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u)))}function Gi(u){var h=u._init;return h(u._payload)}function _n(u){function h(De,fe){if(u){var Oe=De.deletions;Oe===null?(De.deletions=[fe],De.flags|=16):Oe.push(fe)}}function _(De,fe){if(!u)return null;for(;fe!==null;)h(De,fe),fe=fe.sibling;return null}function E(De){for(var fe=new Map;De!==null;)De.key!==null?fe.set(De.key,De):fe.set(De.index,De),De=De.sibling;return fe}function w(De,fe){return De=Sa(De,fe),De.index=0,De.sibling=null,De}function P(De,fe,Oe){return De.index=Oe,u?(Oe=De.alternate,Oe!==null?(Oe=Oe.index,Oe<fe?(De.flags|=33554434,fe):Oe):(De.flags|=33554434,fe)):(De.flags|=1048576,fe)}function Q(De){return u&&De.alternate===null&&(De.flags|=33554434),De}function le(De,fe,Oe,ct){return fe===null||fe.tag!==6?(fe=bp(Oe,De.mode,ct),fe.return=De,fe):(fe=w(fe,Oe),fe.return=De,fe)}function Se(De,fe,Oe,ct){var Ht=Oe.type;return Ht===Kl?pt(De,fe,Oe.props.children,ct,Oe.key):fe!==null&&(fe.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===ba&&Gi(Ht)===fe.type)?(fe=w(fe,Oe.props),cn(fe,Oe),fe.return=De,fe):(fe=Ao(Oe.type,Oe.key,Oe.props,null,De.mode,ct),cn(fe,Oe),fe.return=De,fe)}function je(De,fe,Oe,ct){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==Oe.containerInfo||fe.stateNode.implementation!==Oe.implementation?(fe=qg(Oe,De.mode,ct),fe.return=De,fe):(fe=w(fe,Oe.children||[]),fe.return=De,fe)}function pt(De,fe,Oe,ct,Ht){return fe===null||fe.tag!==7?(fe=Ui(Oe,De.mode,ct,Ht),fe.return=De,fe):(fe=w(fe,Oe),fe.return=De,fe)}function bt(De,fe,Oe){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return fe=bp(""+fe,De.mode,Oe),fe.return=De,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case Gf:return Oe=Ao(fe.type,fe.key,fe.props,null,De.mode,Oe),cn(Oe,fe),Oe.return=De,Oe;case Ea:return fe=qg(fe,De.mode,Oe),fe.return=De,fe;case ba:var ct=fe._init;return fe=ct(fe._payload),bt(De,fe,Oe)}if(lh(fe)||r(fe))return fe=Ui(fe,De.mode,Oe,null),fe.return=De,fe;if(typeof fe.then=="function")return bt(De,Ot(fe),Oe);if(fe.$$typeof===Wa)return bt(De,Pe(De,fe),Oe);Zt(De,fe)}return null}function Ct(De,fe,Oe,ct){var Ht=fe!==null?fe.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Ht!==null?null:le(De,fe,""+Oe,ct);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case Gf:return Oe.key===Ht?Se(De,fe,Oe,ct):null;case Ea:return Oe.key===Ht?je(De,fe,Oe,ct):null;case ba:return Ht=Oe._init,Oe=Ht(Oe._payload),Ct(De,fe,Oe,ct)}if(lh(Oe)||r(Oe))return Ht!==null?null:pt(De,fe,Oe,ct,null);if(typeof Oe.then=="function")return Ct(De,fe,Ot(Oe),ct);if(Oe.$$typeof===Wa)return Ct(De,fe,Pe(De,Oe),ct);Zt(De,Oe)}return null}function fn(De,fe,Oe,ct,Ht){if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return De=De.get(Oe)||null,le(fe,De,""+ct,Ht);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case Gf:return De=De.get(ct.key===null?Oe:ct.key)||null,Se(fe,De,ct,Ht);case Ea:return De=De.get(ct.key===null?Oe:ct.key)||null,je(fe,De,ct,Ht);case ba:var bi=ct._init;return ct=bi(ct._payload),fn(De,fe,Oe,ct,Ht)}if(lh(ct)||r(ct))return De=De.get(Oe)||null,pt(fe,De,ct,Ht,null);if(typeof ct.then=="function")return fn(De,fe,Oe,Ot(ct),Ht);if(ct.$$typeof===Wa)return fn(De,fe,Oe,Pe(fe,ct),Ht);Zt(fe,ct)}return null}function na(De,fe,Oe,ct){for(var Ht=null,bi=null,tn=fe,Xn=fe=0,Qi=null;tn!==null&&Xn<Oe.length;Xn++){tn.index>Xn?(Qi=tn,tn=null):Qi=tn.sibling;var Rn=Ct(De,tn,Oe[Xn],ct);if(Rn===null){tn===null&&(tn=Qi);break}u&&tn&&Rn.alternate===null&&h(De,tn),fe=P(Rn,fe,Xn),bi===null?Ht=Rn:bi.sibling=Rn,bi=Rn,tn=Qi}if(Xn===Oe.length)return _(De,tn),Un&&K(De,Xn),Ht;if(tn===null){for(;Xn<Oe.length;Xn++)tn=bt(De,Oe[Xn],ct),tn!==null&&(fe=P(tn,fe,Xn),bi===null?Ht=tn:bi.sibling=tn,bi=tn);return Un&&K(De,Xn),Ht}for(tn=E(tn);Xn<Oe.length;Xn++)Qi=fn(tn,De,Xn,Oe[Xn],ct),Qi!==null&&(u&&Qi.alternate!==null&&tn.delete(Qi.key===null?Xn:Qi.key),fe=P(Qi,fe,Xn),bi===null?Ht=Qi:bi.sibling=Qi,bi=Qi);return u&&tn.forEach(function(No){return h(De,No)}),Un&&K(De,Xn),Ht}function hc(De,fe,Oe,ct){if(Oe==null)throw Error(s(151));for(var Ht=null,bi=null,tn=fe,Xn=fe=0,Qi=null,Rn=Oe.next();tn!==null&&!Rn.done;Xn++,Rn=Oe.next()){tn.index>Xn?(Qi=tn,tn=null):Qi=tn.sibling;var No=Ct(De,tn,Rn.value,ct);if(No===null){tn===null&&(tn=Qi);break}u&&tn&&No.alternate===null&&h(De,tn),fe=P(No,fe,Xn),bi===null?Ht=No:bi.sibling=No,bi=No,tn=Qi}if(Rn.done)return _(De,tn),Un&&K(De,Xn),Ht;if(tn===null){for(;!Rn.done;Xn++,Rn=Oe.next())Rn=bt(De,Rn.value,ct),Rn!==null&&(fe=P(Rn,fe,Xn),bi===null?Ht=Rn:bi.sibling=Rn,bi=Rn);return Un&&K(De,Xn),Ht}for(tn=E(tn);!Rn.done;Xn++,Rn=Oe.next())Rn=fn(tn,De,Xn,Rn.value,ct),Rn!==null&&(u&&Rn.alternate!==null&&tn.delete(Rn.key===null?Xn:Rn.key),fe=P(Rn,fe,Xn),bi===null?Ht=Rn:bi.sibling=Rn,bi=Rn);return u&&tn.forEach(function(em){return h(De,em)}),Un&&K(De,Xn),Ht}function fc(De,fe,Oe,ct){if(typeof Oe=="object"&&Oe!==null&&Oe.type===Kl&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case Gf:e:{for(var Ht=Oe.key;fe!==null;){if(fe.key===Ht){if(Ht=Oe.type,Ht===Kl){if(fe.tag===7){_(De,fe.sibling),ct=w(fe,Oe.props.children),ct.return=De,De=ct;break e}}else if(fe.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===ba&&Gi(Ht)===fe.type){_(De,fe.sibling),ct=w(fe,Oe.props),cn(ct,Oe),ct.return=De,De=ct;break e}_(De,fe);break}else h(De,fe);fe=fe.sibling}Oe.type===Kl?(ct=Ui(Oe.props.children,De.mode,ct,Oe.key),ct.return=De,De=ct):(ct=Ao(Oe.type,Oe.key,Oe.props,null,De.mode,ct),cn(ct,Oe),ct.return=De,De=ct)}return Q(De);case Ea:e:{for(Ht=Oe.key;fe!==null;){if(fe.key===Ht)if(fe.tag===4&&fe.stateNode.containerInfo===Oe.containerInfo&&fe.stateNode.implementation===Oe.implementation){_(De,fe.sibling),ct=w(fe,Oe.children||[]),ct.return=De,De=ct;break e}else{_(De,fe);break}else h(De,fe);fe=fe.sibling}ct=qg(Oe,De.mode,ct),ct.return=De,De=ct}return Q(De);case ba:return Ht=Oe._init,Oe=Ht(Oe._payload),fc(De,fe,Oe,ct)}if(lh(Oe))return na(De,fe,Oe,ct);if(r(Oe)){if(Ht=r(Oe),typeof Ht!="function")throw Error(s(150));return Oe=Ht.call(Oe),hc(De,fe,Oe,ct)}if(typeof Oe.then=="function")return fc(De,fe,Ot(Oe),ct);if(Oe.$$typeof===Wa)return fc(De,fe,Pe(De,Oe),ct);Zt(De,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint"?(Oe=""+Oe,fe!==null&&fe.tag===6?(_(De,fe.sibling),ct=w(fe,Oe),ct.return=De,De=ct):(_(De,fe),ct=bp(Oe,De.mode,ct),ct.return=De,De=ct),Q(De)):_(De,fe)}return function(De,fe,Oe,ct){try{rc=0;var Ht=fc(De,fe,Oe,ct);return sc=null,Ht}catch(tn){if(tn===Ah)throw tn;var bi=t(29,tn,null,De.mode);return bi.lanes=ct,bi.return=De,bi}finally{}}}function Ci(u,h){u=Ws,D(xh,u),D(yi,h),Ws=u|h.baseLanes}function $n(){D(xh,Ws),D(yi,yi.current)}function As(){Ws=xh.current,T(yi),T(xh)}function er(u){var h=u.alternate;D(ps,ps.current&1),D(Kr,u),hi===null&&(h===null||yi.current!==null||h.memoizedState!==null)&&(hi=u)}function Lc(u){if(u.tag===22){if(D(ps,ps.current),D(Kr,u),hi===null){var h=u.alternate;h!==null&&h.memoizedState!==null&&(hi=u)}}else ns()}function ns(){D(ps,ps.current),D(Kr,Kr.current)}function tr(u){T(Kr),hi===u&&(hi=null),T(ps)}function nr(u){for(var h=u;h!==null;){if(h.tag===13){var _=h.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||Lp(_)||Up(_)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Kn(){throw Error(s(321))}function gr(u,h){if(h===null)return!1;for(var _=0;_<h.length&&_<u.length;_++)if(!Mr(u[_],h[_]))return!1;return!0}function yr(u,h,_,E,w,P){return fl=P,Sn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,en.H=u===null||u.memoizedState===null?lc:cr,oc=!1,P=_(E,w),oc=!1,ru&&(P=xs(h,_,E,w)),zr(u),P}function zr(u){en.H=Pi;var h=Wt!==null&&Wt.next!==null;if(fl=0,Hn=Wt=Sn=null,wa=!1,au=0,Cs=null,h)throw Error(s(300));u===null||fi||(u=u.dependencies,u!==null&&V(u)&&(fi=!0))}function xs(u,h,_,E){Sn=u;var w=0;do{if(ru&&(Cs=null),au=0,ru=!1,25<=w)throw Error(s(301));if(w+=1,Hn=Wt=null,u.updateQueue!=null){var P=u.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}en.H=Jr,P=h(_,E)}while(ru);return P}function Ri(){var u=en.H,h=u.useState()[0];return h=typeof h.then=="function"?Be(h):h,u=u.useState()[0],(Wt!==null?Wt.memoizedState:null)!==u&&(Sn.flags|=1024),h}function qo(){var u=Xp!==0;return Xp=0,u}function po(u,h,_){h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~_}function J(u){if(wa){for(u=u.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}wa=!1}fl=0,Hn=Wt=Sn=null,ru=!1,au=Xp=0,Cs=null}function de(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?Sn.memoizedState=Hn=u:Hn=Hn.next=u,Hn}function be(){if(Wt===null){var u=Sn.alternate;u=u!==null?u.memoizedState:null}else u=Wt.next;var h=Hn===null?Sn.memoizedState:Hn.next;if(h!==null)Hn=h,Wt=u;else{if(u===null)throw Sn.alternate===null?Error(s(467)):Error(s(310));Wt=u,u={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Hn===null?Sn.memoizedState=Hn=u:Hn=Hn.next=u}return Hn}function Be(u){var h=au;return au+=1,Cs===null&&(Cs=[]),u=ke(Cs,u,h),h=Sn,(Hn===null?h.memoizedState:Hn.next)===null&&(h=h.alternate,en.H=h===null||h.memoizedState===null?lc:cr),u}function _e(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Be(u);if(u.$$typeof===Wa)return ve(u)}throw Error(s(438,String(u)))}function at(u){var h=null,_=Sn.updateQueue;if(_!==null&&(h=_.memoCache),h==null){var E=Sn.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(h={data:E.data.map(function(w){return w.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),_===null&&(_=Wp(),Sn.updateQueue=_),_.memoCache=h,_=h.data[h.index],_===void 0)for(_=h.data[h.index]=Array(u),E=0;E<u;E++)_[E]=_v;return h.index++,_}function dt(u,h){return typeof h=="function"?h(u):h}function xt(u){var h=be();return mt(h,Wt,u)}function mt(u,h,_){var E=u.queue;if(E===null)throw Error(s(311));E.lastRenderedReducer=_;var w=u.baseQueue,P=E.pending;if(P!==null){if(w!==null){var Q=w.next;w.next=P.next,P.next=Q}h.baseQueue=w=P,E.pending=null}if(P=u.baseState,w===null)u.memoizedState=P;else{h=w.next;var le=Q=null,Se=null,je=h,pt=!1;do{var bt=je.lane&-536870913;if(bt!==je.lane?(Bn&bt)===bt:(fl&bt)===bt){var Ct=je.revertLane;if(Ct===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),bt===Yr&&(pt=!0);else if((fl&Ct)===Ct){je=je.next,Ct===Yr&&(pt=!0);continue}else bt={lane:0,revertLane:je.revertLane,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null},Se===null?(le=Se=bt,Q=P):Se=Se.next=bt,Sn.lanes|=Ct,ea|=Ct;bt=je.action,oc&&_(P,bt),P=je.hasEagerState?je.eagerState:_(P,bt)}else Ct={lane:bt,revertLane:je.revertLane,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null},Se===null?(le=Se=Ct,Q=P):Se=Se.next=Ct,Sn.lanes|=bt,ea|=bt;je=je.next}while(je!==null&&je!==h);if(Se===null?Q=P:Se.next=le,!Mr(P,u.memoizedState)&&(fi=!0,pt&&(_=iu,_!==null)))throw _;u.memoizedState=P,u.baseState=Q,u.baseQueue=Se,E.lastRenderedState=P}return w===null&&(E.lanes=0),[u.memoizedState,E.dispatch]}function zt(u){var h=be(),_=h.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=u;var E=_.dispatch,w=_.pending,P=h.memoizedState;if(w!==null){_.pending=null;var Q=w=w.next;do P=u(P,Q.action),Q=Q.next;while(Q!==w);Mr(P,h.memoizedState)||(fi=!0),h.memoizedState=P,h.baseQueue===null&&(h.baseState=P),_.lastRenderedState=P}return[P,E]}function jt(u,h,_){var E=Sn,w=be(),P=Un;if(P){if(_===void 0)throw Error(s(407));_=_()}else _=h();var Q=!Mr((Wt||w).memoizedState,_);if(Q&&(w.memoizedState=_,fi=!0),w=w.queue,xf(wn.bind(null,E,w,u),[u]),w.getSnapshot!==h||Q||Hn!==null&&Hn.memoizedState.tag&1){if(E.flags|=2048,Si(9,ln.bind(null,E,w,_,h),{destroy:void 0},null),ni===null)throw Error(s(349));P||(fl&60)!==0||Lt(E,h,_)}return _}function Lt(u,h,_){u.flags|=16384,u={getSnapshot:h,value:_},h=Sn.updateQueue,h===null?(h=Wp(),Sn.updateQueue=h,h.stores=[u]):(_=h.stores,_===null?h.stores=[u]:_.push(u))}function ln(u,h,_,E){h.value=_,h.getSnapshot=E,si(h)&&Vn(u)}function wn(u,h,_){return _(function(){si(h)&&Vn(u)})}function si(u){var h=u.getSnapshot;u=u.value;try{var _=h();return!Mr(u,_)}catch{return!0}}function Vn(u){var h=Fe(u,2);h!==null&&bs(h,u,2)}function an(u){var h=de();if(typeof u=="function"){var _=u;if(u=_(),oc){ee(!0);try{_()}finally{ee(!1)}}}return h.memoizedState=h.baseState=u,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dt,lastRenderedState:u},h}function Vt(u,h,_,E){return u.baseState=_,mt(u,Wt,typeof E=="function"?E:dt)}function li(u,h,_,E,w){if(Ll(u))throw Error(s(485));if(u=h.action,u!==null){var P={payload:w,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){P.listeners.push(Q)}};en.T!==null?_(!0):P.isTransition=!1,E(P),_=h.pending,_===null?(P.next=h.pending=P,xn(h,P)):(P.next=_.next,h.pending=_.next=P)}}function xn(u,h){var _=h.action,E=h.payload,w=u.state;if(h.isTransition){var P=en.T,Q={};en.T=Q;try{var le=_(w,E),Se=en.S;Se!==null&&Se(Q,le),is(u,h,le)}catch(je){us(u,h,je)}finally{en.T=P}}else try{P=_(w,E),is(u,h,P)}catch(je){us(u,h,je)}}function is(u,h,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(E){ir(u,h,E)},function(E){return us(u,h,E)}):ir(u,h,_)}function ir(u,h,_){h.status="fulfilled",h.value=_,ci(h),u.state=_,h=u.pending,h!==null&&(_=h.next,_===h?u.pending=null:(_=_.next,h.next=_,xn(u,_)))}function us(u,h,_){var E=u.pending;if(u.pending=null,E!==null){E=E.next;do h.status="rejected",h.reason=_,ci(h),h=h.next;while(h!==E)}u.action=null}function ci(u){u=u.listeners;for(var h=0;h<u.length;h++)(0,u[h])()}function Mn(u,h){return h}function ji(u,h){if(Un){var _=ni.formState;if(_!==null){e:{var E=Sn;if(Un){if(Ps){var w=ly(Ps,Ms);if(w){Ps=cy(w),E=Vv(w);break e}}lt(E)}E=!1}E&&(h=_[0])}}_=de(),_.memoizedState=_.baseState=h,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mn,lastRenderedState:h},_.queue=E,_=ju.bind(null,Sn,E),E.dispatch=_,E=an(!1);var P=pa.bind(null,Sn,!1,E.queue);return E=de(),w={state:h,dispatch:null,action:u,pending:null},E.queue=w,_=li.bind(null,Sn,w,P,_),w.dispatch=_,E.memoizedState=u,[h,_,!1]}function Li(u){var h=be();return mi(h,Wt,u)}function mi(u,h,_){h=mt(u,h,Mn)[0],u=xt(dt)[0],h=typeof h=="object"&&h!==null&&typeof h.then=="function"?Be(h):h;var E=be(),w=E.queue,P=w.dispatch;return _!==E.memoizedState&&(Sn.flags|=2048,Si(9,un.bind(null,w,_),{destroy:void 0},null)),[h,P,u]}function un(u,h){u.action=h}function ha(u){var h=be(),_=Wt;if(_!==null)return mi(h,_,u);be(),h=h.memoizedState,_=be();var E=_.queue.dispatch;return _.memoizedState=u,[h,E,!1]}function Si(u,h,_,E){return u={tag:u,create:h,inst:_,deps:E,next:null},h=Sn.updateQueue,h===null&&(h=Wp(),Sn.updateQueue=h),_=h.lastEffect,_===null?h.lastEffect=u.next=u:(E=_.next,_.next=u,u.next=E,h.lastEffect=u),u}function Dl(){return be().memoizedState}function Uc(u,h,_,E){var w=de();Sn.flags|=u,w.memoizedState=Si(1|h,_,{destroy:void 0},E===void 0?null:E)}function Il(u,h,_,E){var w=be();E=E===void 0?null:E;var P=w.memoizedState.inst;Wt!==null&&E!==null&&gr(E,Wt.memoizedState.deps)?w.memoizedState=Si(h,_,P,E):(Sn.flags|=u,w.memoizedState=Si(1|h,_,P,E))}function ku(u,h){Uc(8390656,8,u,h)}function xf(u,h){Il(2048,8,u,h)}function hp(u,h){return Il(4,2,u,h)}function Pc(u,h){return Il(4,4,u,h)}function mo(u,h){if(typeof h=="function"){u=u();var _=h(u);return function(){typeof _=="function"?_():h(null)}}if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function Vr(u,h,_){_=_!=null?_.concat([u]):null,Il(4,4,mo.bind(null,h,u),_)}function Ha(){}function go(u,h){var _=be();h=h===void 0?null:h;var E=_.memoizedState;return h!==null&&gr(h,E[1])?E[0]:(_.memoizedState=[u,h],u)}function Gu(u,h){var _=be();h=h===void 0?null:h;var E=_.memoizedState;if(h!==null&&gr(h,E[1]))return E[0];if(E=u(),oc){ee(!0);try{u()}finally{ee(!1)}}return _.memoizedState=[E,h],E}function fa(u,h,_){return _===void 0||(fl&1073741824)!==0?u.memoizedState=h:(u.memoizedState=_,u=zg(),Sn.lanes|=u,ea|=u,_)}function Sf(u,h,_,E){return Mr(_,h)?_:yi.current!==null?(u=fa(u,_,E),Mr(u,h)||(fi=!0),u):(fl&42)===0?(fi=!0,u.memoizedState=_):(u=zg(),Sn.lanes|=u,ea|=u,h)}function Bl(u,h,_,E,w){var P=ol();qs(P!==0&&8>P?P:8);var Q=en.T,le={};en.T=le,pa(u,!1,h,_);try{var Se=w(),je=en.S;if(je!==null&&je(le,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var pt=ht(Se,E);vr(u,h,pt,Wi(u))}else vr(u,h,E,Wi(u))}catch(bt){vr(u,h,{then:function(){},status:"rejected",reason:bt},Wi())}finally{qs(P),en.T=Q}}function da(u){var h=u.memoizedState;if(h!==null)return h;h={memoizedState:Ql,baseState:Ql,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:dt,lastRenderedState:Ql},next:null};var _={};return h.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:dt,lastRenderedState:_},next:null},u.memoizedState=h,u=u.alternate,u!==null&&(u.memoizedState=h),h}function _r(){return ve(Ya)}function Nl(){return be().memoizedState}function ka(){return be().memoizedState}function Ol(u){for(var h=u.return;h!==null;){switch(h.tag){case 24:case 3:var _=Wi();u=et(_);var E=ft(h,u,_);E!==null&&(bs(E,h,_),Dt(E,h,_)),h={cache:Dn()},u.payload=h;return}h=h.return}}function Xo(u,h,_){var E=Wi();_={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},Ll(u)?hs(h,_):(_=tt(u,h,_,E),_!==null&&(bs(_,u,E),Jn(_,h,E)))}function ju(u,h,_){var E=Wi();vr(u,h,_,E)}function vr(u,h,_,E){var w={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(Ll(u))hs(h,w);else{var P=u.alternate;if(u.lanes===0&&(P===null||P.lanes===0)&&(P=h.lastRenderedReducer,P!==null))try{var Q=h.lastRenderedState,le=P(Q,_);if(w.hasEagerState=!0,w.eagerState=le,Mr(le,Q))return He(u,h,w,0),ni===null&&Ge(),!1}catch{}finally{}if(_=tt(u,h,w,E),_!==null)return bs(_,u,E),Jn(_,h,E),!0}return!1}function pa(u,h,_,E){if(E={lane:2,revertLane:Ue(),action:E,hasEagerState:!1,eagerState:null,next:null},Ll(u)){if(h)throw Error(s(479))}else h=tt(u,_,E,2),h!==null&&bs(h,u,2)}function Ll(u){var h=u.alternate;return u===Sn||h!==null&&h===Sn}function hs(u,h){ru=wa=!0;var _=u.pending;_===null?h.next=h:(h.next=_.next,_.next=h),u.pending=h}function Jn(u,h,_){if((_&4194176)!==0){var E=h.lanes;E&=u.pendingLanes,_|=E,h.lanes=_,he(u,_)}}function Ul(u,h,_,E){h=u.memoizedState,_=_(E,h),_=_==null?h:Mp({},h,_),u.memoizedState=_,u.lanes===0&&(u.updateQueue.baseState=_)}function Pl(u,h,_,E,w,P,Q){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,P,Q):h.prototype&&h.prototype.isPureReactComponent?!nt(_,E)||!nt(w,P):!0}function Ef(u,h,_,E){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(_,E),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(_,E),h.state!==u&&Co.enqueueReplaceState(h,h.state,null)}function ma(u,h){var _=h;if("ref"in h){_={};for(var E in h)E!=="ref"&&(_[E]=h[E])}if(u=u.defaultProps){_===h&&(_=Mp({},_));for(var w in u)_[w]===void 0&&(_[w]=u[w])}return _}function Wo(u,h){try{var _=u.onUncaughtError;_(h.value,{componentStack:h.stack})}catch(E){setTimeout(function(){throw E})}}function Ga(u,h,_){try{var E=u.onCaughtError;E(_.value,{componentStack:_.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function Yo(u,h,_){return _=et(_),_.tag=3,_.payload={element:null},_.callback=function(){Wo(u,h)},_}function Hr(u){return u=et(u),u.tag=3,u}function bf(u,h,_,E){var w=_.type.getDerivedStateFromError;if(typeof w=="function"){var P=E.value;u.payload=function(){return w(P)},u.callback=function(){Ga(h,_,E)}}var Q=_.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(u.callback=function(){Ga(h,_,E),typeof w!="function"&&(cc===null?cc=new Set([this]):cc.add(this));var le=E.stack;this.componentDidCatch(E.value,{componentStack:le!==null?le:""})})}function wg(u,h,_,E,w){if(_.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(h=_.alternate,h!==null&&O(h,_,w,!0),_=Kr.current,_!==null){switch(_.tag){case 13:return hi===null?tl():_.alternate===null&&di===0&&(di=3),_.flags&=-257,_.flags|=65536,_.lanes=w,E===sd?_.flags|=16384:(h=_.updateQueue,h===null?_.updateQueue=new Set([E]):h.add(E),qc(u,E,w)),!1;case 22:return _.flags|=65536,E===sd?_.flags|=16384:(h=_.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([E])},_.updateQueue=h):(_=h.retryQueue,_===null?h.retryQueue=new Set([E]):_.add(E)),qc(u,E,w)),!1}throw Error(s(435,_.tag))}return qc(u,E,w),tl(),!1}if(Un)return h=Kr.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=w,E!==td&&(u=Error(s(422),{cause:E}),se(ye(u,_)))):(E!==td&&(h=Error(s(423),{cause:E}),se(ye(h,_))),u=u.current.alternate,u.flags|=65536,w&=-w,u.lanes|=w,E=ye(E,_),w=Yo(u.stateNode,E,w),re(u,w),di!==4&&(di=2)),!1;var P=Error(s(520),{cause:E});if(P=ye(P,_),lu===null?lu=[P]:lu.push(P),di!==4&&(di=2),h===null)return!0;E=ye(E,_),_=h;do{switch(_.tag){case 3:return _.flags|=65536,u=w&-w,_.lanes|=u,u=Yo(_.stateNode,E,u),re(_,u),!1;case 1:if(h=_.type,P=_.stateNode,(_.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(cc===null||!cc.has(P))))return _.flags|=65536,w&=-w,_.lanes|=w,w=Hr(w),bf(w,u,_,E),re(_,w),!1}_=_.return}while(_!==null);return!1}function wi(u,h,_,E){h.child=u===null?Mo(h,null,_,E):ac(h,u.child,_,E)}function Fc(u,h,_,E,w){_=_.render;var P=h.ref;if("ref"in E){var Q={};for(var le in E)le!=="ref"&&(Q[le]=E[le])}else Q=E;return Z(h),E=yr(u,h,_,Q,P,w),le=qo(),u!==null&&!fi?(po(u,h,w),ga(u,h,w)):(Un&&le&&Ee(h),h.flags|=1,wi(u,h,E,w),h.child)}function qu(u,h,_,E,w){if(u===null){var P=_.type;return typeof P=="function"&&!zf(P)&&P.defaultProps===void 0&&_.compare===null?(h.tag=15,h.type=P,zc(u,h,P,E,w)):(u=Ao(_.type,null,E,h,h.mode,w),u.ref=h.ref,u.return=h,h.child=u)}if(P=u.child,!Yu(u,w)){var Q=P.memoizedProps;if(_=_.compare,_=_!==null?_:nt,_(Q,E)&&u.ref===h.ref)return ga(u,h,w)}return h.flags|=1,u=Sa(P,E),u.ref=h.ref,u.return=h,h.child=u}function zc(u,h,_,E,w){if(u!==null){var P=u.memoizedProps;if(nt(P,E)&&u.ref===h.ref)if(fi=!1,h.pendingProps=E=P,Yu(u,w))(u.flags&131072)!==0&&(fi=!0);else return h.lanes=u.lanes,ga(u,h,w)}return kc(u,h,_,E,w)}function Tf(u,h,_){var E=h.pendingProps,w=E.children,P=(h.stateNode._pendingVisibility&2)!==0,Q=u!==null?u.memoizedState:null;if(Hc(u,h),E.mode==="hidden"||P){if((h.flags&128)!==0){if(E=Q!==null?Q.baseLanes|_:_,u!==null){for(w=h.child=u.child,P=0;w!==null;)P=P|w.lanes|w.childLanes,w=w.sibling;h.childLanes=P&~E}else h.childLanes=0,h.child=null;return Vc(u,h,E,_)}if((_&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},u!==null&&qi(h,Q!==null?Q.cachePool:null),Q!==null?Ci(h,Q):$n(),Lc(h);else return h.lanes=h.childLanes=536870912,Vc(u,h,Q!==null?Q.baseLanes|_:_,_)}else Q!==null?(qi(h,Q.cachePool),Ci(h,Q),ns(),h.memoizedState=null):(u!==null&&qi(h,null),$n(),ns());return wi(u,h,w,_),h.child}function Vc(u,h,_,E){var w=In();return w=w===null?null:{parent:ar?_i._currentValue:_i._currentValue2,pool:w},h.memoizedState={baseLanes:_,cachePool:w},u!==null&&qi(h,null),$n(),Lc(h),u!==null&&O(u,h,E,!0),null}function Hc(u,h){var _=h.ref;if(_===null)u!==null&&u.ref!==null&&(h.flags|=2097664);else{if(typeof _!="function"&&typeof _!="object")throw Error(s(284));(u===null||u.ref!==_)&&(h.flags|=2097664)}}function kc(u,h,_,E,w){return Z(h),_=yr(u,h,_,E,void 0,w),E=qo(),u!==null&&!fi?(po(u,h,w),ga(u,h,w)):(Un&&E&&Ee(h),h.flags|=1,wi(u,h,_,w),h.child)}function Fl(u,h,_,E,w,P){return Z(h),h.updateQueue=null,_=xs(h,E,_,w),zr(u),E=qo(),u!==null&&!fi?(po(u,h,P),ga(u,h,P)):(Un&&E&&Ee(h),h.flags|=1,wi(u,h,_,P),h.child)}function Mf(u,h,_,E,w){if(Z(h),h.stateNode===null){var P=tc,Q=_.contextType;typeof Q=="object"&&Q!==null&&(P=ve(Q)),P=new _(E,P),h.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=Co,h.stateNode=P,P._reactInternals=h,P=h.stateNode,P.props=E,P.state=h.memoizedState,P.refs={},wt(h),Q=_.contextType,P.context=typeof Q=="object"&&Q!==null?ve(Q):tc,P.state=h.memoizedState,Q=_.getDerivedStateFromProps,typeof Q=="function"&&(Ul(h,_,Q,E),P.state=h.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(Q=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),Q!==P.state&&Co.enqueueReplaceState(P,P.state,null),rt(h,E,P,w),Te(),P.state=h.memoizedState),typeof P.componentDidMount=="function"&&(h.flags|=4194308),E=!0}else if(u===null){P=h.stateNode;var le=h.memoizedProps,Se=ma(_,le);P.props=Se;var je=P.context,pt=_.contextType;Q=tc,typeof pt=="object"&&pt!==null&&(Q=ve(pt));var bt=_.getDerivedStateFromProps;pt=typeof bt=="function"||typeof P.getSnapshotBeforeUpdate=="function",le=h.pendingProps!==le,pt||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(le||je!==Q)&&Ef(h,P,E,Q),hl=!1;var Ct=h.memoizedState;P.state=Ct,rt(h,E,P,w),Te(),je=h.memoizedState,le||Ct!==je||hl?(typeof bt=="function"&&(Ul(h,_,bt,E),je=h.memoizedState),(Se=hl||Pl(h,_,Se,E,Ct,je,Q))?(pt||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(h.flags|=4194308)):(typeof P.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=E,h.memoizedState=je),P.props=E,P.state=je,P.context=Q,E=Se):(typeof P.componentDidMount=="function"&&(h.flags|=4194308),E=!1)}else{P=h.stateNode,Mt(u,h),Q=h.memoizedProps,pt=ma(_,Q),P.props=pt,bt=h.pendingProps,Ct=P.context,je=_.contextType,Se=tc,typeof je=="object"&&je!==null&&(Se=ve(je)),le=_.getDerivedStateFromProps,(je=typeof le=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Q!==bt||Ct!==Se)&&Ef(h,P,E,Se),hl=!1,Ct=h.memoizedState,P.state=Ct,rt(h,E,P,w),Te();var fn=h.memoizedState;Q!==bt||Ct!==fn||hl||u!==null&&u.dependencies!==null&&V(u.dependencies)?(typeof le=="function"&&(Ul(h,_,le,E),fn=h.memoizedState),(pt=hl||Pl(h,_,pt,E,Ct,fn,Se)||u!==null&&u.dependencies!==null&&V(u.dependencies))?(je||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(E,fn,Se),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(E,fn,Se)),typeof P.componentDidUpdate=="function"&&(h.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof P.componentDidUpdate!="function"||Q===u.memoizedProps&&Ct===u.memoizedState||(h.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Q===u.memoizedProps&&Ct===u.memoizedState||(h.flags|=1024),h.memoizedProps=E,h.memoizedState=fn),P.props=E,P.state=fn,P.context=Se,E=pt):(typeof P.componentDidUpdate!="function"||Q===u.memoizedProps&&Ct===u.memoizedState||(h.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Q===u.memoizedProps&&Ct===u.memoizedState||(h.flags|=1024),E=!1)}return P=E,Hc(u,h),E=(h.flags&128)!==0,P||E?(P=h.stateNode,_=E&&typeof _.getDerivedStateFromError!="function"?null:P.render(),h.flags|=1,u!==null&&E?(h.child=ac(h,u.child,null,w),h.child=ac(h,null,_,w)):wi(u,h,_,w),h.memoizedState=P.state,u=h.child):u=ga(u,h,w),u}function Cf(u,h,_,E){return It(),h.flags|=256,wi(u,h,_,E),h.child}function Gc(u){return{baseLanes:u,cachePool:ss()}}function Ko(u,h,_){return u=u!==null?u.childLanes&~_:0,h&&(u|=ta),u}function Rf(u,h,_){var E=h.pendingProps,w=!1,P=(h.flags&128)!==0,Q;if((Q=P)||(Q=u!==null&&u.memoizedState===null?!1:(ps.current&2)!==0),Q&&(w=!0,h.flags&=-129),Q=(h.flags&32)!==0,h.flags&=-33,u===null){if(Un){if(w?er(h):ns(),Un){var le=Ps,Se;(Se=le)&&(le=Gv(le,Ms),le!==null?(h.memoizedState={dehydrated:le,treeContext:nc!==null?{id:Ja,overflow:Qa}:null,retryLane:536870912},Se=t(18,null,null,0),Se.stateNode=le,Se.return=h,h.child=Se,Us=h,Ps=null,Se=!0):Se=!1),Se||lt(h)}if(le=h.memoizedState,le!==null&&(le=le.dehydrated,le!==null))return Up(le)?h.lanes=16:h.lanes=536870912,null;tr(h)}return le=E.children,E=E.fallback,w?(ns(),w=h.mode,le=Xu({mode:"hidden",children:le},w),E=Ui(E,w,_,null),le.return=h,E.return=h,le.sibling=E,h.child=le,w=h.child,w.memoizedState=Gc(_),w.childLanes=Ko(u,Q,_),h.memoizedState=Jp,E):(er(h),zl(h,le))}if(Se=u.memoizedState,Se!==null&&(le=Se.dehydrated,le!==null)){if(P)h.flags&256?(er(h),h.flags&=-257,h=jc(u,h,_)):h.memoizedState!==null?(ns(),h.child=u.child,h.flags|=128,h=null):(ns(),w=E.fallback,le=h.mode,E=Xu({mode:"visible",children:E.children},le),w=Ui(w,le,_,null),w.flags|=2,E.return=h,w.return=h,E.sibling=w,h.child=E,ac(h,u.child,null,_),E=h.child,E.memoizedState=Gc(_),E.childLanes=Ko(u,Q,_),h.memoizedState=Jp,h=w);else if(er(h),Up(le))Q=Fv(le).digest,E=Error(s(419)),E.stack="",E.digest=Q,se({value:E,source:null,stack:null}),h=jc(u,h,_);else if(fi||O(u,h,_,!1),Q=(_&u.childLanes)!==0,fi||Q){if(Q=ni,Q!==null){if(E=_&-_,(E&42)!==0)E=1;else switch(E){case 2:E=1;break;case 8:E=4;break;case 32:E=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:E=64;break;case 268435456:E=134217728;break;default:E=0}if(E=(E&(Q.suspendedLanes|_))!==0?0:E,E!==0&&E!==Se.retryLane)throw Se.retryLane=E,Fe(u,E),bs(Q,u,E),Kp}Lp(le)||tl(),h=jc(u,h,_)}else Lp(le)?(h.flags|=128,h.child=u.child,h=nl.bind(null,u),zv(le,h),h=null):(u=Se.treeContext,Ls&&(Ps=kv(le),Us=h,Un=!0,Ca=null,Ms=!1,u!==null&&(Xr[Wr++]=Ja,Xr[Wr++]=Qa,Xr[Wr++]=nc,Ja=u.id,Qa=u.overflow,nc=h)),h=zl(h,E.children),h.flags|=4096);return h}return w?(ns(),w=E.fallback,le=h.mode,Se=u.child,P=Se.sibling,E=Sa(Se,{mode:"hidden",children:E.children}),E.subtreeFlags=Se.subtreeFlags&31457280,P!==null?w=Sa(P,w):(w=Ui(w,le,_,null),w.flags|=2),w.return=h,E.return=h,E.sibling=w,h.child=E,E=w,w=h.child,le=u.child.memoizedState,le===null?le=Gc(_):(Se=le.cachePool,Se!==null?(P=ar?_i._currentValue:_i._currentValue2,Se=Se.parent!==P?{parent:P,pool:P}:Se):Se=ss(),le={baseLanes:le.baseLanes|_,cachePool:Se}),w.memoizedState=le,w.childLanes=Ko(u,Q,_),h.memoizedState=Jp,E):(er(h),_=u.child,u=_.sibling,_=Sa(_,{mode:"visible",children:E.children}),_.return=h,_.sibling=null,u!==null&&(Q=h.deletions,Q===null?(h.deletions=[u],h.flags|=16):Q.push(u)),h.child=_,h.memoizedState=null,_)}function zl(u,h){return h=Xu({mode:"visible",children:h},u.mode),h.return=u,u.child=h}function Xu(u,h){return Hf(u,h,0,null)}function jc(u,h,_){return ac(h,u.child,null,_),u=zl(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function yo(u,h,_){u.lanes|=h;var E=u.alternate;E!==null&&(E.lanes|=h),_a(u.return,h,_)}function Wu(u,h,_,E,w){var P=u.memoizedState;P===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:w}:(P.isBackwards=h,P.rendering=null,P.renderingStartTime=0,P.last=E,P.tail=_,P.tailMode=w)}function wf(u,h,_){var E=h.pendingProps,w=E.revealOrder,P=E.tail;if(wi(u,h,E.children,_),E=ps.current,(E&2)!==0)E=E&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&yo(u,_,h);else if(u.tag===19)yo(u,_,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}E&=1}switch(D(ps,E),w){case"forwards":for(_=h.child,w=null;_!==null;)u=_.alternate,u!==null&&nr(u)===null&&(w=_),_=_.sibling;_=w,_===null?(w=h.child,h.child=null):(w=_.sibling,_.sibling=null),Wu(h,!1,w,_,P);break;case"backwards":for(_=null,w=h.child,h.child=null;w!==null;){if(u=w.alternate,u!==null&&nr(u)===null){h.child=w;break}u=w.sibling,w.sibling=_,_=w,w=u}Wu(h,!0,_,null,P);break;case"together":Wu(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function ga(u,h,_){if(u!==null&&(h.dependencies=u.dependencies),ea|=h.lanes,(_&h.childLanes)===0)if(u!==null){if(O(u,h,_,!1),(_&h.childLanes)===0)return null}else return null;if(u!==null&&h.child!==u.child)throw Error(s(153));if(h.child!==null){for(u=h.child,_=Sa(u,u.pendingProps),h.child=_,_.return=h;u.sibling!==null;)u=u.sibling,_=_.sibling=Sa(u,u.pendingProps),_.return=h;_.sibling=null}return h.child}function Yu(u,h){return(u.lanes&h)!==0?!0:(u=u.dependencies,!!(u!==null&&V(u)))}function Ku(u,h,_){switch(h.tag){case 3:Ve(h,h.stateNode.containerInfo),ja(h,_i,u.memoizedState.cache),It();break;case 27:case 5:ze(h);break;case 4:Ve(h,h.stateNode.containerInfo);break;case 10:ja(h,h.type,h.memoizedProps.value);break;case 13:var E=h.memoizedState;if(E!==null)return E.dehydrated!==null?(er(h),h.flags|=128,null):(_&h.child.childLanes)!==0?Rf(u,h,_):(er(h),u=ga(u,h,_),u!==null?u.sibling:null);er(h);break;case 19:var w=(u.flags&128)!==0;if(E=(_&h.childLanes)!==0,E||(O(u,h,_,!1),E=(_&h.childLanes)!==0),w){if(E)return wf(u,h,_);h.flags|=128}if(w=h.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),D(ps,ps.current),E)break;return null;case 22:case 23:return h.lanes=0,Tf(u,h,_);case 24:ja(h,_i,u.memoizedState.cache)}return ga(u,h,_)}function Gs(u,h,_){if(u!==null)if(u.memoizedProps!==h.pendingProps)fi=!0;else{if(!Yu(u,_)&&(h.flags&128)===0)return fi=!1,Ku(u,h,_);fi=(u.flags&131072)!==0}else fi=!1,Un&&(h.flags&1048576)!==0&&ce(h,gh,h.index);switch(h.lanes=0,h.tag){case 16:e:{u=h.pendingProps;var E=h.elementType,w=E._init;if(E=w(E._payload),h.type=E,typeof E=="function")zf(E)?(u=ma(E,u),h.tag=1,h=Mf(null,h,E,u,_)):(h.tag=0,h=kc(null,h,E,u,_));else{if(E!=null){if(w=E.$$typeof,w===Xf){h.tag=11,h=Fc(null,h,E,u,_);break e}else if(w===wp){h.tag=14,h=qu(null,h,E,u,_);break e}}throw h=o(E)||E,Error(s(306,h,""))}}return h;case 0:return kc(u,h,h.type,h.pendingProps,_);case 1:return E=h.type,w=ma(E,h.pendingProps),Mf(u,h,E,w,_);case 3:e:{if(Ve(h,h.stateNode.containerInfo),u===null)throw Error(s(387));var P=h.pendingProps;w=h.memoizedState,E=w.element,Mt(u,h),rt(h,P,null,_);var Q=h.memoizedState;if(P=Q.cache,ja(h,_i,P),P!==w.cache&&A(h,[_i],_,!0),Te(),P=Q.element,Ls&&w.isDehydrated)if(w={element:P,isDehydrated:!1,cache:Q.cache},h.updateQueue.baseState=w,h.memoizedState=w,h.flags&256){h=Cf(u,h,P,_);break e}else if(P!==E){E=ye(Error(s(424)),h),se(E),h=Cf(u,h,P,_);break e}else for(Ls&&(Ps=Hv(h.stateNode.containerInfo),Us=h,Un=!0,Ca=null,Ms=!0),_=Mo(h,null,P,_),h.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(It(),P===E){h=ga(u,h,_);break e}wi(u,h,P,_)}h=h.child}return h;case 26:if(qr)return Hc(u,h),u===null?(_=fy(h.type,null,h.pendingProps,null))?h.memoizedState=_:Un||(h.stateNode=Hp(h.type,h.pendingProps,bo.current,h)):h.memoizedState=fy(h.type,u.memoizedProps,h.pendingProps,u.memoizedState),null;case 27:if(ui)return ze(h),u===null&&ui&&Un&&(E=h.stateNode=Ka(h.type,h.pendingProps,bo.current,ds.current,!1),Us=h,Ms=!0,Ps=Pp(E)),E=h.pendingProps.children,u!==null||Un?wi(u,h,E,_):h.child=ac(h,null,E,_),Hc(u,h),h.child;case 5:return u===null&&Un&&(zp(h.type,h.pendingProps,ds.current),(w=E=Ps)&&(E=EE(E,h.type,h.pendingProps,Ms),E!==null?(h.stateNode=E,Us=h,Ps=Pp(E),Ms=!1,w=!0):w=!1),w||lt(h)),ze(h),w=h.type,P=h.pendingProps,Q=u!==null?u.memoizedProps:null,E=P.children,mn(w,P)?E=null:Q!==null&&mn(w,Q)&&(h.flags|=32),h.memoizedState!==null&&(w=yr(u,h,Ri,null,null,_),ar?Ya._currentValue=w:Ya._currentValue2=w),Hc(u,h),wi(u,h,E,_),h.child;case 6:return u===null&&Un&&(Yv(h.pendingProps,ds.current),(u=_=Ps)&&(_=uy(_,h.pendingProps,Ms),_!==null?(h.stateNode=_,Us=h,Ps=null,u=!0):u=!1),u||lt(h)),null;case 13:return Rf(u,h,_);case 4:return Ve(h,h.stateNode.containerInfo),E=h.pendingProps,u===null?h.child=ac(h,null,E,_):wi(u,h,E,_),h.child;case 11:return Fc(u,h,h.type,h.pendingProps,_);case 7:return wi(u,h,h.pendingProps,_),h.child;case 8:return wi(u,h,h.pendingProps.children,_),h.child;case 12:return wi(u,h,h.pendingProps.children,_),h.child;case 10:return E=h.pendingProps,ja(h,h.type,E.value),wi(u,h,E.children,_),h.child;case 9:return w=h.type._context,E=h.pendingProps.children,Z(h),w=ve(w),E=E(w),h.flags|=1,wi(u,h,E,_),h.child;case 14:return qu(u,h,h.type,h.pendingProps,_);case 15:return zc(u,h,h.type,h.pendingProps,_);case 19:return wf(u,h,_);case 22:return Tf(u,h,_);case 24:return Z(h),E=ve(_i),u===null?(w=In(),w===null&&(w=ni,P=Dn(),w.pooledCache=P,P.refCount++,P!==null&&(w.pooledCacheLanes|=_),w=P),h.memoizedState={parent:E,cache:w},wt(h),ja(h,_i,w)):((u.lanes&_)!==0&&(Mt(u,h),rt(h,null,null,_),Te()),w=u.memoizedState,P=h.memoizedState,w.parent!==E?(w={parent:E,cache:E},h.memoizedState=w,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=w),ja(h,_i,E)):(E=P.cache,ja(h,_i,E),E!==w.cache&&A(h,[_i],_,!0))),wi(u,h,h.pendingProps.children,_),h.child;case 29:throw h.pendingProps}throw Error(s(156,h.tag))}function ja(u,h,_){ar?(D(dl,h._currentValue),h._currentValue=_):(D(dl,h._currentValue2),h._currentValue2=_)}function ya(u){var h=dl.current;ar?u._currentValue=h:u._currentValue2=h,T(dl)}function _a(u,h,_){for(;u!==null;){var E=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,E!==null&&(E.childLanes|=h)):E!==null&&(E.childLanes&h)!==h&&(E.childLanes|=h),u===_)break;u=u.return}}function A(u,h,_,E){var w=u.child;for(w!==null&&(w.return=u);w!==null;){var P=w.dependencies;if(P!==null){var Q=w.child;P=P.firstContext;e:for(;P!==null;){var le=P;P=w;for(var Se=0;Se<h.length;Se++)if(le.context===h[Se]){P.lanes|=_,le=P.alternate,le!==null&&(le.lanes|=_),_a(P.return,_,u),E||(Q=null);break e}P=le.next}}else if(w.tag===18){if(Q=w.return,Q===null)throw Error(s(341));Q.lanes|=_,P=Q.alternate,P!==null&&(P.lanes|=_),_a(Q,_,u),Q=null}else Q=w.child;if(Q!==null)Q.return=w;else for(Q=w;Q!==null;){if(Q===u){Q=null;break}if(w=Q.sibling,w!==null){w.return=Q.return,Q=w;break}Q=Q.return}w=Q}}function O(u,h,_,E){u=null;for(var w=h,P=!1;w!==null;){if(!P){if((w.flags&524288)!==0)P=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var Q=w.alternate;if(Q===null)throw Error(s(387));if(Q=Q.memoizedProps,Q!==null){var le=w.type;Mr(w.pendingProps.value,Q.value)||(u!==null?u.push(le):u=[le])}}else if(w===$c.current){if(Q=w.alternate,Q===null)throw Error(s(387));Q.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(u!==null?u.push(Ya):u=[Ya])}w=w.return}u!==null&&A(h,u,_,E),h.flags|=262144}function V(u){for(u=u.firstContext;u!==null;){var h=u.context;if(!Mr(ar?h._currentValue:h._currentValue2,u.memoizedValue))return!0;u=u.next}return!1}function Z(u){eo=u,Qr=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function ve(u){return gt(eo,u)}function Pe(u,h){return eo===null&&Z(u),gt(u,h)}function gt(u,h){var _=ar?h._currentValue:h._currentValue2;if(h={context:h,memoizedValue:_,next:null},Qr===null){if(u===null)throw Error(s(308));Qr=h,u.dependencies={lanes:0,firstContext:h},u.flags|=524288}else Qr=Qr.next=h;return _}function Dn(){return{controller:new Sh,data:new Map,refCount:0}}function Di(u){u.refCount--,u.refCount===0&&r0(a0,function(){u.controller.abort()})}function In(){var u=Ro.current;return u!==null?u:ni.pooledCache}function qi(u,h){h===null?D(Ro,Ro.current):D(Ro,h.pool)}function ss(){var u=In();return u===null?null:{parent:ar?_i._currentValue:_i._currentValue2,pool:u}}function Xi(u){u.flags|=4}function Ss(u,h){if(u!==null&&u.child===h.child)return!1;if((h.flags&16)!==0)return!0;for(u=h.child;u!==null;){if((u.flags&13878)!==0||(u.subtreeFlags&13878)!==0)return!0;u=u.sibling}return!1}function va(u,h,_,E){if(fs)for(_=h.child;_!==null;){if(_.tag===5||_.tag===6)Yf(u,_.stateNode);else if(!(_.tag===4||ui&&_.tag===27)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return;_=_.return}_.sibling.return=_.return,_=_.sibling}else if(Ta)for(var w=h.child;w!==null;){if(w.tag===5){var P=w.stateNode;_&&E&&(P=ay(P,w.type,w.memoizedProps)),Yf(u,P)}else if(w.tag===6)P=w.stateNode,_&&E&&(P=oy(P,w.memoizedProps)),Yf(u,P);else if(w.tag!==4){if(w.tag===22&&w.memoizedState!==null)P=w.child,P!==null&&(P.return=w),va(u,w,!0,!0);else if(w.child!==null){w.child.return=w,w=w.child;continue}}if(w===h)break;for(;w.sibling===null;){if(w.return===null||w.return===h)return;w=w.return}w.sibling.return=w.return,w=w.sibling}}function Ju(u,h,_,E){if(Ta)for(var w=h.child;w!==null;){if(w.tag===5){var P=w.stateNode;_&&E&&(P=ay(P,w.type,w.memoizedProps)),ry(u,P)}else if(w.tag===6)P=w.stateNode,_&&E&&(P=oy(P,w.memoizedProps)),ry(u,P);else if(w.tag!==4){if(w.tag===22&&w.memoizedState!==null)P=w.child,P!==null&&(P.return=w),Ju(u,w,!(w.memoizedProps!==null&&w.memoizedProps.mode==="manual"),!0);else if(w.child!==null){w.child.return=w,w=w.child;continue}}if(w===h)break;for(;w.sibling===null;){if(w.return===null||w.return===h)return;w=w.return}w.sibling.return=w.return,w=w.sibling}}function Df(u,h){if(Ta&&Ss(u,h)){u=h.stateNode;var _=u.containerInfo,E=Kf();Ju(E,h,!1,!1),u.pendingChildren=E,Xi(h),Op(_,E)}}function fp(u,h,_,E){if(fs)u.memoizedProps!==E&&Xi(h);else if(Ta){var w=u.stateNode,P=u.memoizedProps;if((u=Ss(u,h))||P!==E){var Q=ds.current;P=dh(w,_,P,E,!u,null),P===w?h.stateNode=w:(al(P,_,E,Q)&&Xi(h),h.stateNode=P,u?va(P,h,!1,!1):Xi(h))}else h.stateNode=w}}function dp(u,h,_){if(Qg(h,_)){if(u.flags|=16777216,!Bp(h,_))if(ql())u.flags|=8192;else throw ic=sd,id}else u.flags&=-16777217}function pp(u,h){if(Qv(h)){if(u.flags|=16777216,!Yc(h))if(ql())u.flags|=8192;else throw ic=sd,id}else u.flags&=-16777217}function Qu(u,h){h!==null&&(u.flags|=4),u.flags&16384&&(h=u.tag!==22?I():536870912,u.lanes|=h,Io|=h)}function Zu(u,h){if(!Un)switch(u.tailMode){case"hidden":h=u.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?u.tail=null:_.sibling=null;break;case"collapsed":_=u.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function Ti(u){var h=u.alternate!==null&&u.alternate.child===u.child,_=0,E=0;if(h)for(var w=u.child;w!==null;)_|=w.lanes|w.childLanes,E|=w.subtreeFlags&31457280,E|=w.flags&31457280,w.return=u,w=w.sibling;else for(w=u.child;w!==null;)_|=w.lanes|w.childLanes,E|=w.subtreeFlags,E|=w.flags,w.return=u,w=w.sibling;return u.subtreeFlags|=E,u.childLanes=_,h}function hv(u,h,_){var E=h.pendingProps;switch(Me(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ti(h),null;case 1:return Ti(h),null;case 3:return _=h.stateNode,E=null,u!==null&&(E=u.memoizedState.cache),h.memoizedState.cache!==E&&(h.flags|=2048),ya(_i),ge(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(u===null||u.child===null)&&(Nt(h)?Xi(h):u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ca!==null&&(Pf(Ca),Ca=null))),Df(u,h),Ti(h),null;case 26:if(qr){_=h.type;var w=h.memoizedState;return u===null?(Xi(h),w!==null?(Ti(h),pp(h,w)):(Ti(h),dp(h,_,E))):w?w!==u.memoizedState?(Xi(h),Ti(h),pp(h,w)):(Ti(h),h.flags&=-16777217):(fs?u.memoizedProps!==E&&Xi(h):fp(u,h,_,E),Ti(h),dp(h,_,E)),null}case 27:if(ui){if(Je(h),_=bo.current,w=h.type,u!==null&&h.stateNode!=null)fs?u.memoizedProps!==E&&Xi(h):fp(u,h,w,E);else{if(!E){if(h.stateNode===null)throw Error(s(166));return Ti(h),null}u=ds.current,Nt(h)?At(h,u):(u=Ka(w,E,_,u,!0),h.stateNode=u,Xi(h))}return Ti(h),null}case 5:if(Je(h),_=h.type,u!==null&&h.stateNode!=null)fp(u,h,_,E);else{if(!E){if(h.stateNode===null)throw Error(s(166));return Ti(h),null}u=ds.current,Nt(h)?At(h,u):(w=Jg(_,E,bo.current,u,h),va(w,h,!1,!1),h.stateNode=w,al(w,_,E,u)&&Xi(h))}return Ti(h),dp(h,h.type,h.pendingProps),null;case 6:if(u&&h.stateNode!=null)_=u.memoizedProps,fs?_!==E&&Xi(h):Ta&&(_!==E?(h.stateNode=ri(E,bo.current,ds.current,h),Xi(h)):h.stateNode=u.stateNode);else{if(typeof E!="string"&&h.stateNode===null)throw Error(s(166));if(u=bo.current,_=ds.current,Nt(h)){if(!Ls)throw Error(s(176));if(u=h.stateNode,_=h.memoizedProps,E=null,w=Us,w!==null)switch(w.tag){case 27:case 5:E=w.memoizedProps}hy(u,_,h,E)||lt(h)}else h.stateNode=ri(E,u,_,h)}return Ti(h),null;case 13:if(E=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(w=Nt(h),E!==null&&E.dehydrated!==null){if(u===null){if(!w)throw Error(s(318));if(!Ls)throw Error(s(344));if(w=h.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(s(317));qv(w,h)}else It(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ti(h),w=!1}else Ca!==null&&(Pf(Ca),Ca=null),w=!0;if(!w)return h.flags&256?(tr(h),h):(tr(h),null)}if(tr(h),(h.flags&128)!==0)return h.lanes=_,h;if(_=E!==null,u=u!==null&&u.memoizedState!==null,_){E=h.child,w=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(w=E.alternate.memoizedState.cachePool.pool);var P=null;E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(P=E.memoizedState.cachePool.pool),P!==w&&(E.flags|=2048)}return _!==u&&_&&(h.child.flags|=8192),Qu(h,h.updateQueue),Ti(h),null;case 4:return ge(),Df(u,h),u===null&&Yi(h.stateNode.containerInfo),Ti(h),null;case 10:return ya(h.type),Ti(h),null;case 19:if(T(ps),w=h.memoizedState,w===null)return Ti(h),null;if(E=(h.flags&128)!==0,P=w.rendering,P===null)if(E)Zu(w,!1);else{if(di!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(P=nr(u),P!==null){for(h.flags|=128,Zu(w,!1),u=P.updateQueue,h.updateQueue=u,Qu(h,u),h.subtreeFlags=0,u=_,_=h.child;_!==null;)Vf(_,u),_=_.sibling;return D(ps,ps.current&1|2),h.child}u=u.sibling}w.tail!==null&&Ma()>Th&&(h.flags|=128,E=!0,Zu(w,!1),h.lanes=4194304)}else{if(!E)if(u=nr(P),u!==null){if(h.flags|=128,E=!0,u=u.updateQueue,h.updateQueue=u,Qu(h,u),Zu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Un)return Ti(h),null}else 2*Ma()-w.renderingStartTime>Th&&_!==536870912&&(h.flags|=128,E=!0,Zu(w,!1),h.lanes=4194304);w.isBackwards?(P.sibling=h.child,h.child=P):(u=w.last,u!==null?u.sibling=P:h.child=P,w.last=P)}return w.tail!==null?(h=w.tail,w.rendering=h,w.tail=h.sibling,w.renderingStartTime=Ma(),h.sibling=null,u=ps.current,D(ps,E?u&1|2:u&1),h):(Ti(h),null);case 22:case 23:return tr(h),As(),E=h.memoizedState!==null,u!==null?u.memoizedState!==null!==E&&(h.flags|=8192):E&&(h.flags|=8192),E?(_&536870912)!==0&&(h.flags&128)===0&&(Ti(h),h.subtreeFlags&6&&(h.flags|=8192)):Ti(h),_=h.updateQueue,_!==null&&Qu(h,_.retryQueue),_=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(_=u.memoizedState.cachePool.pool),E=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(E=h.memoizedState.cachePool.pool),E!==_&&(h.flags|=2048),u!==null&&T(Ro),null;case 24:return _=null,u!==null&&(_=u.memoizedState.cache),h.memoizedState.cache!==_&&(h.flags|=2048),ya(_i),Ti(h),null;case 25:return null}throw Error(s(156,h.tag))}function yE(u,h){switch(Me(h),h.tag){case 1:return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return ya(_i),ge(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 26:case 27:case 5:return Je(h),null;case 13:if(tr(h),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(s(340));It()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return T(ps),null;case 4:return ge(),null;case 10:return ya(h.type),null;case 22:case 23:return tr(h),As(),u!==null&&T(Ro),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 24:return ya(_i),null;case 25:return null;default:return null}}function fv(u,h){switch(Me(h),h.tag){case 3:ya(_i),ge();break;case 26:case 27:case 5:Je(h);break;case 4:ge();break;case 13:tr(h);break;case 19:T(ps);break;case 10:ya(h.type);break;case 22:case 23:tr(h),As(),u!==null&&T(Ro);break;case 24:ya(_i)}}function If(u,h){try{var _=h.updateQueue,E=_!==null?_.lastEffect:null;if(E!==null){var w=E.next;_=w;do{if((_.tag&u)===u){E=void 0;var P=_.create,Q=_.inst;E=P(),Q.destroy=E}_=_.next}while(_!==w)}}catch(le){ei(h,h.return,le)}}function Vl(u,h,_){try{var E=h.updateQueue,w=E!==null?E.lastEffect:null;if(w!==null){var P=w.next;E=P;do{if((E.tag&u)===u){var Q=E.inst,le=Q.destroy;if(le!==void 0){Q.destroy=void 0,w=h;var Se=_;try{le()}catch(je){ei(w,Se,je)}}}E=E.next}while(E!==P)}}catch(je){ei(h,h.return,je)}}function dv(u){var h=u.updateQueue;if(h!==null){var _=u.stateNode;try{Ke(h,_)}catch(E){ei(u,u.return,E)}}}function Ar(u,h,_){_.props=ma(u.type,u.memoizedProps),_.state=u.memoizedState;try{_.componentWillUnmount()}catch(E){ei(u,h,E)}}function qa(u,h){try{var _=u.ref;if(_!==null){var E=u.stateNode;switch(u.tag){case 26:case 27:case 5:var w=uh(E);break;default:w=E}typeof _=="function"?u.refCleanup=_(w):_.current=w}}catch(P){ei(u,h,P)}}function xr(u,h){var _=u.ref,E=u.refCleanup;if(_!==null)if(typeof E=="function")try{E()}catch(w){ei(u,h,w)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(w){ei(u,h,w)}else _.current=null}function Dg(u){var h=u.type,_=u.memoizedProps,E=u.stateNode;try{xE(E,h,_,u)}catch(w){ei(u,u.return,w)}}function Ig(u,h,_){try{Dv(u.stateNode,u.type,_,h,u)}catch(E){ei(u,u.return,E)}}function Bg(u){return u.tag===5||u.tag===3||(qr?u.tag===26:!1)||(ui?u.tag===27:!1)||u.tag===4}function Bf(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||Bg(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&(!ui||u.tag!==27)&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Ng(u,h,_){var E=u.tag;if(E===5||E===6)u=u.stateNode,h?Bv(_,u,h):ny(_,u);else if(!(E===4||ui&&E===27)&&(u=u.child,u!==null))for(Ng(u,h,_),u=u.sibling;u!==null;)Ng(u,h,_),u=u.sibling}function Jo(u,h,_){var E=u.tag;if(E===5||E===6)u=u.stateNode,h?Iv(_,u,h):Rv(_,u);else if(!(E===4||ui&&E===27)&&(u=u.child,u!==null))for(Jo(u,h,_),u=u.sibling;u!==null;)Jo(u,h,_),u=u.sibling}function mp(u,h,_){u=u.containerInfo;try{ph(u,_)}catch(E){ei(h,h.return,E)}}function Nf(u,h){for(Dp(u.containerInfo),hn=h;hn!==null;)if(u=hn,h=u.child,(u.subtreeFlags&1028)!==0&&h!==null)h.return=u,hn=h;else for(;hn!==null;){u=hn;var _=u.alternate;switch(h=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((h&1024)!==0&&_!==null){h=void 0;var E=u,w=_.memoizedProps;_=_.memoizedState;var P=E.stateNode;try{var Q=ma(E.type,w,E.elementType===E.type);h=P.getSnapshotBeforeUpdate(Q,_),P.__reactInternalSnapshotBeforeUpdate=h}catch(le){ei(E,E.return,le)}}break;case 3:(h&1024)!==0&&fs&&Pv(u.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(s(163))}if(h=u.sibling,h!==null){h.return=u.return,hn=h;break}hn=u.return}return Q=Cn,Cn=!1,Q}function gp(u,h,_){var E=_.flags;switch(_.tag){case 0:case 11:case 15:Zo(u,_),E&4&&If(5,_);break;case 1:if(Zo(u,_),E&4)if(u=_.stateNode,h===null)try{u.componentDidMount()}catch(le){ei(_,_.return,le)}else{var w=ma(_.type,h.memoizedProps);h=h.memoizedState;try{u.componentDidUpdate(w,h,u.__reactInternalSnapshotBeforeUpdate)}catch(le){ei(_,_.return,le)}}E&64&&dv(_),E&512&&qa(_,_.return);break;case 3:if(Zo(u,_),E&64&&(E=_.updateQueue,E!==null)){if(u=null,_.child!==null)switch(_.child.tag){case 27:case 5:u=uh(_.child.stateNode);break;case 1:u=_.child.stateNode}try{Ke(E,u)}catch(le){ei(_,_.return,le)}}break;case 26:if(qr){Zo(u,_),E&512&&qa(_,_.return);break}case 27:case 5:Zo(u,_),h===null&&E&4&&Dg(_),E&512&&qa(_,_.return);break;case 12:Zo(u,_);break;case 13:Zo(u,_),E&4&&yp(u,_);break;case 22:if(w=_.memoizedState!==null||wo,!w){h=h!==null&&h.memoizedState!==null||Fi;var P=wo,Q=Fi;wo=w,(Fi=h)&&!Q?$o(u,_,(_.subtreeFlags&8772)!==0):Zo(u,_),wo=P,Fi=Q}E&512&&(_.memoizedProps.mode==="manual"?qa(_,_.return):xr(_,_.return));break;default:Zo(u,_)}}function Og(u){var h=u.alternate;h!==null&&(u.alternate=null,Og(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&AE(h)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function Bs(u,h,_){for(_=_.child;_!==null;)Hl(u,h,_),_=_.sibling}function Hl(u,h,_){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(Ji,_)}catch{}switch(_.tag){case 26:if(qr){Fi||xr(_,h),Bs(u,h,_),_.memoizedState?Wc(_.memoizedState):_.stateNode&&mh(_.stateNode);break}case 27:if(ui){Fi||xr(_,h);var E=qt,w=vn;qt=_.stateNode,Bs(u,h,_),ec(_.stateNode),qt=E,vn=w;break}case 5:Fi||xr(_,h);case 6:if(fs){if(E=qt,w=vn,qt=null,Bs(u,h,_),qt=E,vn=w,qt!==null)if(vn)try{Nv(qt,_.stateNode)}catch(P){ei(_,h,P)}else try{iy(qt,_.stateNode)}catch(P){ei(_,h,P)}}else Bs(u,h,_);break;case 18:fs&&qt!==null&&(vn?Jf(qt,_.stateNode):Wv(qt,_.stateNode));break;case 4:fs?(E=qt,w=vn,qt=_.stateNode.containerInfo,vn=!0,Bs(u,h,_),qt=E,vn=w):(Ta&&mp(_.stateNode,_,Kf()),Bs(u,h,_));break;case 0:case 11:case 14:case 15:Fi||Vl(2,_,h),Fi||Vl(4,_,h),Bs(u,h,_);break;case 1:Fi||(xr(_,h),E=_.stateNode,typeof E.componentWillUnmount=="function"&&Ar(_,h,E)),Bs(u,h,_);break;case 21:Bs(u,h,_);break;case 22:Fi||xr(_,h),Fi=(E=Fi)||_.memoizedState!==null,Bs(u,h,_),Fi=E;break;default:Bs(u,h,_)}}function yp(u,h){if(Ls&&h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{TE(u)}catch(_){ei(h,h.return,_)}}function pv(u){switch(u.tag){case 13:case 19:var h=u.stateNode;return h===null&&(h=u.stateNode=new ti),h;case 22:return u=u.stateNode,h=u._retryCache,h===null&&(h=u._retryCache=new ti),h;default:throw Error(s(435,u.tag))}}function Qo(u,h){var _=pv(u);h.forEach(function(E){var w=Yl.bind(null,u,E);_.has(E)||(_.add(E),E.then(w,w))})}function sr(u,h){var _=h.deletions;if(_!==null)for(var E=0;E<_.length;E++){var w=_[E],P=u,Q=h;if(fs){var le=Q;e:for(;le!==null;){switch(le.tag){case 27:case 5:qt=le.stateNode,vn=!1;break e;case 3:qt=le.stateNode.containerInfo,vn=!0;break e;case 4:qt=le.stateNode.containerInfo,vn=!0;break e}le=le.return}if(qt===null)throw Error(s(160));Hl(P,Q,w),qt=null,vn=!1}else Hl(P,Q,w);P=w.alternate,P!==null&&(P.return=null),w.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)Lg(h,u),h=h.sibling}function Lg(u,h){var _=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:sr(h,u),Sr(u),E&4&&(Vl(3,u,u.return),If(3,u),Vl(5,u,u.return));break;case 1:sr(h,u),Sr(u),E&512&&(Fi||_===null||xr(_,_.return)),E&64&&wo&&(u=u.updateQueue,u!==null&&(E=u.callbacks,E!==null&&(_=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=_===null?E:_.concat(E))));break;case 26:if(qr){var w=Bi;sr(h,u),Sr(u),E&512&&(Fi||_===null||xr(_,_.return)),E&4&&(E=_!==null?_.memoizedState:null,h=u.memoizedState,_===null?h===null?u.stateNode===null?u.stateNode=Zf(w,u.type,u.memoizedProps,u):$f(w,u.type,u.stateNode):u.stateNode=Kv(w,h,u.memoizedProps):E!==h?(E===null?_.stateNode!==null&&mh(_.stateNode):Wc(E),h===null?$f(w,u.type,u.stateNode):Kv(w,h,u.memoizedProps)):h===null&&u.stateNode!==null&&Ig(u,u.memoizedProps,_.memoizedProps));break}case 27:if(ui&&E&4&&u.alternate===null){w=u.stateNode;var P=u.memoizedProps;try{$l(w),$v(u.type,P,w,u)}catch(pt){ei(u,u.return,pt)}}case 5:if(sr(h,u),Sr(u),E&512&&(Fi||_===null||xr(_,_.return)),fs){if(u.flags&32){h=u.stateNode;try{sy(h)}catch(pt){ei(u,u.return,pt)}}E&4&&u.stateNode!=null&&(h=u.memoizedProps,Ig(u,h,_!==null?_.memoizedProps:h)),E&1024&&(gy=!0)}break;case 6:if(sr(h,u),Sr(u),E&4&&fs){if(u.stateNode===null)throw Error(s(162));E=u.memoizedProps,_=_!==null?_.memoizedProps:E,h=u.stateNode;try{wv(h,_,E)}catch(pt){ei(u,u.return,pt)}}break;case 3:if(qr?(Jv(),w=Bi,Bi=Vp(h.containerInfo),sr(h,u),Bi=w):sr(h,u),Sr(u),E&4){if(fs&&Ls&&_!==null&&_.memoizedState.isDehydrated)try{bE(h.containerInfo)}catch(pt){ei(u,u.return,pt)}if(Ta){E=h.containerInfo,_=h.pendingChildren;try{ph(E,_)}catch(pt){ei(u,u.return,pt)}}}gy&&(gy=!1,mv(u));break;case 4:qr?(_=Bi,Bi=Vp(u.stateNode.containerInfo),sr(h,u),Sr(u),Bi=_):(sr(h,u),Sr(u)),E&4&&Ta&&mp(u.stateNode,u,u.stateNode.pendingChildren);break;case 12:sr(h,u),Sr(u);break;case 13:sr(h,u),Sr(u),u.child.flags&8192&&u.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(ur=Ma()),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Qo(u,E)));break;case 22:E&512&&(Fi||_===null||xr(_,_.return)),w=u.memoizedState!==null;var Q=_!==null&&_.memoizedState!==null,le=wo,Se=Fi;if(wo=le||w,Fi=Se||Q,sr(h,u),Fi=Se,wo=le,Sr(u),h=u.stateNode,h._current=u,h._visibility&=-3,h._visibility|=h._pendingVisibility&2,E&8192&&(h._visibility=w?h._visibility&-2:h._visibility|1,w&&(h=wo||Fi,_===null||Q||h||$u(u)),fs&&(u.memoizedProps===null||u.memoizedProps.mode!=="manual"))){e:if(_=null,fs)for(h=u;;){if(h.tag===5||qr&&h.tag===26||ui&&h.tag===27){if(_===null){Q=_=h;try{P=Q.stateNode,w?Ov(P):Uv(Q.stateNode,Q.memoizedProps)}catch(pt){ei(Q,Q.return,pt)}}}else if(h.tag===6){if(_===null){Q=h;try{var je=Q.stateNode;w?Lv(je):SE(je,Q.memoizedProps)}catch(pt){ei(Q,Q.return,pt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===u)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break e;for(;h.sibling===null;){if(h.return===null||h.return===u)break e;_===h&&(_=null),h=h.return}_===h&&(_=null),h.sibling.return=h.return,h=h.sibling}}E&4&&(E=u.updateQueue,E!==null&&(_=E.retryQueue,_!==null&&(E.retryQueue=null,Qo(u,_))));break;case 19:sr(h,u),Sr(u),E&4&&(E=u.updateQueue,E!==null&&(u.updateQueue=null,Qo(u,E)));break;case 21:break;default:sr(h,u),Sr(u)}}function Sr(u){var h=u.flags;if(h&2){try{if(fs&&(!ui||u.tag!==27)){e:{for(var _=u.return;_!==null;){if(Bg(_)){var E=_;break e}_=_.return}throw Error(s(160))}switch(E.tag){case 27:if(ui){var w=E.stateNode,P=Bf(u);Jo(u,P,w);break}case 5:var Q=E.stateNode;E.flags&32&&(sy(Q),E.flags&=-33);var le=Bf(u);Jo(u,le,Q);break;case 3:case 4:var Se=E.stateNode.containerInfo,je=Bf(u);Ng(u,je,Se);break;default:throw Error(s(161))}}}catch(pt){ei(u,u.return,pt)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function mv(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var h=u;mv(h),h.tag===5&&h.flags&1024&&Np(h.stateNode),u=u.sibling}}function Zo(u,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)gp(u,h.alternate,h),h=h.sibling}function $u(u){for(u=u.child;u!==null;){var h=u;switch(h.tag){case 0:case 11:case 14:case 15:Vl(4,h,h.return),$u(h);break;case 1:xr(h,h.return);var _=h.stateNode;typeof _.componentWillUnmount=="function"&&Ar(h,h.return,_),$u(h);break;case 26:case 27:case 5:xr(h,h.return),$u(h);break;case 22:xr(h,h.return),h.memoizedState===null&&$u(h);break;default:$u(h)}u=u.sibling}}function $o(u,h,_){for(_=_&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var E=h.alternate,w=u,P=h,Q=P.flags;switch(P.tag){case 0:case 11:case 15:$o(w,P,_),If(4,P);break;case 1:if($o(w,P,_),E=P,w=E.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(je){ei(E,E.return,je)}if(E=P,w=E.updateQueue,w!==null){var le=E.stateNode;try{var Se=w.shared.hiddenCallbacks;if(Se!==null)for(w.shared.hiddenCallbacks=null,w=0;w<Se.length;w++)oe(Se[w],le)}catch(je){ei(E,E.return,je)}}_&&Q&64&&dv(P),qa(P,P.return);break;case 26:case 27:case 5:$o(w,P,_),_&&E===null&&Q&4&&Dg(P),qa(P,P.return);break;case 12:$o(w,P,_);break;case 13:$o(w,P,_),_&&Q&4&&yp(w,P);break;case 22:P.memoizedState===null&&$o(w,P,_),qa(P,P.return);break;default:$o(w,P,_)}h=h.sibling}}function _p(u,h){var _=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(_=u.memoizedState.cachePool.pool),u=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(u=h.memoizedState.cachePool.pool),u!==_&&(u!=null&&u.refCount++,_!=null&&Di(_))}function Of(u,h){u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&Di(u))}function Es(u,h,_,E){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)Ug(u,h,_,E),h=h.sibling}function Ug(u,h,_,E){var w=h.flags;switch(h.tag){case 0:case 11:case 15:Es(u,h,_,E),w&2048&&If(9,h);break;case 3:Es(u,h,_,E),w&2048&&(u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&Di(u)));break;case 12:if(w&2048){Es(u,h,_,E),u=h.stateNode;try{var P=h.memoizedProps,Q=P.id,le=P.onPostCommit;typeof le=="function"&&le(Q,h.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(Se){ei(h,h.return,Se)}}else Es(u,h,_,E);break;case 23:break;case 22:P=h.stateNode,h.memoizedState!==null?P._visibility&4?Es(u,h,_,E):js(u,h):P._visibility&4?Es(u,h,_,E):(P._visibility|=4,Ns(u,h,_,E,(h.subtreeFlags&10256)!==0)),w&2048&&_p(h.alternate,h);break;case 24:Es(u,h,_,E),w&2048&&Of(h.alternate,h);break;default:Es(u,h,_,E)}}function Ns(u,h,_,E,w){for(w=w&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var P=u,Q=h,le=_,Se=E,je=Q.flags;switch(Q.tag){case 0:case 11:case 15:Ns(P,Q,le,Se,w),If(8,Q);break;case 23:break;case 22:var pt=Q.stateNode;Q.memoizedState!==null?pt._visibility&4?Ns(P,Q,le,Se,w):js(P,Q):(pt._visibility|=4,Ns(P,Q,le,Se,w)),w&&je&2048&&_p(Q.alternate,Q);break;case 24:Ns(P,Q,le,Se,w),w&&je&2048&&Of(Q.alternate,Q);break;default:Ns(P,Q,le,Se,w)}h=h.sibling}}function js(u,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var _=u,E=h,w=E.flags;switch(E.tag){case 22:js(_,E),w&2048&&_p(E.alternate,E);break;case 24:js(_,E),w&2048&&Of(E.alternate,E);break;default:js(_,E)}h=h.sibling}}function Aa(u){if(u.subtreeFlags&Zr)for(u=u.child;u!==null;)vp(u),u=u.sibling}function vp(u){switch(u.tag){case 26:Aa(u),u.flags&Zr&&(u.memoizedState!==null?Zv(Bi,u.memoizedState,u.memoizedProps):or(u.type,u.memoizedProps));break;case 5:Aa(u),u.flags&Zr&&or(u.type,u.memoizedProps);break;case 3:case 4:if(qr){var h=Bi;Bi=Vp(u.stateNode.containerInfo),Aa(u),Bi=h}else Aa(u);break;case 22:u.memoizedState===null&&(h=u.alternate,h!==null&&h.memoizedState!==null?(h=Zr,Zr=16777216,Aa(u),Zr=h):Aa(u));break;default:Aa(u)}}function Lf(u){var h=u.alternate;if(h!==null&&(u=h.child,u!==null)){h.child=null;do h=u.sibling,u.sibling=null,u=h;while(u!==null)}}function kl(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var _=0;_<h.length;_++){var E=h[_];hn=E,Pg(E,u)}Lf(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Ap(u),u=u.sibling}function Ap(u){switch(u.tag){case 0:case 11:case 15:kl(u),u.flags&2048&&Vl(9,u,u.return);break;case 3:kl(u);break;case 12:kl(u);break;case 22:var h=u.stateNode;u.memoizedState!==null&&h._visibility&4&&(u.return===null||u.return.tag!==13)?(h._visibility&=-5,el(u)):kl(u);break;default:kl(u)}}function el(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var _=0;_<h.length;_++){var E=h[_];hn=E,Pg(E,u)}Lf(u)}for(u=u.child;u!==null;){switch(h=u,h.tag){case 0:case 11:case 15:Vl(8,h,h.return),el(h);break;case 22:_=h.stateNode,_._visibility&4&&(_._visibility&=-5,el(h));break;default:el(h)}u=u.sibling}}function Pg(u,h){for(;hn!==null;){var _=hn;switch(_.tag){case 0:case 11:case 15:Vl(8,_,h);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var E=_.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:Di(_.memoizedState.cache)}if(E=_.child,E!==null)E.return=_,hn=E;else e:for(_=u;hn!==null;){E=hn;var w=E.sibling,P=E.return;if(Og(E),E===_){hn=null;break e}if(w!==null){w.return=P,hn=w;break e}hn=P}}}function eh(u){var h=xv(u);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(s(364));return h}if(u=ey(u),u===null)throw Error(s(362));return u.stateNode.current}function Gl(u,h){var _=u.tag;switch(h.$$typeof){case bh:if(u.type===h.value)return!0;break;case Da:e:{for(h=h.value,u=[u,0],_=0;_<u.length;){var E=u[_++],w=E.tag,P=u[_++],Q=h[P];if(w!==5&&w!==26&&w!==27||!fh(E)){for(;Q!=null&&Gl(E,Q);)P++,Q=h[P];if(P===h.length){h=!0;break e}else for(E=E.child;E!==null;)u.push(E,P),E=E.sibling}}h=!1}return h;case Ei:if((_===5||_===26||_===27)&&Tv(u.stateNode,h.value))return!0;break;case Do:if((_===5||_===6||_===26||_===27)&&(u=bv(u),u!==null&&0<=u.indexOf(h.value)))return!0;break;case to:if((_===5||_===26||_===27)&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function Fg(u){switch(u.$$typeof){case bh:return"<"+(o(u.value)||"Unknown")+">";case Da:return":has("+(Fg(u)||"")+")";case Ei:return'[role="'+u.value+'"]';case Do:return'"'+u.value+'"';case to:return'[data-testname="'+u.value+'"]';default:throw Error(s(365))}}function Er(u,h){var _=[];u=[u,0];for(var E=0;E<u.length;){var w=u[E++],P=w.tag,Q=u[E++],le=h[Q];if(P!==5&&P!==26&&P!==27||!fh(w)){for(;le!=null&&Gl(w,le);)Q++,le=h[Q];if(Q===h.length)_.push(w);else for(w=w.child;w!==null;)u.push(w,Q),w=w.sibling}}return _}function Uf(u,h){if(!Zl)throw Error(s(363));u=eh(u),u=Er(u,h),h=[],u=Array.from(u);for(var _=0;_<u.length;){var E=u[_++],w=E.tag;if(w===5||w===26||w===27)fh(E)||h.push(E.stateNode);else for(E=E.child;E!==null;)u.push(E),E=E.sibling}return h}function Wi(){if((kn&2)!==0&&Bn!==0)return Bn&-Bn;if(en.T!==null){var u=Yr;return u!==0?u:Ue()}return Sv()}function zg(){ta===0&&(ta=(Bn&536870912)===0||Un?U():536870912);var u=Kr.current;return u!==null&&(u.flags|=32),ta}function bs(u,h,_){(u===ni&&ai===2||u.cancelPendingCommit!==null)&&(Os(u,0),br(u,Bn,ta,!1)),z(u,_),((kn&2)===0||u!==ni)&&(u===ni&&((kn&2)===0&&(pl|=_),di===4&&br(u,Bn,ta,!1)),st(u))}function jl(u,h,_){if((kn&6)!==0)throw Error(s(327));var E=!_&&(h&60)===0&&(h&u.expiredLanes)===0||H(u,h),w=E?Hg(u,h):Sp(u,h,!0),P=E;do{if(w===0){$r&&!E&&br(u,h,0,!1);break}else if(w===6)br(u,h,0,!Ba);else{if(_=u.current.alternate,P&&!th(_)){w=Sp(u,h,!1),P=!1;continue}if(w===2){if(P=h,u.errorRecoveryDisabledLanes&P)var Q=0;else Q=u.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){h=Q;e:{var le=u;w=lu;var Se=Ls&&le.current.memoizedState.isDehydrated;if(Se&&(Os(le,Q).flags|=256),Q=Sp(le,Q,!1),Q!==2){if(ms&&!Se){le.errorRecoveryDisabledLanes|=P,pl|=P,w=4;break e}P=zi,zi=w,P!==null&&Pf(P)}w=Q}if(P=!1,w!==2)continue}}if(w===1){Os(u,0),br(u,h,0,!0);break}e:{switch(E=u,w){case 0:case 1:throw Error(s(345));case 4:if((h&4194176)===h){br(E,h,ta,!Ba);break e}break;case 2:zi=null;break;case 3:case 5:break;default:throw Error(s(329))}if(E.finishedWork=_,E.finishedLanes=h,(h&62914560)===h&&(P=ur+300-Ma(),10<P)){if(br(E,h,ta,!Ba),G(E,0)!==0)break e;E.timeoutHandle=as(xp.bind(null,E,_,zi,ad,Qp,h,ta,pl,Io,Ba,2,-0,0),P);break e}xp(E,_,zi,ad,Qp,h,ta,pl,Io,Ba,0,-0,0)}}break}while(!0);st(u)}function Pf(u){zi===null?zi=u:zi.push.apply(zi,u)}function xp(u,h,_,E,w,P,Q,le,Se,je,pt,bt,Ct){var fn=h.subtreeFlags;if((fn&8192||(fn&16785408)===16785408)&&(Zg(),vp(h),h=os(),h!==null)){u.cancelPendingCommit=h(Xl.bind(null,u,_,E,w,Q,le,Se,1,bt,Ct)),br(u,P,Q,!je);return}Xl(u,_,E,w,Q,le,Se,pt,bt,Ct)}function th(u){for(var h=u;;){var _=h.tag;if((_===0||_===11||_===15)&&h.flags&16384&&(_=h.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var E=0;E<_.length;E++){var w=_[E],P=w.getSnapshot;w=w.value;try{if(!Mr(P(),w))return!1}catch{return!1}}if(_=h.child,h.subtreeFlags&16384&&_!==null)_.return=h,h=_;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function br(u,h,_,E){h&=~rd,h&=~pl,u.suspendedLanes|=h,u.pingedLanes&=~h,E&&(u.warmLanes|=h),E=u.expirationTimes;for(var w=h;0<w;){var P=31-lr(w),Q=1<<P;E[P]=-1,w&=~Q}_!==0&&k(u,_,h)}function Ff(){return(kn&6)===0?(Ft(0),!1):!0}function nh(){if(Yt!==null){if(ai===0)var u=Yt.return;else u=Yt,Qr=eo=null,J(u),sc=null,rc=0,u=Yt;for(;u!==null;)fv(u.alternate,u),u=u.return;Yt=null}}function Os(u,h){u.finishedWork=null,u.finishedLanes=0;var _=u.timeoutHandle;_!==Jl&&(u.timeoutHandle=Jl,Ip(_)),_=u.cancelPendingCommit,_!==null&&(u.cancelPendingCommit=null,_()),nh(),ni=u,Yt=_=Sa(u.current,null),Bn=h,ai=0,Xs=null,Ba=!1,$r=H(u,h),ms=!1,Io=ta=rd=pl=ea=di=0,zi=lu=null,Qp=!1,(h&8)!==0&&(h|=h&32);var E=u.entangledLanes;if(E!==0)for(u=u.entanglements,E&=h;0<E;){var w=31-lr(E),P=1<<w;h|=u[w],E&=~P}return Ws=h,Ge(),_}function kr(u,h){Sn=null,en.H=Pi,h===Ah?(h=vt(),ai=3):h===id?(h=vt(),ai=4):ai=h===Kp?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Xs=h,Yt===null&&(di=1,Wo(u,ye(h,u.current)))}function ql(){var u=Kr.current;return u===null?!0:(Bn&4194176)===Bn?hi===null:(Bn&62914560)===Bn||(Bn&536870912)!==0?u===hi:!1}function _o(){var u=en.H;return en.H=Pi,u===null?Pi:u}function vo(){var u=en.A;return en.A=Eh,u}function tl(){di=4,Ba||(Bn&4194176)!==Bn&&Kr.current!==null||($r=!0),(ea&134217727)===0&&(pl&134217727)===0||ni===null||br(ni,Bn,ta,!1)}function Sp(u,h,_){var E=kn;kn|=2;var w=_o(),P=vo();(ni!==u||Bn!==h)&&(ad=null,Os(u,h)),h=!1;var Q=di;e:do try{if(ai!==0&&Yt!==null){var le=Yt,Se=Xs;switch(ai){case 8:nh(),Q=6;break e;case 3:case 2:case 6:Kr.current===null&&(h=!0);var je=ai;if(ai=0,Xs=null,xa(u,le,Se,je),_&&$r){Q=0;break e}break;default:je=ai,ai=0,Xs=null,xa(u,le,Se,je)}}Vg(),Q=di;break}catch(pt){kr(u,pt)}while(!0);return h&&u.shellSuspendCounter++,Qr=eo=null,kn=E,en.H=w,en.A=P,Yt===null&&(ni=null,Bn=0,Ge()),Q}function Vg(){for(;Yt!==null;)Ii(Yt)}function Hg(u,h){var _=kn;kn|=2;var E=_o(),w=vo();ni!==u||Bn!==h?(ad=null,Th=Ma()+500,Os(u,h)):$r=H(u,h);e:do try{if(ai!==0&&Yt!==null){h=Yt;var P=Xs;t:switch(ai){case 1:ai=0,Xs=null,xa(u,h,P,1);break;case 2:if(yt(P)){ai=0,Xs=null,qn(h);break}h=function(){ai===2&&ni===u&&(ai=7),st(u)},P.then(h,h);break e;case 3:ai=7;break e;case 4:ai=5;break e;case 7:yt(P)?(ai=0,Xs=null,qn(h)):(ai=0,Xs=null,xa(u,h,P,7));break;case 5:var Q=null;switch(Yt.tag){case 26:Q=Yt.memoizedState;case 5:case 27:var le=Yt,Se=le.type,je=le.pendingProps;if(Q?Yc(Q):Bp(Se,je)){ai=0,Xs=null;var pt=le.sibling;if(pt!==null)Yt=pt;else{var bt=le.return;bt!==null?(Yt=bt,Gr(bt)):Yt=null}break t}}ai=0,Xs=null,xa(u,h,P,5);break;case 6:ai=0,Xs=null,xa(u,h,P,6);break;case 8:nh(),di=6;break e;default:throw Error(s(462))}}rr();break}catch(Ct){kr(u,Ct)}while(!0);return Qr=eo=null,en.H=E,en.A=w,kn=_,Yt!==null?0:(ni=null,Bn=0,Ge(),di)}function rr(){for(;Yt!==null&&!n0();)Ii(Yt)}function Ii(u){var h=Gs(u.alternate,u,Ws);u.memoizedProps=u.pendingProps,h===null?Gr(u):Yt=h}function qn(u){var h=u,_=h.alternate;switch(h.tag){case 15:case 0:h=Fl(_,h,h.pendingProps,h.type,void 0,Bn);break;case 11:h=Fl(_,h,h.pendingProps,h.type.render,h.ref,Bn);break;case 5:J(h);default:fv(_,h),h=Yt=Vf(h,Ws),h=Gs(_,h,Ws)}u.memoizedProps=u.pendingProps,h===null?Gr(u):Yt=h}function xa(u,h,_,E){Qr=eo=null,J(h),sc=null,rc=0;var w=h.return;try{if(wg(u,w,h,_,Bn)){di=1,Wo(u,ye(_,u.current)),Yt=null;return}}catch(P){if(w!==null)throw Yt=w,P;di=1,Wo(u,ye(_,u.current)),Yt=null;return}h.flags&32768?(Un||E===1?u=!0:$r||(Bn&536870912)!==0?u=!1:(Ba=u=!0,(E===2||E===3||E===6)&&(E=Kr.current,E!==null&&E.tag===13&&(E.flags|=16384))),Ep(h,u)):Gr(h)}function Gr(u){var h=u;do{if((h.flags&32768)!==0){Ep(h,Ba);return}u=h.return;var _=hv(h.alternate,h,Ws);if(_!==null){Yt=_;return}if(h=h.sibling,h!==null){Yt=h;return}Yt=h=u}while(h!==null);di===0&&(di=5)}function Ep(u,h){do{var _=yE(u.alternate,u);if(_!==null){_.flags&=32767,Yt=_;return}if(_=u.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!h&&(u=u.sibling,u!==null)){Yt=u;return}Yt=u=_}while(u!==null);di=6,Yt=null}function Xl(u,h,_,E,w,P,Q,le,Se,je){var pt=en.T,bt=ol();try{qs(2),en.T=null,gv(u,h,_,E,bt,w,P,Q,le,Se,je)}finally{en.T=pt,qs(bt)}}function gv(u,h,_,E,w,P,Q,le){do Xa();while(Bo!==null);if((kn&6)!==0)throw Error(s(327));var Se=u.finishedWork;if(E=u.finishedLanes,Se===null)return null;if(u.finishedWork=null,u.finishedLanes=0,Se===u.current)throw Error(s(177));u.callbackNode=null,u.callbackPriority=0,u.cancelPendingCommit=null;var je=Se.lanes|Se.childLanes;if(je|=Za,W(u,E,je,P,Q,le),u===ni&&(Yt=ni=null,Bn=0),(Se.subtreeFlags&10256)===0&&(Se.flags&10256)===0||no||(no=!0,uc=je,Zp=_,il(qp,function(){return Xa(),null})),_=(Se.flags&15990)!==0,(Se.subtreeFlags&15990)!==0||_?(_=en.T,en.T=null,P=ol(),qs(2),Q=kn,kn|=4,Nf(u,Se),Lg(Se,u),Av(u.containerInfo),u.current=Se,gp(u,Se.alternate,Se),Gp(),kn=Q,qs(P),en.T=_):u.current=Se,no?(no=!1,Bo=u,cu=E):kg(u,je),je=u.pendingLanes,je===0&&(cc=null),q(Se.stateNode),st(u),h!==null)for(w=u.onRecoverableError,Se=0;Se<h.length;Se++)je=h[Se],w(je.value,{componentStack:je.stack});return(cu&3)!==0&&Xa(),je=u.pendingLanes,(E&4194218)!==0&&(je&42)!==0?u===$p?Mh++:(Mh=0,$p=u):Mh=0,Ft(0),null}function kg(u,h){(u.pooledCacheLanes&=h)===0&&(h=u.pooledCache,h!=null&&(u.pooledCache=null,Di(h)))}function Xa(){if(Bo!==null){var u=Bo,h=uc;uc=0;var _=me(cu),E=32>_?32:_;_=en.T;var w=ol();try{if(qs(E),en.T=null,Bo===null)var P=!1;else{E=Zp,Zp=null;var Q=Bo,le=cu;if(Bo=null,cu=0,(kn&6)!==0)throw Error(s(331));var Se=kn;if(kn|=4,Ap(Q.current),Ug(Q,Q.current,le,E),kn=Se,Ft(0,!1),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(Ji,Q)}catch{}P=!0}return P}finally{qs(w),en.T=_,kg(u,h)}}return!1}function ih(u,h,_){h=ye(_,h),h=Yo(u.stateNode,h,2),u=ft(u,h,2),u!==null&&(z(u,2),st(u))}function ei(u,h,_){if(u.tag===3)ih(u,u,_);else for(;h!==null;){if(h.tag===3){ih(h,u,_);break}else if(h.tag===1){var E=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(cc===null||!cc.has(E))){u=ye(_,u),_=Hr(2),E=ft(h,_,2),E!==null&&(bf(_,E,h,u),z(E,2),st(E));break}}h=h.return}}function qc(u,h,_){var E=u.pingCache;if(E===null){E=u.pingCache=new Ia;var w=new Set;E.set(h,w)}else w=E.get(h),w===void 0&&(w=new Set,E.set(h,w));w.has(_)||(ms=!0,w.add(_),u=Gg.bind(null,u,h,_),h.then(u,u))}function Gg(u,h,_){var E=u.pingCache;E!==null&&E.delete(h),u.pingedLanes|=u.suspendedLanes&_,u.warmLanes&=~_,ni===u&&(Bn&_)===_&&(di===4||di===3&&(Bn&62914560)===Bn&&300>Ma()-ur?(kn&2)===0&&Os(u,0):rd|=_,Io===Bn&&(Io=0)),st(u)}function Wl(u,h){h===0&&(h=I()),u=Fe(u,h),u!==null&&(z(u,h),st(u))}function nl(u){var h=u.memoizedState,_=0;h!==null&&(_=h.retryLane),Wl(u,_)}function Yl(u,h){var _=0;switch(u.tag){case 13:var E=u.stateNode,w=u.memoizedState;w!==null&&(_=w.retryLane);break;case 19:E=u.stateNode;break;case 22:E=u.stateNode._retryCache;break;default:throw Error(s(314))}E!==null&&E.delete(h),Wl(u,_)}function il(u,h){return ed(u,h)}function jg(u,h,_,E){this.tag=u,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zf(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Sa(u,h){var _=u.alternate;return _===null?(_=t(u.tag,h,u.key,u.mode),_.elementType=u.elementType,_.type=u.type,_.stateNode=u.stateNode,_.alternate=u,u.alternate=_):(_.pendingProps=h,_.type=u.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=u.flags&31457280,_.childLanes=u.childLanes,_.lanes=u.lanes,_.child=u.child,_.memoizedProps=u.memoizedProps,_.memoizedState=u.memoizedState,_.updateQueue=u.updateQueue,h=u.dependencies,_.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},_.sibling=u.sibling,_.index=u.index,_.ref=u.ref,_.refCleanup=u.refCleanup,_}function Vf(u,h){u.flags&=31457282;var _=u.alternate;return _===null?(u.childLanes=0,u.lanes=h,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=_.childLanes,u.lanes=_.lanes,u.child=_.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=_.memoizedProps,u.memoizedState=_.memoizedState,u.updateQueue=_.updateQueue,u.type=_.type,h=_.dependencies,u.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),u}function Ao(u,h,_,E,w,P){var Q=0;if(E=u,typeof u=="function")zf(u)&&(Q=1);else if(typeof u=="string")Q=qr&&ui?Qf(u,_,ds.current)?26:So(u)?27:5:qr?Qf(u,_,ds.current)?26:5:ui&&So(u)?27:5;else e:switch(u){case Kl:return Ui(_.children,w,P,h);case jf:Q=8,w|=24;break;case Cp:return u=t(12,_,h,w|2),u.elementType=Cp,u.lanes=P,u;case Rp:return u=t(13,_,h,w),u.elementType=Rp,u.lanes=P,u;case oh:return u=t(19,_,h,w),u.elementType=oh,u.lanes=P,u;case Wg:return Hf(_,w,P,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case qf:case Wa:Q=10;break e;case Xg:Q=9;break e;case Xf:Q=11;break e;case wp:Q=14;break e;case ba:Q=16,E=null;break e}Q=29,_=Error(s(130,u===null?"null":typeof u,"")),E=null}return h=t(Q,_,h,w),h.elementType=u,h.type=E,h.lanes=P,h}function Ui(u,h,_,E){return u=t(7,u,E,h),u.lanes=_,u}function Hf(u,h,_,E){u=t(22,u,E,h),u.elementType=Wg,u.lanes=_;var w={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var P=w._current;if(P===null)throw Error(s(456));if((w._pendingVisibility&2)===0){var Q=Fe(P,2);Q!==null&&(w._pendingVisibility|=2,bs(Q,P,2))}},attach:function(){var P=w._current;if(P===null)throw Error(s(456));if((w._pendingVisibility&2)!==0){var Q=Fe(P,2);Q!==null&&(w._pendingVisibility&=-3,bs(Q,P,2))}}};return u.stateNode=w,u}function bp(u,h,_){return u=t(6,u,null,h),u.lanes=_,u}function qg(u,h,_){return h=t(4,u.children!==null?u.children:[],u.key,h),h.lanes=_,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function _E(u,h,_,E,w,P,Q,le){this.tag=1,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Jl,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=N(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=N(0),this.hiddenUpdates=N(null),this.identifierPrefix=E,this.onUncaughtError=w,this.onCaughtError=P,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=le,this.incompleteTransitions=new Map}function yv(u,h,_,E,w,P,Q,le,Se,je,pt,bt){return u=new _E(u,h,_,Q,le,Se,je,bt),h=1,P===!0&&(h|=24),P=t(3,null,null,h),u.current=P,P.stateNode=u,h=Dn(),h.refCount++,u.pooledCache=h,h.refCount++,P.memoizedState={element:E,isDehydrated:_,cache:h},wt(P),u}function rs(u){return u?(u=tc,u):tc}function Tp(u){var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=x(h),u=u!==null?b(u):null,u===null?null:uh(u.stateNode)}function sh(u,h,_,E,w,P){w=rs(w),E.context===null?E.context=w:E.pendingContext=w,E=et(h),E.payload={element:_},P=P===void 0?null:P,P!==null&&(E.callback=P),_=ft(u,E,h),_!==null&&(bs(_,u,h),Dt(_,u,h))}function rh(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var _=u.retryLane;u.retryLane=_!==0&&_<h?_:h}}function kf(u,h){rh(u,h),(u=u.alternate)&&rh(u,h)}var pn={},ah=pg(),jr=CY(),Mp=Object.assign,vE=Symbol.for("react.element"),Gf=Symbol.for("react.transitional.element"),Ea=Symbol.for("react.portal"),Kl=Symbol.for("react.fragment"),jf=Symbol.for("react.strict_mode"),Cp=Symbol.for("react.profiler"),qf=Symbol.for("react.provider"),Xg=Symbol.for("react.consumer"),Wa=Symbol.for("react.context"),Xf=Symbol.for("react.forward_ref"),Rp=Symbol.for("react.suspense"),oh=Symbol.for("react.suspense_list"),wp=Symbol.for("react.memo"),ba=Symbol.for("react.lazy"),Wg=Symbol.for("react.offscreen"),_v=Symbol.for("react.memo_cache_sentinel"),sl=Symbol.iterator,Yg=Symbol.for("react.client.reference"),en=ah.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xo,rl,Xc=!1,lh=Array.isArray,Kg=e.rendererVersion,Wf=e.rendererPackageName,ch=e.extraDevToolsConfig,uh=e.getPublicInstance,vv=e.getRootHostContext,hh=e.getChildHostContext,Dp=e.prepareForCommit,Av=e.resetAfterCommit,Jg=e.createInstance,Yf=e.appendInitialChild,al=e.finalizeInitialChildren,mn=e.shouldSetTextContent,ri=e.createTextInstance,as=e.scheduleTimeout,Ip=e.cancelTimeout,Jl=e.noTimeout,ar=e.isPrimaryRenderer;e.warnsIfNotActing;var fs=e.supportsMutation,Ta=e.supportsPersistence,Ls=e.supportsHydration,xv=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Yi=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var qs=e.setCurrentUpdatePriority,ol=e.getCurrentUpdatePriority,Sv=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Ev=e.shouldAttemptEagerTransition,AE=e.detachDeletedInstance;e.requestPostPaintCallback;var Qg=e.maySuspendCommit,Bp=e.preloadInstance,Zg=e.startSuspendingCommit,or=e.suspendInstance,os=e.waitForCommitToBeReady,Ql=e.NotPendingTransition,Ya=e.HostTransitionContext,Np=e.resetFormInstance;e.bindToConsole;var $g=e.supportsMicrotasks,ll=e.scheduleMicrotask,Zl=e.supportsTestSelectors,ey=e.findFiberRoot,ty=e.getBoundingRect,bv=e.getTextContent,fh=e.isHiddenSubtree,Tv=e.matchAccessibilityRole,Mv=e.setFocusIfFocusable,Cv=e.setupIntersectionObserver,Rv=e.appendChild,ny=e.appendChildToContainer,wv=e.commitTextUpdate,xE=e.commitMount,Dv=e.commitUpdate,Iv=e.insertBefore,Bv=e.insertInContainerBefore,iy=e.removeChild,Nv=e.removeChildFromContainer,sy=e.resetTextContent,Ov=e.hideInstance,Lv=e.hideTextInstance,Uv=e.unhideInstance,SE=e.unhideTextInstance,Pv=e.clearContainer,dh=e.cloneInstance,Kf=e.createContainerChildSet,ry=e.appendChildToContainerChildSet,Op=e.finalizeContainerChildren,ph=e.replaceContainerChildren,ay=e.cloneHiddenInstance,oy=e.cloneHiddenTextInstance,Lp=e.isSuspenseInstancePending,Up=e.isSuspenseInstanceFallback,Fv=e.getSuspenseInstanceFallbackErrorDetails,zv=e.registerSuspenseInstanceRetry,ly=e.canHydrateFormStateMarker,Vv=e.isFormStateMarkerMatching,cy=e.getNextHydratableSibling,Pp=e.getFirstHydratableChild,Hv=e.getFirstHydratableChildWithinContainer,kv=e.getFirstHydratableChildWithinSuspenseInstance,EE=e.canHydrateInstance,uy=e.canHydrateTextInstance,Gv=e.canHydrateSuspenseInstance,jv=e.hydrateInstance,hy=e.hydrateTextInstance,qv=e.hydrateSuspenseInstance,Xv=e.getNextHydratableInstanceAfterSuspenseInstance,bE=e.commitHydratedContainer,TE=e.commitHydratedSuspenseInstance,Wv=e.clearSuspenseBoundary,Jf=e.clearSuspenseBoundaryFromContainer,Fp=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var zp=e.validateHydratableInstance,Yv=e.validateHydratableTextInstance,qr=e.supportsResources,Qf=e.isHostHoistableType,Vp=e.getHoistableRoot,fy=e.getResource,Kv=e.acquireResource,Wc=e.releaseResource,Zf=e.hydrateHoistable,$f=e.mountHoistable,mh=e.unmountHoistable,Hp=e.createHoistableInstance,Jv=e.prepareToCommitHoistables,Qv=e.mayResourceSuspendCommit,Yc=e.preloadResource,Zv=e.suspendResource,ui=e.supportsSingletons,Ka=e.resolveSingletonInstance,$l=e.clearSingleton,$v=e.acquireSingletonInstance,ec=e.releaseSingletonInstance,So=e.isHostSingletonType,Ki=[],cl=-1,tc={},lr=Math.clz32?Math.clz32:B,e0=Math.log,t0=Math.LN2,Eo=128,Kc=4194304,ed=jr.unstable_scheduleCallback,kp=jr.unstable_cancelCallback,n0=jr.unstable_shouldYield,Gp=jr.unstable_requestPaint,Ma=jr.unstable_now,jp=jr.unstable_ImmediatePriority,i0=jr.unstable_UserBlockingPriority,qp=jr.unstable_NormalPriority,ME=jr.unstable_IdlePriority,s0=jr.log,Ts=jr.unstable_setDisableYieldValue,Ji=null,Tr=null,Mr=typeof Object.is=="function"?Object.is:ne,dy=new WeakMap,Jc=[],Qc=0,Zc=null,gh=0,Xr=[],Wr=0,nc=null,Ja=1,Qa="",ds=M(null),yh=M(null),bo=M(null),$c=M(null),Us=null,Ps=null,Un=!1,Ca=null,Ms=!1,td=Error(s(519)),Ra=[],eu=0,Za=0,nd=null,ul=null,tu=!1,gi=!1,py=!1,_h=0,vh=null,nu=0,Yr=0,iu=null,hl=!1,su=!1,To=Object.prototype.hasOwnProperty,Ah=Error(s(460)),id=Error(s(474)),sd={then:function(){}},ic=null,sc=null,rc=0,ac=_n(!0),Mo=_n(!1),yi=M(null),xh=M(0),Kr=M(null),hi=null,ps=M(0),fl=0,Sn=null,Wt=null,Hn=null,wa=!1,ru=!1,oc=!1,Xp=0,au=0,Cs=null,$a=0,Wp=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Pi={readContext:ve,use:_e,useCallback:Kn,useContext:Kn,useEffect:Kn,useImperativeHandle:Kn,useLayoutEffect:Kn,useInsertionEffect:Kn,useMemo:Kn,useReducer:Kn,useRef:Kn,useState:Kn,useDebugValue:Kn,useDeferredValue:Kn,useTransition:Kn,useSyncExternalStore:Kn,useId:Kn};Pi.useCacheRefresh=Kn,Pi.useMemoCache=Kn,Pi.useHostTransitionStatus=Kn,Pi.useFormState=Kn,Pi.useActionState=Kn,Pi.useOptimistic=Kn;var lc={readContext:ve,use:_e,useCallback:function(u,h){return de().memoizedState=[u,h===void 0?null:h],u},useContext:ve,useEffect:ku,useImperativeHandle:function(u,h,_){_=_!=null?_.concat([u]):null,Uc(4194308,4,mo.bind(null,h,u),_)},useLayoutEffect:function(u,h){return Uc(4194308,4,u,h)},useInsertionEffect:function(u,h){Uc(4,2,u,h)},useMemo:function(u,h){var _=de();h=h===void 0?null:h;var E=u();if(oc){ee(!0);try{u()}finally{ee(!1)}}return _.memoizedState=[E,h],E},useReducer:function(u,h,_){var E=de();if(_!==void 0){var w=_(h);if(oc){ee(!0);try{_(h)}finally{ee(!1)}}}else w=h;return E.memoizedState=E.baseState=w,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:w},E.queue=u,u=u.dispatch=Xo.bind(null,Sn,u),[E.memoizedState,u]},useRef:function(u){var h=de();return u={current:u},h.memoizedState=u},useState:function(u){u=an(u);var h=u.queue,_=ju.bind(null,Sn,h);return h.dispatch=_,[u.memoizedState,_]},useDebugValue:Ha,useDeferredValue:function(u,h){var _=de();return fa(_,u,h)},useTransition:function(){var u=an(!1);return u=Bl.bind(null,Sn,u.queue,!0,!1),de().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,h,_){var E=Sn,w=de();if(Un){if(_===void 0)throw Error(s(407));_=_()}else{if(_=h(),ni===null)throw Error(s(349));(Bn&60)!==0||Lt(E,h,_)}w.memoizedState=_;var P={value:_,getSnapshot:h};return w.queue=P,ku(wn.bind(null,E,P,u),[u]),E.flags|=2048,Si(9,ln.bind(null,E,P,_,h),{destroy:void 0},null),_},useId:function(){var u=de(),h=ni.identifierPrefix;if(Un){var _=Qa,E=Ja;_=(E&~(1<<32-lr(E)-1)).toString(32)+_,h=":"+h+"R"+_,_=Xp++,0<_&&(h+="H"+_.toString(32)),h+=":"}else _=$a++,h=":"+h+"r"+_.toString(32)+":";return u.memoizedState=h},useCacheRefresh:function(){return de().memoizedState=Ol.bind(null,Sn)}};lc.useMemoCache=at,lc.useHostTransitionStatus=_r,lc.useFormState=ji,lc.useActionState=ji,lc.useOptimistic=function(u){var h=de();h.memoizedState=h.baseState=u;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=_,h=pa.bind(null,Sn,!0,_),_.dispatch=h,[u,h]};var cr={readContext:ve,use:_e,useCallback:go,useContext:ve,useEffect:xf,useImperativeHandle:Vr,useInsertionEffect:hp,useLayoutEffect:Pc,useMemo:Gu,useReducer:xt,useRef:Dl,useState:function(){return xt(dt)},useDebugValue:Ha,useDeferredValue:function(u,h){var _=be();return Sf(_,Wt.memoizedState,u,h)},useTransition:function(){var u=xt(dt)[0],h=be().memoizedState;return[typeof u=="boolean"?u:Be(u),h]},useSyncExternalStore:jt,useId:Nl};cr.useCacheRefresh=ka,cr.useMemoCache=at,cr.useHostTransitionStatus=_r,cr.useFormState=Li,cr.useActionState=Li,cr.useOptimistic=function(u,h){var _=be();return Vt(_,Wt,u,h)};var Jr={readContext:ve,use:_e,useCallback:go,useContext:ve,useEffect:xf,useImperativeHandle:Vr,useInsertionEffect:hp,useLayoutEffect:Pc,useMemo:Gu,useReducer:zt,useRef:Dl,useState:function(){return zt(dt)},useDebugValue:Ha,useDeferredValue:function(u,h){var _=be();return Wt===null?fa(_,u,h):Sf(_,Wt.memoizedState,u,h)},useTransition:function(){var u=zt(dt)[0],h=be().memoizedState;return[typeof u=="boolean"?u:Be(u),h]},useSyncExternalStore:jt,useId:Nl};Jr.useCacheRefresh=ka,Jr.useMemoCache=at,Jr.useHostTransitionStatus=_r,Jr.useFormState=ha,Jr.useActionState=ha,Jr.useOptimistic=function(u,h){var _=be();return Wt!==null?Vt(_,Wt,u,h):(_.baseState=u,[u,_.queue.dispatch])};var Co={isMounted:function(u){return(u=u._reactInternals)?y(u)===u:!1},enqueueSetState:function(u,h,_){u=u._reactInternals;var E=Wi(),w=et(E);w.payload=h,_!=null&&(w.callback=_),h=ft(u,w,E),h!==null&&(bs(h,u,E),Dt(h,u,E))},enqueueReplaceState:function(u,h,_){u=u._reactInternals;var E=Wi(),w=et(E);w.tag=1,w.payload=h,_!=null&&(w.callback=_),h=ft(u,w,E),h!==null&&(bs(h,u,E),Dt(h,u,E))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var _=Wi(),E=et(_);E.tag=2,h!=null&&(E.callback=h),h=ft(u,E,_),h!==null&&(bs(h,u,_),Dt(h,u,_))}},Yp=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},Kp=Error(s(461)),fi=!1,Jp={dehydrated:null,treeContext:null,retryLane:0},dl=M(null),eo=null,Qr=null,Sh=typeof AbortController<"u"?AbortController:function(){var u=[],h=this.signal={aborted:!1,addEventListener:function(_,E){u.push(E)}};this.abort=function(){h.aborted=!0,u.forEach(function(_){return _()})}},r0=jr.unstable_scheduleCallback,a0=jr.unstable_NormalPriority,_i={$$typeof:Wa,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},my=en.S;en.S=function(u,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&Le(u,h),my!==null&&my(u,h)};var Ro=M(null),wo=!1,Fi=!1,gy=!1,ti=typeof WeakSet=="function"?WeakSet:Set,hn=null,Cn=!1,qt=null,vn=!1,Bi=null,Zr=8192,Eh={getCacheForType:function(u){var h=ve(_i),_=h.data.get(u);return _===void 0&&(_=u(),h.data.set(u,_)),_}},bh=0,Da=1,Ei=2,to=3,Do=4;if(typeof Symbol=="function"&&Symbol.for){var ou=Symbol.for;bh=ou("selector.component"),Da=ou("selector.has_pseudo_class"),Ei=ou("selector.role"),to=ou("selector.test_id"),Do=ou("selector.text")}var Ia=typeof WeakMap=="function"?WeakMap:Map,kn=0,ni=null,Yt=null,Bn=0,ai=0,Xs=null,Ba=!1,$r=!1,ms=!1,Ws=0,di=0,ea=0,pl=0,rd=0,ta=0,Io=0,lu=null,zi=null,Qp=!1,ur=0,Th=1/0,ad=null,cc=null,no=!1,Bo=null,cu=0,uc=0,Zp=null,Mh=0,$p=null;return pn.attemptContinuousHydration=function(u){if(u.tag===13){var h=Fe(u,67108864);h!==null&&bs(h,u,67108864),kf(u,67108864)}},pn.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13){var h=Wi(),_=Fe(u,h);_!==null&&bs(_,u,h),kf(u,h)}},pn.attemptSynchronousHydration=function(u){switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var h=L(u.pendingLanes);if(h!==0){for(u.pendingLanes|=2,u.entangledLanes|=2;h;){var _=1<<31-lr(h);u.entanglements[1]|=_,h&=~_}st(u),(kn&6)===0&&(Th=Ma()+500,Ft(0))}}break;case 13:h=Fe(u,2),h!==null&&bs(h,u,2),Ff(),kf(u,2)}},pn.batchedUpdates=function(u,h){return u(h)},pn.createComponentSelector=function(u){return{$$typeof:bh,value:u}},pn.createContainer=function(u,h,_,E,w,P,Q,le,Se,je){return yv(u,h,!1,null,_,E,P,Q,le,Se,je,null)},pn.createHasPseudoClassSelector=function(u){return{$$typeof:Da,value:u}},pn.createHydrationContainer=function(u,h,_,E,w,P,Q,le,Se,je,pt,bt,Ct){return u=yv(_,E,!0,u,w,P,le,Se,je,pt,bt,Ct),u.context=rs(null),_=u.current,E=Wi(),w=et(E),w.callback=h??null,ft(_,w,E),u.current.lanes=E,z(u,E),st(u),u},pn.createPortal=function(u,h,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ea,key:E==null?null:""+E,children:u,containerInfo:h,implementation:_}},pn.createRoleSelector=function(u){return{$$typeof:Ei,value:u}},pn.createTestNameSelector=function(u){return{$$typeof:to,value:u}},pn.createTextSelector=function(u){return{$$typeof:Do,value:u}},pn.defaultOnCaughtError=function(u){console.error(u)},pn.defaultOnRecoverableError=function(u){Yp(u)},pn.defaultOnUncaughtError=function(u){Yp(u)},pn.deferredUpdates=function(u){var h=en.T,_=ol();try{return qs(32),en.T=null,u()}finally{qs(_),en.T=h}},pn.discreteUpdates=function(u,h,_,E,w){var P=en.T,Q=ol();try{return qs(2),en.T=null,u(h,_,E,w)}finally{qs(Q),en.T=P,kn===0&&(Th=Ma()+500)}},pn.findAllNodes=Uf,pn.findBoundingRects=function(u,h){if(!Zl)throw Error(s(363));h=Uf(u,h),u=[];for(var _=0;_<h.length;_++)u.push(ty(h[_]));for(h=u.length-1;0<h;h--){_=u[h];for(var E=_.x,w=E+_.width,P=_.y,Q=P+_.height,le=h-1;0<=le;le--)if(h!==le){var Se=u[le],je=Se.x,pt=je+Se.width,bt=Se.y,Ct=bt+Se.height;if(E>=je&&P>=bt&&w<=pt&&Q<=Ct){u.splice(h,1);break}else if(E!==je||_.width!==Se.width||Ct<P||bt>Q){if(!(P!==bt||_.height!==Se.height||pt<E||je>w)){je>E&&(Se.width+=je-E,Se.x=E),pt<w&&(Se.width=w-je),u.splice(h,1);break}}else{bt>P&&(Se.height+=bt-P,Se.y=P),Ct<Q&&(Se.height=Q-bt),u.splice(h,1);break}}}return u},pn.findHostInstance=Tp,pn.findHostInstanceWithNoPortals=function(u){return u=x(u),u=u!==null?R(u):null,u===null?null:uh(u.stateNode)},pn.findHostInstanceWithWarning=function(u){return Tp(u)},pn.flushPassiveEffects=Xa,pn.flushSyncFromReconciler=function(u){var h=kn;kn|=1;var _=en.T,E=ol();try{if(qs(2),en.T=null,u)return u()}finally{qs(E),en.T=_,kn=h,(kn&6)===0&&Ft(0)}},pn.flushSyncWork=Ff,pn.focusWithin=function(u,h){if(!Zl)throw Error(s(363));for(u=eh(u),h=Er(u,h),h=Array.from(h),u=0;u<h.length;){var _=h[u++],E=_.tag;if(!fh(_)){if((E===5||E===26||E===27)&&Mv(_.stateNode))return!0;for(_=_.child;_!==null;)h.push(_),_=_.sibling}}return!1},pn.getFindAllNodesFailureDescription=function(u,h){if(!Zl)throw Error(s(363));var _=0,E=[];u=[eh(u),0];for(var w=0;w<u.length;){var P=u[w++],Q=P.tag,le=u[w++],Se=h[le];if((Q!==5&&Q!==26&&Q!==27||!fh(P))&&(Gl(P,Se)&&(E.push(Fg(Se)),le++,le>_&&(_=le)),le<h.length))for(P=P.child;P!==null;)u.push(P,le),P=P.sibling}if(_<h.length){for(u=[];_<h.length;_++)u.push(Fg(h[_]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},pn.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 27:case 5:return uh(u.child.stateNode);default:return u.child.stateNode}},pn.injectIntoDevTools=function(){var u={bundleType:0,version:Kg,rendererPackageName:Wf,currentDispatcherRef:en,findFiberByHostInstance:xv,reconcilerVersion:"19.0.0"};if(ch!==null&&(u.rendererConfig=ch),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)u=!0;else{try{Ji=h.inject(u),Tr=h}catch{}u=!!h.checkDCE}}return u},pn.isAlreadyRendering=function(){return!1},pn.observeVisibleRects=function(u,h,_,E){if(!Zl)throw Error(s(363));u=Uf(u,h);var w=Cv(u,_,E).disconnect;return{disconnect:function(){w()}}},pn.shouldError=function(){return null},pn.shouldSuspend=function(){return!1},pn.startHostTransition=function(u,h,_,E){if(u.tag!==5)throw Error(s(476));var w=da(u).queue;Bl(u,w,h,Ql,_===null?n:function(){var P=da(u).next.queue;return vr(u,P,{},Wi()),_(E)})},pn.updateContainer=function(u,h,_,E){var w=h.current,P=Wi();return sh(w,P,u,h,_,E),P},pn.updateContainerSync=function(u,h,_,E){return h.tag===0&&Xa(),sh(h.current,2,u,h,_,E),2},pn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})}(mT)),mT.exports}var oI;function wY(){return oI||(oI=1,pT.exports=RY()),pT.exports}var DY=wY();const IY=aS(DY);var _T={exports:{}},vT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lI;function BY(){return lI||(lI=1,function(i){function e(q,ee){var ne=q.length;q.push(ee);e:for(;0<ne;){var ye=ne-1>>>1,K=q[ye];if(0<s(K,ee))q[ye]=ee,q[ne]=K,ne=ye;else break e}}function t(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var ee=q[0],ne=q.pop();if(ne!==ee){q[0]=ne;e:for(var ye=0,K=q.length,ce=K>>>1;ye<ce;){var Ee=2*(ye+1)-1,Me=q[Ee],Ve=Ee+1,ge=q[Ve];if(0>s(Me,ne))Ve<K&&0>s(ge,Me)?(q[ye]=ge,q[Ve]=ne,ye=Ve):(q[ye]=Me,q[Ee]=ne,ye=Ee);else if(Ve<K&&0>s(ge,ne))q[ye]=ge,q[Ve]=ne,ye=Ve;else break e}}return ee}function s(q,ee){var ne=q.sortIndex-ee.sortIndex;return ne!==0?ne:q.id-ee.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var f=[],p=[],m=1,y=null,v=3,x=!1,b=!1,R=!1,M=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function B(q){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=q)n(p),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(p)}}function L(q){if(R=!1,B(q),!b)if(t(f)!==null)b=!0,he();else{var ee=t(p);ee!==null&&me(L,ee.startTime-q)}}var G=!1,H=-1,F=5,U=-1;function I(){return!(i.unstable_now()-U<F)}function N(){if(G){var q=i.unstable_now();U=q;var ee=!0;try{e:{b=!1,R&&(R=!1,T(H),H=-1),x=!0;var ne=v;try{t:{for(B(q),y=t(f);y!==null&&!(y.expirationTime>q&&I());){var ye=y.callback;if(typeof ye=="function"){y.callback=null,v=y.priorityLevel;var K=ye(y.expirationTime<=q);if(q=i.unstable_now(),typeof K=="function"){y.callback=K,B(q),ee=!0;break t}y===t(f)&&n(f),B(q)}else n(f);y=t(f)}if(y!==null)ee=!0;else{var ce=t(p);ce!==null&&me(L,ce.startTime-q),ee=!1}}break e}finally{y=null,v=ne,x=!1}ee=void 0}}finally{ee?z():G=!1}}}var z;if(typeof D=="function")z=function(){D(N)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,k=W.port2;W.port1.onmessage=N,z=function(){k.postMessage(null)}}else z=function(){M(N,0)};function he(){G||(G=!0,z())}function me(q,ee){H=M(function(){q(i.unstable_now())},ee)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(q){q.callback=null},i.unstable_continueExecution=function(){b||x||(b=!0,he())},i.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<q?Math.floor(1e3/q):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_getFirstCallbackNode=function(){return t(f)},i.unstable_next=function(q){switch(v){case 1:case 2:case 3:var ee=3;break;default:ee=v}var ne=v;v=ee;try{return q()}finally{v=ne}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ne=v;v=q;try{return ee()}finally{v=ne}},i.unstable_scheduleCallback=function(q,ee,ne){var ye=i.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ye+ne:ye):ne=ye,q){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ne+K,q={id:m++,callback:ee,priorityLevel:q,startTime:ne,expirationTime:K,sortIndex:-1},ne>ye?(q.sortIndex=ne,e(p,q),t(f)===null&&q===t(p)&&(R?(T(H),H=-1):R=!0,me(L,ne-ye))):(q.sortIndex=K,e(f,q),b||x||(b=!0,he())),q},i.unstable_shouldYield=I,i.unstable_wrapCallback=function(q){var ee=v;return function(){var ne=v;v=ee;try{return q.apply(this,arguments)}finally{v=ne}}}}(vT)),vT}var cI;function NY(){return cI||(cI=1,_T.exports=BY()),_T.exports}var uI=NY();function OC(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const s=OC(n,e,t);if(s)return s;n=e?null:n.sibling}}function TU(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const LC=TU(ue.createContext(null));class MU extends ue.Component{render(){return ue.createElement(LC.Provider,{value:this._reactInternals},this.props.children)}}function CU(){const i=ue.useContext(LC);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ue.useId();return ue.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=OC(t,!1,s=>{let r=s.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(n)return n}},[i,e])}const OY=Symbol.for("react.context"),LY=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===OY;function UY(){const i=CU(),[e]=ue.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;LY(n)&&n!==LC&&!e.has(n)&&e.set(n,ue.use(TU(n))),t=t.return}return e}function PY(){const i=UY();return ue.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>ue.createElement(e,null,ue.createElement(t.Provider,{...n,value:i.get(t)})),e=>ue.createElement(MU,{...e})),[i])}function RU(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const wU=i=>i&&i.isOrthographicCamera,FY=i=>i&&i.hasOwnProperty("current"),zY=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),lv=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?ue.useLayoutEffect:ue.useEffect;function DU(i){const e=ue.useRef(i);return lv(()=>void(e.current=i),[i]),e}function VY(){const i=CU(),e=PY();return ue.useMemo(()=>({children:t})=>{const s=!!OC(i,!0,r=>r.type===ue.StrictMode)?ue.StrictMode:ue.Fragment;return ie.jsx(s,{children:ie.jsx(e,{children:t})})},[i,e])}function HY({set:i}){return lv(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const kY=(i=>(i=class extends ue.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function IU(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Cm(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const Vi={obj:i=>i===Object(i)&&!Vi.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Vi.str(i)||Vi.num(i)||Vi.boo(i))return i===e;const r=Vi.obj(i);if(r&&n==="reference")return i===e;const o=Vi.arr(i);if(o&&t==="reference")return i===e;if((o||r)&&i===e)return!0;let c;for(c in i)if(!(c in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(c in s?e:i)if(!Vi.equ(i[c],e[c],{strict:s,objects:"reference"}))return!1}else for(c in s?e:i)if(i[c]!==e[c])return!1;if(Vi.und(c)){if(o&&i.length===0&&e.length===0||r&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function GY(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function jY(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const BU=["children","key","ref"];function qY(i){const e={};for(const t in i)BU.includes(t)||(e[t]=i[t]);return e}function tS(i,e,t,n){const s=i;let r=s?.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:qY(n),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=r)),r}function U_(i,e){let t=i[e];if(!e.includes("-"))return{root:i,key:e,target:t};t=i;for(const s of e.split("-")){var n;e=s,i=t,t=(n=t)==null?void 0:n[e]}return{root:i,key:e,target:t}}const hI=/-\d+$/;function nS(i,e){if(Vi.str(e.props.attach)){if(hI.test(e.props.attach)){const s=e.props.attach.replace(hI,""),{root:r,key:o}=U_(i.object,s);Array.isArray(r[o])||(r[o]=[])}const{root:t,key:n}=U_(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Vi.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function iS(i,e){if(Vi.str(e.props.attach)){const{root:t,key:n}=U_(i.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[n]:t[n]=s}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const CM=[...BU,"args","dispose","attach","object","onUpdate","dispose"],fI=new Map;function XY(i){let e=fI.get(i.constructor);try{e||(e=new i.constructor,fI.set(i.constructor,e))}catch{}return e}function WY(i,e){const t={};for(const n in e)if(!CM.includes(n)&&!Vi.equ(e[n],i.props[n])){t[n]=e[n];for(const s in e)s.startsWith(`${n}-`)&&(t[s]=e[s])}for(const n in i.props){if(CM.includes(n)||e.hasOwnProperty(n))continue;const{root:s,key:r}=U_(i.object,n);if(s.constructor&&s.constructor.length===0){const o=XY(s);Vi.und(o)||(t[r]=o[r])}else t[r]=0}return t}const YY=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],KY=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Xh(i,e){var t;const n=i.__r3f,s=n&&RU(n).getState(),r=n?.eventCount;for(const c in e){let f=e[c];if(CM.includes(c))continue;if(n&&KY.test(c)){typeof f=="function"?n.handlers[c]=f:delete n.handlers[c],n.eventCount=Object.keys(n.handlers).length;continue}if(f===void 0)continue;let{root:p,key:m,target:y}=U_(i,c);if(y instanceof lg&&f instanceof lg)y.mask=f.mask;else if(y instanceof St&&zY(f))y.set(f);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&typeof y.copy=="function"&&f!=null&&f.constructor&&y.constructor===f.constructor)y.copy(f);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&Array.isArray(f))typeof y.fromArray=="function"?y.fromArray(f):y.set(...f);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&typeof f=="number")typeof y.setScalar=="function"?y.setScalar(f):y.set(f);else{var o;p[m]=f,s&&!s.linear&&YY.includes(m)&&(o=p[m])!=null&&o.isTexture&&p[m].format===Lr&&p[m].type===ko&&(p[m].colorSpace=Nr)}}if(n!=null&&n.parent&&s!=null&&s.internal&&(t=n.object)!=null&&t.isObject3D&&r!==n.eventCount){const c=n.object,f=s.internal.interaction.indexOf(c);f>-1&&s.internal.interaction.splice(f,1),n.eventCount&&c.raycast!==null&&s.internal.interaction.push(c)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Rg(n),i}function Rg(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function JY(i,e){i.manual||(wU(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const aa=i=>i?.isObject3D;function SA(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function NU(i,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(i.delete(n),s.target.releasePointerCapture(n)))}function QY(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{NU(t.capturedMap,e,n,s)})}function ZY(i){function e(f){const{internal:p}=i.getState(),m=f.offsetX-p.initialClick[0],y=f.offsetY-p.initialClick[1];return Math.round(Math.sqrt(m*m+y*y))}function t(f){return f.filter(p=>["Move","Over","Enter","Out","Leave"].some(m=>{var y;return(y=p.__r3f)==null?void 0:y.handlers["onPointer"+m]}))}function n(f,p){const m=i.getState(),y=new Set,v=[],x=p?p(m.internal.interaction):m.internal.interaction;for(let T=0;T<x.length;T++){const D=Cm(x[T]);D&&(D.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(f,m);function b(T){const D=Cm(T);if(!D||!D.events.enabled||D.raycaster.camera===null)return[];if(D.raycaster.camera===void 0){var B;D.events.compute==null||D.events.compute(f,D,(B=D.previousRoot)==null?void 0:B.getState()),D.raycaster.camera===void 0&&(D.raycaster.camera=null)}return D.raycaster.camera?D.raycaster.intersectObject(T,!0):[]}let R=x.flatMap(b).sort((T,D)=>{const B=Cm(T.object),L=Cm(D.object);return!B||!L?T.distance-D.distance:L.events.priority-B.events.priority||T.distance-D.distance}).filter(T=>{const D=SA(T);return y.has(D)?!1:(y.add(D),!0)});m.events.filter&&(R=m.events.filter(R,m));for(const T of R){let D=T.object;for(;D;){var M;(M=D.__r3f)!=null&&M.eventCount&&v.push({...T,eventObject:D}),D=D.parent}}if("pointerId"in f&&m.internal.capturedMap.has(f.pointerId))for(let T of m.internal.capturedMap.get(f.pointerId).values())y.has(SA(T.intersection))||v.push(T.intersection);return v}function s(f,p,m,y){if(f.length){const v={stopped:!1};for(const x of f){let b=Cm(x.object);if(b||x.object.traverseAncestors(R=>{const M=Cm(R);if(M)return b=M,!1}),b){const{raycaster:R,pointer:M,camera:T,internal:D}=b,B=new $(M.x,M.y,0).unproject(T),L=I=>{var N,z;return(N=(z=D.capturedMap.get(I))==null?void 0:z.has(x.eventObject))!=null?N:!1},G=I=>{const N={intersection:x,target:p.target};D.capturedMap.has(I)?D.capturedMap.get(I).set(x.eventObject,N):D.capturedMap.set(I,new Map([[x.eventObject,N]])),p.target.setPointerCapture(I)},H=I=>{const N=D.capturedMap.get(I);N&&NU(D.capturedMap,x.eventObject,N,I)};let F={};for(let I in p){let N=p[I];typeof N!="function"&&(F[I]=N)}let U={...x,...F,pointer:M,intersections:f,stopped:v.stopped,delta:m,unprojectedPoint:B,ray:R.ray,camera:T,stopPropagation(){const I="pointerId"in p&&D.capturedMap.get(p.pointerId);if((!I||I.has(x.eventObject))&&(U.stopped=v.stopped=!0,D.hovered.size&&Array.from(D.hovered.values()).find(N=>N.eventObject===x.eventObject))){const N=f.slice(0,f.indexOf(x));r([...N,x])}},target:{hasPointerCapture:L,setPointerCapture:G,releasePointerCapture:H},currentTarget:{hasPointerCapture:L,setPointerCapture:G,releasePointerCapture:H},nativeEvent:p};if(y(U),v.stopped===!0)break}}}return f}function r(f){const{internal:p}=i.getState();for(const m of p.hovered.values())if(!f.length||!f.find(y=>y.object===m.object&&y.index===m.index&&y.instanceId===m.instanceId)){const v=m.eventObject.__r3f;if(p.hovered.delete(SA(m)),v!=null&&v.eventCount){const x=v.handlers,b={...m,intersections:f};x.onPointerOut==null||x.onPointerOut(b),x.onPointerLeave==null||x.onPointerLeave(b)}}}function o(f,p){for(let m=0;m<p.length;m++){const y=p[m].__r3f;y==null||y.handlers.onPointerMissed==null||y.handlers.onPointerMissed(f)}}function c(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return p=>{const{internal:m}=i.getState();"pointerId"in p&&m.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(p.pointerId)&&(m.capturedMap.delete(p.pointerId),r([]))})}}return function(m){const{onPointerMissed:y,internal:v}=i.getState();v.lastEvent.current=m;const x=f==="onPointerMove",b=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",M=n(m,x?t:void 0),T=b?e(m):0;f==="onPointerDown"&&(v.initialClick=[m.offsetX,m.offsetY],v.initialHits=M.map(B=>B.eventObject)),b&&!M.length&&T<=2&&(o(m,v.interaction),y&&y(m)),x&&r(M);function D(B){const L=B.eventObject,G=L.__r3f;if(!(G!=null&&G.eventCount))return;const H=G.handlers;if(x){if(H.onPointerOver||H.onPointerEnter||H.onPointerOut||H.onPointerLeave){const F=SA(B),U=v.hovered.get(F);U?U.stopped&&B.stopPropagation():(v.hovered.set(F,B),H.onPointerOver==null||H.onPointerOver(B),H.onPointerEnter==null||H.onPointerEnter(B))}H.onPointerMove==null||H.onPointerMove(B)}else{const F=H[f];F?(!b||v.initialHits.includes(L))&&(o(m,v.interaction.filter(U=>!v.initialHits.includes(U))),F(B)):b&&v.initialHits.includes(L)&&o(m,v.interaction.filter(U=>!v.initialHits.includes(U)))}}s(M,m,T,D)}}return{handlePointer:c}}const dI=i=>!!(i!=null&&i.render),OU=ue.createContext(null),$Y=(i,e)=>{const t=xY((c,f)=>{const p=new $,m=new $,y=new $;function v(T=f().camera,D=m,B=f().size){const{width:L,height:G,top:H,left:F}=B,U=L/G;D.isVector3?y.copy(D):y.set(...D);const I=T.getWorldPosition(p).distanceTo(y);if(wU(T))return{width:L/T.zoom,height:G/T.zoom,top:H,left:F,factor:1,distance:I,aspect:U};{const N=T.fov*Math.PI/180,z=2*Math.tan(N/2)*I,W=z*(L/G);return{width:W,height:z,top:H,left:F,factor:L/W,distance:I,aspect:U}}}let x;const b=T=>c(D=>({performance:{...D.performance,current:T}})),R=new Xe;return{set:c,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(T=1)=>i(f(),T),advance:(T,D)=>e(T,D,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new RC,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const T=f();x&&clearTimeout(x),T.performance.current!==T.performance.min&&b(T.performance.min),x=setTimeout(()=>b(f().performance.max),T.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:T=>c(D=>({...D,events:{...D.events,...T}})),setSize:(T,D,B=0,L=0)=>{const G=f().camera,H={width:T,height:D,top:B,left:L};c(F=>({size:H,viewport:{...F.viewport,...v(G,m,H)}}))},setDpr:T=>c(D=>{const B=IU(T);return{viewport:{...D.viewport,dpr:B,initialDpr:D.viewport.initialDpr||B}}}),setFrameloop:(T="always")=>{const D=f().clock;D.stop(),D.elapsedTime=0,T!=="never"&&(D.start(),D.elapsedTime=0),c(()=>({frameloop:T}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:ue.createRef(),active:!1,frames:0,priority:0,subscribe:(T,D,B)=>{const L=f().internal;return L.priority=L.priority+(D>0?1:0),L.subscribers.push({ref:T,priority:D,store:B}),L.subscribers=L.subscribers.sort((G,H)=>G.priority-H.priority),()=>{const G=f().internal;G!=null&&G.subscribers&&(G.priority=G.priority-(D>0?1:0),G.subscribers=G.subscribers.filter(H=>H.ref!==T))}}}}}),n=t.getState();let s=n.size,r=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:c,size:f,viewport:p,gl:m,set:y}=t.getState();if(f.width!==s.width||f.height!==s.height||p.dpr!==r){s=f,r=p.dpr,JY(c,f),p.dpr>0&&m.setPixelRatio(p.dpr);const v=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(f.width,f.height,v)}c!==o&&(o=c,y(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>i(c)),t};function LU(){const i=ue.useContext(OU);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function _u(i=t=>t,e){return LU()(i,e)}function UC(i,e=0){const t=LU(),n=t.getState().internal.subscribe,s=DU(i);return lv(()=>n(s,e,t),[e,n,t]),null}const pI=new WeakMap,eK=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function UU(i,e){return function(t,...n){let s;return eK(t)?(s=pI.get(t),s||(s=new t,pI.set(t,s))):s=t,i&&i(s),Promise.all(n.map(r=>new Promise((o,c)=>s.load(r,f=>{aa(f?.scene)&&Object.assign(f,GY(f.scene)),o(f)},e,f=>c(new Error(`Could not load ${r}: ${f?.message}`))))))}}function cv(i,e,t,n){const s=Array.isArray(e)?e:[e],r=EY(UU(t,n),[i,...s],{equal:Vi.equ});return Array.isArray(e)?r:r[0]}cv.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return bY(UU(t),[i,...n])};cv.clear=function(i,e){const t=Array.isArray(e)?e:[e];return TY([i,...t])};function tK(i){const e=IY(i);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ue.version}),e}const PU=0,fg={},nK=/^three(?=[A-Z])/,gE=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let iK=0;const sK=i=>typeof i=="function";function rK(i){if(sK(i)){const e=`${iK++}`;return fg[e]=i,e}else Object.assign(fg,i)}function FU(i,e){const t=gE(i),n=fg[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function aK(i,e,t){var n;return i=gE(i)in fg?i:i.replace(nK,""),FU(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,tS(e.object,t,i,e)}function oK(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?iS(i.parent,i):aa(i.object)&&(i.object.visible=!1),i.isHidden=!0,Rg(i)}}function zU(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?nS(i.parent,i):aa(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Rg(i)}}function PC(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var s,r;const o=fg[gE(e.type)];e.object=(s=e.props.object)!=null?s:new o(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(Xh(e.object,e.props),e.props.attach)nS(i,e);else if(aa(e.object)&&aa(i.object)){const o=i.object.children.indexOf(t?.object);if(t&&o!==-1){const c=i.object.children.indexOf(e.object);if(c!==-1){i.object.children.splice(c,1);const f=c<o?o-1:o;i.object.children.splice(f,0,e.object)}else e.object.parent=i.object,i.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const o of e.children)PC(e,o);Rg(e)}}function AT(i,e){e&&(e.parent=i,i.children.push(e),PC(i,e))}function mI(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),PC(i,e,t)}function VU(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():uI.unstable_scheduleCallback(uI.unstable_IdlePriority,e)}}function RM(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?iS(i,e):aa(e.object)&&aa(i.object)&&(i.object.remove(e.object),QY(RU(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const o=e.children[r];RM(e,o,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&VU(e.object),t===void 0&&Rg(e)}function lK(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const XA=[];function cK(){for(const[t]of XA){const n=t.parent;if(n){t.props.attach?iS(n,t):aa(t.object)&&aa(n.object)&&n.object.remove(t.object);for(const s of t.children)s.props.attach?iS(t,s):aa(s.object)&&aa(t.object)&&t.object.remove(s.object)}t.isHidden&&zU(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&VU(t.object)}for(const[t,n,s]of XA){t.props=n;const r=t.parent;if(r){var i,e;const o=fg[gE(t.type)];t.object=(i=t.props.object)!=null?i:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,lK(s,t.object),Xh(t.object,t.props),t.props.attach?nS(r,t):aa(t.object)&&aa(r.object)&&r.object.add(t.object);for(const c of t.children)c.props.attach?nS(t,c):aa(c.object)&&aa(t.object)&&t.object.add(c.object);Rg(t)}}XA.length=0}const xT=()=>{},gI={};let EA=PU;const uK=0,hK=4,wM=tK({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:aK,removeChild:RM,appendChild:AT,appendInitialChild:AT,insertBefore:mI,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||AT(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||RM(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||mI(n,e,t)},getRootHostContext:()=>gI,getChildHostContext:()=>gI,commitUpdate(i,e,t,n,s){var r,o,c;FU(e,n);let f=!1;if((i.type==="primitive"&&t.object!==n.object||((r=n.args)==null?void 0:r.length)!==((o=t.args)==null?void 0:o.length)||(c=n.args)!=null&&c.some((m,y)=>{var v;return m!==((v=t.args)==null?void 0:v[y])}))&&(f=!0),f)XA.push([i,{...n},s]);else{const m=WY(i,n);Object.keys(m).length&&(Object.assign(i.props,m),Xh(i.object,m))}(s.sibling===null||(s.flags&hK)===uK)&&cK()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i?.object,prepareForCommit:()=>null,preparePortalMount:i=>tS(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:oK,unhideInstance:zU,createTextInstance:xT,hideTextInstance:xT,unhideTextInstance:xT,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:ue.createContext(null),setCurrentUpdatePriority(i){EA=i},getCurrentUpdatePriority(){return EA},resolveUpdatePriority(){var i;if(EA!==PU)return EA;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return kA.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return kA.ContinuousEventPriority;default:return kA.DefaultEventPriority}},resetFormInstance(){}}),np=new Map,Rm={objects:"shallow",strict:!1};function fK(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:s,left:r}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:s,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function dK(i){const e=np.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,r=n||$Y(BM,_I),o=t||wM.createContainer(r,kA.ConcurrentRoot,null,!1,null,"",s,s,s,null);e||np.set(i,{fiber:o,store:r});let c,f,p=!1,m=null;return{async configure(y={}){let v;m=new Promise(ce=>v=ce);let{gl:x,size:b,scene:R,events:M,onCreated:T,shadows:D=!1,linear:B=!1,flat:L=!1,legacy:G=!1,orthographic:H=!1,frameloop:F="always",dpr:U=[1,2],performance:I,raycaster:N,camera:z,onPointerMissed:W}=y,k=r.getState(),he=k.gl;if(!k.gl){const ce={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},Ee=typeof x=="function"?await x(ce):x;dI(Ee)?he=Ee:he=new SU({...ce,...x}),k.set({gl:he})}let me=k.raycaster;me||k.set({raycaster:me=new dU});const{params:q,...ee}=N||{};if(Vi.equ(ee,me,Rm)||Xh(me,{...ee}),Vi.equ(q,me.params,Rm)||Xh(me,{params:{...me.params,...q}}),!k.camera||k.camera===f&&!Vi.equ(f,z,Rm)){f=z;const ce=z?.isCamera,Ee=ce?z:H?new Tl(0,0,0,0,.1,1e3):new Hi(75,0,.1,1e3);ce||(Ee.position.z=5,z&&(Xh(Ee,z),Ee.manual||("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(Ee.manual=!0,Ee.updateProjectionMatrix())),!k.camera&&!(z!=null&&z.rotation)&&Ee.lookAt(0,0,0)),k.set({camera:Ee}),me.camera=Ee}if(!k.scene){let ce;R!=null&&R.isScene?(ce=R,tS(ce,r,"",{})):(ce=new sC,tS(ce,r,"",{}),R&&Xh(ce,R)),k.set({scene:ce})}M&&!k.events.handlers&&k.set({events:M(r)});const ne=fK(i,b);if(Vi.equ(ne,k.size,Rm)||k.setSize(ne.width,ne.height,ne.top,ne.left),U&&k.viewport.dpr!==IU(U)&&k.setDpr(U),k.frameloop!==F&&k.setFrameloop(F),k.onPointerMissed||k.set({onPointerMissed:W}),I&&!Vi.equ(I,k.performance,Rm)&&k.set(ce=>({performance:{...ce.performance,...I}})),!k.xr){var ye;const ce=(Ve,ge)=>{const ze=r.getState();ze.frameloop!=="never"&&_I(Ve,!0,ze,ge)},Ee=()=>{const Ve=r.getState();Ve.gl.xr.enabled=Ve.gl.xr.isPresenting,Ve.gl.xr.setAnimationLoop(Ve.gl.xr.isPresenting?ce:null),Ve.gl.xr.isPresenting||BM(Ve)},Me={connect(){const Ve=r.getState().gl;Ve.xr.addEventListener("sessionstart",Ee),Ve.xr.addEventListener("sessionend",Ee)},disconnect(){const Ve=r.getState().gl;Ve.xr.removeEventListener("sessionstart",Ee),Ve.xr.removeEventListener("sessionend",Ee)}};typeof((ye=he.xr)==null?void 0:ye.addEventListener)=="function"&&Me.connect(),k.set({xr:Me})}if(he.shadowMap){const ce=he.shadowMap.enabled,Ee=he.shadowMap.type;if(he.shadowMap.enabled=!!D,Vi.boo(D))he.shadowMap.type=a_;else if(Vi.str(D)){var K;const Me={basic:CO,percentage:US,soft:a_,variance:Al};he.shadowMap.type=(K=Me[D])!=null?K:a_}else Vi.obj(D)&&Object.assign(he.shadowMap,D);(ce!==he.shadowMap.enabled||Ee!==he.shadowMap.type)&&(he.shadowMap.needsUpdate=!0)}return Gn.enabled=!G,p||(he.outputColorSpace=B?ff:Nr,he.toneMapping=L?Cc:G1),k.legacy!==G&&k.set(()=>({legacy:G})),k.linear!==B&&k.set(()=>({linear:B})),k.flat!==L&&k.set(()=>({flat:L})),x&&!Vi.fun(x)&&!dI(x)&&!Vi.equ(x,he,Rm)&&Xh(he,x),c=T,p=!0,v(),this},render(y){return!p&&!m&&this.configure(),m.then(()=>{wM.updateContainer(ie.jsx(pK,{store:r,children:y,onCreated:c,rootElement:i}),o,null,()=>{})}),r},unmount(){HU(i)}}}function pK({store:i,children:e,onCreated:t,rootElement:n}){return lv(()=>{const s=i.getState();s.set(r=>({internal:{...r.internal,active:!0}})),t&&t(s),i.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),ie.jsx(OU.Provider,{value:i,children:e})}function HU(i,e){const t=np.get(i),n=t?.fiber;if(n){const s=t?.store.getState();s&&(s.internal.active=!1),wM.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var r,o,c,f;s.events.disconnect==null||s.events.disconnect(),(r=s.gl)==null||(o=r.renderLists)==null||o.dispose==null||o.dispose(),(c=s.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(f=s.gl)!=null&&f.xr&&s.xr.disconnect(),jY(s.scene),np.delete(i)}catch{}},500)})}}const mK=new Set,gK=new Set,yK=new Set;function ST(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function m_(i,e){switch(i){case"before":return ST(mK,e);case"after":return ST(gK,e);case"tail":return ST(yK,e)}}let ET,bT;function DM(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),ET=e.internal.subscribers;for(let s=0;s<ET.length;s++)bT=ET[s],bT.ref.current(bT.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let sS=!1,IM=!1,TT,yI,wm;function kU(i){yI=requestAnimationFrame(kU),sS=!0,TT=0,m_("before",i),IM=!0;for(const t of np.values()){var e;wm=t.store.getState(),wm.internal.active&&(wm.frameloop==="always"||wm.internal.frames>0)&&!((e=wm.gl.xr)!=null&&e.isPresenting)&&(TT+=DM(i,wm))}if(IM=!1,m_("after",i),TT===0)return m_("tail",i),sS=!1,cancelAnimationFrame(yI)}function BM(i,e=1){var t;if(!i)return np.forEach(n=>BM(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):IM?i.internal.frames=2:i.internal.frames=1,sS||(sS=!0,requestAnimationFrame(kU)))}function _I(i,e=!0,t,n){if(e&&m_("before",i),t)DM(i,t,n);else for(const s of np.values())DM(i,s.store.getState());e&&m_("after",i)}const MT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function _K(i){const{handlePointer:e}=ZY(i);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(MT).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=i.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:n,events:s}=i.getState();if(s.disconnect==null||s.disconnect(),n(r=>({events:{...r.events,connected:t}})),s.handlers)for(const r in s.handlers){const o=s.handlers[r],[c,f]=MT[r];t.addEventListener(c,o,{passive:f})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const s in n.handlers){const r=n.handlers[s],[o]=MT[s];n.connected.removeEventListener(o,r)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function vI(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function vK({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,o]=ue.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=ue.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),f=i?typeof i=="number"?i:i.scroll:null,p=i?typeof i=="number"?i:i.resize:null,m=ue.useRef(!1);ue.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[y,v,x]=ue.useMemo(()=>{const T=()=>{if(!c.current.element)return;const{left:D,top:B,width:L,height:G,bottom:H,right:F,x:U,y:I}=c.current.element.getBoundingClientRect(),N={left:D,top:B,width:L,height:G,bottom:H,right:F,x:U,y:I};c.current.element instanceof HTMLElement&&n&&(N.height=c.current.element.offsetHeight,N.width=c.current.element.offsetWidth),Object.freeze(N),m.current&&!EK(c.current.lastBounds,N)&&o(c.current.lastBounds=N)};return[T,p?vI(T,p):T,f?vI(T,f):T]},[o,n,f,p]);function b(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(T=>T.removeEventListener("scroll",x,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function R(){c.current.element&&(c.current.resizeObserver=new s(x),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(T=>T.addEventListener("scroll",x,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{x()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const M=T=>{!T||T===c.current.element||(b(),c.current.element=T,c.current.scrollContainers=GU(T),R())};return xK(x,!!e),AK(v),ue.useEffect(()=>{b(),R()},[e,x,v]),ue.useEffect(()=>b,[]),[M,r,y]}function AK(i){ue.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function xK(i,e){ue.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function GU(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(i);return[t,n,s].some(r=>r==="auto"||r==="scroll")&&e.push(i),[...e,...GU(i.parentElement)]}const SK=["x","y","top","bottom","left","right","width","height"],EK=(i,e)=>SK.every(t=>i[t]===e[t]);function bK({ref:i,children:e,fallback:t,resize:n,style:s,gl:r,events:o=_K,eventSource:c,eventPrefix:f,shadows:p,linear:m,flat:y,legacy:v,orthographic:x,frameloop:b,dpr:R,performance:M,raycaster:T,camera:D,scene:B,onPointerMissed:L,onCreated:G,...H}){ue.useMemo(()=>rK(hY),[]);const F=VY(),[U,I]=vK({scroll:!0,debounce:{scroll:50,resize:0},...n}),N=ue.useRef(null),z=ue.useRef(null);ue.useImperativeHandle(i,()=>N.current);const W=DU(L),[k,he]=ue.useState(!1),[me,q]=ue.useState(!1);if(k)throw k;if(me)throw me;const ee=ue.useRef(null);lv(()=>{const ye=N.current;if(I.width>0&&I.height>0&&ye){ee.current||(ee.current=dK(ye));async function K(){await ee.current.configure({gl:r,scene:B,events:o,shadows:p,linear:m,flat:y,legacy:v,orthographic:x,frameloop:b,dpr:R,performance:M,raycaster:T,camera:D,size:I,onPointerMissed:(...ce)=>W.current==null?void 0:W.current(...ce),onCreated:ce=>{ce.events.connect==null||ce.events.connect(c?FY(c)?c.current:c:z.current),f&&ce.setEvents({compute:(Ee,Me)=>{const Ve=Ee[f+"X"],ge=Ee[f+"Y"];Me.pointer.set(Ve/Me.size.width*2-1,-(ge/Me.size.height)*2+1),Me.raycaster.setFromCamera(Me.pointer,Me.camera)}}),G?.(ce)}}),ee.current.render(ie.jsx(F,{children:ie.jsx(kY,{set:q,children:ie.jsx(ue.Suspense,{fallback:ie.jsx(HY,{set:he}),children:e??null})})}))}K()}}),ue.useEffect(()=>{const ye=N.current;if(ye)return()=>HU(ye)},[]);const ne=c?"none":"auto";return ie.jsx("div",{ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ne,...s},...H,children:ie.jsx("div",{ref:U,style:{width:"100%",height:"100%"},children:ie.jsx("canvas",{ref:N,style:{display:"block"},children:t})})})}function TK(i){return ie.jsx(MU,{children:ie.jsx(bK,{...i})})}function P_(){return P_=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},P_.apply(null,arguments)}const uv=new $,FC=new $,MK=new $,AI=new Xe;function CK(i,e,t){const n=uv.setFromMatrixPosition(i.matrixWorld);n.project(e);const s=t.width/2,r=t.height/2;return[n.x*s+s,-(n.y*r)+r]}function RK(i,e){const t=uv.setFromMatrixPosition(i.matrixWorld),n=FC.setFromMatrixPosition(e.matrixWorld),s=t.sub(n),r=e.getWorldDirection(MK);return s.angleTo(r)>Math.PI/2}function wK(i,e,t,n){const s=uv.setFromMatrixPosition(i.matrixWorld),r=s.clone();r.project(e),AI.set(r.x,r.y),t.setFromCamera(AI,e);const o=t.intersectObjects(n,!0);if(o.length){const c=o[0].distance;return s.distanceTo(t.ray.origin)<c}return!0}function DK(i,e){if(e instanceof Tl)return e.zoom;if(e instanceof Hi){const t=uv.setFromMatrixPosition(i.matrixWorld),n=FC.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,r=t.distanceTo(n);return 1/(2*Math.tan(s/2)*r)}else return 1}function IK(i,e,t){if(e instanceof Hi||e instanceof Tl){const n=uv.setFromMatrixPosition(i.matrixWorld),s=FC.setFromMatrixPosition(e.matrixWorld),r=n.distanceTo(s),o=(t[1]-t[0])/(e.far-e.near),c=t[1]-o*e.far;return Math.round(o*r+c)}}const NM=i=>Math.abs(i)<1e-10?0:i;function jU(i,e,t=""){let n="matrix3d(";for(let s=0;s!==16;s++)n+=NM(e[s]*i.elements[s])+(s!==15?",":")");return t+n}const BK=(i=>e=>jU(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),NK=(i=>(e,t)=>jU(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function OK(i){return i&&typeof i=="object"&&"current"in i}const qU=ue.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:s,center:r,fullscreen:o,portal:c,distanceFactor:f,sprite:p=!1,transform:m=!1,occlude:y,onOcclude:v,castShadow:x,receiveShadow:b,material:R,geometry:M,zIndexRange:T=[16777271,0],calculatePosition:D=CK,as:B="div",wrapperClass:L,pointerEvents:G="auto",...H},F)=>{const{gl:U,camera:I,scene:N,size:z,raycaster:W,events:k,viewport:he}=_u(),[me]=ue.useState(()=>document.createElement(B)),q=ue.useRef(null),ee=ue.useRef(null),ne=ue.useRef(0),ye=ue.useRef([0,0]),K=ue.useRef(null),ce=ue.useRef(null),Ee=c?.current||k.connected||U.domElement.parentNode,Me=ue.useRef(null),Ve=ue.useRef(!1),ge=ue.useMemo(()=>y&&y!=="blending"||Array.isArray(y)&&y.length&&OK(y[0]),[y]);ue.useLayoutEffect(()=>{const Et=U.domElement;y&&y==="blending"?(Et.style.zIndex=`${Math.floor(T[0]/2)}`,Et.style.position="absolute",Et.style.pointerEvents="none"):(Et.style.zIndex=null,Et.style.position=null,Et.style.pointerEvents=null)},[y]),ue.useLayoutEffect(()=>{if(ee.current){const Et=q.current=wI.createRoot(me);if(N.updateMatrixWorld(),m)me.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Nt=D(ee.current,I,z);me.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Nt[0]}px,${Nt[1]}px,0);transform-origin:0 0;`}return Ee&&(s?Ee.prepend(me):Ee.appendChild(me)),()=>{Ee&&Ee.removeChild(me),Et.unmount()}}},[Ee,m]),ue.useLayoutEffect(()=>{L&&(me.className=L)},[L]);const ze=ue.useMemo(()=>m?{position:"absolute",top:0,left:0,width:z.width,height:z.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:r?"translate3d(-50%,-50%,0)":"none",...o&&{top:-z.height/2,left:-z.width/2,width:z.width,height:z.height},...t},[t,r,o,z,m]),Je=ue.useMemo(()=>({position:"absolute",pointerEvents:G}),[G]);ue.useLayoutEffect(()=>{if(Ve.current=!1,m){var Et;(Et=q.current)==null||Et.render(ue.createElement("div",{ref:K,style:ze},ue.createElement("div",{ref:ce,style:Je},ue.createElement("div",{ref:F,className:n,style:t,children:i}))))}else{var Nt;(Nt=q.current)==null||Nt.render(ue.createElement("div",{ref:F,style:ze,className:n,children:i}))}});const lt=ue.useRef(!0);UC(Et=>{if(ee.current){I.updateMatrixWorld(),ee.current.updateWorldMatrix(!0,!1);const Nt=m?ye.current:D(ee.current,I,z);if(m||Math.abs(ne.current-I.zoom)>e||Math.abs(ye.current[0]-Nt[0])>e||Math.abs(ye.current[1]-Nt[1])>e){const It=RK(ee.current,I);let se=!1;ge&&(Array.isArray(y)?se=y.map(Fe=>Fe.current):y!=="blending"&&(se=[N]));const Ge=lt.current;if(se){const Fe=wK(ee.current,I,W,se);lt.current=Fe&&!It}else lt.current=!It;Ge!==lt.current&&(v?v(!lt.current):me.style.display=lt.current?"block":"none");const He=Math.floor(T[0]/2),tt=y?ge?[T[0],He]:[He-1,0]:T;if(me.style.zIndex=`${IK(ee.current,I,tt)}`,m){const[Fe,ut]=[z.width/2,z.height/2],Qe=I.projectionMatrix.elements[5]*ut,{isOrthographicCamera:st,top:Ft,left:Gt,bottom:te,right:X}=I,xe=BK(I.matrixWorldInverse),Re=st?`scale(${Qe})translate(${NM(-(X+Gt)/2)}px,${NM((Ft+te)/2)}px)`:`translateZ(${Qe}px)`;let Ue=ee.current.matrixWorld;p&&(Ue=I.matrixWorldInverse.clone().transpose().copyPosition(Ue).scale(ee.current.scale),Ue.elements[3]=Ue.elements[7]=Ue.elements[11]=0,Ue.elements[15]=1),me.style.width=z.width+"px",me.style.height=z.height+"px",me.style.perspective=st?"":`${Qe}px`,K.current&&ce.current&&(K.current.style.transform=`${Re}${xe}translate(${Fe}px,${ut}px)`,ce.current.style.transform=NK(Ue,1/((f||10)/400)))}else{const Fe=f===void 0?1:DK(ee.current,I)*f;me.style.transform=`translate3d(${Nt[0]}px,${Nt[1]}px,0) scale(${Fe})`}ye.current=Nt,ne.current=I.zoom}}if(!ge&&Me.current&&!Ve.current)if(m){if(K.current){const Nt=K.current.children[0];if(Nt!=null&&Nt.clientWidth&&Nt!=null&&Nt.clientHeight){const{isOrthographicCamera:It}=I;if(It||M)H.scale&&(Array.isArray(H.scale)?H.scale instanceof $?Me.current.scale.copy(H.scale.clone().divideScalar(1)):Me.current.scale.set(1/H.scale[0],1/H.scale[1],1/H.scale[2]):Me.current.scale.setScalar(1/H.scale));else{const se=(f||10)/400,Ge=Nt.clientWidth*se,He=Nt.clientHeight*se;Me.current.scale.set(Ge,He,1)}Ve.current=!0}}}else{const Nt=me.children[0];if(Nt!=null&&Nt.clientWidth&&Nt!=null&&Nt.clientHeight){const It=1/he.factor,se=Nt.clientWidth*It,Ge=Nt.clientHeight*It;Me.current.scale.set(se,Ge,1),Ve.current=!0}Me.current.lookAt(Et.camera.position)}});const At=ue.useMemo(()=>({vertexShader:m?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[m]);return ue.createElement("group",P_({},H,{ref:ee}),y&&!ge&&ue.createElement("mesh",{castShadow:x,receiveShadow:b,ref:Me},M||ue.createElement("planeGeometry",null),R||ue.createElement("shaderMaterial",{side:Fo,vertexShader:At.vertexShader,fragmentShader:At.fragmentShader})))}),LK=parseInt(Q_.replace(/\D+/g,""));function xI(i,e){if(e===sL)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===Jx||e===Z1){let t=i.getIndex();if(t===null){const o=[],c=i.getAttribute("position");if(c!==void 0){for(let f=0;f<c.count;f++)o.push(f);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,s=[];if(t)if(e===Jx)for(let o=1;o<=n;o++)s.push(t.getX(0)),s.push(t.getX(o)),s.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(s.push(t.getX(o)),s.push(t.getX(o+1)),s.push(t.getX(o+2))):(s.push(t.getX(o+2)),s.push(t.getX(o+1)),s.push(t.getX(o)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=i.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var UK=Object.defineProperty,PK=(i,e,t)=>e in i?UK(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,FK=(i,e,t)=>(PK(i,e+"",t),t);class zK{constructor(){FK(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}var VK=Object.defineProperty,HK=(i,e,t)=>e in i?VK(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Kt=(i,e,t)=>(HK(i,typeof e!="symbol"?e+"":e,t),t);const bA=new op,SI=new Au,kK=Math.cos(70*(Math.PI/180)),EI=(i,e)=>(i%e+e)%e;let GK=class extends zK{constructor(e,t){super(),Kt(this,"object"),Kt(this,"domElement"),Kt(this,"enabled",!0),Kt(this,"target",new $),Kt(this,"minDistance",0),Kt(this,"maxDistance",1/0),Kt(this,"minZoom",0),Kt(this,"maxZoom",1/0),Kt(this,"minPolarAngle",0),Kt(this,"maxPolarAngle",Math.PI),Kt(this,"minAzimuthAngle",-1/0),Kt(this,"maxAzimuthAngle",1/0),Kt(this,"enableDamping",!1),Kt(this,"dampingFactor",.05),Kt(this,"enableZoom",!0),Kt(this,"zoomSpeed",1),Kt(this,"enableRotate",!0),Kt(this,"rotateSpeed",1),Kt(this,"enablePan",!0),Kt(this,"panSpeed",1),Kt(this,"screenSpacePanning",!0),Kt(this,"keyPanSpeed",7),Kt(this,"zoomToCursor",!1),Kt(this,"autoRotate",!1),Kt(this,"autoRotateSpeed",2),Kt(this,"reverseOrbit",!1),Kt(this,"reverseHorizontalOrbit",!1),Kt(this,"reverseVerticalOrbit",!1),Kt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Kt(this,"mouseButtons",{LEFT:bd.ROTATE,MIDDLE:bd.DOLLY,RIGHT:bd.PAN}),Kt(this,"touches",{ONE:Td.ROTATE,TWO:Td.DOLLY_PAN}),Kt(this,"target0"),Kt(this,"position0"),Kt(this,"zoom0"),Kt(this,"_domElementKeyEvents",null),Kt(this,"getPolarAngle"),Kt(this,"getAzimuthalAngle"),Kt(this,"setPolarAngle"),Kt(this,"setAzimuthalAngle"),Kt(this,"getDistance"),Kt(this,"getZoomScale"),Kt(this,"listenToKeyEvents"),Kt(this,"stopListenToKeyEvents"),Kt(this,"saveState"),Kt(this,"reset"),Kt(this,"update"),Kt(this,"connect"),Kt(this,"dispose"),Kt(this,"dollyIn"),Kt(this,"dollyOut"),Kt(this,"getScale"),Kt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>m.phi,this.getAzimuthalAngle=()=>m.theta,this.setPolarAngle=re=>{let Te=EI(re,2*Math.PI),rt=m.phi;rt<0&&(rt+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let oe=Math.abs(Te-rt);2*Math.PI-oe<oe&&(Te<rt?Te+=2*Math.PI:rt+=2*Math.PI),y.phi=Te-rt,n.update()},this.setAzimuthalAngle=re=>{let Te=EI(re,2*Math.PI),rt=m.theta;rt<0&&(rt+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let oe=Math.abs(Te-rt);2*Math.PI-oe<oe&&(Te<rt?Te+=2*Math.PI:rt+=2*Math.PI),y.theta=Te-rt,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=re=>{re.addEventListener("keydown",Le),this._domElementKeyEvents=re},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Le),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(s),n.update(),f=c.NONE},this.update=(()=>{const re=new $,Te=new $(0,1,0),rt=new Zs().setFromUnitVectors(e.up,Te),oe=rt.clone().invert(),Ke=new $,nt=new Zs,yt=2*Math.PI;return function(){const ke=n.object.position;rt.setFromUnitVectors(e.up,Te),oe.copy(rt).invert(),re.copy(ke).sub(n.target),re.applyQuaternion(rt),m.setFromVector3(re),n.autoRotate&&f===c.NONE&&he(W()),n.enableDamping?(m.theta+=y.theta*n.dampingFactor,m.phi+=y.phi*n.dampingFactor):(m.theta+=y.theta,m.phi+=y.phi);let vt=n.minAzimuthAngle,Ot=n.maxAzimuthAngle;isFinite(vt)&&isFinite(Ot)&&(vt<-Math.PI?vt+=yt:vt>Math.PI&&(vt-=yt),Ot<-Math.PI?Ot+=yt:Ot>Math.PI&&(Ot-=yt),vt<=Ot?m.theta=Math.max(vt,Math.min(Ot,m.theta)):m.theta=m.theta>(vt+Ot)/2?Math.max(vt,m.theta):Math.min(Ot,m.theta)),m.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,m.phi)),m.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(x,n.dampingFactor):n.target.add(x),n.zoomToCursor&&I||n.object.isOrthographicCamera?m.radius=Me(m.radius):m.radius=Me(m.radius*v),re.setFromSpherical(m),re.applyQuaternion(oe),ke.copy(n.target).add(re),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(y.theta*=1-n.dampingFactor,y.phi*=1-n.dampingFactor,x.multiplyScalar(1-n.dampingFactor)):(y.set(0,0,0),x.set(0,0,0));let cn=!1;if(n.zoomToCursor&&I){let Zt=null;if(n.object instanceof Hi&&n.object.isPerspectiveCamera){const Gi=re.length();Zt=Me(Gi*v);const _n=Gi-Zt;n.object.position.addScaledVector(F,_n),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Gi=new $(U.x,U.y,0);Gi.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix(),cn=!0;const _n=new $(U.x,U.y,0);_n.unproject(n.object),n.object.position.sub(_n).add(Gi),n.object.updateMatrixWorld(),Zt=re.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Zt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Zt).add(n.object.position):(bA.origin.copy(n.object.position),bA.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(bA.direction))<kK?e.lookAt(n.target):(SI.setFromNormalAndCoplanarPoint(n.object.up,n.target),bA.intersectPlane(SI,n.target))))}else n.object instanceof Tl&&n.object.isOrthographicCamera&&(cn=v!==1,cn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix()));return v=1,I=!1,cn||Ke.distanceToSquared(n.object.position)>p||8*(1-nt.dot(n.object.quaternion))>p?(n.dispatchEvent(s),Ke.copy(n.object.position),nt.copy(n.object.quaternion),cn=!1,!0):!1}})(),this.connect=re=>{n.domElement=re,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",wt),n.domElement.addEventListener("pointerdown",Gt),n.domElement.addEventListener("pointercancel",X),n.domElement.addEventListener("wheel",Ue)},this.dispose=()=>{var re,Te,rt,oe,Ke,nt;n.domElement&&(n.domElement.style.touchAction="auto"),(re=n.domElement)==null||re.removeEventListener("contextmenu",wt),(Te=n.domElement)==null||Te.removeEventListener("pointerdown",Gt),(rt=n.domElement)==null||rt.removeEventListener("pointercancel",X),(oe=n.domElement)==null||oe.removeEventListener("wheel",Ue),(Ke=n.domElement)==null||Ke.ownerDocument.removeEventListener("pointermove",te),(nt=n.domElement)==null||nt.ownerDocument.removeEventListener("pointerup",X),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Le)};const n=this,s={type:"change"},r={type:"start"},o={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=c.NONE;const p=1e-6,m=new EM,y=new EM;let v=1;const x=new $,b=new Xe,R=new Xe,M=new Xe,T=new Xe,D=new Xe,B=new Xe,L=new Xe,G=new Xe,H=new Xe,F=new $,U=new Xe;let I=!1;const N=[],z={};function W(){return 2*Math.PI/60/60*n.autoRotateSpeed}function k(){return Math.pow(.95,n.zoomSpeed)}function he(re){n.reverseOrbit||n.reverseHorizontalOrbit?y.theta+=re:y.theta-=re}function me(re){n.reverseOrbit||n.reverseVerticalOrbit?y.phi+=re:y.phi-=re}const q=(()=>{const re=new $;return function(rt,oe){re.setFromMatrixColumn(oe,0),re.multiplyScalar(-rt),x.add(re)}})(),ee=(()=>{const re=new $;return function(rt,oe){n.screenSpacePanning===!0?re.setFromMatrixColumn(oe,1):(re.setFromMatrixColumn(oe,0),re.crossVectors(n.object.up,re)),re.multiplyScalar(rt),x.add(re)}})(),ne=(()=>{const re=new $;return function(rt,oe){const Ke=n.domElement;if(Ke&&n.object instanceof Hi&&n.object.isPerspectiveCamera){const nt=n.object.position;re.copy(nt).sub(n.target);let yt=re.length();yt*=Math.tan(n.object.fov/2*Math.PI/180),q(2*rt*yt/Ke.clientHeight,n.object.matrix),ee(2*oe*yt/Ke.clientHeight,n.object.matrix)}else Ke&&n.object instanceof Tl&&n.object.isOrthographicCamera?(q(rt*(n.object.right-n.object.left)/n.object.zoom/Ke.clientWidth,n.object.matrix),ee(oe*(n.object.top-n.object.bottom)/n.object.zoom/Ke.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ye(re){n.object instanceof Hi&&n.object.isPerspectiveCamera||n.object instanceof Tl&&n.object.isOrthographicCamera?v=re:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function K(re){ye(v/re)}function ce(re){ye(v*re)}function Ee(re){if(!n.zoomToCursor||!n.domElement)return;I=!0;const Te=n.domElement.getBoundingClientRect(),rt=re.clientX-Te.left,oe=re.clientY-Te.top,Ke=Te.width,nt=Te.height;U.x=rt/Ke*2-1,U.y=-(oe/nt)*2+1,F.set(U.x,U.y,1).unproject(n.object).sub(n.object.position).normalize()}function Me(re){return Math.max(n.minDistance,Math.min(n.maxDistance,re))}function Ve(re){b.set(re.clientX,re.clientY)}function ge(re){Ee(re),L.set(re.clientX,re.clientY)}function ze(re){T.set(re.clientX,re.clientY)}function Je(re){R.set(re.clientX,re.clientY),M.subVectors(R,b).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(he(2*Math.PI*M.x/Te.clientHeight),me(2*Math.PI*M.y/Te.clientHeight)),b.copy(R),n.update()}function lt(re){G.set(re.clientX,re.clientY),H.subVectors(G,L),H.y>0?K(k()):H.y<0&&ce(k()),L.copy(G),n.update()}function At(re){D.set(re.clientX,re.clientY),B.subVectors(D,T).multiplyScalar(n.panSpeed),ne(B.x,B.y),T.copy(D),n.update()}function Et(re){Ee(re),re.deltaY<0?ce(k()):re.deltaY>0&&K(k()),n.update()}function Nt(re){let Te=!1;switch(re.code){case n.keys.UP:ne(0,n.keyPanSpeed),Te=!0;break;case n.keys.BOTTOM:ne(0,-n.keyPanSpeed),Te=!0;break;case n.keys.LEFT:ne(n.keyPanSpeed,0),Te=!0;break;case n.keys.RIGHT:ne(-n.keyPanSpeed,0),Te=!0;break}Te&&(re.preventDefault(),n.update())}function It(){if(N.length==1)b.set(N[0].pageX,N[0].pageY);else{const re=.5*(N[0].pageX+N[1].pageX),Te=.5*(N[0].pageY+N[1].pageY);b.set(re,Te)}}function se(){if(N.length==1)T.set(N[0].pageX,N[0].pageY);else{const re=.5*(N[0].pageX+N[1].pageX),Te=.5*(N[0].pageY+N[1].pageY);T.set(re,Te)}}function Ge(){const re=N[0].pageX-N[1].pageX,Te=N[0].pageY-N[1].pageY,rt=Math.sqrt(re*re+Te*Te);L.set(0,rt)}function He(){n.enableZoom&&Ge(),n.enablePan&&se()}function tt(){n.enableZoom&&Ge(),n.enableRotate&&It()}function Fe(re){if(N.length==1)R.set(re.pageX,re.pageY);else{const rt=Dt(re),oe=.5*(re.pageX+rt.x),Ke=.5*(re.pageY+rt.y);R.set(oe,Ke)}M.subVectors(R,b).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(he(2*Math.PI*M.x/Te.clientHeight),me(2*Math.PI*M.y/Te.clientHeight)),b.copy(R)}function ut(re){if(N.length==1)D.set(re.pageX,re.pageY);else{const Te=Dt(re),rt=.5*(re.pageX+Te.x),oe=.5*(re.pageY+Te.y);D.set(rt,oe)}B.subVectors(D,T).multiplyScalar(n.panSpeed),ne(B.x,B.y),T.copy(D)}function Qe(re){const Te=Dt(re),rt=re.pageX-Te.x,oe=re.pageY-Te.y,Ke=Math.sqrt(rt*rt+oe*oe);G.set(0,Ke),H.set(0,Math.pow(G.y/L.y,n.zoomSpeed)),K(H.y),L.copy(G)}function st(re){n.enableZoom&&Qe(re),n.enablePan&&ut(re)}function Ft(re){n.enableZoom&&Qe(re),n.enableRotate&&Fe(re)}function Gt(re){var Te,rt;n.enabled!==!1&&(N.length===0&&((Te=n.domElement)==null||Te.ownerDocument.addEventListener("pointermove",te),(rt=n.domElement)==null||rt.ownerDocument.addEventListener("pointerup",X)),Mt(re),re.pointerType==="touch"?_t(re):xe(re))}function te(re){n.enabled!==!1&&(re.pointerType==="touch"?ht(re):Re(re))}function X(re){var Te,rt,oe;et(re),N.length===0&&((Te=n.domElement)==null||Te.releasePointerCapture(re.pointerId),(rt=n.domElement)==null||rt.ownerDocument.removeEventListener("pointermove",te),(oe=n.domElement)==null||oe.ownerDocument.removeEventListener("pointerup",X)),n.dispatchEvent(o),f=c.NONE}function xe(re){let Te;switch(re.button){case 0:Te=n.mouseButtons.LEFT;break;case 1:Te=n.mouseButtons.MIDDLE;break;case 2:Te=n.mouseButtons.RIGHT;break;default:Te=-1}switch(Te){case bd.DOLLY:if(n.enableZoom===!1)return;ge(re),f=c.DOLLY;break;case bd.ROTATE:if(re.ctrlKey||re.metaKey||re.shiftKey){if(n.enablePan===!1)return;ze(re),f=c.PAN}else{if(n.enableRotate===!1)return;Ve(re),f=c.ROTATE}break;case bd.PAN:if(re.ctrlKey||re.metaKey||re.shiftKey){if(n.enableRotate===!1)return;Ve(re),f=c.ROTATE}else{if(n.enablePan===!1)return;ze(re),f=c.PAN}break;default:f=c.NONE}f!==c.NONE&&n.dispatchEvent(r)}function Re(re){if(n.enabled!==!1)switch(f){case c.ROTATE:if(n.enableRotate===!1)return;Je(re);break;case c.DOLLY:if(n.enableZoom===!1)return;lt(re);break;case c.PAN:if(n.enablePan===!1)return;At(re);break}}function Ue(re){n.enabled===!1||n.enableZoom===!1||f!==c.NONE&&f!==c.ROTATE||(re.preventDefault(),n.dispatchEvent(r),Et(re),n.dispatchEvent(o))}function Le(re){n.enabled===!1||n.enablePan===!1||Nt(re)}function _t(re){switch(ft(re),N.length){case 1:switch(n.touches.ONE){case Td.ROTATE:if(n.enableRotate===!1)return;It(),f=c.TOUCH_ROTATE;break;case Td.PAN:if(n.enablePan===!1)return;se(),f=c.TOUCH_PAN;break;default:f=c.NONE}break;case 2:switch(n.touches.TWO){case Td.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;He(),f=c.TOUCH_DOLLY_PAN;break;case Td.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;tt(),f=c.TOUCH_DOLLY_ROTATE;break;default:f=c.NONE}break;default:f=c.NONE}f!==c.NONE&&n.dispatchEvent(r)}function ht(re){switch(ft(re),f){case c.TOUCH_ROTATE:if(n.enableRotate===!1)return;Fe(re),n.update();break;case c.TOUCH_PAN:if(n.enablePan===!1)return;ut(re),n.update();break;case c.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;st(re),n.update();break;case c.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ft(re),n.update();break;default:f=c.NONE}}function wt(re){n.enabled!==!1&&re.preventDefault()}function Mt(re){N.push(re)}function et(re){delete z[re.pointerId];for(let Te=0;Te<N.length;Te++)if(N[Te].pointerId==re.pointerId){N.splice(Te,1);return}}function ft(re){let Te=z[re.pointerId];Te===void 0&&(Te=new Xe,z[re.pointerId]=Te),Te.set(re.pageX,re.pageY)}function Dt(re){const Te=re.pointerId===N[0].pointerId?N[1]:N[0];return z[Te.pointerId]}this.dollyIn=(re=k())=>{ce(re),n.update()},this.dollyOut=(re=k())=>{K(re),n.update()},this.getScale=()=>v,this.setScale=re=>{ye(re),n.update()},this.getZoomScale=()=>k(),t!==void 0&&this.connect(t),this.update()}};function rS(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Pd="srgb",Iu="srgb-linear",bI=3001,jK=3e3;class zC extends Fr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new KK(t)}),this.register(function(t){return new JK(t)}),this.register(function(t){return new rJ(t)}),this.register(function(t){return new aJ(t)}),this.register(function(t){return new oJ(t)}),this.register(function(t){return new ZK(t)}),this.register(function(t){return new $K(t)}),this.register(function(t){return new eJ(t)}),this.register(function(t){return new tJ(t)}),this.register(function(t){return new YK(t)}),this.register(function(t){return new nJ(t)}),this.register(function(t){return new QK(t)}),this.register(function(t){return new sJ(t)}),this.register(function(t){return new iJ(t)}),this.register(function(t){return new XK(t)}),this.register(function(t){return new lJ(t)}),this.register(function(t){return new cJ(t)})}load(e,t,n,s){const r=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const p=tf.extractUrlBase(e);o=tf.resolveURL(p,this.path)}else o=tf.extractUrlBase(e);this.manager.itemStart(e);const c=function(p){s?s(p):console.error(p),r.manager.itemError(e),r.manager.itemEnd(e)},f=new fo(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(p){try{r.parse(p,o,function(m){t(m),r.manager.itemEnd(e)},c)}catch(m){c(m)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let r;const o={},c={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(rS(new Uint8Array(e.slice(0,4)))===XU){try{o[Ln.KHR_BINARY_GLTF]=new uJ(e)}catch(m){s&&s(m);return}r=JSON.parse(o[Ln.KHR_BINARY_GLTF].content)}else r=JSON.parse(rS(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const f=new EJ(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const m=this.pluginCallbacks[p](f);m.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[m.name]=m,o[m.name]=!0}if(r.extensionsUsed)for(let p=0;p<r.extensionsUsed.length;++p){const m=r.extensionsUsed[p],y=r.extensionsRequired||[];switch(m){case Ln.KHR_MATERIALS_UNLIT:o[m]=new WK;break;case Ln.KHR_DRACO_MESH_COMPRESSION:o[m]=new hJ(r,this.dracoLoader);break;case Ln.KHR_TEXTURE_TRANSFORM:o[m]=new fJ;break;case Ln.KHR_MESH_QUANTIZATION:o[m]=new dJ;break;default:y.indexOf(m)>=0&&c[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}f.setExtensions(o),f.setPlugins(c),f.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,r){n.parse(e,t,s,r)})}}function qK(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Ln={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class XK{constructor(e){this.parser=e,this.name=Ln.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const r=t.json,f=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let p;const m=new St(16777215);f.color!==void 0&&m.setRGB(f.color[0],f.color[1],f.color[2],Iu);const y=f.range!==void 0?f.range:0;switch(f.type){case"directional":p=new MC(m),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new TC(m),p.distance=y;break;case"spot":p=new bC(m),p.distance=y,f.spot=f.spot||{},f.spot.innerConeAngle=f.spot.innerConeAngle!==void 0?f.spot.innerConeAngle:0,f.spot.outerConeAngle=f.spot.outerConeAngle!==void 0?f.spot.outerConeAngle:Math.PI/4,p.angle=f.spot.outerConeAngle,p.penumbra=1-f.spot.innerConeAngle/f.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+f.type)}return p.position.set(0,0,0),p.decay=2,vu(p,f),f.intensity!==void 0&&(p.intensity=f.intensity),p.name=t.createUniqueName(f.name||"light_"+e),s=Promise.resolve(p),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(f){return n._getNodeRef(t.cache,c,f)})}}class WK{constructor(){this.name=Ln.KHR_MATERIALS_UNLIT}getMaterialType(){return co}extendParams(e,t,n){const s=[];e.color=new St(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Iu),e.opacity=o[3]}r.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",r.baseColorTexture,Pd))}return Promise.all(s)}}class YK{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class KK{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const c=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Xe(c,c)}return Promise.all(r)}}class JK{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class QK{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(r)}}class ZK{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new St(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=s.extensions[this.name];if(o.sheenColorFactor!==void 0){const c=o.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],Iu)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Pd)),o.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class $K{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class eJ{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const c=o.attenuationColor||[1,1,1];return t.attenuationColor=new St().setRGB(c[0],c[1],c[2],Iu),Promise.all(r)}}class tJ{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class nJ{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const c=o.specularColorFactor||[1,1,1];return t.specularColor=new St().setRGB(c[0],c[1],c[2],Iu),o.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Pd)),Promise.all(r)}}class iJ{constructor(e){this.parser=e,this.name=Ln.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(r)}}class sJ{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Go}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(r)}}class rJ{constructor(e){this.parser=e,this.name=Ln.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,o)}}class aJ{constructor(e){this.parser=e,this.name=Ln.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],c=s.images[o.source];let f=n.textureLoader;if(c.uri){const p=n.options.manager.getHandler(c.uri);p!==null&&(f=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o.source,f);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class oJ{constructor(e){this.parser=e,this.name=Ln.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],c=s.images[o.source];let f=n.textureLoader;if(c.uri){const p=n.options.manager.getHandler(c.uri);p!==null&&(f=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o.source,f);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class lJ{constructor(e){this.name=Ln.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const f=s.byteOffset||0,p=s.byteLength||0,m=s.count,y=s.byteStride,v=new Uint8Array(c,f,p);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(m,y,v,s.mode,s.filter).then(function(x){return x.buffer}):o.ready.then(function(){const x=new ArrayBuffer(m*y);return o.decodeGltfBuffer(new Uint8Array(x),m,y,v,s.mode,s.filter),x})})}else return null}}class cJ{constructor(e){this.name=Ln.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const p of s.primitives)if(p.mode!==Uo.TRIANGLES&&p.mode!==Uo.TRIANGLE_STRIP&&p.mode!==Uo.TRIANGLE_FAN&&p.mode!==void 0)return null;const o=n.extensions[this.name].attributes,c=[],f={};for(const p in o)c.push(this.parser.getDependency("accessor",o[p]).then(m=>(f[p]=m,f[p])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(p=>{const m=p.pop(),y=m.isGroup?m.children:[m],v=p[0].count,x=[];for(const b of y){const R=new Jt,M=new $,T=new Zs,D=new $(1,1,1),B=new oC(b.geometry,b.material,v);for(let L=0;L<v;L++)f.TRANSLATION&&M.fromBufferAttribute(f.TRANSLATION,L),f.ROTATION&&T.fromBufferAttribute(f.ROTATION,L),f.SCALE&&D.fromBufferAttribute(f.SCALE,L),B.setMatrixAt(L,R.compose(M,T,D));for(const L in f)if(L==="_COLOR_0"){const G=f[L];B.instanceColor=new Qd(G.array,G.itemSize,G.normalized)}else L!=="TRANSLATION"&&L!=="ROTATION"&&L!=="SCALE"&&b.geometry.setAttribute(L,f[L]);jn.prototype.copy.call(B,b),this.parser.assignFinalMaterial(B),x.push(B)}return m.isGroup?(m.clear(),m.add(...x),m):x[0]}))}}const XU="glTF",qy=12,TI={JSON:1313821514,BIN:5130562};class uJ{constructor(e){this.name=Ln.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,qy);if(this.header={magic:rS(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==XU)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-qy,s=new DataView(e,qy);let r=0;for(;r<n;){const o=s.getUint32(r,!0);r+=4;const c=s.getUint32(r,!0);if(r+=4,c===TI.JSON){const f=new Uint8Array(e,qy+r,o);this.content=rS(f)}else if(c===TI.BIN){const f=qy+r;this.body=e.slice(f,f+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class hJ{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ln.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,c={},f={},p={};for(const m in o){const y=OM[m]||m.toLowerCase();c[y]=o[m]}for(const m in e.attributes){const y=OM[m]||m.toLowerCase();if(o[m]!==void 0){const v=n.accessors[e.attributes[m]],x=Gm[v.componentType];p[y]=x.name,f[y]=v.normalized===!0}}return t.getDependency("bufferView",r).then(function(m){return new Promise(function(y,v){s.decodeDracoFile(m,function(x){for(const b in x.attributes){const R=x.attributes[b],M=f[b];M!==void 0&&(R.normalized=M)}y(x)},c,p,Iu,v)})})}}class fJ{constructor(){this.name=Ln.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class dJ{constructor(){this.name=Ln.KHR_MESH_QUANTIZATION}}class WU extends Mg{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let o=0;o!==s;o++)t[o]=n[r+o];return t}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,f=c*2,p=c*3,m=s-t,y=(n-t)/m,v=y*y,x=v*y,b=e*p,R=b-p,M=-2*x+3*v,T=x-v,D=1-M,B=T-v+y;for(let L=0;L!==c;L++){const G=o[R+L+c],H=o[R+L+f]*m,F=o[b+L+c],U=o[b+L]*m;r[L]=D*G+B*H+M*F+T*U}return r}}const pJ=new Zs;class mJ extends WU{interpolate_(e,t,n,s){const r=super.interpolate_(e,t,n,s);return pJ.fromArray(r).normalize().toArray(r),r}}const Uo={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Gm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},MI={9728:Qs,9729:_s,9984:FS,9985:Vm,9986:Bd,9987:zo},CI={33071:oo,33648:$m,10497:hf},CT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},OM={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...LK>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Hh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},gJ={CUBICSPLINE:void 0,LINEAR:rg,STEP:sg},RT={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function yJ(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new ov({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ic})),i.DefaultMaterial}function Sd(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function vu(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function _J(i,e,t){let n=!1,s=!1,r=!1;for(let p=0,m=e.length;p<m;p++){const y=e[p];if(y.POSITION!==void 0&&(n=!0),y.NORMAL!==void 0&&(s=!0),y.COLOR_0!==void 0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(i);const o=[],c=[],f=[];for(let p=0,m=e.length;p<m;p++){const y=e[p];if(n){const v=y.POSITION!==void 0?t.getDependency("accessor",y.POSITION):i.attributes.position;o.push(v)}if(s){const v=y.NORMAL!==void 0?t.getDependency("accessor",y.NORMAL):i.attributes.normal;c.push(v)}if(r){const v=y.COLOR_0!==void 0?t.getDependency("accessor",y.COLOR_0):i.attributes.color;f.push(v)}}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(f)]).then(function(p){const m=p[0],y=p[1],v=p[2];return n&&(i.morphAttributes.position=m),s&&(i.morphAttributes.normal=y),r&&(i.morphAttributes.color=v),i.morphTargetsRelative=!0,i})}function vJ(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function AJ(i){let e;const t=i.extensions&&i.extensions[Ln.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+wT(t.attributes):e=i.indices+":"+wT(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,s=i.targets.length;n<s;n++)e+=":"+wT(i.targets[n]);return e}function wT(i){let e="";const t=Object.keys(i).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+i[t[n]]+";";return e}function LM(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function xJ(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const SJ=new Jt;class EJ{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new qK,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&r<98?this.textureLoader=new eU(this.options.manager):this.textureLoader=new lU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new fo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const c={scene:o[0][s.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:s.asset,parser:n,userData:{}};return Sd(r,c,s),vu(c,s),Promise.all(n._invokeAll(function(f){return f.afterRoot&&f.afterRoot(c)})).then(function(){for(const f of c.scenes)f.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const o=t[s].joints;for(let c=0,f=o.length;c<f;c++)e[o[c]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const o=e[s];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),r=(o,c)=>{const f=this.associations.get(o);f!=null&&this.associations.set(c,f);for(const[p,m]of o.children.entries())r(m,c.children[p])};return r(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ln.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,o){n.load(tf.resolveURL(t.uri,s.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const o=CT[s.type],c=Gm[s.componentType],f=s.normalized===!0,p=new c(s.count*o);return Promise.resolve(new Zn(p,o,f))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(o){const c=o[0],f=CT[s.type],p=Gm[s.componentType],m=p.BYTES_PER_ELEMENT,y=m*f,v=s.byteOffset||0,x=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,b=s.normalized===!0;let R,M;if(x&&x!==y){const T=Math.floor(v/x),D="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+T+":"+s.count;let B=t.cache.get(D);B||(R=new p(c,T*x,s.count*x/m),B=new tv(R,x/m),t.cache.add(D,B)),M=new df(B,f,v%x/m,b)}else c===null?R=new p(s.count*f):R=new p(c,v,s.count*f),M=new Zn(R,f,b);if(s.sparse!==void 0){const T=CT.SCALAR,D=Gm[s.sparse.indices.componentType],B=s.sparse.indices.byteOffset||0,L=s.sparse.values.byteOffset||0,G=new D(o[1],B,s.sparse.count*T),H=new p(o[2],L,s.sparse.count*f);c!==null&&(M=new Zn(M.array.slice(),M.itemSize,M.normalized));for(let F=0,U=G.length;F<U;F++){const I=G[F];if(M.setX(I,H[F*f]),f>=2&&M.setY(I,H[F*f+1]),f>=3&&M.setZ(I,H[F*f+2]),f>=4&&M.setW(I,H[F*f+3]),f>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,o=t.images[r];let c=this.textureLoader;if(o.uri){const f=n.manager.getHandler(o.uri);f!==null&&(c=f)}return this.loadTextureImage(e,r,c)}loadTextureImage(e,t,n){const s=this,r=this.json,o=r.textures[e],c=r.images[t],f=(c.uri||c.bufferView)+":"+o.sampler;if(this.textureCache[f])return this.textureCache[f];const p=this.loadImageSource(t,n).then(function(m){m.flipY=!1,m.name=o.name||c.name||"",m.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(m.name=c.uri);const v=(r.samplers||{})[o.sampler]||{};return m.magFilter=MI[v.magFilter]||_s,m.minFilter=MI[v.minFilter]||zo,m.wrapS=CI[v.wrapS]||hf,m.wrapT=CI[v.wrapT]||hf,s.associations.set(m,{textures:e}),m}).catch(function(){return null});return this.textureCache[f]=p,p}loadImageSource(e,t){const n=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(y=>y.clone());const o=s.images[e],c=self.URL||self.webkitURL;let f=o.uri||"",p=!1;if(o.bufferView!==void 0)f=n.getDependency("bufferView",o.bufferView).then(function(y){p=!0;const v=new Blob([y],{type:o.mimeType});return f=c.createObjectURL(v),f});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const m=Promise.resolve(f).then(function(y){return new Promise(function(v,x){let b=v;t.isImageBitmapLoader===!0&&(b=function(R){const M=new ki(R);M.needsUpdate=!0,v(M)}),t.load(tf.resolveURL(y,r.path),b,void 0,x)})}).then(function(y){return p===!0&&c.revokeObjectURL(f),vu(y,o),y.userData.mimeType=o.mimeType||xJ(o.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",f),y});return this.sourceCache[e]=m,m}assignTexture(e,t,n,s){const r=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),r.extensions[Ln.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[Ln.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const f=r.associations.get(o);o=r.extensions[Ln.KHR_TEXTURE_TRANSFORM].extendTexture(o,c),r.associations.set(o,f)}}return s!==void 0&&(typeof s=="number"&&(s=s===bI?Pd:Iu),"colorSpace"in o?o.colorSpace=s:o.encoding=s===Pd?bI:jK),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let f=this.cache.get(c);f||(f=new $S,Vs.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,f.sizeAttenuation=!1,this.cache.add(c,f)),n=f}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let f=this.cache.get(c);f||(f=new Pr,Vs.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,this.cache.add(c,f)),n=f}if(s||r||o){let c="ClonedMaterial:"+n.uuid+":";s&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),o&&(c+="flat-shading:");let f=this.cache.get(c);f||(f=n.clone(),r&&(f.vertexColors=!0),o&&(f.flatShading=!0),s&&(f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(c,f),this.associations.set(f,this.associations.get(n))),n=f}e.material=n}getMaterialType(){return ov}loadMaterial(e){const t=this,n=this.json,s=this.extensions,r=n.materials[e];let o;const c={},f=r.extensions||{},p=[];if(f[Ln.KHR_MATERIALS_UNLIT]){const y=s[Ln.KHR_MATERIALS_UNLIT];o=y.getMaterialType(),p.push(y.extendParams(c,r,t))}else{const y=r.pbrMetallicRoughness||{};if(c.color=new St(1,1,1),c.opacity=1,Array.isArray(y.baseColorFactor)){const v=y.baseColorFactor;c.color.setRGB(v[0],v[1],v[2],Iu),c.opacity=v[3]}y.baseColorTexture!==void 0&&p.push(t.assignTexture(c,"map",y.baseColorTexture,Pd)),c.metalness=y.metallicFactor!==void 0?y.metallicFactor:1,c.roughness=y.roughnessFactor!==void 0?y.roughnessFactor:1,y.metallicRoughnessTexture!==void 0&&(p.push(t.assignTexture(c,"metalnessMap",y.metallicRoughnessTexture)),p.push(t.assignTexture(c,"roughnessMap",y.metallicRoughnessTexture))),o=this._invokeOne(function(v){return v.getMaterialType&&v.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(v){return v.extendMaterialParams&&v.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=Fo);const m=r.alphaMode||RT.OPAQUE;if(m===RT.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,m===RT.MASK&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&o!==co&&(p.push(t.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new Xe(1,1),r.normalTexture.scale!==void 0)){const y=r.normalTexture.scale;c.normalScale.set(y,y)}if(r.occlusionTexture!==void 0&&o!==co&&(p.push(t.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&o!==co){const y=r.emissiveFactor;c.emissive=new St().setRGB(y[0],y[1],y[2],Iu)}return r.emissiveTexture!==void 0&&o!==co&&p.push(t.assignTexture(c,"emissiveMap",r.emissiveTexture,Pd)),Promise.all(p).then(function(){const y=new o(c);return r.name&&(y.name=r.name),vu(y,r),t.associations.set(y,{materials:e}),r.extensions&&Sd(s,y,r),y})}createUniqueName(e){const t=Yn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function r(c){return n[Ln.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(f){return RI(f,c,t)})}const o=[];for(let c=0,f=e.length;c<f;c++){const p=e[c],m=AJ(p),y=s[m];if(y)o.push(y.promise);else{let v;p.extensions&&p.extensions[Ln.KHR_DRACO_MESH_COMPRESSION]?v=r(p):v=RI(new yn,p,t),s[m]={primitive:p,promise:v},o.push(v)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,s=this.extensions,r=n.meshes[e],o=r.primitives,c=[];for(let f=0,p=o.length;f<p;f++){const m=o[f].material===void 0?yJ(this.cache):this.getDependency("material",o[f].material);c.push(m)}return c.push(t.loadGeometries(o)),Promise.all(c).then(function(f){const p=f.slice(0,f.length-1),m=f[f.length-1],y=[];for(let x=0,b=m.length;x<b;x++){const R=m[x],M=o[x];let T;const D=p[x];if(M.mode===Uo.TRIANGLES||M.mode===Uo.TRIANGLE_STRIP||M.mode===Uo.TRIANGLE_FAN||M.mode===void 0)T=r.isSkinnedMesh===!0?new aC(R,D):new vs(R,D),T.isSkinnedMesh===!0&&T.normalizeSkinWeights(),M.mode===Uo.TRIANGLE_STRIP?T.geometry=xI(T.geometry,Z1):M.mode===Uo.TRIANGLE_FAN&&(T.geometry=xI(T.geometry,Jx));else if(M.mode===Uo.LINES)T=new Rl(R,D);else if(M.mode===Uo.LINE_STRIP)T=new Vu(R,D);else if(M.mode===Uo.LINE_LOOP)T=new lC(R,D);else if(M.mode===Uo.POINTS)T=new cC(R,D);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(T.geometry.morphAttributes).length>0&&vJ(T,r),T.name=t.createUniqueName(r.name||"mesh_"+e),vu(T,r),M.extensions&&Sd(s,T,M),t.assignFinalMaterial(T),y.push(T)}for(let x=0,b=y.length;x<b;x++)t.associations.set(y[x],{meshes:e,primitives:x});if(y.length===1)return r.extensions&&Sd(s,y[0],r),y[0];const v=new Cu;r.extensions&&Sd(s,v,r),t.associations.set(v,{meshes:e});for(let x=0,b=y.length;x<b;x++)v.add(y[x]);return v})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Hi(mL.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new Tl(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),vu(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,r=t.joints.length;s<r;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const r=s.pop(),o=s,c=[],f=[];for(let p=0,m=o.length;p<m;p++){const y=o[p];if(y){c.push(y);const v=new Jt;r!==null&&v.fromArray(r.array,p*16),f.push(v)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new nv(c,f)})}loadAnimation(e){const t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,o=[],c=[],f=[],p=[],m=[];for(let y=0,v=s.channels.length;y<v;y++){const x=s.channels[y],b=s.samplers[x.sampler],R=x.target,M=R.node,T=s.parameters!==void 0?s.parameters[b.input]:b.input,D=s.parameters!==void 0?s.parameters[b.output]:b.output;R.node!==void 0&&(o.push(this.getDependency("node",M)),c.push(this.getDependency("accessor",T)),f.push(this.getDependency("accessor",D)),p.push(b),m.push(R))}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(f),Promise.all(p),Promise.all(m)]).then(function(y){const v=y[0],x=y[1],b=y[2],R=y[3],M=y[4],T=[];for(let D=0,B=v.length;D<B;D++){const L=v[D],G=x[D],H=b[D],F=R[D],U=M[D];if(L===void 0)continue;L.updateMatrix&&L.updateMatrix();const I=n._createAnimationTracks(L,G,H,F,U);if(I)for(let N=0;N<I.length;N++)T.push(I[N])}return new hg(r,void 0,T)})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(r){const o=n._getNodeRef(n.meshCache,s.mesh,r);return s.weights!==void 0&&o.traverse(function(c){if(c.isMesh)for(let f=0,p=s.weights.length;f<p;f++)c.morphTargetInfluences[f]=s.weights[f]}),o})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],r=n._loadNodeShallow(e),o=[],c=s.children||[];for(let p=0,m=c.length;p<m;p++)o.push(n.getDependency("node",c[p]));const f=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([r,Promise.all(o),f]).then(function(p){const m=p[0],y=p[1],v=p[2];v!==null&&m.traverse(function(x){x.isSkinnedMesh&&x.bind(v,SJ)});for(let x=0,b=y.length;x<b;x++)m.add(y[x]);return m})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],o=r.name?s.createUniqueName(r.name):"",c=[],f=s._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return f&&c.push(f),r.camera!==void 0&&c.push(s.getDependency("camera",r.camera).then(function(p){return s._getNodeRef(s.cameraCache,r.camera,p)})),s._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){c.push(p)}),this.nodeCache[e]=Promise.all(c).then(function(p){let m;if(r.isBone===!0?m=new QS:p.length>1?m=new Cu:p.length===1?m=p[0]:m=new jn,m!==p[0])for(let y=0,v=p.length;y<v;y++)m.add(p[y]);if(r.name&&(m.userData.name=r.name,m.name=o),vu(m,r),r.extensions&&Sd(n,m,r),r.matrix!==void 0){const y=new Jt;y.fromArray(r.matrix),m.applyMatrix4(y)}else r.translation!==void 0&&m.position.fromArray(r.translation),r.rotation!==void 0&&m.quaternion.fromArray(r.rotation),r.scale!==void 0&&m.scale.fromArray(r.scale);return s.associations.has(m)||s.associations.set(m,{}),s.associations.get(m).nodes=e,m}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,r=new Cu;n.name&&(r.name=s.createUniqueName(n.name)),vu(r,n),n.extensions&&Sd(t,r,n);const o=n.nodes||[],c=[];for(let f=0,p=o.length;f<p;f++)c.push(s.getDependency("node",o[f]));return Promise.all(c).then(function(f){for(let m=0,y=f.length;m<y;m++)r.add(f[m]);const p=m=>{const y=new Map;for(const[v,x]of s.associations)(v instanceof Vs||v instanceof ki)&&y.set(v,x);return m.traverse(v=>{const x=s.associations.get(v);x!=null&&y.set(v,x)}),y};return s.associations=p(r),r})}_createAnimationTracks(e,t,n,s,r){const o=[],c=e.name?e.name:e.uuid,f=[];Hh[r.path]===Hh.weights?e.traverse(function(v){v.morphTargetInfluences&&f.push(v.name?v.name:v.uuid)}):f.push(c);let p;switch(Hh[r.path]){case Hh.weights:p=$d;break;case Hh.rotation:p=ep;break;case Hh.position:case Hh.scale:p=tp;break;default:switch(n.itemSize){case 1:p=$d;break;case 2:case 3:default:p=tp;break}break}const m=s.interpolation!==void 0?gJ[s.interpolation]:rg,y=this._getArrayFromAccessor(n);for(let v=0,x=f.length;v<x;v++){const b=new p(f[v]+"."+Hh[r.path],t.array,y,m);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(b),o.push(b)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=LM(t.constructor),s=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)s[r]=t[r]*n;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const s=this instanceof ep?mJ:WU;return new s(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function bJ(i,e,t){const n=e.attributes,s=new $s;if(n.POSITION!==void 0){const c=t.json.accessors[n.POSITION],f=c.min,p=c.max;if(f!==void 0&&p!==void 0){if(s.set(new $(f[0],f[1],f[2]),new $(p[0],p[1],p[2])),c.normalized){const m=LM(Gm[c.componentType]);s.min.multiplyScalar(m),s.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const c=new $,f=new $;for(let p=0,m=r.length;p<m;p++){const y=r[p];if(y.POSITION!==void 0){const v=t.json.accessors[y.POSITION],x=v.min,b=v.max;if(x!==void 0&&b!==void 0){if(f.setX(Math.max(Math.abs(x[0]),Math.abs(b[0]))),f.setY(Math.max(Math.abs(x[1]),Math.abs(b[1]))),f.setZ(Math.max(Math.abs(x[2]),Math.abs(b[2]))),v.normalized){const R=LM(Gm[v.componentType]);f.multiplyScalar(R)}c.max(f)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}i.boundingBox=s;const o=new zs;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,i.boundingSphere=o}function RI(i,e,t){const n=e.attributes,s=[];function r(o,c){return t.getDependency("accessor",o).then(function(f){i.setAttribute(c,f)})}for(const o in n){const c=OM[o]||o.toLowerCase();c in i.attributes||s.push(r(n[o],c))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(c){i.setIndex(c)});s.push(o)}return vu(i,e),bJ(i,e,t),Promise.all(s).then(function(){return e.targets!==void 0?_J(i,e.targets,t):i})}const DT=new WeakMap;class TJ extends Fr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,s){const r=new fo(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,o=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,c).then(t).catch(s)},n,s)}decodeDracoFile(e,t,n,s){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const f in t.attributeTypes){const p=t.attributeTypes[f];p.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[f]=p.name)}const n=JSON.stringify(t);if(DT.has(e)){const f=DT.get(e);if(f.key===n)return f.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,o=e.byteLength,c=this._getWorker(r,o).then(f=>(s=f,new Promise((p,m)=>{s._callbacks[r]={resolve:p,reject:m},s.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(f=>this._createGeometry(f.geometry));return c.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),DT.set(e,{key:n,promise:c}),c}_createGeometry(e){const t=new yn;e.index&&t.setIndex(new Zn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n],r=s.name,o=s.array,c=s.itemSize;t.setAttribute(r,new Zn(o,c))}return t}_loadLibrary(e,t){const n=new fo(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((s,r)=>{n.load(e,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const s=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=MJ.toString(),o=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const o=r.data;switch(o.type){case"decode":s._callbacks[o.id].resolve(o);break;case"error":s._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function MJ(){let i,e;onmessage=function(o){const c=o.data;switch(c.type){case"init":i=c.decoderConfig,e=new Promise(function(m){i.onModuleLoaded=function(y){m({draco:y})},DracoDecoderModule(i)});break;case"decode":const f=c.buffer,p=c.taskConfig;e.then(m=>{const y=m.draco,v=new y.Decoder,x=new y.DecoderBuffer;x.Init(new Int8Array(f),f.byteLength);try{const b=t(y,v,x,p),R=b.attributes.map(M=>M.array.buffer);b.index&&R.push(b.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:b},R)}catch(b){console.error(b),self.postMessage({type:"error",id:c.id,error:b.message})}finally{y.destroy(x),y.destroy(v)}});break}};function t(o,c,f,p){const m=p.attributeIDs,y=p.attributeTypes;let v,x;const b=c.GetEncodedGeometryType(f);if(b===o.TRIANGULAR_MESH)v=new o.Mesh,x=c.DecodeBufferToMesh(f,v);else if(b===o.POINT_CLOUD)v=new o.PointCloud,x=c.DecodeBufferToPointCloud(f,v);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!x.ok()||v.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+x.error_msg());const R={index:null,attributes:[]};for(const M in m){const T=self[y[M]];let D,B;if(p.useUniqueIDs)B=m[M],D=c.GetAttributeByUniqueId(v,B);else{if(B=c.GetAttributeId(v,o[m[M]]),B===-1)continue;D=c.GetAttribute(v,B)}R.attributes.push(s(o,c,v,M,T,D))}return b===o.TRIANGULAR_MESH&&(R.index=n(o,c,v)),o.destroy(v),R}function n(o,c,f){const m=f.num_faces()*3,y=m*4,v=o._malloc(y);c.GetTrianglesUInt32Array(f,y,v);const x=new Uint32Array(o.HEAPF32.buffer,v,m).slice();return o._free(v),{array:x,itemSize:1}}function s(o,c,f,p,m,y){const v=y.num_components(),b=f.num_points()*v,R=b*m.BYTES_PER_ELEMENT,M=r(o,m),T=o._malloc(R);c.GetAttributeDataArrayForAllPoints(f,y,M,R,T);const D=new m(o.HEAPF32.buffer,T,b).slice();return o._free(T),{name:p,array:D,itemSize:v}}function r(o,c){switch(c){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let TA;const IT=()=>{if(TA)return TA;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=i;WebAssembly.validate(t)&&(s=e);let r;const o=WebAssembly.instantiate(c(s),{}).then(y=>{r=y.instance,r.exports.__wasm_call_ctors()});function c(y){const v=new Uint8Array(y.length);for(let b=0;b<y.length;++b){const R=y.charCodeAt(b);v[b]=R>96?R-71:R>64?R-65:R>47?R+4:R>46?63:62}let x=0;for(let b=0;b<y.length;++b)v[x++]=v[b]<60?n[v[b]]:(v[b]-60)*64+v[++b];return v.buffer.slice(0,x)}function f(y,v,x,b,R,M){const T=r.exports.sbrk,D=x+3&-4,B=T(D*b),L=T(R.length),G=new Uint8Array(r.exports.memory.buffer);G.set(R,L);const H=y(B,x,b,L,R.length);if(H===0&&M&&M(B,D,b),v.set(G.subarray(B,B+x*b)),T(B-T(0)),H!==0)throw new Error(`Malformed buffer data: ${H}`)}const p={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},m={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return TA={ready:o,supported:!0,decodeVertexBuffer(y,v,x,b,R){f(r.exports.meshopt_decodeVertexBuffer,y,v,x,b,r.exports[p[R]])},decodeIndexBuffer(y,v,x,b){f(r.exports.meshopt_decodeIndexBuffer,y,v,x,b)},decodeIndexSequence(y,v,x,b){f(r.exports.meshopt_decodeIndexSequence,y,v,x,b)},decodeGltfBuffer(y,v,x,b,R,M){f(r.exports[m[R]],y,v,x,b,r.exports[p[M]])}},TA};let MA=null,YU="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function KU(i=!0,e=!0,t){return n=>{t&&t(n),i&&(MA||(MA=new TJ),MA.setDecoderPath(typeof i=="string"?i:YU),n.setDRACOLoader(MA)),e&&n.setMeshoptDecoder(typeof IT=="function"?IT():IT)}}const dg=(i,e,t,n)=>cv(zC,i,KU(e,t,n));dg.preload=(i,e,t,n)=>cv.preload(zC,i,KU(e,t,n));dg.clear=i=>cv.clear(zC,i);dg.setDecoderPath=i=>{YU=i};const CJ=ue.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:s=!0,keyEvents:r=!1,onChange:o,onStart:c,onEnd:f,...p},m)=>{const y=_u(H=>H.invalidate),v=_u(H=>H.camera),x=_u(H=>H.gl),b=_u(H=>H.events),R=_u(H=>H.setEvents),M=_u(H=>H.set),T=_u(H=>H.get),D=_u(H=>H.performance),B=e||v,L=n||b.connected||x.domElement,G=ue.useMemo(()=>new GK(B),[B]);return UC(()=>{G.enabled&&G.update()},-1),ue.useEffect(()=>(r&&G.connect(r===!0?L:r),G.connect(L),()=>void G.dispose()),[r,L,t,G,y]),ue.useEffect(()=>{const H=I=>{y(),t&&D.regress(),o&&o(I)},F=I=>{c&&c(I)},U=I=>{f&&f(I)};return G.addEventListener("change",H),G.addEventListener("start",F),G.addEventListener("end",U),()=>{G.removeEventListener("start",F),G.removeEventListener("end",U),G.removeEventListener("change",H)}},[o,c,f,G,y,R]),ue.useEffect(()=>{if(i){const H=T().controls;return M({controls:G}),()=>M({controls:H})}},[i,G]),ue.createElement("primitive",P_({ref:m,object:G,enableDamping:s},p))}),RJ=ue.forwardRef(function({children:e,disable:t,disableX:n,disableY:s,disableZ:r,left:o,right:c,top:f,bottom:p,front:m,back:y,onCentered:v,precise:x=!0,cacheKey:b=0,...R},M){const T=ue.useRef(null),D=ue.useRef(null),B=ue.useRef(null);return ue.useLayoutEffect(()=>{D.current.matrixWorld.identity();const L=new $s().setFromObject(B.current,x),G=new $,H=new zs,F=L.max.x-L.min.x,U=L.max.y-L.min.y,I=L.max.z-L.min.z;L.getCenter(G),L.getBoundingSphere(H);const N=f?U/2:p?-U/2:0,z=o?-F/2:c?F/2:0,W=m?I/2:y?-I/2:0;D.current.position.set(t||n?0:-G.x+z,t||s?0:-G.y+N,t||r?0:-G.z+W),typeof v<"u"&&v({parent:T.current.parent,container:T.current,width:F,height:U,depth:I,boundingBox:L,boundingSphere:H,center:G,verticalAlignment:N,horizontalAlignment:z,depthAlignment:W})},[b,v,f,o,m,t,n,s,r,x,c,p,y]),ue.useImperativeHandle(M,()=>T.current,[]),ue.createElement("group",P_({ref:T},R),ue.createElement("group",{ref:D},ue.createElement("group",{ref:B},e)))}),wJ=({url:i,scale:e=1})=>{const t=ue.useRef(null),{scene:n}=dg(i);return UC((s,r)=>{t.current&&(t.current.rotation.y+=r*.5)}),ie.jsx(RJ,{children:ie.jsx("group",{ref:t,scale:e,children:ie.jsx("primitive",{object:n.clone()})})})},DJ=()=>ie.jsx(qU,{center:!0,children:ie.jsx("div",{style:{color:"#000000",fontFamily:"'Pixelify Sans', monospace",fontSize:"12px",textAlign:"center",background:"#c0c0c0",padding:"8px",border:"2px outset #c0c0c0"},children:"Loading 3D Model..."})}),IJ=({error:i})=>ie.jsx(qU,{center:!0,children:ie.jsxs("div",{style:{color:"#800000",fontFamily:"'Pixelify Sans', monospace",fontSize:"10px",textAlign:"center",background:"#c0c0c0",padding:"8px",border:"2px inset #c0c0c0",maxWidth:"200px"},children:[" Error loading model:",ie.jsx("br",{}),i]})}),BJ=({modelUrl:i,modelName:e,onClose:t,style:n={},className:s=""})=>{const[r,o]=ue.useState(null),[c,f]=ue.useState(!1),p=b=>{console.error("3D Model loading error:",b),o(b.message||"Failed to load 3D model")},m=()=>{f(!c)},y={width:c?"80vw":"400px",height:c?"80vh":"300px",background:"#c0c0c0",border:"2px outset #c0c0c0",borderRadius:"0",position:"relative",overflow:"hidden",fontFamily:"'Pixelify Sans', monospace",...n},v={background:"#008080",color:"#ffffff",padding:"4px 8px",fontSize:"11px",fontFamily:"'Pixelify Sans', monospace",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #404040"},x={width:"100%",height:"calc(100% - 28px)",background:"linear-gradient(45deg, #e0e0e0 25%, transparent 25%), linear-gradient(-45deg, #e0e0e0 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #e0e0e0 75%), linear-gradient(-45deg, transparent 75%, #e0e0e0 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"};return ie.jsxs("div",{className:s,style:y,children:[ie.jsxs("div",{style:v,children:[ie.jsxs("span",{title:e,children:[" ",e.length>25?e.substring(0,25)+"...":e]}),ie.jsxs("div",{children:[ie.jsx("button",{onClick:m,style:{background:"none",border:"none",color:"#ffffff",fontSize:"12px",cursor:"pointer",marginRight:"8px"},title:c?"Exit Fullscreen":"Fullscreen",children:c?"":""}),t&&ie.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ffffff",fontSize:"12px",cursor:"pointer"},title:"Close",children:""})]})]}),ie.jsx("div",{style:x,children:ie.jsxs(TK,{camera:{position:[0,0,5],fov:50},onError:p,gl:{antialias:!0,alpha:!0,preserveDrawingBuffer:!0},children:[ie.jsx("ambientLight",{intensity:.5}),ie.jsx("directionalLight",{position:[10,10,5],intensity:1}),ie.jsx("directionalLight",{position:[-10,-10,-5],intensity:.3}),ie.jsx(ue.Suspense,{fallback:ie.jsx(DJ,{}),children:r?ie.jsx(IJ,{error:r}):ie.jsx(wJ,{url:i})}),ie.jsx(CJ,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:1,maxDistance:20})]})})]})};dg.preload=i=>dg(i);const NJ=({id:i,model:e,initialSize:t={width:400,height:328},onPositionChange:n,onPositionChangeLocal:s,onSizeChange:r,onSizeChangeLocal:o,onDelete:c})=>{const[f,p]=ue.useState(t),m=ue.useCallback((x,b)=>{s(i,b),n(i,b)},[i,n,s]),y=ue.useCallback((x,b)=>{p(b),o(i,b),r(i,b)},[i,r,o]),v=ue.useCallback(()=>{c(i)},[i,c]);return ie.jsx(xO,{id:i,title:` ${e.name.length>25?e.name.substring(0,25)+"...":e.name}`,position:e.position,size:f,onPositionChange:m,onSizeChange:y,onClose:v,zIndex:1e3,children:ie.jsx("div",{style:{width:"100%",height:"100%"},children:ie.jsx(BJ,{modelUrl:e.url,modelName:e.name,style:{width:"100%",height:"100%",border:"none"}})})})},OJ=()=>{const{models:i,uploading:e,uploadProgress:t,uploadModel:n,updateModelPosition:s,deleteModel:r,error:o}=Q9(),{startSync:c,endSync:f,onStorageChange:p}=J_(),[m,y]=ue.useState(!1),[v,x]=ue.useState({}),[b,R]=ue.useState({}),M=ue.useCallback(T_((W,k)=>{c(),s(W,k),setTimeout(f,1200)},500),[s,c,f]),T=ue.useCallback(T_((W,k)=>{console.log("Size update - not persisted to backend yet")},500),[]),D=ue.useCallback(async(W,k)=>{await n(W,k),p()},[n,p]),B=ue.useCallback(async W=>{await r(W),p()},[r,p]),L=ue.useCallback((W,k)=>{x(he=>({...he,[W]:k}))},[]),G=ue.useCallback((W,k)=>{M(W,k)},[M]),H=ue.useCallback((W,k)=>{R(he=>({...he,[W]:k}))},[]),F=ue.useCallback((W,k)=>{T(W,k)},[T]),U=ue.useCallback(async(W,k,he)=>{const me=W.filter(q=>q.type==="model/gltf-binary"||q.name.toLowerCase().endsWith(".glb")||q.name.toLowerCase().endsWith(".gltf"));if(me.length!==0)for(const q of me){const ee={x:k-200,y:he-150};await D(q,ee)}},[D]);ue.useEffect(()=>{const W=k=>{const{files:he,originalEvent:me}=k.detail;U(he,me.clientX,me.clientY)};return document.addEventListener("non-image-files-dropped",W),()=>{document.removeEventListener("non-image-files-dropped",W)}},[U]);const I=ue.useCallback(W=>{W.preventDefault(),y(!0)},[]),N=ue.useCallback(W=>{W.preventDefault(),y(!1)},[]),z=ue.useCallback(async W=>{W.preventDefault(),y(!1);const k=Array.from(W.dataTransfer.files);await U(k,W.clientX,W.clientY)},[U]);return ie.jsxs(ie.Fragment,{children:[ie.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:m?9999:-1,background:m?"rgba(0, 128, 128, 0.3)":"transparent",border:m?"4px dashed #008080":"none",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:m?"auto":"none",transition:"all 0.2s ease",fontFamily:"'Pixelify Sans', monospace"},onDragOver:I,onDragLeave:N,onDrop:z,children:m&&ie.jsx("div",{style:{background:"#c0c0c0",border:"2px outset #c0c0c0",padding:"20px",fontSize:"16px",color:"#000000",textAlign:"center",borderRadius:"0"},children:" Drop GLB/GLTF files to create 3D viewers"})}),e&&ie.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"#c0c0c0",border:"2px outset #c0c0c0",padding:"12px",zIndex:1e4,fontFamily:"'Pixelify Sans', monospace",fontSize:"11px"},children:[ie.jsx("div",{style:{marginBottom:"8px"},children:"Uploading 3D Model..."}),ie.jsx("div",{style:{width:"200px",height:"20px",background:"#808080",border:"1px inset #c0c0c0"},children:ie.jsx("div",{style:{width:`${t}%`,height:"100%",background:"#008080",transition:"width 0.3s ease"}})}),ie.jsxs("div",{style:{marginTop:"4px",textAlign:"center"},children:[Math.round(t),"%"]})]}),o&&ie.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"#c0c0c0",border:"2px inset #c0c0c0",padding:"12px",zIndex:1e4,color:"#800000",fontFamily:"'Pixelify Sans', monospace",fontSize:"10px",maxWidth:"300px"},children:[" ",o]}),i.map(W=>{const k=v[W.id]||W.position,he=b[W.id]||{width:400,height:328};return ie.jsx(NJ,{id:W.id,model:{...W,position:k},initialSize:he,onPositionChange:G,onPositionChangeLocal:L,onSizeChange:F,onSizeChangeLocal:H,onDelete:B},W.id)})]})},BT=({children:i,style:e="raised",size:t=2,className:n="",customStyle:s={},onClick:r})=>{const o=()=>{const c="#ffffff",f="#c0c0c0",p="#808080",m="#000000";switch(e){case"raised":return{borderStyle:"solid",borderWidth:`${t}px`,borderTopColor:c,borderLeftColor:c,borderRightColor:t>1?m:p,borderBottomColor:t>1?m:p,backgroundColor:f};case"inset":return{borderStyle:"solid",borderWidth:`${t}px`,borderTopColor:t>1?m:p,borderLeftColor:t>1?m:p,borderRightColor:c,borderBottomColor:c,backgroundColor:f};case"flat":return{borderStyle:"solid",borderWidth:`${t}px`,borderColor:p,backgroundColor:f};default:return{}}};return ie.jsx("div",{className:n,onClick:r,style:{...o(),...s},children:i})},NT=({children:i,borderStyle:e="raised",borderWidth:t=2,cornerRadius:n=0,className:s="",style:r={},onClick:o})=>{const c={light:"#ffffff",medium:"#c0c0c0",dark:"#808080",black:"#000000"},p=(()=>{switch(e){case"raised":return{top:c.light,left:c.light,right:c.black,bottom:c.black,topInner:t>1?c.medium:c.light,leftInner:t>1?c.medium:c.light,rightInner:t>1?c.dark:c.black,bottomInner:t>1?c.dark:c.black};case"inset":return{top:c.black,left:c.black,right:c.light,bottom:c.light,topInner:t>1?c.dark:c.black,leftInner:t>1?c.dark:c.black,rightInner:t>1?c.medium:c.light,bottomInner:t>1?c.medium:c.light};case"flat":return{top:c.dark,left:c.dark,right:c.dark,bottom:c.dark,topInner:c.dark,leftInner:c.dark,rightInner:c.dark,bottomInner:c.dark};default:return{top:c.medium,left:c.medium,right:c.medium,bottom:c.medium,topInner:c.medium,leftInner:c.medium,rightInner:c.medium,bottomInner:c.medium}}})();return t>2?ie.jsxs("div",{className:s,onClick:o,style:{position:"relative",backgroundColor:c.medium,...r},children:[ie.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,borderStyle:"solid",borderWidth:"1px",borderTopColor:p.top,borderLeftColor:p.left,borderRightColor:p.right,borderBottomColor:p.bottom,borderRadius:n}}),ie.jsx("div",{style:{position:"absolute",top:"1px",left:"1px",right:"1px",bottom:"1px",borderStyle:"solid",borderWidth:`${t-1}px`,borderTopColor:p.topInner,borderLeftColor:p.leftInner,borderRightColor:p.rightInner,borderBottomColor:p.bottomInner,borderRadius:Math.max(0,n-1)}}),ie.jsx("div",{style:{position:"relative",margin:`${t}px`,zIndex:1},children:i})]}):ie.jsx("div",{className:s,onClick:o,style:{borderStyle:"solid",borderWidth:`${t}px`,borderTopColor:p.top,borderLeftColor:p.left,borderRightColor:p.right,borderBottomColor:p.bottom,backgroundColor:c.medium,borderRadius:n,...r},children:i})},vl=({children:i,borderStyle:e="raised",className:t="",style:n={},onClick:s,disabled:r=!1})=>{const o={light:"#ffffff",medium:"#c0c0c0",dark:"#808080",black:"#000000"},f=(()=>{switch(e){case"raised":return{outerTop:o.light,outerLeft:o.light,outerRight:o.black,outerBottom:o.black,innerTop:o.medium,innerLeft:o.medium,innerRight:o.dark,innerBottom:o.dark,background:o.medium,borderWidth:2};case"inset":return{outerTop:o.black,outerLeft:o.black,outerRight:o.light,outerBottom:o.light,innerTop:o.dark,innerLeft:o.dark,innerRight:o.medium,innerBottom:o.medium,background:o.medium,borderWidth:2};case"window":return{outerTop:o.light,outerLeft:o.light,outerRight:o.black,outerBottom:o.black,innerTop:o.medium,innerLeft:o.medium,innerRight:o.dark,innerBottom:o.dark,background:o.medium,borderWidth:2};case"button":return{outerTop:r?o.dark:o.light,outerLeft:r?o.dark:o.light,outerRight:r?o.light:o.black,outerBottom:r?o.light:o.black,innerTop:o.medium,innerLeft:o.medium,innerRight:r?o.medium:o.dark,innerBottom:r?o.medium:o.dark,background:o.medium,borderWidth:2};case"textbox":return{outerTop:o.black,outerLeft:o.black,outerRight:o.light,outerBottom:o.light,innerTop:o.dark,innerLeft:o.dark,innerRight:o.medium,innerBottom:o.medium,background:o.light,borderWidth:2};default:return{outerTop:o.medium,outerLeft:o.medium,outerRight:o.medium,outerBottom:o.medium,innerTop:o.medium,innerLeft:o.medium,innerRight:o.medium,innerBottom:o.medium,background:o.medium,borderWidth:1}}})(),p={position:"relative",display:"inline-block",minWidth:f.borderWidth*4,minHeight:f.borderWidth*4,cursor:s?"pointer":void 0,...n},m={position:"absolute",top:0,left:0,right:0,bottom:0,borderStyle:"solid",borderWidth:"1px",borderTopColor:f.outerTop,borderLeftColor:f.outerLeft,borderRightColor:f.outerRight,borderBottomColor:f.outerBottom,backgroundColor:f.background},y=f.borderWidth>1?{position:"absolute",top:"1px",left:"1px",right:"1px",bottom:"1px",borderStyle:"solid",borderWidth:"1px",borderTopColor:f.innerTop,borderLeftColor:f.innerLeft,borderRightColor:f.innerRight,borderBottomColor:f.innerBottom}:{},v={position:"relative",padding:e==="textbox"?"2px 4px":"4px",margin:`${f.borderWidth}px`,zIndex:1,fontFamily:"'Pixelify Sans', monospace",fontSize:"11px",color:e==="textbox"?o.black:void 0};return ie.jsxs("div",{className:t,onClick:s,style:p,children:[ie.jsx("div",{style:m}),f.borderWidth>1&&ie.jsx("div",{style:y}),ie.jsx("div",{style:v,children:i})]})},CA=({children:i,borderStyle:e="raised",cornerStyle:t="gothic",className:n="",style:s={},onClick:r,disabled:o=!1})=>{const c={light:"#ffffff",medium:"#c0c0c0",dark:"#808080",black:"#000000",gold:"#ffd700",bronze:"#cd7f32"},f=()=>{switch(e){case"raised":return{outerTop:c.light,outerLeft:c.light,outerRight:c.black,outerBottom:c.black,innerTop:c.medium,innerLeft:c.medium,innerRight:c.dark,innerBottom:c.dark,background:c.medium};case"inset":return{outerTop:c.black,outerLeft:c.black,outerRight:c.light,outerBottom:c.light,innerTop:c.dark,innerLeft:c.dark,innerRight:c.medium,innerBottom:c.medium,background:c.medium};case"ornate":return{outerTop:c.gold,outerLeft:c.gold,outerRight:c.bronze,outerBottom:c.bronze,innerTop:c.light,innerLeft:c.light,innerRight:c.dark,innerBottom:c.dark,background:c.medium};default:return{outerTop:c.light,outerLeft:c.light,outerRight:c.black,outerBottom:c.black,innerTop:c.medium,innerLeft:c.medium,innerRight:c.dark,innerBottom:c.dark,background:c.medium}}},p=R=>{const M={position:"absolute",width:"16px",height:"16px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"'Jacquard 12', monospace",fontWeight:"bold",zIndex:10,textShadow:"1px 1px 0px rgba(0,0,0,0.3)"},T={topLeft:{top:"-2px",left:"-2px"},topRight:{top:"-2px",right:"-2px"},bottomLeft:{bottom:"-2px",left:"-2px"},bottomRight:{bottom:"-2px",right:"-2px"}};let D="",B=c.gold;switch(t){case"gothic":D=["","","",""][["topLeft","topRight","bottomLeft","bottomRight"].indexOf(R)],B=e==="ornate"?c.gold:c.dark;break;case"carved":D=["","","",""][["topLeft","topRight","bottomLeft","bottomRight"].indexOf(R)],B=c.dark;break;case"jeweled":D=["","","",""][["topLeft","topRight","bottomLeft","bottomRight"].indexOf(R)],B=e==="ornate"?c.gold:c.bronze;break;case"scrollwork":D=["","","",""][["topLeft","topRight","bottomLeft","bottomRight"].indexOf(R)],B=c.bronze;break;default:D="",B=c.dark;break}return ie.jsx("div",{style:{...M,...T[R],color:B,background:e==="ornate"?`radial-gradient(circle, ${c.light} 0%, ${c.medium} 100%)`:c.medium,borderRadius:"50%",border:`1px solid ${c.dark}`},children:D})},m=f(),y={position:"relative",display:"inline-block",minWidth:"40px",minHeight:"40px",cursor:r?"pointer":void 0,...s},v={position:"absolute",top:0,left:0,right:0,bottom:0,borderStyle:"solid",borderWidth:"2px",borderTopColor:m.outerTop,borderLeftColor:m.outerLeft,borderRightColor:m.outerRight,borderBottomColor:m.outerBottom,backgroundColor:m.background},x={position:"absolute",top:"2px",left:"2px",right:"2px",bottom:"2px",borderStyle:"solid",borderWidth:"1px",borderTopColor:m.innerTop,borderLeftColor:m.innerLeft,borderRightColor:m.innerRight,borderBottomColor:m.innerBottom},b={position:"relative",padding:"8px 12px",margin:"6px",zIndex:1,fontFamily:"'Pixelify Sans', monospace",fontSize:"11px"};return ie.jsxs("div",{className:n,onClick:o?void 0:r,style:{...y,opacity:o?.6:1,cursor:o?"not-allowed":r?"pointer":"default"},children:[ie.jsx("div",{style:v}),ie.jsx("div",{style:x}),p("topLeft"),p("topRight"),p("bottomLeft"),p("bottomRight"),ie.jsx("div",{style:b,children:i})]})},RA=({children:i,theme:e="medieval",size:t="medium",ornamentLevel:n="decorative",className:s="",style:r={},onClick:o})=>{const c={medieval:{primary:"#8B4513",secondary:"#DAA520",accent:"#CD853F",light:"#F5DEB3",dark:"#654321"},gothic:{primary:"#2F2F2F",secondary:"#FFD700",accent:"#8B0000",light:"#D3D3D3",dark:"#000000"},renaissance:{primary:"#B8860B",secondary:"#FF6347",accent:"#4169E1",light:"#FFFACD",dark:"#8B4513"},celtic:{primary:"#228B22",secondary:"#FFD700",accent:"#4169E1",light:"#F0FFF0",dark:"#006400"}},f={small:{border:8,corner:12,font:"8px"},medium:{border:12,corner:16,font:"10px"},large:{border:16,corner:20,font:"12px"}},p=c[e],m=f[t],y=T=>{const D={minimal:{tl:"",tr:"",bl:"",br:""},decorative:{tl:"",tr:"",bl:"",br:""},elaborate:{tl:"",tr:"",bl:"",br:""}},B={tl:{top:"-4px",left:"-4px"},tr:{top:"-4px",right:"-4px"},bl:{bottom:"-4px",left:"-4px"},br:{bottom:"-4px",right:"-4px"}};return ie.jsx("div",{style:{position:"absolute",...B[T],width:`${m.corner}px`,height:`${m.corner}px`,background:`radial-gradient(circle, ${p.secondary} 0%, ${p.primary} 70%, ${p.dark} 100%)`,border:`2px solid ${p.dark}`,borderRadius:n==="elaborate"?"50%":"20%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:m.font,color:p.light,fontFamily:"'Jacquard 12', monospace",fontWeight:"bold",textShadow:`1px 1px 0px ${p.dark}`,boxShadow:`inset 1px 1px 0px ${p.light}, inset -1px -1px 0px ${p.dark}`,zIndex:10},children:D[n][T]})},v=T=>{const D={top:{position:"absolute",top:"0px",left:"50%",transform:"translateX(-50%)",width:"60%",height:"4px",background:`linear-gradient(90deg, transparent 0%, ${p.secondary} 20%, ${p.primary} 50%, ${p.secondary} 80%, transparent 100%)`,borderRadius:"2px"},bottom:{position:"absolute",bottom:"0px",left:"50%",transform:"translateX(-50%)",width:"60%",height:"4px",background:`linear-gradient(90deg, transparent 0%, ${p.secondary} 20%, ${p.primary} 50%, ${p.secondary} 80%, transparent 100%)`,borderRadius:"2px"},left:{position:"absolute",left:"0px",top:"50%",transform:"translateY(-50%)",width:"4px",height:"60%",background:`linear-gradient(180deg, transparent 0%, ${p.secondary} 20%, ${p.primary} 50%, ${p.secondary} 80%, transparent 100%)`,borderRadius:"2px"},right:{position:"absolute",right:"0px",top:"50%",transform:"translateY(-50%)",width:"4px",height:"60%",background:`linear-gradient(180deg, transparent 0%, ${p.secondary} 20%, ${p.primary} 50%, ${p.secondary} 80%, transparent 100%)`,borderRadius:"2px"}};return ie.jsx("div",{style:D[T]})},x={position:"relative",display:"inline-block",minWidth:`${m.border*4}px`,minHeight:`${m.border*4}px`,cursor:o?"pointer":void 0,...r},b={position:"absolute",top:0,left:0,right:0,bottom:0,background:`linear-gradient(135deg, ${p.light} 0%, ${p.primary} 50%, ${p.dark} 100%)`,border:`3px solid ${p.dark}`,borderRadius:"4px"},R={position:"absolute",top:"6px",left:"6px",right:"6px",bottom:"6px",background:"#c0c0c0",border:"2px solid",borderColor:"#ffffff #808080 #808080 #ffffff",borderRadius:"2px"},M={position:"relative",padding:`${m.border}px`,margin:`${m.border+4}px`,zIndex:1,fontFamily:"'Pixelify Sans', monospace",fontSize:"11px"};return ie.jsxs("div",{className:s,onClick:o,style:x,children:[ie.jsx("div",{style:b}),ie.jsx("div",{style:R}),n==="elaborate"&&ie.jsxs(ie.Fragment,{children:[v("top"),v("right"),v("bottom"),v("left")]}),y("tl"),y("tr"),y("bl"),y("br"),ie.jsx("div",{style:M,children:i})]})},wA=({style:i="fleurDeLis",size:e=16,color:t="#DAA520",position:n})=>{const s=()=>{switch(i){case"fleurDeLis":return"";case"celtic":return"";case"gothic":return"";case"baroque":return"";case"runes":return"";default:return""}},r=()=>{const o=-e/2;switch(n){case"topLeft":return{top:o,left:o};case"topRight":return{top:o,right:o};case"bottomLeft":return{bottom:o,left:o};case"bottomRight":return{bottom:o,right:o}}};return ie.jsx("div",{style:{position:"absolute",width:e,height:e,...r(),background:`radial-gradient(circle, ${t} 0%, #8B4513 70%, #654321 100%)`,border:"2px solid #654321",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${e*.6}px`,color:"#F5DEB3",fontFamily:"'Jacquard 12', monospace",fontWeight:"bold",textShadow:"1px 1px 0px #654321",boxShadow:"inset 1px 1px 0px rgba(245, 222, 179, 0.5), inset -1px -1px 0px rgba(101, 67, 33, 0.8)",zIndex:10},children:s()})},DA=({children:i,cornerStyle:e="fleurDeLis",cornerSize:t=16,cornerColor:n="#DAA520",showCorners:s=[!0,!0,!0,!0],className:r="",style:o={}})=>ie.jsxs("div",{className:r,style:{position:"relative",display:"inline-block",...o},children:[i,s[0]&&ie.jsx(wA,{style:e,size:t,color:n,position:"topLeft"}),s[1]&&ie.jsx(wA,{style:e,size:t,color:n,position:"topRight"}),s[2]&&ie.jsx(wA,{style:e,size:t,color:n,position:"bottomLeft"}),s[3]&&ie.jsx(wA,{style:e,size:t,color:n,position:"bottomRight"})]}),LJ=()=>{const[i,e]=ue.useState(null);return ie.jsxs("div",{style:{padding:"20px",fontFamily:"'Pixelify Sans', monospace",fontSize:"11px",display:"flex",flexDirection:"column",gap:"20px"},children:[ie.jsx("h2",{style:{fontFamily:"'Jacquard 12', monospace",fontSize:"14px"},children:"Windows 95 UI Kit Demo"}),ie.jsxs("div",{children:[ie.jsx("h3",{style:{marginBottom:"10px"},children:"BorderBox Components:"}),ie.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[ie.jsx(BT,{style:"raised",size:2,customStyle:{padding:"8px",minWidth:"100px"},children:"Raised Border"}),ie.jsx(BT,{style:"inset",size:2,customStyle:{padding:"8px",minWidth:"100px"},children:"Inset Border"}),ie.jsx(BT,{style:"flat",size:1,customStyle:{padding:"8px",minWidth:"100px"},children:"Flat Border"})]})]}),ie.jsxs("div",{children:[ie.jsx("h3",{style:{marginBottom:"10px"},children:"ScalableBorder Components:"}),ie.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[ie.jsx(NT,{borderStyle:"raised",borderWidth:3,style:{padding:"12px",minWidth:"120px"},children:"Thick Raised Border"}),ie.jsx(NT,{borderStyle:"inset",borderWidth:4,style:{padding:"12px",minWidth:"120px"},children:"Very Thick Inset"}),ie.jsx(NT,{borderStyle:"raised",borderWidth:2,cornerRadius:4,style:{padding:"12px",minWidth:"120px"},children:"Rounded Corners"})]})]}),ie.jsxs("div",{children:[ie.jsx("h3",{style:{marginBottom:"10px"},children:"NineSliceBorder Components:"}),ie.jsx(vl,{borderStyle:"window",style:{width:"300px",height:"200px",marginBottom:"10px"},children:ie.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[ie.jsx("div",{style:{backgroundColor:"#008080",color:"white",padding:"2px 4px",marginBottom:"4px",fontWeight:"bold"},children:"Window Title Bar"}),ie.jsx("div",{style:{flex:1,overflow:"auto"},children:"This is a resizable window content area. It maintains proper borders at any size."})]})}),ie.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"10px"},children:[ie.jsx(vl,{borderStyle:"button",onClick:()=>e("btn1"),style:{minWidth:"80px"},children:"Normal Button"}),ie.jsx(vl,{borderStyle:"button",disabled:!0,style:{minWidth:"80px"},children:"Disabled Button"}),ie.jsx(vl,{borderStyle:i==="btn3"?"inset":"button",onClick:()=>e(i==="btn3"?null:"btn3"),style:{minWidth:"80px"},children:"Toggle Button"})]}),ie.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[ie.jsx(vl,{borderStyle:"textbox",style:{minWidth:"150px"},children:ie.jsx("input",{type:"text",placeholder:"Text input...",style:{border:"none",outline:"none",background:"transparent",fontFamily:"'Pixelify Sans', monospace",fontSize:"11px",width:"100%"}})}),ie.jsx(vl,{borderStyle:"textbox",style:{minWidth:"200px",height:"60px"},children:ie.jsx("textarea",{placeholder:"Multi-line text...",style:{border:"none",outline:"none",background:"transparent",fontFamily:"'Pixelify Sans', monospace",fontSize:"11px",width:"100%",height:"100%",resize:"none"}})})]})]}),ie.jsxs("div",{children:[ie.jsx("h3",{style:{marginBottom:"10px"},children:"Resizable Demo:"}),ie.jsx(vl,{borderStyle:"window",style:{resize:"both",overflow:"auto",minWidth:"200px",minHeight:"100px",width:"250px",height:"150px"},children:ie.jsx("div",{children:"Try resizing this window by dragging the bottom-right corner. The borders will scale properly at any size!"})})]}),ie.jsxs("div",{children:[ie.jsx("h3",{style:{marginBottom:"10px"},children:"Medieval Ornamental Borders:"}),ie.jsxs("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap",marginBottom:"15px"},children:[ie.jsx(CA,{cornerStyle:"gothic",borderStyle:"raised",children:"Gothic Corners"}),ie.jsx(CA,{cornerStyle:"jeweled",borderStyle:"ornate",children:"Jeweled Ornate"}),ie.jsx(CA,{cornerStyle:"scrollwork",borderStyle:"raised",children:"Scrollwork Design"}),ie.jsx(CA,{cornerStyle:"carved",borderStyle:"inset",children:"Carved Style"})]}),ie.jsxs("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap",marginBottom:"15px"},children:[ie.jsx(RA,{theme:"medieval",ornamentLevel:"elaborate",size:"medium",children:"Medieval Theme"}),ie.jsx(RA,{theme:"gothic",ornamentLevel:"decorative",size:"medium",children:"Gothic Theme"}),ie.jsx(RA,{theme:"renaissance",ornamentLevel:"elaborate",size:"large",children:"Renaissance"}),ie.jsx(RA,{theme:"celtic",ornamentLevel:"decorative",size:"medium",children:"Celtic Design"})]}),ie.jsxs("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap"},children:[ie.jsx(DA,{cornerStyle:"fleurDeLis",cornerSize:20,children:ie.jsx(vl,{borderStyle:"window",style:{padding:"10px",minWidth:"120px"},children:"Fleur-de-Lis Corners"})}),ie.jsx(DA,{cornerStyle:"celtic",cornerSize:18,cornerColor:"#228B22",children:ie.jsx(vl,{borderStyle:"raised",style:{padding:"10px",minWidth:"120px"},children:"Celtic Corners"})}),ie.jsx(DA,{cornerStyle:"runes",cornerSize:16,cornerColor:"#8B0000",children:ie.jsx(vl,{borderStyle:"button",style:{padding:"10px",minWidth:"120px"},children:"Runic Corners"})})]})]}),ie.jsxs("div",{children:[ie.jsx("h3",{style:{marginBottom:"10px"},children:"Mixed Styles - Medieval Windows:"}),ie.jsx(DA,{cornerStyle:"gothic",cornerSize:24,cornerColor:"#FFD700",children:ie.jsx(vl,{borderStyle:"window",style:{width:"400px",height:"250px",resize:"both",overflow:"auto"},children:ie.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[ie.jsx("div",{style:{backgroundColor:"#8B4513",color:"#F5DEB3",padding:"4px 8px",marginBottom:"8px",fontWeight:"bold",fontFamily:"'Jacquard 12', monospace"},children:" Medieval Window "}),ie.jsxs("div",{style:{flex:1,overflow:"auto"},children:["This window combines Windows 95 functionality with medieval aesthetics. The ornate corners add character while maintaining the practical resizable interface.",ie.jsx("br",{}),ie.jsx("br",{}),"Try resizing this window to see how the ornamental corners stay perfectly positioned!"]})]})})})]})]})},UJ=()=>{const i=async()=>{try{await N4(oa,AO)}catch(e){console.error("Authentication failed:",e)}};return ie.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:ot.desktop},children:ie.jsxs("div",{style:{background:ot.windowBg,padding:"40px",border:"2px solid",borderColor:`${ot.borderLight} ${ot.borderDark} ${ot.borderDark} ${ot.borderLight}`,textAlign:"center",fontFamily:"'Pixelify Sans', monospace"},children:[ie.jsx("h1",{style:{margin:"0 0 20px 0",color:"#000000",fontSize:"16px",fontFamily:"'Jacquard 12', monospace"},children:"Dashboard Login"}),ie.jsx("p",{style:{margin:"0 0 30px 0",color:"#000000",fontFamily:"'Pixelify Sans', monospace"},children:"Please sign in to continue"}),ie.jsx(Zi,{onClick:i,children:"Sign In with Google"})]})})},PJ={search:T9,rss:I9,notes:z9,ai:V9,bookmarks:k9,calendar:j9,uidemo:LJ},FJ=()=>{const[i,e]=ue.useState(new Date().toLocaleTimeString()),[t,n]=ue.useState(null),[s,r]=ue.useState(!0),{windows:o,activeWindow:c,addWindow:f,removeWindow:p,updateWindowPosition:m,updateWindowSize:y,focusWindow:v,saveLayout:x,loadLayout:b,clearAll:R,setUserId:M}=k1();ue.useEffect(()=>{const D=oB(oa,B=>{n(B),M(B?.uid||null),r(!1),B&&b()});return()=>D()},[b,M]),ue.useEffect(()=>{const D=setInterval(()=>{e(new Date().toLocaleTimeString())},1e3);return()=>clearInterval(D)},[]);const T=async()=>{await d4(oa)};return s?ie.jsx("div",{style:{background:ot.desktop,height:"100vh",color:"#000000",display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"'Pixelify Sans', monospace"},children:"Loading..."}):t?ie.jsxs("div",{style:{minHeight:"100vh",background:ot.desktop,fontFamily:"'Pixelify Sans', monospace",position:"relative",overflow:"hidden"},children:[o.map(D=>{const B=PJ[D.type];return ie.jsx("div",{onClick:()=>v(D.id),children:ie.jsx(xO,{id:D.id,title:D.title,position:D.position,size:D.size,onPositionChange:m,onSizeChange:y,onClose:()=>p(D.id),zIndex:c===D.id?1e3:100,children:ie.jsx(B,{})})},D.id)}),ie.jsx(K9,{}),ie.jsx(OJ,{}),ie.jsx(b9,{windows:o,activeWindow:c,onAddWindow:f,onFocusWindow:v,onSaveLayout:x,onClearAll:R,onLogout:T,currentTime:i})]}):ie.jsx(UJ,{})};function zJ(){return ie.jsx(x9,{children:ie.jsx(FJ,{})})}jP.createRoot(document.getElementById("root")).render(ie.jsx(wd.StrictMode,{children:ie.jsx(zJ,{})}));
